<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Responder - Walkthrough | Ee-Vah?</title><meta name=keywords content="htb,walkthrough,vaccine,tier-2,free-tier,web,network,vulnerability-assessment,databases,injection,custom-applications,protocols,source-code-analysis,apache,postgresql,ftp,php,reconnaissance,password-cracking,sudo-exploitation,sql-injection,remote-code-execution,clear-text-credentials,anonymous-access,guest-access"><meta name=description content="The aim of this walkthrough is to provide help with the Vaccine machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta name=author content="bluewalle"><link rel=canonical href=https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_2/vaccine/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bluewalle.github.io/main/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://bluewalle.github.io/main/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bluewalle.github.io/main/img/favicon-32x32.png><link rel=apple-touch-icon href=https://bluewalle.github.io/main/img/apple-touch-icon.png><link rel=mask-icon href=https://bluewalle.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB - Responder - Walkthrough"><meta property="og:description" content="The aim of this walkthrough is to provide help with the Vaccine machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta property="og:type" content="article"><meta property="og:url" content="https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_2/vaccine/"><meta property="og:image" content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-13T08:00:00+00:00"><meta property="article:modified_time" content="2023-05-13T08:00:00+00:00"><meta property="og:site_name" content="Just Keep Swimming"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HTB - Responder - Walkthrough"><meta name=twitter:description content="The aim of this walkthrough is to provide help with the Vaccine machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.
SETUP There are a couple of ways to connect to the target machine."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bluewalle.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Responder - Walkthrough","item":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_2/vaccine/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Responder - Walkthrough","name":"HTB - Responder - Walkthrough","description":"The aim of this walkthrough is to provide help with the Vaccine machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.\nSETUP There are a couple of ways to connect to the target machine.","keywords":["htb","walkthrough","vaccine","tier-2","free-tier","web","network","vulnerability-assessment","databases","injection","custom-applications","protocols","source-code-analysis","apache","postgresql","ftp","php","reconnaissance","password-cracking","sudo-exploitation","sql-injection","remote-code-execution","clear-text-credentials","anonymous-access","guest-access"],"articleBody":"The aim of this walkthrough is to provide help with the Vaccine machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.\nSETUP There are a couple of ways to connect to the target machine. The one we will be using throughout this walkthrough is via the provided pwnbox.\nOnce our connection is taken care of, we spawn the target machine.\nAdditionally - even though not required - it is possible to set a local variable (only available in the current shell) containing our target host’s IP address. Once set, we can easily access it by prepending a $ to our variable name.\n┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $rhost= ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ echo $rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ We could use the unset command to remove it after we no longer need it.\n┌─[✗]─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $unset rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ TASK 1 Question: Besides SSH and HTTP, what other service is hosted on this box?\nWe start out with a quick connection check\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ ping $rhost -c 4 PING 10.129.30.132 (10.129.30.132) 56(84) bytes of data. 64 bytes from 10.129.30.132: icmp_seq=1 ttl=63 time=10.6 ms 64 bytes from 10.129.30.132: icmp_seq=2 ttl=63 time=11.0 ms 64 bytes from 10.129.30.132: icmp_seq=3 ttl=63 time=11.0 ms 64 bytes from 10.129.30.132: icmp_seq=4 ttl=63 time=10.5 ms --- 10.129.30.132 ping statistics --- 4 packets transmitted, 4 received, 0% packet loss, time 3004ms rtt min/avg/max/mdev = 10.457/10.765/11.029/0.240 ms ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ and follow up on it with the usual (version and script | top 1000 ports) nmap scan.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ nmap -sC -sV $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-13 10:46 BST Nmap scan report for 10.129.30.132 Host is up (0.039s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_-rwxr-xr-x 1 0 0 2533 Apr 13 2021 backup.zip | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:10.10.14.46 | Logged in as ftpuser | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 2 | vsFTPd 3.0.3 - secure, fast, stable |_End of status 22/tcp open ssh OpenSSH 8.0p1 Ubuntu 6ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 c0ee58077534b00b9165b259569527a4 (RSA) | 256 ac6e81188922d7a7417d814f1bb8b251 (ECDSA) |_ 256 425bc321dfefa20bc95e03421d69d028 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set |_http-title: MegaCorp Login |_http-server-header: Apache/2.4.41 (Ubuntu) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 9.58 seconds ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ Couple of things that may stand out at first look:\nftp anonymous/guest login is allowed there is a file backup.zip which we can access via ftp ssh version is 1:8.0p1-6ubuntu0.1 apache webserver is running with version Apache httpd 2.4.41 running os is probably Ubuntu 19.10 - Eoan Ermine We continue with a quick fingerprinting.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ whatweb $rhost http://10.129.30.132 [200 OK] Apache[2.4.41], Cookies[PHPSESSID], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.129.30.132], PasswordField[password], Title[MegaCorp Login] ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ ftp\nTASK 2 Question: This service can be configured to allow login with any password for specific username. What is that username?\nSince anonymous login is enabled on the ftp server, we check it out and proceed downloading the file we spotted earlier (in TASK1).\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ ftp $rhost Connected to 10.129.30.132. 220 (vsFTPd 3.0.3) Name (10.129.30.132:root): anonymous 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u003e ls 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. -rwxr-xr-x 1 0 0 2533 Apr 13 2021 backup.zip 226 Directory send OK. ftp\u003e get backup.zip local: backup.zip remote: backup.zip 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for backup.zip (2533 bytes). 226 Transfer complete. 2533 bytes received in 0.00 secs (16.7754 MB/s) ftp\u003e exit 221 Goodbye. ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ anonymous\nTASK 3 Question: What is the name of the file downloaded over this service?\nTrying to decompress it does not work since it’s password protected.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ ll total 4.0K -rw-r--r-- 1 htb-bluewalle htb-bluewalle 2.5K May 13 10:56 backup.zip ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ unzip backup.zip Archive: backup.zip [backup.zip] index.php password: password incorrect--reenter: ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ backup.zip\nTASK 4 Question: What script comes with the John The Ripper toolset and generates a hash from a password protected zip archive in a format to allow for cracking attempts?\nA quick online search leaves us with two potential candidates:\nzip2john rar2john But given the extension of backup.zip, it should be the first one. Now that we identified the necessary tools, we get to it.\nFirst we create the password hashes to be cracked.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ man john ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ zip2john backup.zip \u003e backup.zip.hash Created directory: /home/htb-bluewalle/.john ver 2.0 efh 5455 efh 7875 backup.zip/index.php PKZIP Encr: 2b chk, TS_chk, cmplen=1201, decmplen=2594, crc=3A41AE06 ver 2.0 efh 5455 efh 7875 backup.zip/style.css PKZIP Encr: 2b chk, TS_chk, cmplen=986, decmplen=3274, crc=1B1CCD6A NOTE: It is assumed that all files in each archive have the same password. If that is not the case, the hash may be uncrackable. To avoid this, use option -o to pick a file at a time. ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ ll total 8.0K -rw-r--r-- 1 htb-bluewalle htb-bluewalle 2.5K May 13 10:56 backup.zip -rw-r--r-- 1 htb-bluewalle htb-bluewalle 2.2K May 13 11:06 backup.zip.hash ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ This is how the resulting password hash looks like:\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ cat backup.zip.hash backup.zip:$pkzip2$2*2*1*0*8*24*3a41*5722*543fb39ed1a919ce7b58641a238e00f4cb3a826cfb1b8f4b225aa15c4ffda8fe72f60a82*2*0*3da*cca*1b1ccd6a*504*43*8*3da*1b1c*989a*22290dc3505e51d341f31925a7ffefc181ef9f66d8d25e53c82afc7c1598fbc3fff28a17ba9d8cec9a52d66a11ac103f257e14885793fe01e26238915796640e8936073177d3e6e28915f5abf20fb2fb2354cf3b7744be3e7a0a9a798bd40b63dc00c2ceaef81beb5d3c2b94e588c58725a07fe4ef86c990872b652b3dae89b2fff1f127142c95a5c3452b997e3312db40aee19b120b85b90f8a8828a13dd114f3401142d4bb6b4e369e308cc81c26912c3d673dc23a15920764f108ed151ebc3648932f1e8befd9554b9c904f6e6f19cbded8e1cac4e48a5be2b250ddfe42f7261444fbed8f86d207578c61c45fb2f48d7984ef7dcf88ed3885aaa12b943be3682b7df461842e3566700298efad66607052bd59c0e861a7672356729e81dc326ef431c4f3a3cdaf784c15fa7eea73adf02d9272e5c35a5d934b859133082a9f0e74d31243e81b72b45ef3074c0b2a676f409ad5aad7efb32971e68adbbb4d34ed681ad638947f35f43bb33217f71cbb0ec9f876ea75c299800bd36ec81017a4938c86fc7dbe2d412ccf032a3dc98f53e22e066defeb32f00a6f91ce9119da438a327d0e6b990eec23ea820fa24d3ed2dc2a7a56e4b21f8599cc75d00a42f02c653f9168249747832500bfd5828eae19a68b84da170d2a55abeb8430d0d77e6469b89da8e0d49bb24dbfc88f27258be9cf0f7fd531a0e980b6defe1f725e55538128fe52d296b3119b7e4149da3716abac1acd841afcbf79474911196d8596f79862dea26f555c772bbd1d0601814cb0e5939ce6e4452182d23167a287c5a18464581baab1d5f7d5d58d8087b7d0ca8647481e2d4cb6bc2e63aa9bc8c5d4dfc51f9cd2a1ee12a6a44a6e64ac208365180c1fa02bf4f627d5ca5c817cc101ce689afe130e1e6682123635a6e524e2833335f3a44704de5300b8d196df50660bb4dbb7b5cb082ce78d79b4b38e8e738e26798d10502281bfed1a9bb6426bfc47ef62841079d41dbe4fd356f53afc211b04af58fe3978f0cf4b96a7a6fc7ded6e2fba800227b186ee598dbf0c14cbfa557056ca836d69e28262a060a201d005b3f2ce736caed814591e4ccde4e2ab6bdbd647b08e543b4b2a5b23bc17488464b2d0359602a45cc26e30cf166720c43d6b5a1fddcfd380a9c7240ea888638e12a4533cfee2c7040a2f293a888d6dcc0d77bf0a2270f765e5ad8bfcbb7e68762359e335dfd2a9563f1d1d9327eb39e68690a8740fc9748483ba64f1d923edfc2754fc020bbfae77d06e8c94fba2a02612c0787b60f0ee78d21a6305fb97ad04bb562db282c223667af8ad907466b88e7052072d6968acb7258fb8846da057b1448a2a9699ac0e5592e369fd6e87d677a1fe91c0d0155fd237bfd2dc49*$/pkzip2$::backup.zip:style.css, index.php:backup.zip ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ It’s time to get cracking\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ john backup.zip.hash Using default input encoding: UTF-8 Loaded 1 password hash (PKZIP [32/64]) Will run 4 OpenMP threads Proceeding with single, rules:Single Press 'q' or Ctrl-C to abort, almost any other key for status Warning: Only 5 candidates buffered for the current salt, minimum 8 needed for performance. Warning: Only 4 candidates buffered for the current salt, minimum 8 needed for performance. Almost done: Processing the remaining buffered candidate passwords, if any. Warning: Only 6 candidates buffered for the current salt, minimum 8 needed for performance. Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist 741852963 (backup.zip) 1g 0:00:00:00 DONE 2/3 (2023-05-13 11:10) 11.11g/s 844766p/s 844766c/s 844766C/s 123456..ferrises Use the \"--show\" option to display all of the cracked passwords reliably Session completed ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ john --show backup.zip.hash backup.zip:741852963::backup.zip:style.css, index.php:backup.zip 1 password hash cracked, 0 left ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ Unzipping the backup.zip file with the password we just found 741852963 will provide us with two source files:\nindex.php style.css ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ unzip backup.zip Archive: backup.zip [backup.zip] index.php password: inflating: index.php inflating: style.css ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ Let’s check them out.\nindex.php\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-xkcyjt5b53]─[~/vaccine] └──╼ [★]$ cat index.php \u003c!DOCTYPE html\u003e \u003c?php session_start(); if(isset($_POST['username']) \u0026\u0026 isset($_POST['password'])) { if($_POST['username'] === 'admin' \u0026\u0026 md5($_POST['password']) === \"2cb42f8734ea607eefed3b70af13bbd3\") { $_SESSION['login'] = \"true\"; header(\"Location: dashboard.php\"); } } ?\u003e ","wordCount":"1843","inLanguage":"en","datePublished":"2023-05-13T08:00:00Z","dateModified":"2023-05-13T08:00:00Z","author":{"@type":"Person","name":"bluewalle"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_2/vaccine/"},"publisher":{"@type":"Organization","name":"Ee-Vah?","logo":{"@type":"ImageObject","url":"https://bluewalle.github.io/main/img/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bluewalle.github.io/ accesskey=h title="Just Keep Swimming (Alt + H)"><img src=https://bluewalle.github.io/apple-touch-icon.png alt aria-label=logo height=35>Just Keep Swimming</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bluewalle.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bluewalle.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://bluewalle.github.io/about title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bluewalle.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bluewalle.github.io/posts/>Posts</a></div><h1 class=post-title>HTB - Responder - Walkthrough<sup><span class=entry-isdraft>&nbsp;&nbsp;[draft]</span></sup></h1><div class=post-meta><span title='2023-05-13 08:00:00 +0000 +0000'>May, 2023</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1843 words&nbsp;·&nbsp;bluewalle</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#setup><strong>SETUP</strong></a></li><li><a href=#task-1><strong>TASK 1</strong></a></li><li><a href=#task-2><strong>TASK 2</strong></a></li><li><a href=#task-3><strong>TASK 3</strong></a></li><li><a href=#task-4><strong>TASK 4</strong></a></li><li><a href=#task-5><strong>TASK 5</strong></a></li><li><a href=#task-6><strong>TASK 6</strong></a></li><li><a href=#task-7><strong>TASK 7</strong></a></li><li><a href=#submit-flag><strong>SUBMIT FLAG</strong></a></li><li><a href=#submit-flag-1><strong>SUBMIT FLAG</strong></a></li></ul></nav></div></details></div><div class=post-content><p>The aim of this walkthrough is to provide help with the <strong>Vaccine</strong> machine on the <a href=https://hackthebox.com title="Hack The Box website">Hack The Box website</a>. Please <strong>note</strong> that no <strong>flags</strong> are directly provided here. Moreover, <strong>be aware</strong> that this is only <strong>one</strong> of the <strong>many</strong> ways to solve the challenges.</p><p>It belongs to a series of tutorials that aim to help out complete beginners with finishing the <a href=https://app.hackthebox.com/starting-point title="HTB Starting Point">Starting Point</a> <strong>TIER 2</strong> challenges.</p><h2 id=setup><strong>SETUP</strong><a hidden class=anchor aria-hidden=true href=#setup>#</a></h2><p>There are a couple of ways to <strong>connect</strong> to the <strong>target machine</strong>. The one we will be using <strong>throughout</strong> this <strong>walkthrough</strong> is via the provided <strong>pwnbox</strong>.</p><p>Once our <strong>connection</strong> is taken care of, we <strong>spawn</strong> the <strong>target</strong> <strong>machine</strong>.</p><p>Additionally - even though not required - it is possible to set a <strong>local</strong> variable (only available in the current <strong>shell</strong>) containing our <strong>target host&rsquo;s</strong> IP address. Once set, we can easily <strong>access</strong> it by prepending a <em>$</em> to our variable name.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$rhost</span><span class=o>=</span>&lt;target-hosts-ip&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $ <span class=nb>echo</span> <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>&lt;target-hosts-ip&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>We could use the <em><strong>unset</strong></em> command to remove it after we no longer need it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$unset</span> rhost 
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><h2 id=task-1><strong>TASK 1</strong><a hidden class=anchor aria-hidden=true href=#task-1>#</a></h2><p><strong>Question</strong>: <em>Besides SSH and HTTP, what other service is hosted on this box?</em></p><p>We start out with a quick <em><strong>connection check</strong></em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ping <span class=nv>$rhost</span> -c <span class=m>4</span>
</span></span><span class=line><span class=cl>PING 10.129.30.132 <span class=o>(</span>10.129.30.132<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.30.132: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>10.6 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.30.132: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>11.0 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.30.132: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>11.0 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.30.132: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>10.5 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.129.30.132 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> received, 0% packet loss, <span class=nb>time</span> 3004ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 10.457/10.765/11.029/0.240 ms
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><p>and follow up on it with the usual (version and script | top 1000 ports) <em><strong>nmap</strong></em> scan.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nmap -sC -sV <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-13 10:46 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.30.132
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.039s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>997</span> closed tcp ports <span class=o>(</span>conn-refused<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>21/tcp open  ftp     vsftpd 3.0.3
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-anon: Anonymous FTP login allowed <span class=o>(</span>FTP code 230<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_-rwxr-xr-x    <span class=m>1</span> <span class=m>0</span>        <span class=m>0</span>            <span class=m>2533</span> Apr <span class=m>13</span>  <span class=m>2021</span> backup.zip
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-syst: 
</span></span><span class=line><span class=cl><span class=p>|</span>   STAT: 
</span></span><span class=line><span class=cl><span class=p>|</span> FTP server status:
</span></span><span class=line><span class=cl><span class=p>|</span>      Connected to ::ffff:10.10.14.46
</span></span><span class=line><span class=cl><span class=p>|</span>      Logged in as ftpuser
</span></span><span class=line><span class=cl><span class=p>|</span>      TYPE: ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>      No session bandwidth limit
</span></span><span class=line><span class=cl><span class=p>|</span>      Session timeout in seconds is <span class=m>300</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      Control connection is plain text
</span></span><span class=line><span class=cl><span class=p>|</span>      Data connections will be plain text
</span></span><span class=line><span class=cl><span class=p>|</span>      At session startup, client count was <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      vsFTPd 3.0.3 - secure, fast, stable
</span></span><span class=line><span class=cl><span class=p>|</span>_End of status
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6ubuntu0.1 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>3072</span> c0ee58077534b00b9165b259569527a4 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> ac6e81188922d7a7417d814f1bb8b251 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> 425bc321dfefa20bc95e03421d69d028 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.41 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span> http-cookie-flags: 
</span></span><span class=line><span class=cl><span class=p>|</span>   /: 
</span></span><span class=line><span class=cl><span class=p>|</span>     PHPSESSID: 
</span></span><span class=line><span class=cl><span class=p>|</span>_      httponly flag not <span class=nb>set</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: MegaCorp Login
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.41 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl>Service Info: OSs: Unix, Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 9.58 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><p>Couple of things that may stand out at first look:</p><ul><li><em><strong>ftp</strong></em> <strong>anonymous/guest</strong> login is allowed</li><li>there is a file <em>backup.zip</em> which we can access via <em><strong>ftp</strong></em></li><li><em><strong>ssh</strong></em> version is 1:8.0p1-6ubuntu0.1</li><li>apache webserver is running with version Apache httpd 2.4.41</li><li>running os is probably Ubuntu 19.10 - Eoan Ermine</li></ul><p>We continue with a quick <strong>fingerprinting</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ whatweb <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>http://10.129.30.132 <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Apache<span class=o>[</span>2.4.41<span class=o>]</span>, Cookies<span class=o>[</span>PHPSESSID<span class=o>]</span>, Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, HTML5, HTTPServer<span class=o>[</span>Ubuntu Linux<span class=o>][</span>Apache/2.4.41 <span class=o>(</span>Ubuntu<span class=o>)]</span>, IP<span class=o>[</span>10.129.30.132<span class=o>]</span>, PasswordField<span class=o>[</span>password<span class=o>]</span>, Title<span class=o>[</span>MegaCorp Login<span class=o>]</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><blockquote><p>ftp</p></blockquote><h2 id=task-2><strong>TASK 2</strong><a hidden class=anchor aria-hidden=true href=#task-2>#</a></h2><p><strong>Question</strong>: <em>This service can be configured to allow login with any password for specific username. What is that username?</em></p><p>Since <strong>anonymous login</strong> is enabled on the <em><strong>ftp</strong></em> server, we check it out and proceed <strong>downloading</strong> the <strong>file</strong> we spotted earlier (in TASK1).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ftp <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>Connected to 10.129.30.132.
</span></span><span class=line><span class=cl><span class=m>220</span> <span class=o>(</span>vsFTPd 3.0.3<span class=o>)</span>
</span></span><span class=line><span class=cl>Name <span class=o>(</span>10.129.30.132:root<span class=o>)</span>: anonymous
</span></span><span class=line><span class=cl><span class=m>331</span> Please specify the password.
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl><span class=m>230</span> Login successful.
</span></span><span class=line><span class=cl>Remote system <span class=nb>type</span> is UNIX.
</span></span><span class=line><span class=cl>Using binary mode to transfer files.
</span></span><span class=line><span class=cl>ftp&gt; ls
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful. Consider using PASV.
</span></span><span class=line><span class=cl><span class=m>150</span> Here comes the directory listing.
</span></span><span class=line><span class=cl>-rwxr-xr-x    <span class=m>1</span> <span class=m>0</span>        <span class=m>0</span>            <span class=m>2533</span> Apr <span class=m>13</span>  <span class=m>2021</span> backup.zip
</span></span><span class=line><span class=cl><span class=m>226</span> Directory send OK.
</span></span><span class=line><span class=cl>ftp&gt; get backup.zip
</span></span><span class=line><span class=cl>local: backup.zip remote: backup.zip
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful. Consider using PASV.
</span></span><span class=line><span class=cl><span class=m>150</span> Opening BINARY mode data connection <span class=k>for</span> backup.zip <span class=o>(</span><span class=m>2533</span> bytes<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl><span class=m>2533</span> bytes received in 0.00 secs <span class=o>(</span>16.7754 MB/s<span class=o>)</span>
</span></span><span class=line><span class=cl>ftp&gt; <span class=nb>exit</span>
</span></span><span class=line><span class=cl><span class=m>221</span> Goodbye.
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><blockquote><p>anonymous</p></blockquote><h2 id=task-3><strong>TASK 3</strong><a hidden class=anchor aria-hidden=true href=#task-3>#</a></h2><p><strong>Question</strong>: <em>What is the name of the file downloaded over this service?</em></p><p>Trying to <strong>decompress</strong> it does not work since it&rsquo;s <strong>password</strong> protected.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ll
</span></span><span class=line><span class=cl>total 4.0K
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle 2.5K May <span class=m>13</span> 10:56 backup.zip
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ unzip backup.zip 
</span></span><span class=line><span class=cl>Archive:  backup.zip
</span></span><span class=line><span class=cl><span class=o>[</span>backup.zip<span class=o>]</span> index.php password: 
</span></span><span class=line><span class=cl>password incorrect--reenter: ┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><blockquote><p>backup.zip</p></blockquote><h2 id=task-4><strong>TASK 4</strong><a hidden class=anchor aria-hidden=true href=#task-4>#</a></h2><p><strong>Question</strong>: <em>What script comes with the John The Ripper toolset and generates a hash from a password protected zip archive in a format to allow for cracking attempts?</em></p><p>A quick <strong>online search</strong> leaves us with <strong>two</strong> potential <strong>candidates</strong>:</p><ul><li>zip2john</li><li>rar2john</li></ul><p>But given the <strong>extension</strong> of <em>backup.zip</em>, it should be the first one. Now that we <strong>identified</strong> the necessary tools, we get to it.</p><p>First we create the <strong>password hashes</strong> to be cracked.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ man john
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ zip2john backup.zip &gt; backup.zip.hash
</span></span><span class=line><span class=cl>Created directory: /home/htb-bluewalle/.john
</span></span><span class=line><span class=cl>ver 2.0 efh <span class=m>5455</span> efh <span class=m>7875</span> backup.zip/index.php PKZIP Encr: 2b chk, TS_chk, <span class=nv>cmplen</span><span class=o>=</span>1201, <span class=nv>decmplen</span><span class=o>=</span>2594, <span class=nv>crc</span><span class=o>=</span>3A41AE06
</span></span><span class=line><span class=cl>ver 2.0 efh <span class=m>5455</span> efh <span class=m>7875</span> backup.zip/style.css PKZIP Encr: 2b chk, TS_chk, <span class=nv>cmplen</span><span class=o>=</span>986, <span class=nv>decmplen</span><span class=o>=</span>3274, <span class=nv>crc</span><span class=o>=</span>1B1CCD6A
</span></span><span class=line><span class=cl>NOTE: It is assumed that all files in each archive have the same password.
</span></span><span class=line><span class=cl>If that is not the <span class=k>case</span>, the <span class=nb>hash</span> may be uncrackable. To avoid this, use
</span></span><span class=line><span class=cl>option -o to pick a file at a time.
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ll
</span></span><span class=line><span class=cl>total 8.0K
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle 2.5K May <span class=m>13</span> 10:56 backup.zip
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle 2.2K May <span class=m>13</span> 11:06 backup.zip.hash
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>This is how the resulting <strong>password hash</strong> looks like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat backup.zip.hash 
</span></span><span class=line><span class=cl>backup.zip:<span class=nv>$pkzip2$2</span>*2*1*0*8*24*3a41*5722*543fb39ed1a919ce7b58641a238e00f4cb3a826cfb1b8f4b225aa15c4ffda8fe72f60a82*2*0*3da*cca*1b1ccd6a*504*43*8*3da*1b1c*989a*22290dc3505e51d341f31925a7ffefc181ef9f66d8d25e53c82afc7c1598fbc3fff28a17ba9d8cec9a52d66a11ac103f257e14885793fe01e26238915796640e8936073177d3e6e28915f5abf20fb2fb2354cf3b7744be3e7a0a9a798bd40b63dc00c2ceaef81beb5d3c2b94e588c58725a07fe4ef86c990872b652b3dae89b2fff1f127142c95a5c3452b997e3312db40aee19b120b85b90f8a8828a13dd114f3401142d4bb6b4e369e308cc81c26912c3d673dc23a15920764f108ed151ebc3648932f1e8befd9554b9c904f6e6f19cbded8e1cac4e48a5be2b250ddfe42f7261444fbed8f86d207578c61c45fb2f48d7984ef7dcf88ed3885aaa12b943be3682b7df461842e3566700298efad66607052bd59c0e861a7672356729e81dc326ef431c4f3a3cdaf784c15fa7eea73adf02d9272e5c35a5d934b859133082a9f0e74d31243e81b72b45ef3074c0b2a676f409ad5aad7efb32971e68adbbb4d34ed681ad638947f35f43bb33217f71cbb0ec9f876ea75c299800bd36ec81017a4938c86fc7dbe2d412ccf032a3dc98f53e22e066defeb32f00a6f91ce9119da438a327d0e6b990eec23ea820fa24d3ed2dc2a7a56e4b21f8599cc75d00a42f02c653f9168249747832500bfd5828eae19a68b84da170d2a55abeb8430d0d77e6469b89da8e0d49bb24dbfc88f27258be9cf0f7fd531a0e980b6defe1f725e55538128fe52d296b3119b7e4149da3716abac1acd841afcbf79474911196d8596f79862dea26f555c772bbd1d0601814cb0e5939ce6e4452182d23167a287c5a18464581baab1d5f7d5d58d8087b7d0ca8647481e2d4cb6bc2e63aa9bc8c5d4dfc51f9cd2a1ee12a6a44a6e64ac208365180c1fa02bf4f627d5ca5c817cc101ce689afe130e1e6682123635a6e524e2833335f3a44704de5300b8d196df50660bb4dbb7b5cb082ce78d79b4b38e8e738e26798d10502281bfed1a9bb6426bfc47ef62841079d41dbe4fd356f53afc211b04af58fe3978f0cf4b96a7a6fc7ded6e2fba800227b186ee598dbf0c14cbfa557056ca836d69e28262a060a201d005b3f2ce736caed814591e4ccde4e2ab6bdbd647b08e543b4b2a5b23bc17488464b2d0359602a45cc26e30cf166720c43d6b5a1fddcfd380a9c7240ea888638e12a4533cfee2c7040a2f293a888d6dcc0d77bf0a2270f765e5ad8bfcbb7e68762359e335dfd2a9563f1d1d9327eb39e68690a8740fc9748483ba64f1d923edfc2754fc020bbfae77d06e8c94fba2a02612c0787b60f0ee78d21a6305fb97ad04bb562db282c223667af8ad907466b88e7052072d6968acb7258fb8846da057b1448a2a9699ac0e5592e369fd6e87d677a1fe91c0d0155fd237bfd2dc49*$/pkzip2$::backup.zip:style.css, index.php:backup.zip
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><p>It&rsquo;s time to get <strong>cracking</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ john backup.zip.hash 
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>PKZIP <span class=o>[</span>32/64<span class=o>])</span>
</span></span><span class=line><span class=cl>Will run <span class=m>4</span> OpenMP threads
</span></span><span class=line><span class=cl>Proceeding with single, rules:Single
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>Warning: Only <span class=m>5</span> candidates buffered <span class=k>for</span> the current salt, minimum <span class=m>8</span> needed <span class=k>for</span> performance.
</span></span><span class=line><span class=cl>Warning: Only <span class=m>4</span> candidates buffered <span class=k>for</span> the current salt, minimum <span class=m>8</span> needed <span class=k>for</span> performance.
</span></span><span class=line><span class=cl>Almost <span class=k>done</span>: Processing the remaining buffered candidate passwords, <span class=k>if</span> any.
</span></span><span class=line><span class=cl>Warning: Only <span class=m>6</span> candidates buffered <span class=k>for</span> the current salt, minimum <span class=m>8</span> needed <span class=k>for</span> performance.
</span></span><span class=line><span class=cl>Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
</span></span><span class=line><span class=cl><span class=m>741852963</span>        <span class=o>(</span>backup.zip<span class=o>)</span>
</span></span><span class=line><span class=cl>1g 0:00:00:00 DONE 2/3 <span class=o>(</span>2023-05-13 11:10<span class=o>)</span> 11.11g/s 844766p/s 844766c/s 844766C/s 123456..ferrises
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class=line><span class=cl>Session completed
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ john --show backup.zip.hash 
</span></span><span class=line><span class=cl>backup.zip:741852963::backup.zip:style.css, index.php:backup.zip
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>1</span> password <span class=nb>hash</span> cracked, <span class=m>0</span> left
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p><em><strong>Unzipping</strong></em> the <em>backup.zip</em> file with the <strong>password</strong> we just found <em>741852963</em> will provide us with <strong>two source files</strong>:</p><ul><li>index.php</li><li>style.css</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ unzip backup.zip 
</span></span><span class=line><span class=cl>Archive:  backup.zip
</span></span><span class=line><span class=cl><span class=o>[</span>backup.zip<span class=o>]</span> index.php password: 
</span></span><span class=line><span class=cl>  inflating: index.php               
</span></span><span class=line><span class=cl>  inflating: style.css               
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><p>Let&rsquo;s check them out.</p><p><em>index.php</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat index.php 
</span></span><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;?php
</span></span><span class=line><span class=cl>session_start<span class=o>()</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=o>(</span>isset<span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;username&#39;</span><span class=o>])</span> <span class=o>&amp;&amp;</span> isset<span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;password&#39;</span><span class=o>]))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;username&#39;</span><span class=o>]</span> <span class=o>===</span> <span class=s1>&#39;admin&#39;</span> <span class=o>&amp;&amp;</span> md5<span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;password&#39;</span><span class=o>])</span> <span class=o>===</span> <span class=s2>&#34;2cb42f8734ea607eefed3b70af13bbd3&#34;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=nv>$_SESSION</span><span class=o>[</span><span class=s1>&#39;login&#39;</span><span class=o>]</span> <span class=o>=</span> <span class=s2>&#34;true&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      header<span class=o>(</span><span class=s2>&#34;Location: dashboard.php&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>?&gt;
</span></span><span class=line><span class=cl>&lt;html <span class=nv>lang</span><span class=o>=</span><span class=s2>&#34;en&#34;</span> &gt;
</span></span><span class=line><span class=cl>&lt;head&gt;
</span></span><span class=line><span class=cl>  &lt;meta <span class=nv>charset</span><span class=o>=</span><span class=s2>&#34;UTF-8&#34;</span>&gt;
</span></span><span class=line><span class=cl>  &lt;title&gt;MegaCorp Login&lt;/title&gt;
</span></span><span class=line><span class=cl>  &lt;link <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;https://fonts.googleapis.com/css?family=Open+Sans:400,700&#34;</span> <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span>&gt;&lt;link <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;./style.css&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;/head&gt;
</span></span><span class=line><span class=cl>  &lt;h1 <span class=nv>align</span><span class=o>=</span>center&gt;MegaCorp Login&lt;/h1&gt;
</span></span><span class=line><span class=cl>&lt;body&gt;
</span></span><span class=line><span class=cl>&lt;!-- partial:index.partial.html --&gt;
</span></span><span class=line><span class=cl>&lt;body <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;align&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  &lt;div <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;grid&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;form <span class=nv>action</span><span class=o>=</span><span class=s2>&#34;&#34;</span> <span class=nv>method</span><span class=o>=</span><span class=s2>&#34;POST&#34;</span> <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form login&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      &lt;div <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form__field&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;label <span class=k>for</span><span class=o>=</span><span class=s2>&#34;login__username&#34;</span>&gt;&lt;svg <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;icon&#34;</span>&gt;&lt;use xmlns:xlink<span class=o>=</span><span class=s2>&#34;http://www.w3.org/1999/xlink&#34;</span> xlink:href<span class=o>=</span><span class=s2>&#34;#user&#34;</span>&gt;&lt;/use&gt;&lt;/svg&gt;&lt;span <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;hidden&#34;</span>&gt;Username&lt;/span&gt;&lt;/label&gt;
</span></span><span class=line><span class=cl>        &lt;input <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;login__username&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text&#34;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;username&#34;</span> <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form__input&#34;</span> <span class=nv>placeholder</span><span class=o>=</span><span class=s2>&#34;Username&#34;</span> required&gt;
</span></span><span class=line><span class=cl>      &lt;/div&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      &lt;div <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form__field&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;label <span class=k>for</span><span class=o>=</span><span class=s2>&#34;login__password&#34;</span>&gt;&lt;svg <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;icon&#34;</span>&gt;&lt;use xmlns:xlink<span class=o>=</span><span class=s2>&#34;http://www.w3.org/1999/xlink&#34;</span> xlink:href<span class=o>=</span><span class=s2>&#34;#lock&#34;</span>&gt;&lt;/use&gt;&lt;/svg&gt;&lt;span <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;hidden&#34;</span>&gt;Password&lt;/span&gt;&lt;/label&gt;
</span></span><span class=line><span class=cl>        &lt;input <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;login__password&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;password&#34;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;password&#34;</span> <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form__input&#34;</span> <span class=nv>placeholder</span><span class=o>=</span><span class=s2>&#34;Password&#34;</span> required&gt;
</span></span><span class=line><span class=cl>      &lt;/div&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      &lt;div <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form__field&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;input <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;submit&#34;</span> <span class=nv>value</span><span class=o>=</span><span class=s2>&#34;Sign In&#34;</span>&gt;
</span></span><span class=line><span class=cl>      &lt;/div&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;/form&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  &lt;/div&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  &lt;svg <span class=nv>xmlns</span><span class=o>=</span><span class=s2>&#34;http://www.w3.org/2000/svg&#34;</span> <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;icons&#34;</span>&gt;&lt;symbol <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;arrow-right&#34;</span> <span class=nv>viewBox</span><span class=o>=</span><span class=s2>&#34;0 0 1792 1792&#34;</span>&gt;&lt;path <span class=nv>d</span><span class=o>=</span><span class=s2>&#34;M1600 960q0 54-37 91l-651 651q-39 37-91 37-51 0-90-37l-75-75q-38-38-38-91t38-91l293-293H245q-52 0-84.5-37.5T128 1024V896q0-53 32.5-90.5T245 768h704L656 474q-38-36-38-90t38-90l75-75q38-38 90-38 53 0 91 38l651 651q37 35 37 90z&#34;</span>/&gt;&lt;/symbol&gt;&lt;symbol <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;lock&#34;</span> <span class=nv>viewBox</span><span class=o>=</span><span class=s2>&#34;0 0 1792 1792&#34;</span>&gt;&lt;path <span class=nv>d</span><span class=o>=</span><span class=s2>&#34;M640 768h512V576q0-106-75-181t-181-75-181 75-75 181v192zm832 96v576q0 40-28 68t-68 28H416q-40 0-68-28t-28-68V864q0-40 28-68t68-28h32V576q0-184 132-316t316-132 316 132 132 316v192h32q40 0 68 28t28 68z&#34;</span>/&gt;&lt;/symbol&gt;&lt;symbol <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;user&#34;</span> <span class=nv>viewBox</span><span class=o>=</span><span class=s2>&#34;0 0 1792 1792&#34;</span>&gt;&lt;path <span class=nv>d</span><span class=o>=</span><span class=s2>&#34;M1600 1405q0 120-73 189.5t-194 69.5H459q-121 0-194-69.5T192 1405q0-53 3.5-103.5t14-109T236 1084t43-97.5 62-81 85.5-53.5T538 832q9 0 42 21.5t74.5 48 108 48T896 971t133.5-21.5 108-48 74.5-48 42-21.5q61 0 111.5 20t85.5 53.5 62 81 43 97.5 26.5 108.5 14 109 3.5 103.5zm-320-893q0 159-112.5 271.5T896 896 624.5 783.5 512 512t112.5-271.5T896 128t271.5 112.5T1280 512z&#34;</span>/&gt;&lt;/symbol&gt;&lt;/svg&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;!-- partial --&gt;
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>&lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p><em>style.css</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat style.css 
</span></span><span class=line><span class=cl>/* config.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/* helpers/align.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.align <span class=o>{</span>
</span></span><span class=line><span class=cl>  -webkit-box-align: center<span class=p>;</span>
</span></span><span class=line><span class=cl>      -ms-flex-align: center<span class=p>;</span>
</span></span><span class=line><span class=cl>          align-items: center<span class=p>;</span>
</span></span><span class=line><span class=cl>  display: -webkit-box<span class=p>;</span>
</span></span><span class=line><span class=cl>  display: -ms-flexbox<span class=p>;</span>
</span></span><span class=line><span class=cl>  display: flex<span class=p>;</span>
</span></span><span class=line><span class=cl>  -webkit-box-orient: vertical<span class=p>;</span>
</span></span><span class=line><span class=cl>  -webkit-box-direction: normal<span class=p>;</span>
</span></span><span class=line><span class=cl>      -ms-flex-direction: column<span class=p>;</span>
</span></span><span class=line><span class=cl>          flex-direction: column<span class=p>;</span>
</span></span><span class=line><span class=cl>  -webkit-box-pack: center<span class=p>;</span>
</span></span><span class=line><span class=cl>      -ms-flex-pack: center<span class=p>;</span>
</span></span><span class=line><span class=cl>          justify-content: center<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/* helpers/grid.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.grid <span class=o>{</span>
</span></span><span class=line><span class=cl>  margin-left: auto<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin-right: auto<span class=p>;</span>
</span></span><span class=line><span class=cl>  max-width: 320px<span class=p>;</span>
</span></span><span class=line><span class=cl>  max-width: 20rem<span class=p>;</span>
</span></span><span class=line><span class=cl>  width: 90%<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/* helpers/hidden.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.hidden <span class=o>{</span>
</span></span><span class=line><span class=cl>  border: 0<span class=p>;</span>
</span></span><span class=line><span class=cl>  clip: rect<span class=o>(</span><span class=m>0</span> <span class=m>0</span> <span class=m>0</span> 0<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  height: 1px<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin: -1px<span class=p>;</span>
</span></span><span class=line><span class=cl>  overflow: hidden<span class=p>;</span>
</span></span><span class=line><span class=cl>  padding: 0<span class=p>;</span>
</span></span><span class=line><span class=cl>  position: absolute<span class=p>;</span>
</span></span><span class=line><span class=cl>  width: 1px<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/* helpers/icon.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.icons <span class=o>{</span>
</span></span><span class=line><span class=cl>  display: none<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.icon <span class=o>{</span>
</span></span><span class=line><span class=cl>  display: inline-block<span class=p>;</span>
</span></span><span class=line><span class=cl>  fill: <span class=c1>#606468;</span>
</span></span><span class=line><span class=cl>  font-size: 16px<span class=p>;</span>
</span></span><span class=line><span class=cl>  font-size: 1rem<span class=p>;</span>
</span></span><span class=line><span class=cl>  height: 1em<span class=p>;</span>
</span></span><span class=line><span class=cl>  vertical-align: middle<span class=p>;</span>
</span></span><span class=line><span class=cl>  width: 1em<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/* layout/base.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* <span class=o>{</span>
</span></span><span class=line><span class=cl>  -webkit-box-sizing: inherit<span class=p>;</span>
</span></span><span class=line><span class=cl>          box-sizing: inherit<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>html <span class=o>{</span>
</span></span><span class=line><span class=cl>  -webkit-box-sizing: border-box<span class=p>;</span>
</span></span><span class=line><span class=cl>          box-sizing: border-box<span class=p>;</span>
</span></span><span class=line><span class=cl>  font-size: 100%<span class=p>;</span>
</span></span><span class=line><span class=cl>  height: 100%<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>body <span class=o>{</span>
</span></span><span class=line><span class=cl>  background-color: <span class=c1>#2c3338;</span>
</span></span><span class=line><span class=cl>  color: <span class=c1>#606468;</span>
</span></span><span class=line><span class=cl>  font-family: <span class=s1>&#39;Open Sans&#39;</span>, sans-serif<span class=p>;</span>
</span></span><span class=line><span class=cl>  font-size: 14px<span class=p>;</span>
</span></span><span class=line><span class=cl>  font-size: 0.875rem<span class=p>;</span>
</span></span><span class=line><span class=cl>  font-weight: 400<span class=p>;</span>
</span></span><span class=line><span class=cl>  height: 100%<span class=p>;</span>
</span></span><span class=line><span class=cl>  line-height: 1.5<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin: 0<span class=p>;</span>
</span></span><span class=line><span class=cl>  min-height: 100vh<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/* modules/anchor.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>a <span class=o>{</span>
</span></span><span class=line><span class=cl>  color: <span class=c1>#eee;</span>
</span></span><span class=line><span class=cl>  outline: 0<span class=p>;</span>
</span></span><span class=line><span class=cl>  text-decoration: none<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>a:focus,
</span></span><span class=line><span class=cl>a:hover <span class=o>{</span>
</span></span><span class=line><span class=cl>  text-decoration: underline<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/* modules/form.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>input <span class=o>{</span>
</span></span><span class=line><span class=cl>  background-image: none<span class=p>;</span>
</span></span><span class=line><span class=cl>  border: 0<span class=p>;</span>
</span></span><span class=line><span class=cl>  color: inherit<span class=p>;</span>
</span></span><span class=line><span class=cl>  font: inherit<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin: 0<span class=p>;</span>
</span></span><span class=line><span class=cl>  outline: 0<span class=p>;</span>
</span></span><span class=line><span class=cl>  padding: 0<span class=p>;</span>
</span></span><span class=line><span class=cl>  -webkit-transition: background-color 0.3s<span class=p>;</span>
</span></span><span class=line><span class=cl>  transition: background-color 0.3s<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;submit&#39;</span><span class=o>]</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  cursor: pointer<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.form <span class=o>{</span>
</span></span><span class=line><span class=cl>  margin: -14px<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin: -0.875rem<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.form input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;password&#39;</span><span class=o>]</span>,
</span></span><span class=line><span class=cl>.form input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=o>]</span>,
</span></span><span class=line><span class=cl>.form input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;submit&#39;</span><span class=o>]</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  width: 100%<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.form__field <span class=o>{</span>
</span></span><span class=line><span class=cl>  display: -webkit-box<span class=p>;</span>
</span></span><span class=line><span class=cl>  display: -ms-flexbox<span class=p>;</span>
</span></span><span class=line><span class=cl>  display: flex<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin: 14px<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin: 0.875rem<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.form__input <span class=o>{</span>
</span></span><span class=line><span class=cl>  -webkit-box-flex: 1<span class=p>;</span>
</span></span><span class=line><span class=cl>      -ms-flex: 1<span class=p>;</span>
</span></span><span class=line><span class=cl>          flex: 1<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/* modules/login.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.login <span class=o>{</span>
</span></span><span class=line><span class=cl>  color: <span class=c1>#eee;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.login label,
</span></span><span class=line><span class=cl>.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=o>]</span>,
</span></span><span class=line><span class=cl>.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;password&#39;</span><span class=o>]</span>,
</span></span><span class=line><span class=cl>.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;submit&#39;</span><span class=o>]</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  border-radius: 0.25rem<span class=p>;</span>
</span></span><span class=line><span class=cl>  padding: 16px<span class=p>;</span>
</span></span><span class=line><span class=cl>  padding: 1rem<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.login label <span class=o>{</span>
</span></span><span class=line><span class=cl>  background-color: <span class=c1>#363b41;</span>
</span></span><span class=line><span class=cl>  border-bottom-right-radius: 0<span class=p>;</span>
</span></span><span class=line><span class=cl>  border-top-right-radius: 0<span class=p>;</span>
</span></span><span class=line><span class=cl>  padding-left: 20px<span class=p>;</span>
</span></span><span class=line><span class=cl>  padding-left: 1.25rem<span class=p>;</span>
</span></span><span class=line><span class=cl>  padding-right: 20px<span class=p>;</span>
</span></span><span class=line><span class=cl>  padding-right: 1.25rem<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;password&#39;</span><span class=o>]</span>,
</span></span><span class=line><span class=cl>.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=o>]</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  background-color: <span class=c1>#3b4148;</span>
</span></span><span class=line><span class=cl>  border-bottom-left-radius: 0<span class=p>;</span>
</span></span><span class=line><span class=cl>  border-top-left-radius: 0<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;password&#39;</span><span class=o>]</span>:focus,
</span></span><span class=line><span class=cl>.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;password&#39;</span><span class=o>]</span>:hover,
</span></span><span class=line><span class=cl>.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=o>]</span>:focus,
</span></span><span class=line><span class=cl>.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;text&#39;</span><span class=o>]</span>:hover <span class=o>{</span>
</span></span><span class=line><span class=cl>  background-color: <span class=c1>#434a52;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;submit&#39;</span><span class=o>]</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  background-color: blue<span class=p>;</span>
</span></span><span class=line><span class=cl>  color: <span class=c1>#eee;</span>
</span></span><span class=line><span class=cl>  font-weight: 700<span class=p>;</span>
</span></span><span class=line><span class=cl>  text-transform: uppercase<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;submit&#39;</span><span class=o>]</span>:focus,
</span></span><span class=line><span class=cl>.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;submit&#39;</span><span class=o>]</span>:hover <span class=o>{</span>
</span></span><span class=line><span class=cl>  background-color: blue<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/* modules/text.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>p <span class=o>{</span>
</span></span><span class=line><span class=cl>  margin-bottom: 24px<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin-bottom: 1.5rem<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin-top: 24px<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin-top: 1.5rem<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.text--center <span class=o>{</span>
</span></span><span class=line><span class=cl>  text-align: center<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xkcyjt5b53<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><blockquote><p>zip2john</p></blockquote><h2 id=task-5><strong>TASK 5</strong><a hidden class=anchor aria-hidden=true href=#task-5>#</a></h2><p><strong>Question</strong>: <em>What is the password for the admin user on the website?</em></p><blockquote><p>TODO</p></blockquote><h2 id=task-6><strong>TASK 6</strong><a hidden class=anchor aria-hidden=true href=#task-6>#</a></h2><p><strong>Question</strong>: <em>What option can be passed to sqlmap to try to get command execution via the sql injection?</em></p><blockquote><p>TODO</p></blockquote><h2 id=task-7><strong>TASK 7</strong><a hidden class=anchor aria-hidden=true href=#task-7>#</a></h2><p><strong>Question</strong>: <em>What program can the postgres user run as root using sudo?</em></p><blockquote><p>TODO</p></blockquote><h2 id=submit-flag><strong>SUBMIT FLAG</strong><a hidden class=anchor aria-hidden=true href=#submit-flag>#</a></h2><p><strong>Question</strong>: <em>Submit user flag</em></p><blockquote><p>flag</p></blockquote><h2 id=submit-flag-1><strong>SUBMIT FLAG</strong><a hidden class=anchor aria-hidden=true href=#submit-flag-1>#</a></h2><p><strong>Question</strong>: <em>Submit root flag</em></p><blockquote><p>flag</p></blockquote><p><strong>Congratulations</strong>, we just successfully <strong>pwned</strong> the <strong>target machine</strong>. All we have left to do now is to <strong>terminate</strong> the <strong>target</strong> box (if not terminated automatically) <strong>before</strong> we <strong>continue</strong> with the next box!</p><h1 id=todo>TODO<a hidden class=anchor aria-hidden=true href=#todo>#</a></h1><table><thead><tr><th>collected credentials</th><th></th></tr></thead><tbody><tr><td><em>username</em></td><td style=text-align:left>admin</td></tr><tr><td><em>password</em></td><td style=text-align:left>rKXM59ESxesUFHAd</td></tr></tbody></table><p>They <strong>worked</strong> and we are now welcomed with the <strong>flag</strong>.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_1/crododile/crocodile-flag.png alt=post-log-in title=post-log-in></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bluewalle.github.io/tags/htb/>htb</a></li><li><a href=https://bluewalle.github.io/tags/walkthrough/>walkthrough</a></li><li><a href=https://bluewalle.github.io/tags/vaccine/>vaccine</a></li><li><a href=https://bluewalle.github.io/tags/tier-2/>tier-2</a></li><li><a href=https://bluewalle.github.io/tags/free-tier/>free-tier</a></li><li><a href=https://bluewalle.github.io/tags/web/>web</a></li><li><a href=https://bluewalle.github.io/tags/network/>network</a></li><li><a href=https://bluewalle.github.io/tags/vulnerability-assessment/>vulnerability-assessment</a></li><li><a href=https://bluewalle.github.io/tags/databases/>databases</a></li><li><a href=https://bluewalle.github.io/tags/injection/>injection</a></li><li><a href=https://bluewalle.github.io/tags/custom-applications/>custom-applications</a></li><li><a href=https://bluewalle.github.io/tags/protocols/>protocols</a></li><li><a href=https://bluewalle.github.io/tags/source-code-analysis/>source-code-analysis</a></li><li><a href=https://bluewalle.github.io/tags/apache/>apache</a></li><li><a href=https://bluewalle.github.io/tags/postgresql/>postgresql</a></li><li><a href=https://bluewalle.github.io/tags/ftp/>ftp</a></li><li><a href=https://bluewalle.github.io/tags/php/>php</a></li><li><a href=https://bluewalle.github.io/tags/reconnaissance/>reconnaissance</a></li><li><a href=https://bluewalle.github.io/tags/password-cracking/>password-cracking</a></li><li><a href=https://bluewalle.github.io/tags/sudo-exploitation/>sudo-exploitation</a></li><li><a href=https://bluewalle.github.io/tags/sql-injection/>sql-injection</a></li><li><a href=https://bluewalle.github.io/tags/remote-code-execution/>remote-code-execution</a></li><li><a href=https://bluewalle.github.io/tags/clear-text-credentials/>clear-text-credentials</a></li><li><a href=https://bluewalle.github.io/tags/anonymous-access/>anonymous-access</a></li><li><a href=https://bluewalle.github.io/tags/guest-access/>guest-access</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>