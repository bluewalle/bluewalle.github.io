<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Funnel - Walkthrough | Ee-Vah?</title><meta name=keywords content="htb,walkthrough,funnel,tier-1,vip-tier,ftp,postgresql,reconnaissance,tunneling,password-spraying,port-forwarding,anonymous-access,guest-access,clear-text-credentials"><meta name=description content="The aim of this walkthrough is to provide help with the Funnel machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta name=author content="bluewalle"><link rel=canonical href=https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/funnel/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bluewalle.github.io/main/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://bluewalle.github.io/main/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bluewalle.github.io/main/img/favicon-32x32.png><link rel=apple-touch-icon href=https://bluewalle.github.io/main/img/apple-touch-icon.png><link rel=mask-icon href=https://bluewalle.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB - Funnel - Walkthrough"><meta property="og:description" content="The aim of this walkthrough is to provide help with the Funnel machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta property="og:type" content="article"><meta property="og:url" content="https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/funnel/"><meta property="og:image" content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-09T20:00:00+00:00"><meta property="article:modified_time" content="2023-05-09T20:00:00+00:00"><meta property="og:site_name" content="Just Keep Swimming"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HTB - Funnel - Walkthrough"><meta name=twitter:description content="The aim of this walkthrough is to provide help with the Funnel machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.
SETUP There are a couple of ways to connect to the target machine."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bluewalle.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Funnel - Walkthrough","item":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/funnel/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Funnel - Walkthrough","name":"HTB - Funnel - Walkthrough","description":"The aim of this walkthrough is to provide help with the Funnel machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.\nSETUP There are a couple of ways to connect to the target machine.","keywords":["htb","walkthrough","funnel","tier-1","vip-tier","ftp","postgresql","reconnaissance","tunneling","password-spraying","port-forwarding","anonymous-access","guest-access","clear-text-credentials"],"articleBody":"The aim of this walkthrough is to provide help with the Funnel machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.\nSETUP There are a couple of ways to connect to the target machine. The one we will be using throughout this walkthrough is via the provided pwnbox.\nOnce our connection is taken care of, we spawn the target machine.\nAdditionally - even though not required - it is possible to set a local variable (only available in the current shell) containing our target host’s IP address. Once set, we can easily access it by prepending a $ to our variable name.\n┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $rhost= ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ echo $rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ We could use the unset command to remove it after we no longer need it.\n┌─[✗]─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $unset rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ TASK 1 Question: How many TCP ports are open?\nStarting out with a quick connection check and following up with an all-ports tcp scan should get us the first answer.\n┌─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $ping $rhost -c 4 PING 10.129.228.195 (10.129.228.195) 56(84) bytes of data. 64 bytes from 10.129.228.195: icmp_seq=1 ttl=63 time=11.9 ms 64 bytes from 10.129.228.195: icmp_seq=2 ttl=63 time=11.5 ms 64 bytes from 10.129.228.195: icmp_seq=3 ttl=63 time=12.1 ms 64 bytes from 10.129.228.195: icmp_seq=4 ttl=63 time=11.5 ms --- 10.129.228.195 ping statistics --- 4 packets transmitted, 4 received, 0% packet loss, time 3004ms rtt min/avg/max/mdev = 11.452/11.750/12.100/0.263 ms ┌─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $ But even with the packet rate doubled, it might take a while for our nmap scan to finish…\n┌─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $nmap -p- --min-rate=10000 $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-09 21:50 BST Nmap scan report for 10.129.228.195 Host is up (3.2s latency). Not shown: 64218 filtered tcp ports (no-response), 1315 closed tcp ports (conn-refused) PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh Nmap done: 1 IP address (1 host up) scanned in 407.71 seconds ┌─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $ It looks like our target has two services up: ftp and ssh.\n2\nTASK 2 Question: What is the name of the directory that is available on the FTP server?\nGathering more information about our running ftp service reveals that it has anonymous login enabled.\n┌─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $nmap -sC -sV -p 21 $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-09 22:00 BST Nmap scan report for 10.129.228.195 Host is up (0.019s latency). PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_drwxr-xr-x 2 ftp ftp 4096 Nov 28 14:31 mail_backup | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:10.10.14.46 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 3 | vsFTPd 3.0.3 - secure, fast, stable |_End of status Service Info: OS: Unix Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 1.39 seconds ┌─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $ Connecting to it anonymously lands us two interesting looking files:\npassword_policy.pdf welcome_28112022 ┌─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $ftp $rhost 21 Connected to 10.129.228.195. 220 (vsFTPd 3.0.3) Name (10.129.228.195:root): anonymous 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u003e ls 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. drwxr-xr-x 2 ftp ftp 4096 Nov 28 14:31 mail_backup 226 Directory send OK. ftp\u003e cd mail_backup 250 Directory successfully changed. ftp\u003e ls 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. -rw-r--r-- 1 ftp ftp 58899 Nov 28 14:30 password_policy.pdf -rw-r--r-- 1 ftp ftp 713 Nov 28 14:31 welcome_28112022 226 Directory send OK. ftp\u003e Since they are up for a grab, we welcome ourselves to them.\nftp\u003e get password_policy.pdf local: password_policy.pdf remote: password_policy.pdf 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for password_policy.pdf (58899 bytes). 226 Transfer complete. 58899 bytes received in 0.02 secs (2.2648 MB/s) ftp\u003e get welcome_28112022 local: welcome_28112022 remote: welcome_28112022 200 PORT command successful. Consider using PASV. 150 Opening BINARY mode data connection for welcome_28112022 (713 bytes). 226 Transfer complete. 713 bytes received in 0.00 secs (952.5159 kB/s) ftp\u003e exit 221 Goodbye. ┌─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $ mail_backup\nTASK 3 Question: What is the default account password that every new member on the \"Funnel\" team should change as soon as possible?\nWe mark down a few potentially interesting looking bits of information that are revealed when the files that were collected in TASK2 are opened:\n(possible) usernames - root, optimus, albert, andreas, christine, maria (possible) hostname - funnel.htb (possible) default password - funnel123#!# ┌─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $cat welcome_28112022 Frome: root@funnel.htb To: optimus@funnel.htb albert@funnel.htb andreas@funnel.htb christine@funnel.htb maria@funnel.htb Subject:Welcome to the team! Hello everyone, We would like to welcome you to our team. We think you’ll be a great asset to the \"Funnel\" team and want to make sure you get settled in as smoothly as possible. We have set up your accounts that you will need to access our internal infrastracture. Please, read through the attached password policy with extreme care. All the steps mentioned there should be completed as soon as possible. If you have any questions or concerns feel free to reach directly to your manager. We hope that you will have an amazing time with us, The funnel team. ┌─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $ funnel123#!#\nTASK 4 Question: Which user has not changed their default password yet?\nGoing through the collected usernames one-by-one appears to be rewarding.\ncollected credentials from TASK3 username root, optimus, albert, andreas, christine, maria password funnel123#!# ... ─[✗]─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $ssh albert@$rhost -p 22 albert@10.129.228.195's password: Permission denied, please try again. albert@10.129.228.195's password: ┌─[✗]─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $ssh andreas@$rhost -p 22 andreas@10.129.228.195's password: Permission denied, please try again. andreas@10.129.228.195's password: ┌─[✗]─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $ssh christine@$rhost -p 22 christine@10.129.228.195's password: Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-135-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Tue 09 May 2023 09:33:21 PM UTC System load: 0.0 Usage of /: 63.2% of 4.78GB Memory usage: 13% Swap usage: 0% Processes: 160 Users logged in: 0 IPv4 address for docker0: 172.17.0.1 IPv4 address for ens160: 10.129.228.195 IPv6 address for ens160: dead:beef::250:56ff:fe96:da50 * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s just raised the bar for easy, resilient and secure K8s cluster deployment. https://ubuntu.com/engage/secure-kubernetes-at-the-edge 0 updates can be applied immediately. The list of available updates is more than a week old. To check for new updates run: sudo apt update christine@funnel:~$ It looks like Christine was the one who forgot to reset her default password.\nChristine\nTASK 5 Question: Which service is running on TCP port 5432 and listens only on localhost?\nOne way to do this is to search around in the - /etc/services - file.\nchristine@funnel:~$ cat /etc/services | grep 5432 postgresql\t5432/tcp\tpostgres\t# PostgreSQL Database christine@funnel:~$ postgresql\nTASK 6 Question: Since you can't access the previously mentioned service from the local machine, you will have to create a tunnel and connect to it from your machine. What is the correct type of tunneling to use?\nremote port forwarding local port forwarding Since our goal is to forward all the traffic from our local machine’s arbitrary port (4444) to our target machines’s port 5432 (postgres), the one we set up is local port forwarding.\nLooking up the man page belonging to ssh gives us a better idea about the addressing format:\n-L [bind_address:]port:host:hostport And this is how we can actually set it up:\n# setting up local port forwarding on local machine ┌─[✗]─[htb-bluewalle@htb-dhydjsev2w]─[~/funnel] └──╼ $ssh -L 4444:localhost:5432 christine@$rhost christine@10.129.228.195's password: Welcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-135-generic x86_64) ... local port forwarding\nTASK 7 Question: What is the name of the database that holds the flag?\nMaking use of the local port forwarding that was just set up, we can open up an other terminal (on local machine) and start psql. As for the database configuration, we set the server to localhost and the port to the forwarded port.\nSo that when an sql command is used (on local machine) it is directly fed to port 4444 (still on local machine), then - since a port forwarding is set up - forwarded to the target machine’s port 5432, where the postgresql is already listening and running it.\nThis is how it looks like in a nutshell:\nsql-command -\u003e terminal(local machine) -\u003e port 4444 (local machine) -\u003e localhost (target machine) -\u003e port 5432 (target machine) -\u003e postgres (target machine) It is important to note that we use the same credentials to access postgres and to get the ssh connection.\n┌─[htb-bluewalle@htb-dhydjsev2w]─[~/Desktop] └──╼ $psql -U christine -h localhost -p 4444 Password for user christine: psql (13.10 (Debian 13.10-0+deb11u1), server 15.1 (Debian 15.1-1.pgdg110+1)) WARNING: psql major version 13, server major version 15. Some psql features might not work. Type \"help\" for help. christine=# There is one particularly interesting database we see, once we list all the available databases.\nchristine=#\\list List of databases Name | Owner | Encoding | Collate | Ctype | Access privileges -----------+-----------+----------+------------+------------+------------------------- christine | christine | UTF8 | en_US.utf8 | en_US.utf8 | postgres | christine | UTF8 | en_US.utf8 | en_US.utf8 | secrets | christine | UTF8 | en_US.utf8 | en_US.utf8 | template0 | christine | UTF8 | en_US.utf8 | en_US.utf8 | =c/christine + | | | | | christine=CTc/christine template1 | christine | UTF8 | en_US.utf8 | en_US.utf8 | =c/christine + | | | | | christine=CTc/christine (5 rows) christine=# Selecting the appropriate database and table, then listing all the table’s content lands us the flag.\nchristine=#\\connect secrets psql (13.10 (Debian 13.10-0+deb11u1), server 15.1 (Debian 15.1-1.pgdg110+1)) WARNING: psql major version 13, server major version 15. Some psql features might not work. You are now connected to database \"secrets\" as user \"christine\". secrets=# \\dt List of relations Schema | Name | Type | Owner --------+------+-------+----------- public | flag | table | christine (1 row) secrets=# select * from flag; value ---------------------------------- (1 row) secrets=# secrets\nTASK 8 Question: Could you use a dynamic tunnel instead of local port forwarding?\nYes No Reading up on dynamic tunnels should make this clear.\nyes\nSUBMIT FLAG Question: Submit root flag\nThe flag was already acquired in TASK7.\nflag\nCongratulations, we just successfully pwned the target machine. All we have left to do now is to terminate the target box (if not terminated automatically) before we continue with the next box!\n","wordCount":"1786","inLanguage":"en","datePublished":"2023-05-09T20:00:00Z","dateModified":"2023-05-09T20:00:00Z","author":{"@type":"Person","name":"bluewalle"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/funnel/"},"publisher":{"@type":"Organization","name":"Ee-Vah?","logo":{"@type":"ImageObject","url":"https://bluewalle.github.io/main/img/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bluewalle.github.io/ accesskey=h title="Just Keep Swimming (Alt + H)"><img src=https://bluewalle.github.io/apple-touch-icon.png alt aria-label=logo height=35>Just Keep Swimming</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bluewalle.github.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://bluewalle.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bluewalle.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://bluewalle.github.io/about title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bluewalle.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bluewalle.github.io/posts/>Posts</a></div><h1 class=post-title>HTB - Funnel - Walkthrough</h1><div class=post-meta><span title='2023-05-09 20:00:00 +0000 +0000'>May, 2023</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1786 words&nbsp;·&nbsp;bluewalle</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#setup><strong>SETUP</strong></a></li><li><a href=#task-1><strong>TASK 1</strong></a></li><li><a href=#task-2><strong>TASK 2</strong></a></li><li><a href=#task-3><strong>TASK 3</strong></a></li><li><a href=#task-4><strong>TASK 4</strong></a></li><li><a href=#task-5><strong>TASK 5</strong></a></li><li><a href=#task-6><strong>TASK 6</strong></a></li><li><a href=#task-7><strong>TASK 7</strong></a></li><li><a href=#task-8><strong>TASK 8</strong></a></li><li><a href=#submit-flag><strong>SUBMIT FLAG</strong></a></li></ul></nav></div></details></div><div class=post-content><p>The aim of this walkthrough is to provide help with the <strong>Funnel</strong> machine on the <a href=https://hackthebox.com title="Hack The Box website">Hack The Box website</a>. Please <strong>note</strong> that no <strong>flags</strong> are directly provided here. Moreover, <strong>be aware</strong> that this is only <strong>one</strong> of the <strong>many</strong> ways to solve the challenges.</p><p>It belongs to a series of tutorials that aim to help out complete beginners with finishing the <a href=https://app.hackthebox.com/starting-point title="HTB Starting Point">Starting Point</a> <strong>TIER 1</strong> challenges.</p><h2 id=setup><strong>SETUP</strong><a hidden class=anchor aria-hidden=true href=#setup>#</a></h2><p>There are a couple of ways to <strong>connect</strong> to the <strong>target machine</strong>. The one we will be using <strong>throughout</strong> this <strong>walkthrough</strong> is via the provided <strong>pwnbox</strong>.</p><p>Once our <strong>connection</strong> is taken care of, we <strong>spawn</strong> the <strong>target</strong> <strong>machine</strong>.</p><p>Additionally - even though not required - it is possible to set a <strong>local</strong> variable (only available in the current <strong>shell</strong>) containing our <strong>target host&rsquo;s</strong> IP address. Once set, we can easily <strong>access</strong> it by prepending a <em>$</em> to our variable name.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$rhost</span><span class=o>=</span>&lt;target-hosts-ip&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $ <span class=nb>echo</span> <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>&lt;target-hosts-ip&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>We could use the <em><strong>unset</strong></em> command to remove it after we no longer need it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$unset</span> rhost 
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><h2 id=task-1><strong>TASK 1</strong><a hidden class=anchor aria-hidden=true href=#task-1>#</a></h2><p><strong>Question</strong>: <em>How many TCP ports are open?</em></p><p>Starting out with a quick <strong>connection check</strong> and following up with an <strong>all-ports</strong> <strong>tcp</strong> <strong>scan</strong> should get us the first answer.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$ping</span> <span class=nv>$rhost</span> -c <span class=m>4</span>
</span></span><span class=line><span class=cl>PING 10.129.228.195 <span class=o>(</span>10.129.228.195<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.228.195: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>11.9 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.228.195: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>11.5 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.228.195: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>12.1 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.228.195: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>11.5 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.129.228.195 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> received, 0% packet loss, <span class=nb>time</span> 3004ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 11.452/11.750/12.100/0.263 ms
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>But even with the <strong>packet rate</strong> doubled, it might take a while for our <em><strong>nmap</strong></em> <strong>scan</strong> to finish&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$nmap</span> -p- --min-rate<span class=o>=</span><span class=m>10000</span> <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-09 21:50 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.228.195
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>3.2s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>64218</span> filtered tcp ports <span class=o>(</span>no-response<span class=o>)</span>, <span class=m>1315</span> closed tcp ports <span class=o>(</span>conn-refused<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE
</span></span><span class=line><span class=cl>21/tcp open  ftp
</span></span><span class=line><span class=cl>22/tcp open  ssh
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 407.71 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>It looks like our <strong>target</strong> has two services up: <em><strong>ftp</strong></em> and <em><strong>ssh</strong></em>.</p><blockquote><p>2</p></blockquote><h2 id=task-2><strong>TASK 2</strong><a hidden class=anchor aria-hidden=true href=#task-2>#</a></h2><p><strong>Question</strong>: <em>What is the name of the directory that is available on the FTP server?</em></p><p><strong>Gathering</strong> more <strong>information</strong> about our running <em><strong>ftp</strong></em> service reveals that it has <strong>anonymous</strong> login <strong>enabled</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$nmap</span> -sC -sV -p <span class=m>21</span> <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-09 22:00 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.228.195
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.019s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>21/tcp open  ftp     vsftpd 3.0.3
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-anon: Anonymous FTP login allowed <span class=o>(</span>FTP code 230<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_drwxr-xr-x    <span class=m>2</span> ftp      ftp          <span class=m>4096</span> Nov <span class=m>28</span> 14:31 mail_backup
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-syst: 
</span></span><span class=line><span class=cl><span class=p>|</span>   STAT: 
</span></span><span class=line><span class=cl><span class=p>|</span> FTP server status:
</span></span><span class=line><span class=cl><span class=p>|</span>      Connected to ::ffff:10.10.14.46
</span></span><span class=line><span class=cl><span class=p>|</span>      Logged in as ftp
</span></span><span class=line><span class=cl><span class=p>|</span>      TYPE: ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>      No session bandwidth limit
</span></span><span class=line><span class=cl><span class=p>|</span>      Session timeout in seconds is <span class=m>300</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      Control connection is plain text
</span></span><span class=line><span class=cl><span class=p>|</span>      Data connections will be plain text
</span></span><span class=line><span class=cl><span class=p>|</span>      At session startup, client count was <span class=m>3</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      vsFTPd 3.0.3 - secure, fast, stable
</span></span><span class=line><span class=cl><span class=p>|</span>_End of status
</span></span><span class=line><span class=cl>Service Info: OS: Unix
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 1.39 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>Connecting to it <strong>anonymously</strong> lands us two <strong>interesting</strong> looking files:</p><ul><li>password_policy.pdf</li><li>welcome_28112022</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$ftp</span> <span class=nv>$rhost</span> <span class=m>21</span>
</span></span><span class=line><span class=cl>Connected to 10.129.228.195.
</span></span><span class=line><span class=cl><span class=m>220</span> <span class=o>(</span>vsFTPd 3.0.3<span class=o>)</span>
</span></span><span class=line><span class=cl>Name <span class=o>(</span>10.129.228.195:root<span class=o>)</span>: anonymous
</span></span><span class=line><span class=cl><span class=m>331</span> Please specify the password.
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl><span class=m>230</span> Login successful.
</span></span><span class=line><span class=cl>Remote system <span class=nb>type</span> is UNIX.
</span></span><span class=line><span class=cl>Using binary mode to transfer files.
</span></span><span class=line><span class=cl>ftp&gt; ls
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful. Consider using PASV.
</span></span><span class=line><span class=cl><span class=m>150</span> Here comes the directory listing.
</span></span><span class=line><span class=cl>drwxr-xr-x    <span class=m>2</span> ftp      ftp          <span class=m>4096</span> Nov <span class=m>28</span> 14:31 mail_backup
</span></span><span class=line><span class=cl><span class=m>226</span> Directory send OK.
</span></span><span class=line><span class=cl>ftp&gt; <span class=nb>cd</span> mail_backup
</span></span><span class=line><span class=cl><span class=m>250</span> Directory successfully changed.
</span></span><span class=line><span class=cl>ftp&gt; ls
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful. Consider using PASV.
</span></span><span class=line><span class=cl><span class=m>150</span> Here comes the directory listing.
</span></span><span class=line><span class=cl>-rw-r--r--    <span class=m>1</span> ftp      ftp         <span class=m>58899</span> Nov <span class=m>28</span> 14:30 password_policy.pdf
</span></span><span class=line><span class=cl>-rw-r--r--    <span class=m>1</span> ftp      ftp           <span class=m>713</span> Nov <span class=m>28</span> 14:31 welcome_28112022
</span></span><span class=line><span class=cl><span class=m>226</span> Directory send OK.
</span></span><span class=line><span class=cl>ftp&gt; 
</span></span></code></pre></div><p>Since they are up for a <strong>grab</strong>, we welcome ourselves to them.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ftp&gt; get password_policy.pdf
</span></span><span class=line><span class=cl>local: password_policy.pdf remote: password_policy.pdf
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful. Consider using PASV.
</span></span><span class=line><span class=cl><span class=m>150</span> Opening BINARY mode data connection <span class=k>for</span> password_policy.pdf <span class=o>(</span><span class=m>58899</span> bytes<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl><span class=m>58899</span> bytes received in 0.02 secs <span class=o>(</span>2.2648 MB/s<span class=o>)</span>
</span></span><span class=line><span class=cl>ftp&gt; get welcome_28112022
</span></span><span class=line><span class=cl>local: welcome_28112022 remote: welcome_28112022
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful. Consider using PASV.
</span></span><span class=line><span class=cl><span class=m>150</span> Opening BINARY mode data connection <span class=k>for</span> welcome_28112022 <span class=o>(</span><span class=m>713</span> bytes<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl><span class=m>713</span> bytes received in 0.00 secs <span class=o>(</span>952.5159 kB/s<span class=o>)</span>
</span></span><span class=line><span class=cl>ftp&gt; <span class=nb>exit</span>
</span></span><span class=line><span class=cl><span class=m>221</span> Goodbye.
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><blockquote><p>mail_backup</p></blockquote><h2 id=task-3><strong>TASK 3</strong><a hidden class=anchor aria-hidden=true href=#task-3>#</a></h2><p><strong>Question</strong>: <em>What is the default account password that every new member on the "Funnel" team should change as soon as possible?</em></p><p>We <strong>mark down</strong> a few <strong>potentially</strong> interesting looking bits of <strong>information</strong> that are revealed when the files that were collected in TASK2 are <strong>opened</strong>:</p><ul><li>(possible) usernames - root, optimus, albert, andreas, christine, maria</li><li>(possible) hostname - funnel.htb</li><li>(possible) default password - funnel123#!#</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$cat</span> welcome_28112022 
</span></span><span class=line><span class=cl>Frome: root@funnel.htb
</span></span><span class=line><span class=cl>To: optimus@funnel.htb albert@funnel.htb andreas@funnel.htb christine@funnel.htb maria@funnel.htb
</span></span><span class=line><span class=cl>Subject:Welcome to the team!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hello everyone,
</span></span><span class=line><span class=cl>We would like to welcome you to our team. 
</span></span><span class=line><span class=cl>We think you’ll be a great asset to the <span class=s2>&#34;Funnel&#34;</span> team and want to make sure you get settled in as smoothly as possible.
</span></span><span class=line><span class=cl>We have <span class=nb>set</span> up your accounts that you will need to access our internal infrastracture. Please, <span class=nb>read</span> through the attached password policy with extreme care.
</span></span><span class=line><span class=cl>All the steps mentioned there should be completed as soon as possible. If you have any questions or concerns feel free to reach directly to your manager. 
</span></span><span class=line><span class=cl>We hope that you will have an amazing <span class=nb>time</span> with us,
</span></span><span class=line><span class=cl>The funnel team. 
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_1/funnel/password-policy.png alt=password-policy title=password-policy></p><blockquote><p>funnel123#!#</p></blockquote><h2 id=task-4><strong>TASK 4</strong><a hidden class=anchor aria-hidden=true href=#task-4>#</a></h2><p><strong>Question</strong>: <em>Which user has not changed their default password yet?</em></p><p>Going through the <strong>collected</strong> usernames <strong>one-by-one</strong> appears to be rewarding.</p><table><thead><tr><th>collected credentials from TASK3</th><th></th></tr></thead><tbody><tr><td><em>username</em></td><td style=text-align:left>root, optimus, albert, andreas, christine, maria</td></tr><tr><td><em>password</em></td><td style=text-align:left>funnel123#!#</td></tr></tbody></table><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$ssh</span> albert@<span class=nv>$rhost</span> -p <span class=m>22</span>
</span></span><span class=line><span class=cl>albert@10.129.228.195<span class=s1>&#39;s password: 
</span></span></span><span class=line><span class=cl><span class=s1>Permission denied, please try again.
</span></span></span><span class=line><span class=cl><span class=s1>albert@10.129.228.195&#39;</span>s password: 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$ssh</span> andreas@<span class=nv>$rhost</span> -p <span class=m>22</span>
</span></span><span class=line><span class=cl>andreas@10.129.228.195<span class=s1>&#39;s password: 
</span></span></span><span class=line><span class=cl><span class=s1>Permission denied, please try again.
</span></span></span><span class=line><span class=cl><span class=s1>andreas@10.129.228.195&#39;</span>s password: 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$ssh</span> christine@<span class=nv>$rhost</span> -p <span class=m>22</span>
</span></span><span class=line><span class=cl>christine@10.129.228.195<span class=err>&#39;</span>s password: 
</span></span><span class=line><span class=cl>Welcome to Ubuntu 20.04.5 LTS <span class=o>(</span>GNU/Linux 5.4.0-135-generic x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Documentation:  https://help.ubuntu.com
</span></span><span class=line><span class=cl> * Management:     https://landscape.canonical.com
</span></span><span class=line><span class=cl> * Support:        https://ubuntu.com/advantage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System information as of Tue <span class=m>09</span> May <span class=m>2023</span> 09:33:21 PM UTC
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System load:              0.0
</span></span><span class=line><span class=cl>  Usage of /:               63.2% of 4.78GB
</span></span><span class=line><span class=cl>  Memory usage:             13%
</span></span><span class=line><span class=cl>  Swap usage:               0%
</span></span><span class=line><span class=cl>  Processes:                <span class=m>160</span>
</span></span><span class=line><span class=cl>  Users logged in:          <span class=m>0</span>
</span></span><span class=line><span class=cl>  IPv4 address <span class=k>for</span> docker0: 172.17.0.1
</span></span><span class=line><span class=cl>  IPv4 address <span class=k>for</span> ens160:  10.129.228.195
</span></span><span class=line><span class=cl>  IPv6 address <span class=k>for</span> ens160:  dead:beef::250:56ff:fe96:da50
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
</span></span><span class=line><span class=cl>   just raised the bar <span class=k>for</span> easy, resilient and secure K8s cluster deployment.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   https://ubuntu.com/engage/secure-kubernetes-at-the-edge
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>0</span> updates can be applied immediately.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The list of available updates is more than a week old.
</span></span><span class=line><span class=cl>To check <span class=k>for</span> new updates run: sudo apt update
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>christine@funnel:~$ 
</span></span></code></pre></div><p>It looks like <em>Christine</em> was the <strong>one</strong> who forgot to reset her <strong>default password</strong>.</p><blockquote><p>Christine</p></blockquote><h2 id=task-5><strong>TASK 5</strong><a hidden class=anchor aria-hidden=true href=#task-5>#</a></h2><p><strong>Question</strong>: <em>Which service is running on TCP port 5432 and listens only on localhost?</em></p><p>One way to do this is to <strong>search around</strong> in the - <em>/etc/services</em> - file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>christine@funnel:~$ cat /etc/services <span class=p>|</span> grep <span class=m>5432</span>
</span></span><span class=line><span class=cl>postgresql	5432/tcp	postgres	<span class=c1># PostgreSQL Database</span>
</span></span><span class=line><span class=cl>christine@funnel:~$
</span></span></code></pre></div><blockquote><p>postgresql</p></blockquote><h2 id=task-6><strong>TASK 6</strong><a hidden class=anchor aria-hidden=true href=#task-6>#</a></h2><p><strong>Question</strong>: <em>Since you can't access the previously mentioned service from the local machine, you will have to create a tunnel and connect to it from your machine. What is the correct type of tunneling to use?</em></p><ul><li>remote port forwarding</li><li>local port forwarding</li></ul><p>Since our goal is to <strong>forward</strong> all the traffic <strong>from</strong> our <strong>local</strong> machine&rsquo;s arbitrary port (<em>4444</em>) to our <strong>target</strong> machines&rsquo;s port 5432 (<em>postgres</em>), the one we set up is <strong>local port forwarding</strong>.</p><p>Looking up the <strong>man page</strong> belonging to <em><strong>ssh</strong></em> gives us a better idea about the <strong>addressing</strong> format:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>-L [bind_address:]port:host:hostport
</span></span></code></pre></div><p>And this is how we can actually <strong>set it up</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># setting up local port forwarding on local machine</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/funnel<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$ssh</span> -L 4444:localhost:5432 christine@<span class=nv>$rhost</span>
</span></span><span class=line><span class=cl>christine@10.129.228.195<span class=err>&#39;</span>s password: 
</span></span><span class=line><span class=cl>Welcome to Ubuntu 20.04.5 LTS <span class=o>(</span>GNU/Linux 5.4.0-135-generic x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><blockquote><p>local port forwarding</p></blockquote><h2 id=task-7><strong>TASK 7</strong><a hidden class=anchor aria-hidden=true href=#task-7>#</a></h2><p><strong>Question</strong>: <em>What is the name of the database that holds the flag?</em></p><p>Making use of the <strong>local port forwarding</strong> that was just set up, we can open up an <strong>other terminal</strong> (on local machine) and start <em><strong>psql</strong></em>. As for the <strong>database</strong> configuration, we set the <strong>server</strong> to <em>localhost</em> and the <strong>port</strong> to the <strong>forwarded</strong> port.</p><p>So that when an <strong>sql</strong> command is used (on local machine) it is directly fed to port 4444 (still on local machine), then - since a port forwarding is set up - forwarded to the target machine&rsquo;s port 5432, where the <strong>postgresql</strong> is already listening and running it.</p><p>This is how it looks like in a <strong>nutshell</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>sql-command -&gt; terminal(local machine) -&gt; port 4444 (local machine) -&gt; localhost (target machine) -&gt; port 5432 (target machine) -&gt; postgres (target machine)
</span></span></code></pre></div><p>It is important to note that we use the <strong>same credentials</strong> to access <em><strong>postgres</strong></em> and to get the <em><strong>ssh</strong></em> connection.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-dhydjsev2w<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$psql</span> -U christine -h localhost -p <span class=m>4444</span>
</span></span><span class=line><span class=cl>Password <span class=k>for</span> user christine: 
</span></span><span class=line><span class=cl>psql <span class=o>(</span>13.10 <span class=o>(</span>Debian 13.10-0+deb11u1<span class=o>)</span>, server 15.1 <span class=o>(</span>Debian 15.1-1.pgdg110+1<span class=o>))</span>
</span></span><span class=line><span class=cl>WARNING: psql major version 13, server major version 15.
</span></span><span class=line><span class=cl>         Some psql features might not work.
</span></span><span class=line><span class=cl>Type <span class=s2>&#34;help&#34;</span> <span class=k>for</span> help.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>christine</span><span class=o>=</span><span class=c1>#</span>
</span></span></code></pre></div><p>There is one particularly <strong>interesting</strong> <strong>database</strong> we see, once we list all the available <strong>databases</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>christine</span><span class=o>=</span><span class=c1>#\list</span>
</span></span><span class=line><span class=cl>                                  List of databases
</span></span><span class=line><span class=cl>   Name    <span class=p>|</span>   Owner   <span class=p>|</span> Encoding <span class=p>|</span>  Collate   <span class=p>|</span>   Ctype    <span class=p>|</span>    Access privileges    
</span></span><span class=line><span class=cl>-----------+-----------+----------+------------+------------+-------------------------
</span></span><span class=line><span class=cl> christine <span class=p>|</span> christine <span class=p>|</span> UTF8     <span class=p>|</span> en_US.utf8 <span class=p>|</span> en_US.utf8 <span class=p>|</span> 
</span></span><span class=line><span class=cl> postgres  <span class=p>|</span> christine <span class=p>|</span> UTF8     <span class=p>|</span> en_US.utf8 <span class=p>|</span> en_US.utf8 <span class=p>|</span> 
</span></span><span class=line><span class=cl> secrets   <span class=p>|</span> christine <span class=p>|</span> UTF8     <span class=p>|</span> en_US.utf8 <span class=p>|</span> en_US.utf8 <span class=p>|</span> 
</span></span><span class=line><span class=cl> template0 <span class=p>|</span> christine <span class=p>|</span> UTF8     <span class=p>|</span> en_US.utf8 <span class=p>|</span> en_US.utf8 <span class=p>|</span> <span class=o>=</span>c/christine           +
</span></span><span class=line><span class=cl>           <span class=p>|</span>           <span class=p>|</span>          <span class=p>|</span>            <span class=p>|</span>            <span class=p>|</span> <span class=nv>christine</span><span class=o>=</span>CTc/christine
</span></span><span class=line><span class=cl> template1 <span class=p>|</span> christine <span class=p>|</span> UTF8     <span class=p>|</span> en_US.utf8 <span class=p>|</span> en_US.utf8 <span class=p>|</span> <span class=o>=</span>c/christine           +
</span></span><span class=line><span class=cl>           <span class=p>|</span>           <span class=p>|</span>          <span class=p>|</span>            <span class=p>|</span>            <span class=p>|</span> <span class=nv>christine</span><span class=o>=</span>CTc/christine
</span></span><span class=line><span class=cl><span class=o>(</span><span class=m>5</span> rows<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>christine</span><span class=o>=</span><span class=c1>#</span>
</span></span></code></pre></div><p><strong>Selecting</strong> the appropriate <strong>database</strong> and <strong>table</strong>, then <strong>listing</strong> all the table&rsquo;s <strong>content</strong> lands us the <strong>flag</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>christine</span><span class=o>=</span><span class=c1>#\connect secrets</span>
</span></span><span class=line><span class=cl>psql <span class=o>(</span>13.10 <span class=o>(</span>Debian 13.10-0+deb11u1<span class=o>)</span>, server 15.1 <span class=o>(</span>Debian 15.1-1.pgdg110+1<span class=o>))</span>
</span></span><span class=line><span class=cl>WARNING: psql major version 13, server major version 15.
</span></span><span class=line><span class=cl>         Some psql features might not work.
</span></span><span class=line><span class=cl>You are now connected to database <span class=s2>&#34;secrets&#34;</span> as user <span class=s2>&#34;christine&#34;</span>.
</span></span><span class=line><span class=cl><span class=nv>secrets</span><span class=o>=</span><span class=c1># \dt </span>
</span></span><span class=line><span class=cl>         List of relations
</span></span><span class=line><span class=cl> Schema <span class=p>|</span> Name <span class=p>|</span> Type  <span class=p>|</span>   Owner   
</span></span><span class=line><span class=cl>--------+------+-------+-----------
</span></span><span class=line><span class=cl> public <span class=p>|</span> flag <span class=p>|</span> table <span class=p>|</span> christine
</span></span><span class=line><span class=cl><span class=o>(</span><span class=m>1</span> row<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>secrets</span><span class=o>=</span><span class=c1># select * from flag;</span>
</span></span><span class=line><span class=cl>              value               
</span></span><span class=line><span class=cl>----------------------------------
</span></span><span class=line><span class=cl> &lt;flag&gt;
</span></span><span class=line><span class=cl><span class=o>(</span><span class=m>1</span> row<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>secrets</span><span class=o>=</span><span class=c1>#</span>
</span></span></code></pre></div><blockquote><p>secrets</p></blockquote><h2 id=task-8><strong>TASK 8</strong><a hidden class=anchor aria-hidden=true href=#task-8>#</a></h2><p><strong>Question</strong>: <em>Could you use a dynamic tunnel instead of local port forwarding?</em></p><ul><li>Yes</li><li>No</li></ul><p><strong>Reading up</strong> on <strong>dynamic tunnels</strong> should make this clear.</p><blockquote><p>yes</p></blockquote><h2 id=submit-flag><strong>SUBMIT FLAG</strong><a hidden class=anchor aria-hidden=true href=#submit-flag>#</a></h2><p><strong>Question</strong>: <em>Submit root flag</em></p><p>The <strong>flag</strong> was already <strong>acquired</strong> in TASK7.</p><blockquote><p>flag</p></blockquote><p><strong>Congratulations</strong>, we just successfully <strong>pwned</strong> the <strong>target machine</strong>. All we have left to do now is to <strong>terminate</strong> the <strong>target</strong> box (if not terminated automatically) <strong>before</strong> we <strong>continue</strong> with the next box!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bluewalle.github.io/tags/htb/>htb</a></li><li><a href=https://bluewalle.github.io/tags/walkthrough/>walkthrough</a></li><li><a href=https://bluewalle.github.io/tags/funnel/>funnel</a></li><li><a href=https://bluewalle.github.io/tags/tier-1/>tier-1</a></li><li><a href=https://bluewalle.github.io/tags/vip-tier/>vip-tier</a></li><li><a href=https://bluewalle.github.io/tags/ftp/>ftp</a></li><li><a href=https://bluewalle.github.io/tags/postgresql/>postgresql</a></li><li><a href=https://bluewalle.github.io/tags/reconnaissance/>reconnaissance</a></li><li><a href=https://bluewalle.github.io/tags/tunneling/>tunneling</a></li><li><a href=https://bluewalle.github.io/tags/password-spraying/>password-spraying</a></li><li><a href=https://bluewalle.github.io/tags/port-forwarding/>port-forwarding</a></li><li><a href=https://bluewalle.github.io/tags/anonymous-access/>anonymous-access</a></li><li><a href=https://bluewalle.github.io/tags/guest-access/>guest-access</a></li><li><a href=https://bluewalle.github.io/tags/clear-text-credentials/>clear-text-credentials</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>