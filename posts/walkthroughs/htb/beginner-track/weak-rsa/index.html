<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Weak RSA - Walkthrough | Ee-Vah?</title><meta name=keywords content="htb,walkthrough,weak-rsa,difficulty-easy,completed-challenge,retired,challenge-box,weak-rsa-public-key,encrypted-flag,rsactftool,cracking-weak-rsa-public-key"><meta name=description content="The aim of this walkthrough is to provide help with the Weak RSA challenge on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Beginner-Track challenges.
PREPARING-CHALLENGE-FILES After a quick look at the challenge description"><meta name=author content="bluewalle"><link rel=canonical href=https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/weak-rsa/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bluewalle.github.io/main/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://bluewalle.github.io/main/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bluewalle.github.io/main/img/favicon-32x32.png><link rel=apple-touch-icon href=https://bluewalle.github.io/main/img/apple-touch-icon.png><link rel=mask-icon href=https://bluewalle.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB - Weak RSA - Walkthrough"><meta property="og:description" content="The aim of this walkthrough is to provide help with the Weak RSA challenge on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Beginner-Track challenges.
PREPARING-CHALLENGE-FILES After a quick look at the challenge description"><meta property="og:type" content="article"><meta property="og:url" content="https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/weak-rsa/"><meta property="og:image" content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-27T08:00:00+00:00"><meta property="article:modified_time" content="2023-05-27T08:00:00+00:00"><meta property="og:site_name" content="Just Keep Swimming"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HTB - Weak RSA - Walkthrough"><meta name=twitter:description content="The aim of this walkthrough is to provide help with the Weak RSA challenge on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.
It belongs to a series of tutorials that aim to help out complete beginners with finishing the Beginner-Track challenges.
PREPARING-CHALLENGE-FILES After a quick look at the challenge description"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bluewalle.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Weak RSA - Walkthrough","item":"https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/weak-rsa/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Weak RSA - Walkthrough","name":"HTB - Weak RSA - Walkthrough","description":"The aim of this walkthrough is to provide help with the Weak RSA challenge on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Beginner-Track challenges.\nPREPARING-CHALLENGE-FILES After a quick look at the challenge description","keywords":["htb","walkthrough","weak-rsa","difficulty-easy","completed-challenge","retired","challenge-box","weak-rsa-public-key","encrypted-flag","rsactftool","cracking-weak-rsa-public-key"],"articleBody":"The aim of this walkthrough is to provide help with the Weak RSA challenge on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out complete beginners with finishing the Beginner-Track challenges.\nPREPARING-CHALLENGE-FILES After a quick look at the challenge description\nCan you decrypt the message and get the flag? we proceed directly by downloading the challenge files.\nThere is only one compressed file called - Weak RSA.zip - and we use the provided sha256 checksum to verify it’s integrity.\n# shell command echo \"1cbf890e7a0fe8b404597b565da96c388e5653937631e2dc8710ede9d15bdb7d Weak RSA.zip\" | sha256sum -c # command line interaction ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ ll total 4.0K -rw-r--r-- 1 htb-bluewalle htb-bluewalle 826 May 27 14:34 'Weak RSA.zip' ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ echo \"1cbf890e7a0fe8b404597b565da96c388e5653937631e2dc8710ede9d15bdb7d Weak RSA.zip\" | sha256sum -c Weak RSA.zip: OK ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ It looks like our file has not been tampered with so we continue with decompressing it.\n# shell command unzip -P hackthebox Weak\\ RSA.zip # command line interaction ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ unzip -P hackthebox Weak\\ RSA.zip Archive: Weak RSA.zip inflating: flag.enc inflating: key.pub ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ The archive contains two files:\nflag.enc key.pub Once we check them out\n# shell command cat flag.enc # command line interaction ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ cat flag.enc �_�vc[��~�kZ�1�Ĩ�4�I�9V�ֿ�^G���(�+3Lu\"�T$���F0�VP�־j@�����|j������{¾�,�����YE�����Xx��,��c�N\u0026Hl2�Ӎ��[o��┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ # shell command cat key.pub # command line interaction ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ cat key.pub -----BEGIN PUBLIC KEY----- MIIBHzANBgkqhkiG9w0BAQEFAAOCAQwAMIIBBwKBgQMwO3kPsUnaNAbUlaubn7ip 4pNEXjvUOxjvLwUhtybr6Ng4undLtSQPCPf7ygoUKh1KYeqXMpTmhKjRos3xioTy 23CZuOl3WIsLiRKSVYyqBc9d8rxjNMXuUIOiNO38ealcR4p44zfHI66INPuKmTG3 RQP/6p5hv1PYcWmErEeDewKBgGEXxgRIsTlFGrW2C2JXoSvakMCWD60eAH0W2PpD qlqqOFD8JA5UFK0roQkOjhLWSVu8c6DLpWJQQlXHPqP702qIg/gx2o0bm4EzrCEJ 4gYo6Ax+U7q6TOWhQpiBHnC0ojE8kUoqMhfALpUaruTJ6zmj8IA1e1M6bMqVF8sr lb/N -----END PUBLIC KEY----- ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ it becomes clear, that only the - key.pub - file contains ASCII text, the encrypted flag file on the other hand appears to have some other character encoding in place.\nPREPARING-NECESSARY-TOOLS So in a nutshell, we have a weak public rsa key - with which our flag was probably encrypted with - our encrypted flag on our hands. Our goal is then to decrypt the flag by leveraging the weak public key and then generate the matching private rsa key. The crux of the issue lies in finding this matching private rsa key. Once the private key is found, decrypting our flag becomes trivial.\nDoing a bit of research on the topic rewards us with a very nice rsactftool which we can use to to do just that.\nFollowing the tool’s Ubuntu 18.04 and Kali specific instructions, we fist clone the repo,\n# shell command git clone https://github.com/RsaCtfTool/RsaCtfTool.git # command line interaction ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ git clone https://github.com/RsaCtfTool/RsaCtfTool.git Cloning into 'RsaCtfTool'... remote: Enumerating objects: 4587, done. remote: Counting objects: 100% (118/118), done. remote: Compressing objects: 100% (72/72), done. remote: Total 4587 (delta 73), reused 76 (delta 46), pack-reused 4469 Receiving objects: 100% (4587/4587), 16.52 MiB | 16.55 MiB/s, done. Resolving deltas: 100% (3153/3153), done. ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ then we install the required packages.\n# shell command sudo apt-get install libgmp3-dev libmpc-dev # command line interaction ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ sudo apt-get install libgmp3-dev libmpc-dev Reading package lists... Done Building dependency tree... Done Reading state information... Done The following additional packages will be installed: libmpfr-dev Suggested packages: libmpfr-doc The following NEW packages will be installed: libgmp3-dev libmpc-dev libmpfr-dev 0 upgraded, 3 newly installed, 0 to remove and 0 not upgraded. Need to get 639 kB of archives. After this operation, 1,909 kB of additional disk space will be used. Do you want to continue? [Y/n] Y Get:1 https://deb.parrot.sh/parrot parrot/main amd64 libgmp3-dev amd64 2:6.2.1+dfsg-1+deb11u1 [330 kB] Get:2 https://deb.parrot.sh/parrot parrot/main amd64 libmpfr-dev amd64 4.1.0-3 [252 kB] Get:3 https://deb.parrot.sh/parrot parrot/main amd64 libmpc-dev amd64 1.2.0-1 [56.7 kB] Fetched 639 kB in 0s (2,423 kB/s) Selecting previously unselected package libgmp3-dev:amd64. (Reading database ... 506084 files and directories currently installed.) Preparing to unpack .../libgmp3-dev_2%3a6.2.1+dfsg-1+deb11u1_amd64.deb ... Unpacking libgmp3-dev:amd64 (2:6.2.1+dfsg-1+deb11u1) ... Selecting previously unselected package libmpfr-dev:amd64. Preparing to unpack .../libmpfr-dev_4.1.0-3_amd64.deb ... Unpacking libmpfr-dev:amd64 (4.1.0-3) ... Selecting previously unselected package libmpc-dev:amd64. Preparing to unpack .../libmpc-dev_1.2.0-1_amd64.deb ... Unpacking libmpc-dev:amd64 (1.2.0-1) ... Setting up libmpfr-dev:amd64 (4.1.0-3) ... Setting up libmpc-dev:amd64 (1.2.0-1) ... Setting up libgmp3-dev:amd64 (2:6.2.1+dfsg-1+deb11u1) ... Scanning application launchers Removing duplicate launchers or broken launchers Launchers are updated ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ After that, we head over to the cloned repo and install the necessary python modules too.\n# shell command cd RsaCtfTool/ ; ll # command line interaction ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa] └──╼ [★]$ cd RsaCtfTool/ ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa/RsaCtfTool] └──╼ [★]$ ll total 76K drwxr-xr-x 1 htb-bluewalle htb-bluewalle 98 May 27 15:25 attacks -rw-r--r-- 1 htb-bluewalle htb-bluewalle 3.3K May 27 15:25 CHANGELOG.md -rw-r--r-- 1 htb-bluewalle htb-bluewalle 891 May 27 15:25 CONTRIBUTING.md -rw-r--r-- 1 htb-bluewalle htb-bluewalle 394 May 27 15:25 Dockerfile -rw-r--r-- 1 htb-bluewalle htb-bluewalle 3.2K May 27 15:25 Dockerfile_full drwxr-xr-x 1 htb-bluewalle htb-bluewalle 1.7K May 27 15:25 examples drwxr-xr-x 1 htb-bluewalle htb-bluewalle 414 May 27 15:25 lib -rw-r--r-- 1 htb-bluewalle htb-bluewalle 250 May 27 15:25 LICENSE.md -rw-r--r-- 1 htb-bluewalle htb-bluewalle 33 May 27 15:25 optional-requirements.txt -rw-r--r-- 1 htb-bluewalle htb-bluewalle 11K May 27 15:25 README.md -rw-r--r-- 1 htb-bluewalle htb-bluewalle 145 May 27 15:25 requirements.txt -rwxr-xr-x 1 htb-bluewalle htb-bluewalle 17K May 27 15:25 RsaCtfTool.py drwxr-xr-x 1 htb-bluewalle htb-bluewalle 356 May 27 15:25 sage -rw-r--r-- 1 htb-bluewalle htb-bluewalle 938 May 27 15:25 setup.py -rwxr-xr-x 1 htb-bluewalle htb-bluewalle 11K May 27 15:25 test.sh ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa/RsaCtfTool] └──╼ [★]$ # shell command pip3 install -r \"requirements.txt\" # command line interaction ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa/RsaCtfTool] └──╼ [★]$ pip3 install -r \"requirements.txt\" Requirement already satisfied: six in /usr/lib/python3/dist-packages (from -r requirements.txt (line 1)) (1.16.0) Collecting cryptography==39.0.1 Downloading cryptography-39.0.1-cp36-abi3-manylinux_2_28_x86_64.whl (4.2 MB) |████████████████████████████████| 4.2 MB 13.2 MB/s Requirement already satisfied: urllib3==1.26.5 in /usr/lib/python3/dist-packages (from -r requirements.txt (line 3)) (1.26.5) Collecting requests==2.25.1 Downloading requests-2.25.1-py2.py3-none-any.whl (61 kB) |████████████████████████████████| 61 kB 6.9 MB/s ... ... Installing collected packages: requests, z3-solver, pycryptodome, psutil, gmpy2, factordb-pycli, cryptography, bitarray ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts. crackmapexec 5.4.1 requires paramiko\u003c3.0.0,\u003e=2.7.2, but you have paramiko 3.1.0 which is incompatible. crackmapexec 5.4.1 requires requests\u003e=2.27.1, but you have requests 2.25.1 which is incompatible. censys 2.1.9 requires backoff\u003c3.0.0,\u003e=2.0.1, but you have backoff 1.10.0 which is incompatible. censys 2.1.9 requires requests\u003e=2.26.0, but you have requests 2.25.1 which is incompatible. censys 2.1.9 requires rich\u003e=10.16.2, but you have rich 10.12.0 which is incompatible. Successfully installed bitarray-2.7.3 cryptography-39.0.1 factordb-pycli-1.1.1 gmpy2-2.1.2 psutil-5.9.4 pycryptodome-3.10.4 requests-2.25.1 z3-solver-4.12.2.0 ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa/RsaCtfTool] └──╼ [★]$ DEBUGGING Since there were some error messages and warnings during the installation of the necessary python modules, we decide to install the optional requirements too.\n# shell command pip3 install -r \"optional-requirements.txt\" # command line interaction ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa/RsaCtfTool] └──╼ [★]$ pip3 install -r \"optional-requirements.txt\" Collecting wolframalpha Downloading wolframalpha-5.0.0-py3-none-any.whl (7.5 kB) Collecting SageMath Downloading sagemath-1.3.0.tar.gz (9.4 kB) Collecting gmpy==1.17 Downloading gmpy-1.17.zip (147 kB) |████████████████████████████████| 147 kB 31.6 MB/s Collecting cython\u003e=0.26 Downloading Cython-0.29.35-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (2.0 MB) |████████████████████████████████| 2.0 MB 59.4 MB/s Collecting jaraco.context Downloading jaraco.context-4.3.0-py3-none-any.whl (5.3 kB) Requirement already satisfied: xmltodict in /usr/lib/python3/dist-packages (from wolframalpha-\u003e-r optional-requirements.txt (line 1)) (0.12.0) Requirement already satisfied: more-itertools in /usr/lib/python3/dist-packages (from wolframalpha-\u003e-r optional-requirements.txt (line 1)) (4.2.0) Building wheels for collected packages: gmpy, SageMath Building wheel for gmpy (setup.py) ... done Created wheel for gmpy: filename=gmpy-1.17-cp39-cp39-linux_x86_64.whl size=243383 sha256=50e19384f637b09189bde707e5c932207510717306eeb23fe388cd7057ba2426 Stored in directory: /home/htb-bluewalle/.cache/pip/wheels/51/cd/a9/d2cbef6019ffcb5d63560bf572a00956ce0ebf043519eaef5c Building wheel for SageMath (setup.py) ... done Created wheel for SageMath: filename=sagemath-1.3.0-py3-none-any.whl size=9346 sha256=a1303dcb41118248b616236b879759160e25d52da1773ab6a435d423b267405c Stored in directory: /home/htb-bluewalle/.cache/pip/wheels/25/00/30/c3c9c8116235d0f05f58254f3713f97b6c974cbde229032be6 Successfully built gmpy SageMath Installing collected packages: jaraco.context, cython, wolframalpha, SageMath, gmpy Successfully installed SageMath-1.3.0 cython-0.29.35 gmpy-1.17 jaraco.context-4.3.0 wolframalpha-5.0.0 ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa/RsaCtfTool] └──╼ [★]$ Trying to uncipher the flag on the first run throws an error message indicating that the -private argument is not set, the private key will not be displayed, even if recovered-.\nThere is a quick fix for this mentioned under - Issues - by simply uncommenting lines 425 and 426 in the - RsaCtfTool.py - file.\n# RsaCtfTool.py ... # if we have uncipher but no uncipherfile if args.uncipher is not None: uncipher_array = [] for uncipher in args.uncipher.split(\",\"): uncipher = get_numeric_value(uncipher) uncipher = get_base64_value(uncipher) uncipher_array.append(n2s(uncipher)) args.uncipher = uncipher_array # if we have uncipherfile if args.uncipherfile is not None: if uncipher_file(args, logger): sys.exit(0) #else: # sys.exit(-1) # If we have n and one of p and q, calculated the other if args.n and (args.p or args.q): args.p, args.q = generate_pq_from_n_and_p_or_q(args.n, args.p, args.q) ... ATTACKING-WEAK-RSA-PUBLIC-KEY Then we try again.\n# shell command ./RsaCtfTool.py --publickey ../key.pub --uncipherfile ../flag.enc --private # command line interaction ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa/RsaCtfTool] └──╼ [★]$ ./RsaCtfTool.py --publickey ../key.pub --uncipherfile ../flag.enc --private [*] Testing key ../key.pub. attack initialized... attack initialized... [*] Performing factordb attack on ../key.pub. [!] internal error :-( [+] Time elapsed: 0.0410 sec. [*] Performing fibonacci_gcd attack on ../key.pub. 100%|██████████████████████████████████████████████████| 9999/9999 [00:00\u003c00:00, 76579.79it/s] [+] Time elapsed: 0.1452 sec. [*] Performing lucas_gcd attack on ../key.pub. 100%|██████████████████████████████████████████████████| 9999/9999 [00:00\u003c00:00, 78579.10it/s] [+] Time elapsed: 0.1278 sec. [*] Performing mersenne_primes attack on ../key.pub. 27%|██████████████▌ | 14/51 [00:00\u003c00:00, 279620.27it/s] [+] Time elapsed: 0.0007 sec. [*] Performing nonRSA attack on ../key.pub. [+] Time elapsed: 0.0017 sec. [*] Performing pastctfprimes attack on ../key.pub. 100%|███████████████████████████████████████████████████| 113/113 [00:00\u003c00:00, 923891.52it/s] [+] Time elapsed: 0.0006 sec. [*] Performing smallq attack on ../key.pub. [+] Time elapsed: 0.4057 sec. [*] Performing system_primes_gcd attack on ../key.pub. 100%|█████████████████████████████████████████████████| 7007/7007 [00:00\u003c00:00, 604784.20it/s] [+] Time elapsed: 0.0407 sec. [*] Performing SQUFOF attack on ../key.pub. [!] Timeout. [+] Time elapsed: 60.0004 sec. [*] Performing boneh_durfee attack on ../key.pub. Can't load boneh_durfee because sage binary is not installed [*] Performing carmichael attack on ../key.pub. [!] Timeout. [+] Time elapsed: 60.0005 sec. [*] Performing classical_shor attack on ../key.pub. [!] Timeout. [+] Time elapsed: 60.0004 sec. [*] Performing comfact_cn attack on ../key.pub. [+] Time elapsed: 0.0003 sec. [*] Performing compositorial_pm1_gcd attack on ../key.pub. 100%|██████████████████████████████████████████████████| 9999/9999 [00:00\u003c00:00, 12892.83it/s] [+] Time elapsed: 0.7763 sec. [*] Performing cube_root attack on ../key.pub. [+] Time elapsed: 0.0001 sec. [*] Performing ecm2 attack on ../key.pub. Can't load ecm2 because sage binary is not installed [*] Performing factor_2PN attack on ../key.pub. [+] Time elapsed: 0.0001 sec. [*] Performing factorial_pm1_gcd attack on ../key.pub. 100%|█████████████████████████████████████████████████| 29998/29998 [00:09\u003c00:00, 3211.78it/s] [+] Time elapsed: 9.3420 sec. [*] Performing fermat attack on ../key.pub. [!] Timeout. [+] Time elapsed: 60.0005 sec. [*] Performing fermat_numbers_gcd attack on ../key.pub. 100%|█████████████████████████████████████████████████████████| 28/28 [00:01\u003c00:00, 25.24it/s] [+] Time elapsed: 1.1110 sec. [*] Performing hart attack on ../key.pub. [!] Timeout. [+] Time elapsed: 60.0004 sec. [*] Performing highandlowbitsequal attack on ../key.pub. [+] Time elapsed: 0.0002 sec. [*] Performing kraitchik attack on ../key.pub. [!] Timeout. [+] Time elapsed: 60.0004 sec. [*] Performing lattice attack on ../key.pub. [!] simple lattice attack is for partial keys only... [+] Time elapsed: 0.0002 sec. [*] Performing lehman attack on ../key.pub. [!] Timeout. [+] Time elapsed: 60.0003 sec. [*] Performing lehmer attack on ../key.pub. [!] Timeout. [+] Time elapsed: 60.0005 sec. [*] Performing mersenne_pm1_gcd attack on ../key.pub. 100%|██████████████████████████████████████████████████| 1024/1024 [00:00\u003c00:00, 80179.35it/s] [+] Time elapsed: 0.0136 sec. [*] Performing noveltyprimes attack on ../key.pub. 100%|█████████████████████████████████████████████████████| 21/21 [00:00\u003c00:00, 222425.21it/s] [+] Time elapsed: 0.0007 sec. [*] Performing partial_d attack on ../key.pub. [!] partial_d attack is only for partial private keys not pubkeys... [!] partial_d internal error... [+] Time elapsed: 0.0003 sec. [*] Performing partial_q attack on ../key.pub. [!] partial_q attack is only for partial private keys not pubkeys... [+] Time elapsed: 0.0001 sec. [*] Performing pisano_period attack on ../key.pub. [+] Time elapsed: 0.0001 sec. [*] Performing pollard_p_1 attack on ../key.pub. 8%|████▎ | 76/997 [00:59\u003c13:07, 1.17it/s][!] Timeout. 8%|████▎ | 76/997 [00:59\u003c12:07, 1.27it/s] [+] Time elapsed: 60.0008 sec. [*] Performing primorial_pm1_gcd attack on ../key.pub. 100%|████████████████████████████████████████████████| 10000/10000 [00:00\u003c00:00, 10667.54it/s] [+] Time elapsed: 0.9382 sec. [*] Performing qicheng attack on ../key.pub. Can't load qicheng because sage binary is not installed [*] Performing qs attack on ../key.pub. Can't load qs because sage binary is not installed [*] Performing siqs attack on ../key.pub. Can't load siqs because yafu binary is not installed [*] Performing small_crt_exp attack on ../key.pub. Can't load small_crt_exp because sage binary is not installed [*] Performing wiener attack on ../key.pub. 26%|█████████████▎ | 158/607 [00:00\u003c00:00, 485494.53it/s] [*] Attack success with wiener method ! [+] Total time elapsed min,max,avg: 0.0001/60.0008/17.8371 sec. Results for ../key.pub: Private key : -----BEGIN RSA PRIVATE KEY----- MIICOQIBAAKBgQMwO3kPsUnaNAbUlaubn7ip4pNEXjvUOxjvLwUhtybr6Ng4undL tSQPCPf7ygoUKh1KYeqXMpTmhKjRos3xioTy23CZuOl3WIsLiRKSVYyqBc9d8rxj NMXuUIOiNO38ealcR4p44zfHI66INPuKmTG3RQP/6p5hv1PYcWmErEeDewKBgGEX xgRIsTlFGrW2C2JXoSvakMCWD60eAH0W2PpDqlqqOFD8JA5UFK0roQkOjhLWSVu8 c6DLpWJQQlXHPqP702qIg/gx2o0bm4EzrCEJ4gYo6Ax+U7q6TOWhQpiBHnC0ojE8 kUoqMhfALpUaruTJ6zmj8IA1e1M6bMqVF8srlb/NAiBhwngxi+Cbie3YBogNzGJV h10vAgw+i7cQqiiwEiPFNQJBAYXzr5r2KkHVjGcZNCLRAoXrzJjVhb7knZE5oEYo nEI+h2gQSt1bavv3YVxhcisTVuNrlgQo58eGb4c9dtY2blMCQQIX2W9IbtJ26KzZ C/5HPsVqgxWtuP5hN8OLf3ohhojr1NigJwc6o68dtKScaEQ5A33vmNpuWqKucecT 0HEVxuE5AiBhwngxi+Cbie3YBogNzGJVh10vAgw+i7cQqiiwEiPFNQIgYcJ4MYvg m4nt2AaIDcxiVYddLwIMPou3EKoosBIjxTUCQQCnqbJMPEQHpg5lI6MQi8ixFRqo +KwoBrwYfZlGEwZxdK2Ms0jgeta5jFFS11Fwk5+GyimnRzVcEbADJno/8BKe -----END RSA PRIVATE KEY----- Unciphered data : HEX : 0x000221cfb29883b06f409a679a58a4e97b446e28b244bbcd0687d178a8ab8722bf86da06a62e042c892d2921b336571e9ff7ac9d89ba90512bac4cfb8d7e4a3901bbccf5dfac01b27bddd35f1ca55344a75943df9a18eadb344cf7cf55fa0baa7005bfe32f41004854427b73316d706c335f5769336e3372735f34747434636b7d INT (big endian) : 1497194306832430076266314478305730170974165912795150306640063107539292495904192020114449824357438113183764256783752233913408135242464239912689425668318419718061442061010640167802145162377597484106658670422900749326253337728846324798012274989739031662527650589811318528908253458824763561374522387177140349821 INT (little endian) : 22546574266225300968123857704721191858671593287972919965619572675918636257464402082642870677657579044805501825719744981953609630743396909394906721219496019830622451770590549653716476856077849644487076110495020954617170743371827481017047908786316114794508942268154434710618690751442928771926238749045133355844096 STR : b'\\x00\\x02!\\xcf\\xb2\\x98\\x83\\xb0o@\\x9ag\\x9aX\\xa4\\xe9{Dn(\\xb2D\\xbb\\xcd\\x06\\x87\\xd1x\\xa8\\xab\\x87\"\\xbf\\x86\\xda\\x06\\xa6.\\x04,\\x89-)!\\xb36W\\x1e\\x9f\\xf7\\xac\\x9d\\x89\\xba\\x90Q+\\xacL\\xfb\\x8d~J9\\x01\\xbb\\xcc\\xf5\\xdf\\xac\\x01\\xb2{\\xdd\\xd3_\\x1c\\xa5SD\\xa7YC\\xdf\\x9a\\x18\\xea\\xdb4L\\xf7\\xcfU\\xfa\\x0b\\xaap\\x05\\xbf\\xe3/A\\x00' PKCS#1.5 padding decoded! HEX : INT (big endian) : INT (little endian) : utf-8 : STR : b'\\x00' ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa/RsaCtfTool] └──╼ [★]$ This time it works, and using the Wiener attack a matching private rsa key is found. Decrypting our flag goes pretty fast after that.\nCLEAN-UP Given that this was a challenge box without any instantiated targets, there is simply not much to clean up here. Once the flag is submitted, we move on to the next machine.\n","wordCount":"2068","inLanguage":"en","datePublished":"2023-05-27T08:00:00Z","dateModified":"2023-05-27T08:00:00Z","author":{"@type":"Person","name":"bluewalle"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/weak-rsa/"},"publisher":{"@type":"Organization","name":"Ee-Vah?","logo":{"@type":"ImageObject","url":"https://bluewalle.github.io/main/img/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bluewalle.github.io/ accesskey=h title="Just Keep Swimming (Alt + H)"><img src=https://bluewalle.github.io/apple-touch-icon.png alt aria-label=logo height=35>Just Keep Swimming</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bluewalle.github.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://bluewalle.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bluewalle.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://bluewalle.github.io/about title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bluewalle.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bluewalle.github.io/posts/>Posts</a></div><h1 class=post-title>HTB - Weak RSA - Walkthrough</h1><div class=post-meta><span title='2023-05-27 08:00:00 +0000 +0000'>May, 2023</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;2068 words&nbsp;·&nbsp;bluewalle</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#preparing-challenge-files><strong>PREPARING-CHALLENGE-FILES</strong></a></li><li><a href=#preparing-necessary-tools><strong>PREPARING-NECESSARY-TOOLS</strong></a></li><li><a href=#debugging><strong>DEBUGGING</strong></a></li><li><a href=#attacking-weak-rsa-public-key><strong>ATTACKING-WEAK-RSA-PUBLIC-KEY</strong></a></li><li><a href=#clean-up><strong>CLEAN-UP</strong></a></li></ul></nav></div></details></div><div class=post-content><p>The aim of this walkthrough is to provide help with the <a href=https://app.hackthebox.com/challenges/6 title="Weak RSA">Weak RSA</a> challenge on the <a href=https://hackthebox.com title="Hack The Box website">Hack The Box website</a>. Please <strong>note</strong> that no <strong>flags</strong> are directly provided here. Moreover, <strong>be aware</strong> that this is only <strong>one</strong> of the <strong>many</strong> ways to solve the challenges.</p><p>It belongs to a series of tutorials that aim to help out complete beginners with finishing the <a href=https://app.hackthebox.com/tracks/Beginner-Track title=Beginner-Track>Beginner-Track</a> challenges.</p><h2 id=preparing-challenge-files><strong>PREPARING-CHALLENGE-FILES</strong><a hidden class=anchor aria-hidden=true href=#preparing-challenge-files>#</a></h2><p>After a quick look at the <strong>challenge description</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Can you decrypt the message and get the flag?
</span></span></code></pre></div><p>we proceed directly by <strong>downloading</strong> the <strong>challenge files</strong>.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/weak-rsa/downloading-challenge.png alt=downloading-challenge title=downloading-challenge></p><p>There is only one <strong>compressed file</strong> called - <em>Weak RSA.zip</em> - and we use the provided <strong>sha256</strong> <strong>checksum</strong> to verify it&rsquo;s <strong>integrity</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;1cbf890e7a0fe8b404597b565da96c388e5653937631e2dc8710ede9d15bdb7d  Weak RSA.zip&#34;</span> <span class=p>|</span> sha256sum -c
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ll
</span></span><span class=line><span class=cl>total 4.0K
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle <span class=m>826</span> May <span class=m>27</span> 14:34 <span class=s1>&#39;Weak RSA.zip&#39;</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ <span class=nb>echo</span> <span class=s2>&#34;1cbf890e7a0fe8b404597b565da96c388e5653937631e2dc8710ede9d15bdb7d  Weak RSA.zip&#34;</span> <span class=p>|</span> sha256sum -c 
</span></span><span class=line><span class=cl>Weak RSA.zip: OK
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>It looks like our file has <strong>not been tampered with</strong> so we continue with <strong>decompressing</strong> it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>unzip -P hackthebox Weak<span class=se>\ </span>RSA.zip
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ unzip -P hackthebox Weak<span class=se>\ </span>RSA.zip
</span></span><span class=line><span class=cl>Archive:  Weak RSA.zip
</span></span><span class=line><span class=cl>  inflating: flag.enc                
</span></span><span class=line><span class=cl>  inflating: key.pub                 
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>The <strong>archive</strong> contains two files:</p><ul><li><em>flag.enc</em></li><li><em>key.pub</em></li></ul><p>Once we <strong>check</strong> them <strong>out</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>cat flag.enc
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat flag.enc 
</span></span><span class=line><span class=cl>�_�vc<span class=o>[</span>��~�kZ�1�Ĩ�4�I�9V�ֿ�^G���<span class=o>(</span>�+3Lu<span class=s2>&#34;�T</span>$<span class=s2>���F0�VP�־j@�����|j������{¾�,�����YE�����Xx��,��c�N&amp;Hl2�Ӎ��[o��┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-cgu0osry2k]─[~/weak-rsa]
</span></span></span><span class=line><span class=cl><span class=s2>└──╼ [★]</span>$<span class=s2>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>cat key.pub
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat key.pub 
</span></span><span class=line><span class=cl>-----BEGIN PUBLIC KEY-----
</span></span><span class=line><span class=cl>MIIBHzANBgkqhkiG9w0BAQEFAAOCAQwAMIIBBwKBgQMwO3kPsUnaNAbUlaubn7ip
</span></span><span class=line><span class=cl>4pNEXjvUOxjvLwUhtybr6Ng4undLtSQPCPf7ygoUKh1KYeqXMpTmhKjRos3xioTy
</span></span><span class=line><span class=cl>23CZuOl3WIsLiRKSVYyqBc9d8rxjNMXuUIOiNO38ealcR4p44zfHI66INPuKmTG3
</span></span><span class=line><span class=cl>RQP/6p5hv1PYcWmErEeDewKBgGEXxgRIsTlFGrW2C2JXoSvakMCWD60eAH0W2PpD
</span></span><span class=line><span class=cl>qlqqOFD8JA5UFK0roQkOjhLWSVu8c6DLpWJQQlXHPqP702qIg/gx2o0bm4EzrCEJ
</span></span><span class=line><span class=cl>4gYo6Ax+U7q6TOWhQpiBHnC0ojE8kUoqMhfALpUaruTJ6zmj8IA1e1M6bMqVF8sr
</span></span><span class=line><span class=cl>lb/N
</span></span><span class=line><span class=cl>-----END PUBLIC KEY-----
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>it becomes clear, that only the - <em>key.pub</em> - file contains <strong>ASCII text</strong>, the <strong>encrypted</strong> flag file on the other hand appears to have some other <strong>character encoding</strong> in place.</p><h2 id=preparing-necessary-tools><strong>PREPARING-NECESSARY-TOOLS</strong><a hidden class=anchor aria-hidden=true href=#preparing-necessary-tools>#</a></h2><p>So in a nutshell, we have a <strong>weak</strong> <strong>public rsa key</strong> - with which our flag was probably <strong>encrypted</strong> with - our <strong>encrypted flag</strong> on our hands. Our goal is then to <strong>decrypt</strong> the <strong>flag</strong> by leveraging the <strong>weak</strong> public key and then generate the matching <strong>private rsa key</strong>. The crux of the issue lies in finding this matching <strong>private rsa key</strong>. Once the private key is found, <strong>decrypting</strong> our <strong>flag</strong> becomes trivial.</p><p>Doing a bit of <strong>research</strong> on the topic rewards us with a very nice <a href=https://github.com/RsaCtfTool/RsaCtfTool title=rsactftool>rsactftool</a> which we can use to to do just that.</p><p>Following the tool&rsquo;s <em>Ubuntu 18.04 and Kali</em> specific <strong>instructions</strong>, we fist <strong>clone</strong> the <strong>repo</strong>,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>git clone https://github.com/RsaCtfTool/RsaCtfTool.git
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ git clone https://github.com/RsaCtfTool/RsaCtfTool.git
</span></span><span class=line><span class=cl>Cloning into <span class=s1>&#39;RsaCtfTool&#39;</span>...
</span></span><span class=line><span class=cl>remote: Enumerating objects: 4587, <span class=k>done</span>.
</span></span><span class=line><span class=cl>remote: Counting objects: 100% <span class=o>(</span>118/118<span class=o>)</span>, <span class=k>done</span>.
</span></span><span class=line><span class=cl>remote: Compressing objects: 100% <span class=o>(</span>72/72<span class=o>)</span>, <span class=k>done</span>.
</span></span><span class=line><span class=cl>remote: Total <span class=m>4587</span> <span class=o>(</span>delta 73<span class=o>)</span>, reused <span class=m>76</span> <span class=o>(</span>delta 46<span class=o>)</span>, pack-reused <span class=m>4469</span>
</span></span><span class=line><span class=cl>Receiving objects: 100% <span class=o>(</span>4587/4587<span class=o>)</span>, 16.52 MiB <span class=p>|</span> 16.55 MiB/s, <span class=k>done</span>.
</span></span><span class=line><span class=cl>Resolving deltas: 100% <span class=o>(</span>3153/3153<span class=o>)</span>, <span class=k>done</span>.
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>then we <strong>install</strong> the <strong>required packages</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>sudo apt-get install libgmp3-dev libmpc-dev
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ sudo apt-get install libgmp3-dev libmpc-dev 
</span></span><span class=line><span class=cl>Reading package lists... Done
</span></span><span class=line><span class=cl>Building dependency tree... Done
</span></span><span class=line><span class=cl>Reading state information... Done
</span></span><span class=line><span class=cl>The following additional packages will be installed:
</span></span><span class=line><span class=cl>  libmpfr-dev
</span></span><span class=line><span class=cl>Suggested packages:
</span></span><span class=line><span class=cl>  libmpfr-doc
</span></span><span class=line><span class=cl>The following NEW packages will be installed:
</span></span><span class=line><span class=cl>  libgmp3-dev libmpc-dev libmpfr-dev
</span></span><span class=line><span class=cl><span class=m>0</span> upgraded, <span class=m>3</span> newly installed, <span class=m>0</span> to remove and <span class=m>0</span> not upgraded.
</span></span><span class=line><span class=cl>Need to get <span class=m>639</span> kB of archives.
</span></span><span class=line><span class=cl>After this operation, 1,909 kB of additional disk space will be used.
</span></span><span class=line><span class=cl>Do you want to <span class=k>continue</span>? <span class=o>[</span>Y/n<span class=o>]</span> Y
</span></span><span class=line><span class=cl>Get:1 https://deb.parrot.sh/parrot parrot/main amd64 libgmp3-dev amd64 2:6.2.1+dfsg-1+deb11u1 <span class=o>[</span><span class=m>330</span> kB<span class=o>]</span>
</span></span><span class=line><span class=cl>Get:2 https://deb.parrot.sh/parrot parrot/main amd64 libmpfr-dev amd64 4.1.0-3 <span class=o>[</span><span class=m>252</span> kB<span class=o>]</span>
</span></span><span class=line><span class=cl>Get:3 https://deb.parrot.sh/parrot parrot/main amd64 libmpc-dev amd64 1.2.0-1 <span class=o>[</span>56.7 kB<span class=o>]</span>
</span></span><span class=line><span class=cl>Fetched <span class=m>639</span> kB in 0s <span class=o>(</span>2,423 kB/s<span class=o>)</span>     
</span></span><span class=line><span class=cl>Selecting previously unselected package libgmp3-dev:amd64.
</span></span><span class=line><span class=cl><span class=o>(</span>Reading database ... <span class=m>506084</span> files and directories currently installed.<span class=o>)</span>
</span></span><span class=line><span class=cl>Preparing to unpack .../libgmp3-dev_2%3a6.2.1+dfsg-1+deb11u1_amd64.deb ...
</span></span><span class=line><span class=cl>Unpacking libgmp3-dev:amd64 <span class=o>(</span>2:6.2.1+dfsg-1+deb11u1<span class=o>)</span> ...
</span></span><span class=line><span class=cl>Selecting previously unselected package libmpfr-dev:amd64.
</span></span><span class=line><span class=cl>Preparing to unpack .../libmpfr-dev_4.1.0-3_amd64.deb ...
</span></span><span class=line><span class=cl>Unpacking libmpfr-dev:amd64 <span class=o>(</span>4.1.0-3<span class=o>)</span> ...
</span></span><span class=line><span class=cl>Selecting previously unselected package libmpc-dev:amd64.
</span></span><span class=line><span class=cl>Preparing to unpack .../libmpc-dev_1.2.0-1_amd64.deb ...
</span></span><span class=line><span class=cl>Unpacking libmpc-dev:amd64 <span class=o>(</span>1.2.0-1<span class=o>)</span> ...
</span></span><span class=line><span class=cl>Setting up libmpfr-dev:amd64 <span class=o>(</span>4.1.0-3<span class=o>)</span> ...
</span></span><span class=line><span class=cl>Setting up libmpc-dev:amd64 <span class=o>(</span>1.2.0-1<span class=o>)</span> ...
</span></span><span class=line><span class=cl>Setting up libgmp3-dev:amd64 <span class=o>(</span>2:6.2.1+dfsg-1+deb11u1<span class=o>)</span> ...
</span></span><span class=line><span class=cl>Scanning application launchers
</span></span><span class=line><span class=cl>Removing duplicate launchers or broken launchers
</span></span><span class=line><span class=cl>Launchers are updated
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>After that, we <strong>head</strong> <strong>over</strong> to the <strong>cloned repo</strong> and <strong>install</strong> the necessary <strong>python modules</strong> too.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> RsaCtfTool/ <span class=p>;</span> ll
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ <span class=nb>cd</span> RsaCtfTool/
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa/RsaCtfTool<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ll
</span></span><span class=line><span class=cl>total 76K
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> htb-bluewalle htb-bluewalle   <span class=m>98</span> May <span class=m>27</span> 15:25 attacks
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle 3.3K May <span class=m>27</span> 15:25 CHANGELOG.md
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle  <span class=m>891</span> May <span class=m>27</span> 15:25 CONTRIBUTING.md
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle  <span class=m>394</span> May <span class=m>27</span> 15:25 Dockerfile
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle 3.2K May <span class=m>27</span> 15:25 Dockerfile_full
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> htb-bluewalle htb-bluewalle 1.7K May <span class=m>27</span> 15:25 examples
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> htb-bluewalle htb-bluewalle  <span class=m>414</span> May <span class=m>27</span> 15:25 lib
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle  <span class=m>250</span> May <span class=m>27</span> 15:25 LICENSE.md
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle   <span class=m>33</span> May <span class=m>27</span> 15:25 optional-requirements.txt
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle  11K May <span class=m>27</span> 15:25 README.md
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle  <span class=m>145</span> May <span class=m>27</span> 15:25 requirements.txt
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> htb-bluewalle htb-bluewalle  17K May <span class=m>27</span> 15:25 RsaCtfTool.py
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> htb-bluewalle htb-bluewalle  <span class=m>356</span> May <span class=m>27</span> 15:25 sage
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle  <span class=m>938</span> May <span class=m>27</span> 15:25 setup.py
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> htb-bluewalle htb-bluewalle  11K May <span class=m>27</span> 15:25 test.sh
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa/RsaCtfTool<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>pip3 install -r <span class=s2>&#34;requirements.txt&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa/RsaCtfTool<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ pip3 install -r <span class=s2>&#34;requirements.txt&#34;</span>
</span></span><span class=line><span class=cl>Requirement already satisfied: six in /usr/lib/python3/dist-packages <span class=o>(</span>from -r requirements.txt <span class=o>(</span>line 1<span class=o>))</span> <span class=o>(</span>1.16.0<span class=o>)</span>
</span></span><span class=line><span class=cl>Collecting <span class=nv>cryptography</span><span class=o>==</span>39.0.1
</span></span><span class=line><span class=cl>  Downloading cryptography-39.0.1-cp36-abi3-manylinux_2_28_x86_64.whl <span class=o>(</span>4.2 MB<span class=o>)</span>
</span></span><span class=line><span class=cl>     <span class=p>|</span>████████████████████████████████<span class=p>|</span> 4.2 MB 13.2 MB/s 
</span></span><span class=line><span class=cl>Requirement already satisfied: <span class=nv>urllib3</span><span class=o>==</span>1.26.5 in /usr/lib/python3/dist-packages <span class=o>(</span>from -r requirements.txt <span class=o>(</span>line 3<span class=o>))</span> <span class=o>(</span>1.26.5<span class=o>)</span>
</span></span><span class=line><span class=cl>Collecting <span class=nv>requests</span><span class=o>==</span>2.25.1
</span></span><span class=line><span class=cl>  Downloading requests-2.25.1-py2.py3-none-any.whl <span class=o>(</span><span class=m>61</span> kB<span class=o>)</span>
</span></span><span class=line><span class=cl>     <span class=p>|</span>████████████████████████████████<span class=p>|</span> <span class=m>61</span> kB 6.9 MB/s 
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Installing collected packages: requests, z3-solver, pycryptodome, psutil, gmpy2, factordb-pycli, cryptography, bitarray
</span></span><span class=line><span class=cl>ERROR: pip<span class=err>&#39;</span>s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the <span class=nb>source</span> of the following dependency conflicts.
</span></span><span class=line><span class=cl>crackmapexec 5.4.1 requires paramiko&lt;3.0.0,&gt;<span class=o>=</span>2.7.2, but you have paramiko 3.1.0 which is incompatible.
</span></span><span class=line><span class=cl>crackmapexec 5.4.1 requires requests&gt;<span class=o>=</span>2.27.1, but you have requests 2.25.1 which is incompatible.
</span></span><span class=line><span class=cl>censys 2.1.9 requires backoff&lt;3.0.0,&gt;<span class=o>=</span>2.0.1, but you have backoff 1.10.0 which is incompatible.
</span></span><span class=line><span class=cl>censys 2.1.9 requires requests&gt;<span class=o>=</span>2.26.0, but you have requests 2.25.1 which is incompatible.
</span></span><span class=line><span class=cl>censys 2.1.9 requires rich&gt;<span class=o>=</span>10.16.2, but you have rich 10.12.0 which is incompatible.
</span></span><span class=line><span class=cl>Successfully installed bitarray-2.7.3 cryptography-39.0.1 factordb-pycli-1.1.1 gmpy2-2.1.2 psutil-5.9.4 pycryptodome-3.10.4 requests-2.25.1 z3-solver-4.12.2.0
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa/RsaCtfTool<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><h2 id=debugging><strong>DEBUGGING</strong><a hidden class=anchor aria-hidden=true href=#debugging>#</a></h2><p>Since there were some <strong>error messages</strong> and <strong>warnings</strong> during the <strong>installation</strong> of the necessary python modules, we decide to <strong>install</strong> the <strong>optional requirements</strong> too.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>pip3 install -r <span class=s2>&#34;optional-requirements.txt&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa/RsaCtfTool<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ pip3 install -r <span class=s2>&#34;optional-requirements.txt&#34;</span> 
</span></span><span class=line><span class=cl>Collecting wolframalpha
</span></span><span class=line><span class=cl>  Downloading wolframalpha-5.0.0-py3-none-any.whl <span class=o>(</span>7.5 kB<span class=o>)</span>
</span></span><span class=line><span class=cl>Collecting SageMath
</span></span><span class=line><span class=cl>  Downloading sagemath-1.3.0.tar.gz <span class=o>(</span>9.4 kB<span class=o>)</span>
</span></span><span class=line><span class=cl>Collecting <span class=nv>gmpy</span><span class=o>==</span>1.17
</span></span><span class=line><span class=cl>  Downloading gmpy-1.17.zip <span class=o>(</span><span class=m>147</span> kB<span class=o>)</span>
</span></span><span class=line><span class=cl>     <span class=p>|</span>████████████████████████████████<span class=p>|</span> <span class=m>147</span> kB 31.6 MB/s 
</span></span><span class=line><span class=cl>Collecting cython&gt;<span class=o>=</span>0.26
</span></span><span class=line><span class=cl>  Downloading Cython-0.29.35-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl <span class=o>(</span>2.0 MB<span class=o>)</span>
</span></span><span class=line><span class=cl>     <span class=p>|</span>████████████████████████████████<span class=p>|</span> 2.0 MB 59.4 MB/s 
</span></span><span class=line><span class=cl>Collecting jaraco.context
</span></span><span class=line><span class=cl>  Downloading jaraco.context-4.3.0-py3-none-any.whl <span class=o>(</span>5.3 kB<span class=o>)</span>
</span></span><span class=line><span class=cl>Requirement already satisfied: xmltodict in /usr/lib/python3/dist-packages <span class=o>(</span>from wolframalpha-&gt;-r optional-requirements.txt <span class=o>(</span>line 1<span class=o>))</span> <span class=o>(</span>0.12.0<span class=o>)</span>
</span></span><span class=line><span class=cl>Requirement already satisfied: more-itertools in /usr/lib/python3/dist-packages <span class=o>(</span>from wolframalpha-&gt;-r optional-requirements.txt <span class=o>(</span>line 1<span class=o>))</span> <span class=o>(</span>4.2.0<span class=o>)</span>
</span></span><span class=line><span class=cl>Building wheels <span class=k>for</span> collected packages: gmpy, SageMath
</span></span><span class=line><span class=cl>  Building wheel <span class=k>for</span> gmpy <span class=o>(</span>setup.py<span class=o>)</span> ... <span class=k>done</span>
</span></span><span class=line><span class=cl>  Created wheel <span class=k>for</span> gmpy: <span class=nv>filename</span><span class=o>=</span>gmpy-1.17-cp39-cp39-linux_x86_64.whl <span class=nv>size</span><span class=o>=</span><span class=m>243383</span> <span class=nv>sha256</span><span class=o>=</span>50e19384f637b09189bde707e5c932207510717306eeb23fe388cd7057ba2426
</span></span><span class=line><span class=cl>  Stored in directory: /home/htb-bluewalle/.cache/pip/wheels/51/cd/a9/d2cbef6019ffcb5d63560bf572a00956ce0ebf043519eaef5c
</span></span><span class=line><span class=cl>  Building wheel <span class=k>for</span> SageMath <span class=o>(</span>setup.py<span class=o>)</span> ... <span class=k>done</span>
</span></span><span class=line><span class=cl>  Created wheel <span class=k>for</span> SageMath: <span class=nv>filename</span><span class=o>=</span>sagemath-1.3.0-py3-none-any.whl <span class=nv>size</span><span class=o>=</span><span class=m>9346</span> <span class=nv>sha256</span><span class=o>=</span>a1303dcb41118248b616236b879759160e25d52da1773ab6a435d423b267405c
</span></span><span class=line><span class=cl>  Stored in directory: /home/htb-bluewalle/.cache/pip/wheels/25/00/30/c3c9c8116235d0f05f58254f3713f97b6c974cbde229032be6
</span></span><span class=line><span class=cl>Successfully built gmpy SageMath
</span></span><span class=line><span class=cl>Installing collected packages: jaraco.context, cython, wolframalpha, SageMath, gmpy
</span></span><span class=line><span class=cl>Successfully installed SageMath-1.3.0 cython-0.29.35 gmpy-1.17 jaraco.context-4.3.0 wolframalpha-5.0.0
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa/RsaCtfTool<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Trying to <strong>uncipher</strong> the <strong>flag</strong> on the <strong>first run</strong> throws an <strong>error message</strong> indicating that the -<em>private argument is not set, the private key will not be displayed, even if recovered</em>-.</p><p>There is a <strong>quick fix</strong> for this mentioned under - <em>Issues</em> - by simply <strong>uncommenting lines</strong> 425 and 426 in the - <em>RsaCtfTool.py</em> - file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># RsaCtfTool.py</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>    <span class=c1># if we have uncipher but no uncipherfile</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>uncipher</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>uncipher_array</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>uncipher</span> <span class=ow>in</span> <span class=n>args</span><span class=o>.</span><span class=n>uncipher</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;,&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>uncipher</span> <span class=o>=</span> <span class=n>get_numeric_value</span><span class=p>(</span><span class=n>uncipher</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>uncipher</span> <span class=o>=</span> <span class=n>get_base64_value</span><span class=p>(</span><span class=n>uncipher</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>uncipher_array</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>n2s</span><span class=p>(</span><span class=n>uncipher</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>args</span><span class=o>.</span><span class=n>uncipher</span> <span class=o>=</span> <span class=n>uncipher_array</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># if we have uncipherfile</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>uncipherfile</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>uncipher_file</span><span class=p>(</span><span class=n>args</span><span class=p>,</span> <span class=n>logger</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1>#else:</span>
</span></span><span class=line><span class=cl>        <span class=c1>#    sys.exit(-1)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># If we have n and one of p and q, calculated the other</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>n</span> <span class=ow>and</span> <span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>p</span> <span class=ow>or</span> <span class=n>args</span><span class=o>.</span><span class=n>q</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>args</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>q</span> <span class=o>=</span> <span class=n>generate_pq_from_n_and_p_or_q</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>n</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>p</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>q</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div><h2 id=attacking-weak-rsa-public-key><strong>ATTACKING-WEAK-RSA-PUBLIC-KEY</strong><a hidden class=anchor aria-hidden=true href=#attacking-weak-rsa-public-key>#</a></h2><p>Then we <strong>try again</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>./RsaCtfTool.py --publickey ../key.pub --uncipherfile ../flag.enc --private
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa/RsaCtfTool<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ./RsaCtfTool.py --publickey ../key.pub --uncipherfile ../flag.enc --private
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Testing key ../key.pub.
</span></span><span class=line><span class=cl>attack initialized...
</span></span><span class=line><span class=cl>attack initialized...
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing factordb attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> internal error :-<span class=o>(</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0410 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing fibonacci_gcd attack on ../key.pub.
</span></span><span class=line><span class=cl>100%<span class=p>|</span>██████████████████████████████████████████████████<span class=p>|</span> 9999/9999 <span class=o>[</span>00:00&lt;00:00, 76579.79it/s<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.1452 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing lucas_gcd attack on ../key.pub.
</span></span><span class=line><span class=cl>100%<span class=p>|</span>██████████████████████████████████████████████████<span class=p>|</span> 9999/9999 <span class=o>[</span>00:00&lt;00:00, 78579.10it/s<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.1278 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing mersenne_primes attack on ../key.pub.
</span></span><span class=line><span class=cl> 27%<span class=p>|</span>██████████████▌                                      <span class=p>|</span> 14/51 <span class=o>[</span>00:00&lt;00:00, 279620.27it/s<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0007 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing nonRSA attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0017 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing pastctfprimes attack on ../key.pub.
</span></span><span class=line><span class=cl>100%<span class=p>|</span>███████████████████████████████████████████████████<span class=p>|</span> 113/113 <span class=o>[</span>00:00&lt;00:00, 923891.52it/s<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0006 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing smallq attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.4057 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing system_primes_gcd attack on ../key.pub.
</span></span><span class=line><span class=cl>100%<span class=p>|</span>█████████████████████████████████████████████████<span class=p>|</span> 7007/7007 <span class=o>[</span>00:00&lt;00:00, 604784.20it/s<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0407 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing SQUFOF attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Timeout.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 60.0004 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing boneh_durfee attack on ../key.pub.
</span></span><span class=line><span class=cl>Can<span class=s1>&#39;t load boneh_durfee because sage binary is not installed
</span></span></span><span class=line><span class=cl><span class=s1>[*] Performing carmichael attack on ../key.pub.
</span></span></span><span class=line><span class=cl><span class=s1>[!] Timeout.
</span></span></span><span class=line><span class=cl><span class=s1>[+] Time elapsed: 60.0005 sec.
</span></span></span><span class=line><span class=cl><span class=s1>[*] Performing classical_shor attack on ../key.pub.
</span></span></span><span class=line><span class=cl><span class=s1>[!] Timeout.
</span></span></span><span class=line><span class=cl><span class=s1>[+] Time elapsed: 60.0004 sec.
</span></span></span><span class=line><span class=cl><span class=s1>[*] Performing comfact_cn attack on ../key.pub.
</span></span></span><span class=line><span class=cl><span class=s1>[+] Time elapsed: 0.0003 sec.
</span></span></span><span class=line><span class=cl><span class=s1>[*] Performing compositorial_pm1_gcd attack on ../key.pub.
</span></span></span><span class=line><span class=cl><span class=s1>100%|██████████████████████████████████████████████████| 9999/9999 [00:00&lt;00:00, 12892.83it/s]
</span></span></span><span class=line><span class=cl><span class=s1>[+] Time elapsed: 0.7763 sec.
</span></span></span><span class=line><span class=cl><span class=s1>[*] Performing cube_root attack on ../key.pub.
</span></span></span><span class=line><span class=cl><span class=s1>[+] Time elapsed: 0.0001 sec.
</span></span></span><span class=line><span class=cl><span class=s1>[*] Performing ecm2 attack on ../key.pub.
</span></span></span><span class=line><span class=cl><span class=s1>Can&#39;</span>t load ecm2 because sage binary is not installed
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing factor_2PN attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0001 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing factorial_pm1_gcd attack on ../key.pub.
</span></span><span class=line><span class=cl>100%<span class=p>|</span>█████████████████████████████████████████████████<span class=p>|</span> 29998/29998 <span class=o>[</span>00:09&lt;00:00, 3211.78it/s<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 9.3420 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing fermat attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Timeout.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 60.0005 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing fermat_numbers_gcd attack on ../key.pub.
</span></span><span class=line><span class=cl>100%<span class=p>|</span>█████████████████████████████████████████████████████████<span class=p>|</span> 28/28 <span class=o>[</span>00:01&lt;00:00, 25.24it/s<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 1.1110 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing hart attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Timeout.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 60.0004 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing highandlowbitsequal attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0002 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing kraitchik attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Timeout.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 60.0004 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing lattice attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> simple lattice attack is <span class=k>for</span> partial keys only...
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0002 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing lehman attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Timeout.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 60.0003 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing lehmer attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Timeout.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 60.0005 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing mersenne_pm1_gcd attack on ../key.pub.
</span></span><span class=line><span class=cl>100%<span class=p>|</span>██████████████████████████████████████████████████<span class=p>|</span> 1024/1024 <span class=o>[</span>00:00&lt;00:00, 80179.35it/s<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0136 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing noveltyprimes attack on ../key.pub.
</span></span><span class=line><span class=cl>100%<span class=p>|</span>█████████████████████████████████████████████████████<span class=p>|</span> 21/21 <span class=o>[</span>00:00&lt;00:00, 222425.21it/s<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0007 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing partial_d attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> partial_d attack is only <span class=k>for</span> partial private keys not pubkeys...
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> partial_d internal error...
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0003 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing partial_q attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> partial_q attack is only <span class=k>for</span> partial private keys not pubkeys...
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0001 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing pisano_period attack on ../key.pub.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.0001 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing pollard_p_1 attack on ../key.pub.
</span></span><span class=line><span class=cl>  8%<span class=p>|</span>████▎                                                   <span class=p>|</span> 76/997 <span class=o>[</span>00:59&lt;13:07,  1.17it/s<span class=o>][</span>!<span class=o>]</span> Timeout.
</span></span><span class=line><span class=cl>  8%<span class=p>|</span>████▎                                                   <span class=p>|</span> 76/997 <span class=o>[</span>00:59&lt;12:07,  1.27it/s<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 60.0008 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing primorial_pm1_gcd attack on ../key.pub.
</span></span><span class=line><span class=cl>100%<span class=p>|</span>████████████████████████████████████████████████<span class=p>|</span> 10000/10000 <span class=o>[</span>00:00&lt;00:00, 10667.54it/s<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Time elapsed: 0.9382 sec.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing qicheng attack on ../key.pub.
</span></span><span class=line><span class=cl>Can<span class=s1>&#39;t load qicheng because sage binary is not installed
</span></span></span><span class=line><span class=cl><span class=s1>[*] Performing qs attack on ../key.pub.
</span></span></span><span class=line><span class=cl><span class=s1>Can&#39;</span>t load qs because sage binary is not installed
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing siqs attack on ../key.pub.
</span></span><span class=line><span class=cl>Can<span class=s1>&#39;t load siqs because yafu binary is not installed
</span></span></span><span class=line><span class=cl><span class=s1>[*] Performing small_crt_exp attack on ../key.pub.
</span></span></span><span class=line><span class=cl><span class=s1>Can&#39;</span>t load small_crt_exp because sage binary is not installed
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Performing wiener attack on ../key.pub.
</span></span><span class=line><span class=cl> 26%<span class=p>|</span>█████████████▎                                     <span class=p>|</span> 158/607 <span class=o>[</span>00:00&lt;00:00, 485494.53it/s<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Attack success with wiener method !
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Total <span class=nb>time</span> elapsed min,max,avg: 0.0001/60.0008/17.8371 sec.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Results <span class=k>for</span> ../key.pub:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Private key :
</span></span><span class=line><span class=cl>-----BEGIN RSA PRIVATE KEY-----
</span></span><span class=line><span class=cl>MIICOQIBAAKBgQMwO3kPsUnaNAbUlaubn7ip4pNEXjvUOxjvLwUhtybr6Ng4undL
</span></span><span class=line><span class=cl>tSQPCPf7ygoUKh1KYeqXMpTmhKjRos3xioTy23CZuOl3WIsLiRKSVYyqBc9d8rxj
</span></span><span class=line><span class=cl>NMXuUIOiNO38ealcR4p44zfHI66INPuKmTG3RQP/6p5hv1PYcWmErEeDewKBgGEX
</span></span><span class=line><span class=cl>xgRIsTlFGrW2C2JXoSvakMCWD60eAH0W2PpDqlqqOFD8JA5UFK0roQkOjhLWSVu8
</span></span><span class=line><span class=cl>c6DLpWJQQlXHPqP702qIg/gx2o0bm4EzrCEJ4gYo6Ax+U7q6TOWhQpiBHnC0ojE8
</span></span><span class=line><span class=cl>kUoqMhfALpUaruTJ6zmj8IA1e1M6bMqVF8srlb/NAiBhwngxi+Cbie3YBogNzGJV
</span></span><span class=line><span class=cl>h10vAgw+i7cQqiiwEiPFNQJBAYXzr5r2KkHVjGcZNCLRAoXrzJjVhb7knZE5oEYo
</span></span><span class=line><span class=cl>nEI+h2gQSt1bavv3YVxhcisTVuNrlgQo58eGb4c9dtY2blMCQQIX2W9IbtJ26KzZ
</span></span><span class=line><span class=cl>C/5HPsVqgxWtuP5hN8OLf3ohhojr1NigJwc6o68dtKScaEQ5A33vmNpuWqKucecT
</span></span><span class=line><span class=cl>0HEVxuE5AiBhwngxi+Cbie3YBogNzGJVh10vAgw+i7cQqiiwEiPFNQIgYcJ4MYvg
</span></span><span class=line><span class=cl>m4nt2AaIDcxiVYddLwIMPou3EKoosBIjxTUCQQCnqbJMPEQHpg5lI6MQi8ixFRqo
</span></span><span class=line><span class=cl>+KwoBrwYfZlGEwZxdK2Ms0jgeta5jFFS11Fwk5+GyimnRzVcEbADJno/8BKe
</span></span><span class=line><span class=cl>-----END RSA PRIVATE KEY-----
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Unciphered data :
</span></span><span class=line><span class=cl>HEX : 0x000221cfb29883b06f409a679a58a4e97b446e28b244bbcd0687d178a8ab8722bf86da06a62e042c892d2921b336571e9ff7ac9d89ba90512bac4cfb8d7e4a3901bbccf5dfac01b27bddd35f1ca55344a75943df9a18eadb344cf7cf55fa0baa7005bfe32f41004854427b73316d706c335f5769336e3372735f34747434636b7d
</span></span><span class=line><span class=cl>INT <span class=o>(</span>big endian<span class=o>)</span> : <span class=m>1497194306832430076266314478305730170974165912795150306640063107539292495904192020114449824357438113183764256783752233913408135242464239912689425668318419718061442061010640167802145162377597484106658670422900749326253337728846324798012274989739031662527650589811318528908253458824763561374522387177140349821</span>
</span></span><span class=line><span class=cl>INT <span class=o>(</span>little endian<span class=o>)</span> : <span class=m>22546574266225300968123857704721191858671593287972919965619572675918636257464402082642870677657579044805501825719744981953609630743396909394906721219496019830622451770590549653716476856077849644487076110495020954617170743371827481017047908786316114794508942268154434710618690751442928771926238749045133355844096</span>
</span></span><span class=line><span class=cl>STR : b<span class=s1>&#39;\x00\x02!\xcf\xb2\x98\x83\xb0o@\x9ag\x9aX\xa4\xe9{Dn(\xb2D\xbb\xcd\x06\x87\xd1x\xa8\xab\x87&#34;\xbf\x86\xda\x06\xa6.\x04,\x89-)!\xb36W\x1e\x9f\xf7\xac\x9d\x89\xba\x90Q+\xacL\xfb\x8d~J9\x01\xbb\xcc\xf5\xdf\xac\x01\xb2{\xdd\xd3_\x1c\xa5SD\xa7YC\xdf\x9a\x18\xea\xdb4L\xf7\xcfU\xfa\x0b\xaap\x05\xbf\xe3/A\x00&lt;flag&gt;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PKCS#1.5 padding decoded!
</span></span><span class=line><span class=cl>HEX : &lt;flag-hex-encoded&gt;
</span></span><span class=line><span class=cl>INT <span class=o>(</span>big endian<span class=o>)</span> : 
</span></span><span class=line><span class=cl>&lt;flag-big-endian-encoded&gt;
</span></span><span class=line><span class=cl>INT <span class=o>(</span>little endian<span class=o>)</span> : 
</span></span><span class=line><span class=cl>&lt;flag-little-endian-encoded&gt;
</span></span><span class=line><span class=cl>utf-8 : &lt;flag&gt;
</span></span><span class=line><span class=cl>STR : b<span class=s1>&#39;\x00&lt;flag&gt;&#39;</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-cgu0osry2k<span class=o>]</span>─<span class=o>[</span>~/weak-rsa/RsaCtfTool<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>This time it <strong>works</strong>, and using the <strong>Wiener attack</strong> a matching <strong>private rsa key</strong> is <strong>found</strong>. <strong>Decrypting</strong> our <strong>flag</strong> goes pretty fast after that.</p><h2 id=clean-up><strong>CLEAN-UP</strong><a hidden class=anchor aria-hidden=true href=#clean-up>#</a></h2><p>Given that this was a <strong>challenge box</strong> without any <strong>instantiated targets</strong>, there is simply not much to clean up here. Once the <strong>flag</strong> is <strong>submitted</strong>, we move on to the <strong>next machine</strong>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bluewalle.github.io/tags/htb/>htb</a></li><li><a href=https://bluewalle.github.io/tags/walkthrough/>walkthrough</a></li><li><a href=https://bluewalle.github.io/tags/weak-rsa/>weak-rsa</a></li><li><a href=https://bluewalle.github.io/tags/difficulty-easy/>difficulty-easy</a></li><li><a href=https://bluewalle.github.io/tags/completed-challenge/>completed-challenge</a></li><li><a href=https://bluewalle.github.io/tags/retired/>retired</a></li><li><a href=https://bluewalle.github.io/tags/challenge-box/>challenge-box</a></li><li><a href=https://bluewalle.github.io/tags/weak-rsa-public-key/>weak-rsa-public-key</a></li><li><a href=https://bluewalle.github.io/tags/encrypted-flag/>encrypted-flag</a></li><li><a href=https://bluewalle.github.io/tags/rsactftool/>rsactftool</a></li><li><a href=https://bluewalle.github.io/tags/cracking-weak-rsa-public-key/>cracking-weak-rsa-public-key</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>