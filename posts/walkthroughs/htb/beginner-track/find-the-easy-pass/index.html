<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Find The Easy Pass - Walkthrough | Ee-Vah?</title><meta name=keywords content="htb,walkthrough,find-the-easy-pass,easy-box,retired,challenge-box,checksum,sha256sum,reverse-engineering,ghidra,ollydbg,completed-challenge"><meta name=description content="SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.
The aim of this walkthrough is to provide help with the Find The Easy Pass challenge on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges."><meta name=author content="bluewalle"><link rel=canonical href=https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/find-the-easy-pass/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bluewalle.github.io/main/img/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://bluewalle.github.io/main/img/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bluewalle.github.io/main/img/favicon-32x32.png><link rel=apple-touch-icon href=https://bluewalle.github.io/main/img/apple-touch-icon.png><link rel=mask-icon href=https://bluewalle.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB - Find The Easy Pass - Walkthrough"><meta property="og:description" content="SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.
The aim of this walkthrough is to provide help with the Find The Easy Pass challenge on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges."><meta property="og:type" content="article"><meta property="og:url" content="https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/find-the-easy-pass/"><meta property="og:image" content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-26T08:00:00+00:00"><meta property="article:modified_time" content="2023-05-26T08:00:00+00:00"><meta property="og:site_name" content="Just Keep Swimming"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HTB - Find The Easy Pass - Walkthrough"><meta name=twitter:description content="SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.
The aim of this walkthrough is to provide help with the Find The Easy Pass challenge on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bluewalle.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Find The Easy Pass - Walkthrough","item":"https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/find-the-easy-pass/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Find The Easy Pass - Walkthrough","name":"HTB - Find The Easy Pass - Walkthrough","description":"SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.\nThe aim of this walkthrough is to provide help with the Find The Easy Pass challenge on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.","keywords":["htb","walkthrough","find-the-easy-pass","easy-box","retired","challenge-box","checksum","sha256sum","reverse-engineering","ghidra","ollydbg","completed-challenge"],"articleBody":"SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.\nThe aim of this walkthrough is to provide help with the Find The Easy Pass challenge on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out with finishing the Beginner-Track challenges.\nPREPARATION After reading the challenge description\nFind the password (say PASS) and enter the flag in the form HTB{PASS} we set out and download the provided challenge files. There is only one this time: - Find The Easy Pass.zip -.\nOnce downloaded, we make sure to copy the provided sha256 checksum and use it for integrity check.\nOnce nice way to do this is to use the -c option with the sha256sum command.\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ ll total 208K -rw-r--r-- 1 htb-bluewalle htb-bluewalle 206K May 26 22:02 'Find The Easy Pass.zip' ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ echo \"0c48ca8a4a3ab2f73f76b0e6535c2feb510c1caf16b8bcc41c74b392c945e4db Find The Easy Pass.zip\" | sha256sum -c Find The Easy Pass.zip: OK ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ Looks like the file was not tampered with so we decompress it.\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ unzip -P hackthebox Find\\ The\\ Easy\\ Pass.zip Archive: Find The Easy Pass.zip inflating: EasyPass.exe ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ ll total 604K -rw-r--r-- 1 htb-bluewalle htb-bluewalle 393K Jul 3 2017 EasyPass.exe -rw-r--r-- 1 htb-bluewalle htb-bluewalle 206K May 26 22:02 'Find The Easy Pass.zip' ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ SEARCH-FOR-STRINGS After determining the file type as a 32-bit windows portable executable,\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ file EasyPass.exe EasyPass.exe: PE32 executable (GUI) Intel 80386, for MS Windows ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ we try and store all the printable strings in a separate file. This way, we can easily sort through them. For example, searching for all words starting with pass (case insensitive) does provide us with some ideas about where to look.\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ strings EasyPass.exe \u003e easypass_strings.txt ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ cat easypass_strings.txt | grep -i -n pass* 1960:PasswordChar 3795:Wrong Password! 5158:Enter Password 5171:Check Password ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ Looks like some login text. Let’s use vim and take a better look at the environment where those words are mentioned. Maybe we get lucky and the password is located near one of them.\nNo luck this time. Moreover, since the generated strings file alone contains more than 5000 entries,\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ wc -l easypass_strings.txt 5174 easypass_strings.txt ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ RUNNING-THE-EXECUTABLE it is time to take an other approach. How about simply running it (which could be very dangerous if it were a malware) and see what happens? But there is an other issue with this. Namely, running native windows 32-bit apps on linux (pwnbox - parrot os, debian based) does not work right out of the box.\nAfter doing some quick online research we end up with the wine tool. It comes already installed on the pwnbox, so all that’s left for us is to run it.\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ wine EasyPass.exe it looks like wine32 is missing, you should install it. multiarch needs to be enabled first. as root, please execute \"dpkg --add-architecture i386 \u0026\u0026 apt-get update \u0026\u0026 apt-get install wine32:i386\" wine: created the configuration directory '/home/htb-bluewalle/.wine' 0050:err:ole:StdMarshalImpl_MarshalInterface Failed to create ifstub, hr 0x80004002 0050:err:ole:CoMarshalInterface Failed to marshal the interface {6d5140c1-7436-11ce-8034-00aa006009fa}, hr 0x80004002 0050:err:ole:apartment_get_local_server_stream Failed: 0x80004002 0048:err:ole:StdMarshalImpl_MarshalInterface Failed to create ifstub, hr 0x80004002 0048:err:ole:CoMarshalInterface Failed to marshal the interface {6d5140c1-7436-11ce-8034-00aa006009fa}, hr 0x80004002 0048:err:ole:apartment_get_local_server_stream Failed: 0x80004002 0050:err:ole:start_rpcss Failed to open RpcSs service it looks like wine32 is missing, you should install it. multiarch needs to be enabled first. as root, please execute \"dpkg --add-architecture i386 \u0026\u0026 apt-get update \u0026\u0026 apt-get install wine32:i386\" wine: failed to open L\"C:\\\\windows\\\\syswow64\\\\rundll32.exe\": c0000135 wine: configuration in L\"/home/htb-bluewalle/.wine\" has been updated. it looks like wine32 is missing, you should install it. multiarch needs to be enabled first. as root, please execute \"dpkg --add-architecture i386 \u0026\u0026 apt-get update \u0026\u0026 apt-get install wine32:i386\" 00f8:err:module:load_wow64_ntdll failed to load L\"\\\\??\\\\C:\\\\windows\\\\syswow64\\\\ntdll.dll\" error c0000135 00f8:err:virtual:virtual_setup_exception stack overflow 1488 bytes in thread 00f8 addr 0x7f3288b160b0 stack 0x470a30 (0x470000-0x471000-0x56fd20) ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ It does not work, but we get some nice hints about the follow up instructions.\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ sudo dpkg --add-architecture i386 \u0026\u0026 sudo apt-get update \u0026\u0026 sudo apt-get install wine32:i386 Ign:1 https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 InRelease ... ... Reading state information... Done Some packages could not be installed. This may mean that you have requested an impossible situation or if you are using the unstable distribution that some required packages have not yet been created or been moved out of Incoming. The following information may help to resolve the situation: The following packages have unmet dependencies: wine32:i386 : Depends: libwine:i386 (= 5.0.3-3) but it is not going to be installed Recommends: wine:i386 (= 5.0.3-3) E: Unable to correct problems, you have held broken packages. ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ But sadly, nor does this one. Running them separately seems to be working.\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ sudo dpkg --add-architecture i386 ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ sudo apt-get update Hit:1 https://debian.neo4j.com stable InRelease Hit:2 https://repos.insights.digitalocean.com/apt/do-agent main InRelease Hit:3 https://download.docker.com/linux/debian bullseye InRelease Hit:4 https://packages.microsoft.com/debian/10/prod buster InRelease Ign:5 https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 InRelease Hit:6 https://deb.parrot.sh/parrot parrot InRelease Hit:7 https://deb.parrot.sh/direct/parrot parrot-security InRelease Hit:8 https://deb.parrot.sh/parrot parrot-backports InRelease Hit:9 https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 Release Reading package lists... Done ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ All that’s left now is to find a way to install the wine32 module. One quick (and dirty) fix we find online is the following:\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ sudo apt install -t parrot-backports wine32 Reading package lists... Done Building dependency tree... Done Reading state information... Done The following additional packages will be installed: gcc-11-base:i386 glib-networking:i386 gstreamer1.0-plugins-base:i386 ... ... Scanning application launchers Removing duplicate launchers or broken launchers Launchers are updated ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ Now, with everything (finally) prepared, it’s time to finally run it.\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ wine EasyPass.exe wine: could not load kernel32.dll, status c0000135 ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ Dang, not again… Well, just like before, looking up some fixes online provides us with the answer.\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ mv ../.wine/ ../.wine-old/ ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ Let’s try it again…\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ wine EasyPass.exe wine: created the configuration directory '/home/htb-bluewalle/.wine' 0048:err:ole:StdMarshalImpl_MarshalInterface Failed to create ifstub, hr 0x80004002 0048:err:ole:CoMarshalInterface Failed to marshal the interface {6d5140c1-7436-11ce-8034-00aa006009fa}, hr 0x80004002 0048:err:ole:apartment_get_local_server_stream Failed: 0x80004002 0050:err:ole:StdMarshalImpl_MarshalInterface Failed to create ifstub, hr 0x80004002 0050:err:ole:CoMarshalInterface Failed to marshal the interface {6d5140c1-7436-11ce-8034-00aa006009fa}, hr 0x80004002 0050:err:ole:apartment_get_local_server_stream Failed: 0x80004002 0050:err:ole:start_rpcss Failed to open RpcSs service wine: configuration in L\"/home/htb-bluewalle/.wine\" has been updated. Great, it appears to be working and we are provided with a password field. Trying out some default credentials all lead to the same error message: Wrong Password!.\nSTATIC-ANALYSIS Sadly, running the program did not really help us out. Maybe if we could understand how the program actually works… We set out with this new goal in mind to get some reverse engineering done.\nFiring up Ghidra (Applications -\u003e Reverse Engineering -\u003e Ghidra), agreeing to the conditions, creating a new project and importing our executable should get us a similar screen:\nClicking (left) two times on our executable should open it in the CodeBrowser. Once opened, we run the automatic analysis that pops-up.\nUsing Search -\u003e For Strings… and filtering for - Wrong Password! - results in only one match. Selecting it (double click on match) should move us to it’s place in the source code. Once there, we can follow the function reference to the decompiled version.\nOne way to solve this challenge would be to use static analysis on this source code and reverse engineer the final password from it. Clearly, the - uVar10 - variable holds the password and we would have to work from there step-by-step.\nvoid UndefinedFunction_00454050(uint *param_1,byte *param_2,byte *param_3) { ushort *puVar1; char *pcVar2; undefined4 uVar3; uint uVar4; byte bVar5; uint uVar6; int iVar7; undefined2 uVar8; uint unaff_EBX; int unaff_EBP; int iVar9; int unaff_ESI; undefined4 *in_FS_OFFSET; bool in_CF; byte in_AF; undefined uVar10; undefined4 uStack32; undefined *puStack28; int iStack24; uVar10 = (undefined4 *)(unaff_ESI + 1) == (undefined4 *)0x0; uVar8 = SUB42(param_2,0); out(*(undefined4 *)(unaff_ESI + 1),uVar8); iVar9 = unaff_EBP; if (!in_CF) { *param_1 = *param_1 ^ (uint)param_1; bVar5 = 9 \u003c ((byte)param_1 \u0026 0xf) | in_AF; uVar4 = (uint)(CONCAT11((char)((uint)param_1 \u003e\u003e 8) - bVar5,(byte)param_1 + bVar5 * -6) \u0026 0xff0f) ; uVar6 = (uint)param_1 \u0026 0xffff0000 | uVar4; iVar9 = unaff_EBP + 1; pcVar2 = (char *)(uVar6 + 0x5e004486); *pcVar2 = *pcVar2 + (char)(unaff_EBX \u003e\u003e 8); bVar5 = *param_3; *param_3 = *param_3 + (byte)param_3; puVar1 = (ushort *)(uVar6 + 0x30); *puVar1 = *puVar1 + (ushort)CARRY1(bVar5,(byte)param_3) * (((ushort)iVar9 \u0026 3) - (*puVar1 \u0026 3)); *param_2 = *param_2 ^ (byte)((uint)param_2 \u003e\u003e 8); out(*(undefined *)(unaff_ESI + 5),uVar8); bVar5 = in(uVar8); unaff_EBX = (uint)param_1 \u0026 0xffff0000 | uVar4 \u0026 0xffffff00 | (uint)bVar5; iVar7 = 5; do { iVar7 = iVar7 + -1; } while (iVar7 != 0); uVar10 = 1; puStack28 = \u0026DAT_00454171; uStack32 = *in_FS_OFFSET; *in_FS_OFFSET = \u0026uStack32; iStack24 = iVar9; FUN_004042b4((int *)(unaff_EBP + -7),(int)\u0026DAT_00454188); FUN_004042b4((int *)(unaff_EBP + -0xb),(int)\u0026DAT_00454194); FUN_004042b4((int *)(unaff_EBP + -0xf),(int)\u0026DAT_004541a0); FUN_004042b4((int *)(unaff_EBP + -0x13),(int)\u0026DAT_004541ac); } FUN_004042b4((int *)(iVar9 + -0x18),(int)\u0026DAT_004541a0); FUN_004042b4((int *)(iVar9 + -0x1c),(int)\u0026DAT_004541b8); FUN_004042b4((int *)(iVar9 + -0x20),(int)\u0026DAT_004541c4); FUN_004042b4((int *)(iVar9 + -0x24),(int)\u0026DAT_004541d0); uVar3 = *(undefined4 *)(iVar9 + -0x24); FUN_0040459c((int **)(iVar9 + -4),8); FUN_00433110(*(int *)(unaff_EBX + 0x2f8),(int *)(iVar9 + -0x28)); FUN_00404628(*(uint **)(iVar9 + -0x28),*(uint **)(iVar9 + -4)); if ((bool)uVar10) { FUN_00427a30((uint *)\"Good Job. Congratulations\"); } else { FUN_00427a30((uint *)\"Wrong Password!\"); } *in_FS_OFFSET = uVar3; FUN_0040421c((int *)(iVar9 + -0x28)); FUN_00404240((int *)(iVar9 + -0x24),9); return; } DYNAMIC-ANALYSIS Such an analysis would be quite a hurdle and require more time, therefore, we go with dynamic analysis instead.\nInstalling ollydbg happens to be both easy and quick.\n┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ sudo apt install ollydbg Reading package lists... Done Building dependency tree... Done Reading state information... Done The following NEW packages will be installed: ollydbg 0 upgraded, 1 newly installed, 0 to remove and 25 not upgraded. Need to get 1,115 kB of archives. After this operation, 2,622 kB of additional disk space will be used. Get:1 https://deb.parrot.sh/parrot parrot/main amd64 ollydbg all 1.10-1parrot2 [1,115 kB] Fetched 1,115 kB in 0s (2,832 kB/s) Selecting previously unselected package ollydbg. (Reading database ... 508345 files and directories currently installed.) Preparing to unpack .../ollydbg_1.10-1parrot2_all.deb ... Unpacking ollydbg (1.10-1parrot2) ... Setting up ollydbg (1.10-1parrot2) ... Scanning application launchers Removing duplicate launchers or broken launchers Launchers are updated ┌─[eu-dedivip-2]─[10.10.14.25]─[htb-bluewalle@htb-xh9th8t7hj]─[~/find-the-easy-pass] └──╼ [★]$ Running - ollydbg EasyPass.exe and\nchoosing View -\u003e Executable modules -\u003e EasyPass should change our left-top window.\nLet’s search for the - Wrong Password! - string. (Right click in top-left window) -\u003e Search for -\u003e All referenced text strings -\u003e (Right click in new window) -\u003e Search for text -\u003e “Wrong Password!” -\u003e (Right click on match) -\u003e Follow in Disassembler.\nNow that we found our place in the source code, let’s set a breakpoint here and run the executable.\nChoosing — (Right click on - Wrong Password! - match in top-left window) -\u003e Breakpoint -\u003e Toggle — should set the breakpoint. Starting our program is then done by clicking the play button.\nBut considering the breakpoint we just set, the execution will only continue till before the point where - Wrong Password! - get’s displayed. Then it would stop.\nWe start it and wait until the execution halts. Then we head over to the bottom-right window since this is where the data which surrounds our test input/password is displayed. Maybe the real password is stored nearby?\nThe only other ASCII field other than our test input in our close environment contains the - - string.\nVERIFICATION Could this be the password? Running - EasyPass.exe - with wine and inputting the found password - confirms it. We have our winner!\nGiven that this was a challenge box without any instantiated targets, there is simply not much to clean up here. Once we submit the password as - HTB{} - we move on to the next machine.\n","wordCount":"1962","inLanguage":"en","datePublished":"2023-05-26T08:00:00Z","dateModified":"2023-05-26T08:00:00Z","author":{"@type":"Person","name":"bluewalle"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/find-the-easy-pass/"},"publisher":{"@type":"Organization","name":"Ee-Vah?","logo":{"@type":"ImageObject","url":"https://bluewalle.github.io/main/img/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bluewalle.github.io/ accesskey=h title="Just Keep Swimming (Alt + H)"><img src=https://bluewalle.github.io/apple-touch-icon.png alt aria-label=logo height=35>Just Keep Swimming</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bluewalle.github.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://bluewalle.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bluewalle.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://bluewalle.github.io/about title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bluewalle.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bluewalle.github.io/posts/>Posts</a></div><h1 class=post-title>HTB - Find The Easy Pass - Walkthrough</h1><div class=post-meta><span title='2023-05-26 08:00:00 +0000 +0000'>May, 2023</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;1962 words&nbsp;·&nbsp;bluewalle</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#synopsis><strong>SYNOPSIS</strong></a></li><li><a href=#preparation><strong>PREPARATION</strong></a></li><li><a href=#search-for-strings><strong>SEARCH-FOR-STRINGS</strong></a></li><li><a href=#running-the-executable><strong>RUNNING-THE-EXECUTABLE</strong></a></li><li><a href=#static-analysis><strong>STATIC-ANALYSIS</strong></a></li><li><a href=#dynamic-analysis><strong>DYNAMIC-ANALYSIS</strong></a></li><li><a href=#verification><strong>VERIFICATION</strong></a></li></ul></nav></div></details></div><div class=post-content><h2 id=synopsis><strong>SYNOPSIS</strong><a hidden class=anchor aria-hidden=true href=#synopsis>#</a></h2><p>Outlining the <strong>attack path</strong> demonstrated in this <strong>writeup</strong> is much easier through a picture rather than a description, since <strong>a picture is worth a thousand words</strong>.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/attack-path_ftep.png alt="Attack Path - Find The Easy Pass" title="Attack Path -  Find The Easy Pass"></p><p>The aim of this walkthrough is to provide help with the <a href=https://app.hackthebox.com/challenges/5 title="Find The Easy Pass">Find The Easy Pass</a> challenge on the <a href=https://hackthebox.com title="Hack The Box website">Hack The Box website</a>. Please <strong>note</strong> that no <strong>flags</strong> are directly provided here. Moreover, <strong>be aware</strong> that this is only <strong>one</strong> of the <strong>many</strong> ways to solve the challenges.</p><p>It belongs to a series of tutorials that aim to help out with finishing the <a href=https://app.hackthebox.com/tracks/Beginner-Track title=Beginner-Track>Beginner-Track</a> challenges.</p><h2 id=preparation><strong>PREPARATION</strong><a hidden class=anchor aria-hidden=true href=#preparation>#</a></h2><p>After reading the <strong>challenge description</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Find the password (say PASS) and enter the flag in the form HTB{PASS}
</span></span></code></pre></div><p>we set out and <strong>download</strong> the provided <strong>challenge files</strong>. There is only one this time: - <em>Find The Easy Pass.zip</em> -.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/source-files.png alt=source-files title=source-files></p><p>Once downloaded, we make sure to <strong>copy</strong> the provided <strong>sha256</strong> <strong>checksum</strong> and use it for <strong>integrity check</strong>.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/source-files-hash.png alt=source-files-hash title=source-files-hash></p><p>Once nice way to do this is to use the <em><strong>-c</strong></em> option with the <em><strong>sha256sum</strong></em> command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ll
</span></span><span class=line><span class=cl>total 208K
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle 206K May <span class=m>26</span> 22:02 <span class=s1>&#39;Find The Easy Pass.zip&#39;</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ <span class=nb>echo</span> <span class=s2>&#34;0c48ca8a4a3ab2f73f76b0e6535c2feb510c1caf16b8bcc41c74b392c945e4db  Find The Easy Pass.zip&#34;</span> <span class=p>|</span> sha256sum -c
</span></span><span class=line><span class=cl>Find The Easy Pass.zip: OK
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Looks like the file was <strong>not tampered with</strong> so we <strong>decompress</strong> it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ unzip -P hackthebox Find<span class=se>\ </span>The<span class=se>\ </span>Easy<span class=se>\ </span>Pass.zip
</span></span><span class=line><span class=cl>Archive:  Find The Easy Pass.zip
</span></span><span class=line><span class=cl>  inflating: EasyPass.exe            
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ll
</span></span><span class=line><span class=cl>total 604K
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle 393K Jul  <span class=m>3</span>  <span class=m>2017</span>  EasyPass.exe
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle 206K May <span class=m>26</span> 22:02 <span class=s1>&#39;Find The Easy Pass.zip&#39;</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><h2 id=search-for-strings><strong>SEARCH-FOR-STRINGS</strong><a hidden class=anchor aria-hidden=true href=#search-for-strings>#</a></h2><p>After <strong>determining</strong> the file type as a <strong>32-bit windows portable executable</strong>,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ file EasyPass.exe 
</span></span><span class=line><span class=cl>EasyPass.exe: PE32 executable <span class=o>(</span>GUI<span class=o>)</span> Intel 80386, <span class=k>for</span> MS Windows
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ 
</span></span></code></pre></div><p>we try and <strong>store</strong> all the <strong>printable strings</strong> in a separate file. This way, we can easily sort through them. For example, searching for all words starting with <em>pass</em> (case insensitive) does provide us with some ideas about where to look.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ strings EasyPass.exe &gt; easypass_strings.txt
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat easypass_strings.txt <span class=p>|</span> grep -i -n pass*
</span></span><span class=line><span class=cl>1960:PasswordChar
</span></span><span class=line><span class=cl>3795:Wrong Password!
</span></span><span class=line><span class=cl>5158:Enter Password
</span></span><span class=line><span class=cl>5171:Check Password
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Looks like some login text. Let&rsquo;s use <em><strong>vim</strong></em> and take a better look at the <strong>environment</strong> where those words are mentioned. Maybe we get lucky and the password is located near one of them.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/strings-vim.png alt=strings-vim title=strings-vim></p><p>No luck this time. Moreover, since the <strong>generated</strong> strings file alone contains more than 5000 entries,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ wc -l easypass_strings.txt 
</span></span><span class=line><span class=cl><span class=m>5174</span> easypass_strings.txt
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><h2 id=running-the-executable><strong>RUNNING-THE-EXECUTABLE</strong><a hidden class=anchor aria-hidden=true href=#running-the-executable>#</a></h2><p>it is time to take an <strong>other approach</strong>. How about simply <strong>running it</strong> (which could be very dangerous if it were a malware) and see what happens? But there is an other <strong>issue</strong> with this. Namely, running <strong>native windows 32-bit</strong> apps on <strong>linux</strong> (pwnbox - parrot os, debian based) does not work right out of the box.</p><p>After doing some quick online research we end up with the <em><strong>wine</strong></em> tool. It comes already <strong>installed</strong> on the <strong>pwnbox</strong>, so all that&rsquo;s left for us is to <strong>run it</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ wine EasyPass.exe 
</span></span><span class=line><span class=cl>it looks like wine32 is missing, you should install it.
</span></span><span class=line><span class=cl>multiarch needs to be enabled first.  as root, please
</span></span><span class=line><span class=cl>execute <span class=s2>&#34;dpkg --add-architecture i386 &amp;&amp; apt-get update &amp;&amp;
</span></span></span><span class=line><span class=cl><span class=s2>apt-get install wine32:i386&#34;</span>
</span></span><span class=line><span class=cl>wine: created the configuration directory <span class=s1>&#39;/home/htb-bluewalle/.wine&#39;</span>
</span></span><span class=line><span class=cl>0050:err:ole:StdMarshalImpl_MarshalInterface Failed to create ifstub, hr 0x80004002
</span></span><span class=line><span class=cl>0050:err:ole:CoMarshalInterface Failed to marshal the interface <span class=o>{</span>6d5140c1-7436-11ce-8034-00aa006009fa<span class=o>}</span>, hr 0x80004002
</span></span><span class=line><span class=cl>0050:err:ole:apartment_get_local_server_stream Failed: 0x80004002
</span></span><span class=line><span class=cl>0048:err:ole:StdMarshalImpl_MarshalInterface Failed to create ifstub, hr 0x80004002
</span></span><span class=line><span class=cl>0048:err:ole:CoMarshalInterface Failed to marshal the interface <span class=o>{</span>6d5140c1-7436-11ce-8034-00aa006009fa<span class=o>}</span>, hr 0x80004002
</span></span><span class=line><span class=cl>0048:err:ole:apartment_get_local_server_stream Failed: 0x80004002
</span></span><span class=line><span class=cl>0050:err:ole:start_rpcss Failed to open RpcSs service
</span></span><span class=line><span class=cl>it looks like wine32 is missing, you should install it.
</span></span><span class=line><span class=cl>multiarch needs to be enabled first.  as root, please
</span></span><span class=line><span class=cl>execute <span class=s2>&#34;dpkg --add-architecture i386 &amp;&amp; apt-get update &amp;&amp;
</span></span></span><span class=line><span class=cl><span class=s2>apt-get install wine32:i386&#34;</span>
</span></span><span class=line><span class=cl>wine: failed to open L<span class=s2>&#34;C:\\windows\\syswow64\\rundll32.exe&#34;</span>: c0000135
</span></span><span class=line><span class=cl>wine: configuration in L<span class=s2>&#34;/home/htb-bluewalle/.wine&#34;</span> has been updated.
</span></span><span class=line><span class=cl>it looks like wine32 is missing, you should install it.
</span></span><span class=line><span class=cl>multiarch needs to be enabled first.  as root, please
</span></span><span class=line><span class=cl>execute <span class=s2>&#34;dpkg --add-architecture i386 &amp;&amp; apt-get update &amp;&amp;
</span></span></span><span class=line><span class=cl><span class=s2>apt-get install wine32:i386&#34;</span>
</span></span><span class=line><span class=cl>00f8:err:module:load_wow64_ntdll failed to load L<span class=s2>&#34;\\??\\C:\\windows\\syswow64\\ntdll.dll&#34;</span> error c0000135
</span></span><span class=line><span class=cl>00f8:err:virtual:virtual_setup_exception stack overflow <span class=m>1488</span> bytes in thread 00f8 addr 0x7f3288b160b0 stack 0x470a30 <span class=o>(</span>0x470000-0x471000-0x56fd20<span class=o>)</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>It does not work, but we get some nice <strong>hints</strong> about the follow up instructions.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ sudo dpkg --add-architecture i386 <span class=o>&amp;&amp;</span> sudo apt-get update <span class=o>&amp;&amp;</span> sudo apt-get install wine32:i386
</span></span><span class=line><span class=cl>Ign:1 https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 InRelease
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Reading state information... Done
</span></span><span class=line><span class=cl>Some packages could not be installed. This may mean that you have
</span></span><span class=line><span class=cl>requested an impossible situation or <span class=k>if</span> you are using the unstable
</span></span><span class=line><span class=cl>distribution that some required packages have not yet been created
</span></span><span class=line><span class=cl>or been moved out of Incoming.
</span></span><span class=line><span class=cl>The following information may <span class=nb>help</span> to resolve the situation:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The following packages have unmet dependencies:
</span></span><span class=line><span class=cl> wine32:i386 : Depends: libwine:i386 <span class=o>(=</span> 5.0.3-3<span class=o>)</span> but it is not going to be installed
</span></span><span class=line><span class=cl>               Recommends: wine:i386 <span class=o>(=</span> 5.0.3-3<span class=o>)</span>
</span></span><span class=line><span class=cl>E: Unable to correct problems, you have held broken packages.
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>But sadly, nor does this one. Running them separately seems to be working.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ sudo dpkg --add-architecture i386
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ sudo apt-get update 
</span></span><span class=line><span class=cl>Hit:1 https://debian.neo4j.com stable InRelease
</span></span><span class=line><span class=cl>Hit:2 https://repos.insights.digitalocean.com/apt/do-agent main InRelease                    
</span></span><span class=line><span class=cl>Hit:3 https://download.docker.com/linux/debian bullseye InRelease                            
</span></span><span class=line><span class=cl>Hit:4 https://packages.microsoft.com/debian/10/prod buster InRelease                         
</span></span><span class=line><span class=cl>Ign:5 https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 InRelease                    
</span></span><span class=line><span class=cl>Hit:6 https://deb.parrot.sh/parrot parrot InRelease   
</span></span><span class=line><span class=cl>Hit:7 https://deb.parrot.sh/direct/parrot parrot-security InRelease
</span></span><span class=line><span class=cl>Hit:8 https://deb.parrot.sh/parrot parrot-backports InRelease
</span></span><span class=line><span class=cl>Hit:9 https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 Release
</span></span><span class=line><span class=cl>Reading package lists... Done
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>All that&rsquo;s left now is to find a way to <strong>install</strong> the <em>wine32</em> module. One quick (and dirty) fix we find online is the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ sudo apt install -t parrot-backports wine32
</span></span><span class=line><span class=cl>Reading package lists... Done
</span></span><span class=line><span class=cl>Building dependency tree... Done
</span></span><span class=line><span class=cl>Reading state information... Done
</span></span><span class=line><span class=cl>The following additional packages will be installed:
</span></span><span class=line><span class=cl>  gcc-11-base:i386 glib-networking:i386 gstreamer1.0-plugins-base:i386
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Scanning application launchers
</span></span><span class=line><span class=cl>Removing duplicate launchers or broken launchers
</span></span><span class=line><span class=cl>Launchers are updated
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Now, with everything (finally) prepared, it&rsquo;s time to finally <strong>run</strong> it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ wine EasyPass.exe 
</span></span><span class=line><span class=cl>wine: could not load kernel32.dll, status c0000135
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Dang, not again&mldr; Well, just like before, looking up some <strong>fixes</strong> online provides us with the answer.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ mv ../.wine/ ../.wine-old/
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Let&rsquo;s try it again&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ wine EasyPass.exe 
</span></span><span class=line><span class=cl>wine: created the configuration directory <span class=s1>&#39;/home/htb-bluewalle/.wine&#39;</span>
</span></span><span class=line><span class=cl>0048:err:ole:StdMarshalImpl_MarshalInterface Failed to create ifstub, hr 0x80004002
</span></span><span class=line><span class=cl>0048:err:ole:CoMarshalInterface Failed to marshal the interface <span class=o>{</span>6d5140c1-7436-11ce-8034-00aa006009fa<span class=o>}</span>, hr 0x80004002
</span></span><span class=line><span class=cl>0048:err:ole:apartment_get_local_server_stream Failed: 0x80004002
</span></span><span class=line><span class=cl>0050:err:ole:StdMarshalImpl_MarshalInterface Failed to create ifstub, hr 0x80004002
</span></span><span class=line><span class=cl>0050:err:ole:CoMarshalInterface Failed to marshal the interface <span class=o>{</span>6d5140c1-7436-11ce-8034-00aa006009fa<span class=o>}</span>, hr 0x80004002
</span></span><span class=line><span class=cl>0050:err:ole:apartment_get_local_server_stream Failed: 0x80004002
</span></span><span class=line><span class=cl>0050:err:ole:start_rpcss Failed to open RpcSs service
</span></span><span class=line><span class=cl>wine: configuration in L<span class=s2>&#34;/home/htb-bluewalle/.wine&#34;</span> has been updated.
</span></span></code></pre></div><p>Great, it appears to be working and we are provided with a <strong>password field</strong>. Trying out some <strong>default credentials</strong> all lead to the same <strong>error message</strong>: <em>Wrong Password!</em>.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/wine-run.png alt=wine-run title=wine-run></p><h2 id=static-analysis><strong>STATIC-ANALYSIS</strong><a hidden class=anchor aria-hidden=true href=#static-analysis>#</a></h2><p>Sadly, running the program did not really help us out. Maybe if we could understand how the program actually works&mldr; We set out with this new goal in mind to get some <strong>reverse engineering</strong> done.</p><p>Firing up <em><strong>Ghidra</strong></em> (<em>Applications</em> -> <em>Reverse Engineering</em> -> <em>Ghidra</em>), agreeing to the conditions, <strong>creating</strong> a new <strong>project</strong> and <strong>importing</strong> our <strong>executable</strong> should get us a similar screen:</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/ghidra.png alt=ghidra title=ghidra></p><p>Clicking (left) two times on our <strong>executable</strong> should open it in the <strong>CodeBrowser</strong>. Once opened, we run the <strong>automatic analysis</strong> that pops-up.</p><p>Using <em>Search</em> -> <em>For Strings&mldr;</em> and <strong>filtering</strong> for - <em>Wrong Password!</em> - results in only one match. <strong>Selecting</strong> it (double click on match) should move us to it&rsquo;s place in the <strong>source code</strong>. Once there, we can follow the function <strong>reference</strong> to the <strong>decompiled</strong> version.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/ghidra-reference.png alt=ghidra-reference title=ghidra-reference></p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/ghidra-decompiled.png alt=ghidra-decompiled title=ghidra-decompiled></p><p>One way to solve this <strong>challenge</strong> would be to use <strong>static analysis</strong> on this <strong>source code</strong> and reverse engineer the final password from it. Clearly, the - <em>uVar10</em> - variable holds the <strong>password</strong> and we would have to work from there <strong>step-by-step</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>void</span> <span class=nf>UndefinedFunction_00454050</span><span class=p>(</span><span class=n>uint</span> <span class=o>*</span><span class=n>param_1</span><span class=p>,</span><span class=n>byte</span> <span class=o>*</span><span class=n>param_2</span><span class=p>,</span><span class=n>byte</span> <span class=o>*</span><span class=n>param_3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>ushort</span> <span class=o>*</span><span class=n>puVar1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=o>*</span><span class=n>pcVar2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined4</span> <span class=n>uVar3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>uint</span> <span class=n>uVar4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>byte</span> <span class=n>bVar5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>uint</span> <span class=n>uVar6</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>iVar7</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined2</span> <span class=n>uVar8</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>uint</span> <span class=n>unaff_EBX</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>unaff_EBP</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>iVar9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>unaff_ESI</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined4</span> <span class=o>*</span><span class=n>in_FS_OFFSET</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>bool</span> <span class=n>in_CF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>byte</span> <span class=n>in_AF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined</span> <span class=n>uVar10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined4</span> <span class=n>uStack32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>undefined</span> <span class=o>*</span><span class=n>puStack28</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>iStack24</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>uVar10</span> <span class=o>=</span> <span class=p>(</span><span class=n>undefined4</span> <span class=o>*</span><span class=p>)(</span><span class=n>unaff_ESI</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>==</span> <span class=p>(</span><span class=n>undefined4</span> <span class=o>*</span><span class=p>)</span><span class=mh>0x0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>uVar8</span> <span class=o>=</span> <span class=nf>SUB42</span><span class=p>(</span><span class=n>param_2</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>out</span><span class=p>(</span><span class=o>*</span><span class=p>(</span><span class=n>undefined4</span> <span class=o>*</span><span class=p>)(</span><span class=n>unaff_ESI</span> <span class=o>+</span> <span class=mi>1</span><span class=p>),</span><span class=n>uVar8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>iVar9</span> <span class=o>=</span> <span class=n>unaff_EBP</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>in_CF</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>param_1</span> <span class=o>=</span> <span class=o>*</span><span class=n>param_1</span> <span class=o>^</span> <span class=p>(</span><span class=n>uint</span><span class=p>)</span><span class=n>param_1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>bVar5</span> <span class=o>=</span> <span class=mi>9</span> <span class=o>&lt;</span> <span class=p>((</span><span class=n>byte</span><span class=p>)</span><span class=n>param_1</span> <span class=o>&amp;</span> <span class=mh>0xf</span><span class=p>)</span> <span class=o>|</span> <span class=n>in_AF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>uVar4</span> <span class=o>=</span> <span class=p>(</span><span class=n>uint</span><span class=p>)(</span><span class=nf>CONCAT11</span><span class=p>((</span><span class=kt>char</span><span class=p>)((</span><span class=n>uint</span><span class=p>)</span><span class=n>param_1</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>-</span> <span class=n>bVar5</span><span class=p>,(</span><span class=n>byte</span><span class=p>)</span><span class=n>param_1</span> <span class=o>+</span> <span class=n>bVar5</span> <span class=o>*</span> <span class=o>-</span><span class=mi>6</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xff0f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>uVar6</span> <span class=o>=</span> <span class=p>(</span><span class=n>uint</span><span class=p>)</span><span class=n>param_1</span> <span class=o>&amp;</span> <span class=mh>0xffff0000</span> <span class=o>|</span> <span class=n>uVar4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>iVar9</span> <span class=o>=</span> <span class=n>unaff_EBP</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>pcVar2</span> <span class=o>=</span> <span class=p>(</span><span class=kt>char</span> <span class=o>*</span><span class=p>)(</span><span class=n>uVar6</span> <span class=o>+</span> <span class=mh>0x5e004486</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>pcVar2</span> <span class=o>=</span> <span class=o>*</span><span class=n>pcVar2</span> <span class=o>+</span> <span class=p>(</span><span class=kt>char</span><span class=p>)(</span><span class=n>unaff_EBX</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>bVar5</span> <span class=o>=</span> <span class=o>*</span><span class=n>param_3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>param_3</span> <span class=o>=</span> <span class=o>*</span><span class=n>param_3</span> <span class=o>+</span> <span class=p>(</span><span class=n>byte</span><span class=p>)</span><span class=n>param_3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>puVar1</span> <span class=o>=</span> <span class=p>(</span><span class=n>ushort</span> <span class=o>*</span><span class=p>)(</span><span class=n>uVar6</span> <span class=o>+</span> <span class=mh>0x30</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>puVar1</span> <span class=o>=</span> <span class=o>*</span><span class=n>puVar1</span> <span class=o>+</span> <span class=p>(</span><span class=n>ushort</span><span class=p>)</span><span class=nf>CARRY1</span><span class=p>(</span><span class=n>bVar5</span><span class=p>,(</span><span class=n>byte</span><span class=p>)</span><span class=n>param_3</span><span class=p>)</span> <span class=o>*</span> <span class=p>(((</span><span class=n>ushort</span><span class=p>)</span><span class=n>iVar9</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>)</span> <span class=o>-</span> <span class=p>(</span><span class=o>*</span><span class=n>puVar1</span> <span class=o>&amp;</span> <span class=mi>3</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>param_2</span> <span class=o>=</span> <span class=o>*</span><span class=n>param_2</span> <span class=o>^</span> <span class=p>(</span><span class=n>byte</span><span class=p>)((</span><span class=n>uint</span><span class=p>)</span><span class=n>param_2</span> <span class=o>&gt;&gt;</span> <span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>out</span><span class=p>(</span><span class=o>*</span><span class=p>(</span><span class=n>undefined</span> <span class=o>*</span><span class=p>)(</span><span class=n>unaff_ESI</span> <span class=o>+</span> <span class=mi>5</span><span class=p>),</span><span class=n>uVar8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>bVar5</span> <span class=o>=</span> <span class=nf>in</span><span class=p>(</span><span class=n>uVar8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>unaff_EBX</span> <span class=o>=</span> <span class=p>(</span><span class=n>uint</span><span class=p>)</span><span class=n>param_1</span> <span class=o>&amp;</span> <span class=mh>0xffff0000</span> <span class=o>|</span> <span class=n>uVar4</span> <span class=o>&amp;</span> <span class=mh>0xffffff00</span> <span class=o>|</span> <span class=p>(</span><span class=n>uint</span><span class=p>)</span><span class=n>bVar5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>iVar7</span> <span class=o>=</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>iVar7</span> <span class=o>=</span> <span class=n>iVar7</span> <span class=o>+</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>while</span> <span class=p>(</span><span class=n>iVar7</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>uVar10</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>puStack28</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>DAT_00454171</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>uStack32</span> <span class=o>=</span> <span class=o>*</span><span class=n>in_FS_OFFSET</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>in_FS_OFFSET</span> <span class=o>=</span> <span class=o>&amp;</span><span class=n>uStack32</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>iStack24</span> <span class=o>=</span> <span class=n>iVar9</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nf>FUN_004042b4</span><span class=p>((</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>unaff_EBP</span> <span class=o>+</span> <span class=o>-</span><span class=mi>7</span><span class=p>),(</span><span class=kt>int</span><span class=p>)</span><span class=o>&amp;</span><span class=n>DAT_00454188</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>FUN_004042b4</span><span class=p>((</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>unaff_EBP</span> <span class=o>+</span> <span class=o>-</span><span class=mh>0xb</span><span class=p>),(</span><span class=kt>int</span><span class=p>)</span><span class=o>&amp;</span><span class=n>DAT_00454194</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>FUN_004042b4</span><span class=p>((</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>unaff_EBP</span> <span class=o>+</span> <span class=o>-</span><span class=mh>0xf</span><span class=p>),(</span><span class=kt>int</span><span class=p>)</span><span class=o>&amp;</span><span class=n>DAT_004541a0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>FUN_004042b4</span><span class=p>((</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>unaff_EBP</span> <span class=o>+</span> <span class=o>-</span><span class=mh>0x13</span><span class=p>),(</span><span class=kt>int</span><span class=p>)</span><span class=o>&amp;</span><span class=n>DAT_004541ac</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nf>FUN_004042b4</span><span class=p>((</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>iVar9</span> <span class=o>+</span> <span class=o>-</span><span class=mh>0x18</span><span class=p>),(</span><span class=kt>int</span><span class=p>)</span><span class=o>&amp;</span><span class=n>DAT_004541a0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>FUN_004042b4</span><span class=p>((</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>iVar9</span> <span class=o>+</span> <span class=o>-</span><span class=mh>0x1c</span><span class=p>),(</span><span class=kt>int</span><span class=p>)</span><span class=o>&amp;</span><span class=n>DAT_004541b8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>FUN_004042b4</span><span class=p>((</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>iVar9</span> <span class=o>+</span> <span class=o>-</span><span class=mh>0x20</span><span class=p>),(</span><span class=kt>int</span><span class=p>)</span><span class=o>&amp;</span><span class=n>DAT_004541c4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>FUN_004042b4</span><span class=p>((</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>iVar9</span> <span class=o>+</span> <span class=o>-</span><span class=mh>0x24</span><span class=p>),(</span><span class=kt>int</span><span class=p>)</span><span class=o>&amp;</span><span class=n>DAT_004541d0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>uVar3</span> <span class=o>=</span> <span class=o>*</span><span class=p>(</span><span class=n>undefined4</span> <span class=o>*</span><span class=p>)(</span><span class=n>iVar9</span> <span class=o>+</span> <span class=o>-</span><span class=mh>0x24</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>FUN_0040459c</span><span class=p>((</span><span class=kt>int</span> <span class=o>**</span><span class=p>)(</span><span class=n>iVar9</span> <span class=o>+</span> <span class=o>-</span><span class=mi>4</span><span class=p>),</span><span class=mi>8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>FUN_00433110</span><span class=p>(</span><span class=o>*</span><span class=p>(</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>unaff_EBX</span> <span class=o>+</span> <span class=mh>0x2f8</span><span class=p>),(</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>iVar9</span> <span class=o>+</span> <span class=o>-</span><span class=mh>0x28</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=nf>FUN_00404628</span><span class=p>(</span><span class=o>*</span><span class=p>(</span><span class=n>uint</span> <span class=o>**</span><span class=p>)(</span><span class=n>iVar9</span> <span class=o>+</span> <span class=o>-</span><span class=mh>0x28</span><span class=p>),</span><span class=o>*</span><span class=p>(</span><span class=n>uint</span> <span class=o>**</span><span class=p>)(</span><span class=n>iVar9</span> <span class=o>+</span> <span class=o>-</span><span class=mi>4</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>((</span><span class=kt>bool</span><span class=p>)</span><span class=n>uVar10</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>FUN_00427a30</span><span class=p>((</span><span class=n>uint</span> <span class=o>*</span><span class=p>)</span><span class=s>&#34;Good Job. Congratulations&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>FUN_00427a30</span><span class=p>((</span><span class=n>uint</span> <span class=o>*</span><span class=p>)</span><span class=s>&#34;Wrong Password!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span><span class=n>in_FS_OFFSET</span> <span class=o>=</span> <span class=n>uVar3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nf>FUN_0040421c</span><span class=p>((</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>iVar9</span> <span class=o>+</span> <span class=o>-</span><span class=mh>0x28</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=nf>FUN_00404240</span><span class=p>((</span><span class=kt>int</span> <span class=o>*</span><span class=p>)(</span><span class=n>iVar9</span> <span class=o>+</span> <span class=o>-</span><span class=mh>0x24</span><span class=p>),</span><span class=mi>9</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=dynamic-analysis><strong>DYNAMIC-ANALYSIS</strong><a hidden class=anchor aria-hidden=true href=#dynamic-analysis>#</a></h2><p>Such an <strong>analysis</strong> would be quite a hurdle and require more time, therefore, we go with <strong>dynamic analysis</strong> instead.</p><p>Installing <em><strong>ollydbg</strong></em> happens to be both easy and quick.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ sudo apt install ollydbg
</span></span><span class=line><span class=cl>Reading package lists... Done
</span></span><span class=line><span class=cl>Building dependency tree... Done
</span></span><span class=line><span class=cl>Reading state information... Done
</span></span><span class=line><span class=cl>The following NEW packages will be installed:
</span></span><span class=line><span class=cl>  ollydbg
</span></span><span class=line><span class=cl><span class=m>0</span> upgraded, <span class=m>1</span> newly installed, <span class=m>0</span> to remove and <span class=m>25</span> not upgraded.
</span></span><span class=line><span class=cl>Need to get 1,115 kB of archives.
</span></span><span class=line><span class=cl>After this operation, 2,622 kB of additional disk space will be used.
</span></span><span class=line><span class=cl>Get:1 https://deb.parrot.sh/parrot parrot/main amd64 ollydbg all 1.10-1parrot2 <span class=o>[</span>1,115 kB<span class=o>]</span>
</span></span><span class=line><span class=cl>Fetched 1,115 kB in 0s <span class=o>(</span>2,832 kB/s<span class=o>)</span>
</span></span><span class=line><span class=cl>Selecting previously unselected package ollydbg.
</span></span><span class=line><span class=cl><span class=o>(</span>Reading database ... <span class=m>508345</span> files and directories currently installed.<span class=o>)</span>
</span></span><span class=line><span class=cl>Preparing to unpack .../ollydbg_1.10-1parrot2_all.deb ...
</span></span><span class=line><span class=cl>Unpacking ollydbg <span class=o>(</span>1.10-1parrot2<span class=o>)</span> ...
</span></span><span class=line><span class=cl>Setting up ollydbg <span class=o>(</span>1.10-1parrot2<span class=o>)</span> ...
</span></span><span class=line><span class=cl>Scanning application launchers
</span></span><span class=line><span class=cl>Removing duplicate launchers or broken launchers
</span></span><span class=line><span class=cl>Launchers are updated
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-2<span class=o>]</span>─<span class=o>[</span>10.10.14.25<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-xh9th8t7hj<span class=o>]</span>─<span class=o>[</span>~/find-the-easy-pass<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Running - <em><strong>ollydbg EasyPass.exe</strong></em> and</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/ollydbg.png alt=ollydbg title=ollydbg></p><p>choosing <em>View</em> -> <em>Executable modules</em> -> <em>EasyPass</em> should change our left-top window.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/ollydbg-module.png alt=ollydbg-module title=ollydbg-module></p><p>Let&rsquo;s <strong>search</strong> for the - <em>Wrong Password!</em> - string. <em>(Right click in top-left window)</em> -> <em>Search for</em> -> <em>All referenced text strings</em> -> <em>(Right click in new window)</em> -> <em>Search for text</em> -> <em>&ldquo;Wrong Password!&rdquo;</em> -> <em>(Right click on match)</em> -> <em>Follow in Disassembler</em>.</p><p>Now that we found our <strong>place</strong> in the <strong>source code</strong>, let&rsquo;s set a <strong>breakpoint</strong> here and <strong>run</strong> the <strong>executable</strong>.</p><p>Choosing &mdash; <em>(Right click on - Wrong Password! - match in top-left window)</em> -> <em>Breakpoint</em> -> <em>Toggle</em> &mdash; should set the <strong>breakpoint</strong>. Starting our program is then done by clicking the <em>play</em> button.</p><p>But considering the <strong>breakpoint</strong> we just set, the execution will only continue <strong>till before the point</strong> where - <em>Wrong Password!</em> - get&rsquo;s displayed. Then it would <strong>stop</strong>.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/ollydbg-breakpoint.png alt=ollydbg-breakpoint title=ollydbg-breakpoint></p><p>We <strong>start</strong> it and <strong>wait</strong> until the execution <strong>halts</strong>. Then we head over to the bottom-right window since this is where the <strong>data</strong> which <strong>surrounds</strong> our <strong>test input/password</strong> is displayed. Maybe the real password is stored nearby?</p><p>The only other <em>ASCII</em> field other than our <strong>test input</strong> in our close <strong>environment</strong> contains the - <em>&lt;password></em> - string.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/ollydbg-paused.png alt=ollydbg-paused title=ollydbg-paused></p><h2 id=verification><strong>VERIFICATION</strong><a hidden class=anchor aria-hidden=true href=#verification>#</a></h2><p>Could this be the <strong>password</strong>? Running - <em>EasyPass.exe</em> - with <em><strong>wine</strong></em> and inputting the found <strong>password</strong> - confirms it. We have our <strong>winner</strong>!</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/find-the-easy-pass/wine-success.png alt=wine-success title=wine-success></p><p>Given that this was a <strong>challenge box</strong> without any <strong>instantiated targets</strong>, there is simply not much to clean up here. Once we <strong>submit</strong> the <strong>password</strong> as - <em>HTB{&lt;password>}</em> - we move on to the <strong>next machine</strong>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bluewalle.github.io/tags/htb/>htb</a></li><li><a href=https://bluewalle.github.io/tags/walkthrough/>walkthrough</a></li><li><a href=https://bluewalle.github.io/tags/find-the-easy-pass/>find-the-easy-pass</a></li><li><a href=https://bluewalle.github.io/tags/easy-box/>easy-box</a></li><li><a href=https://bluewalle.github.io/tags/retired/>retired</a></li><li><a href=https://bluewalle.github.io/tags/challenge-box/>challenge-box</a></li><li><a href=https://bluewalle.github.io/tags/checksum/>checksum</a></li><li><a href=https://bluewalle.github.io/tags/sha256sum/>sha256sum</a></li><li><a href=https://bluewalle.github.io/tags/reverse-engineering/>reverse-engineering</a></li><li><a href=https://bluewalle.github.io/tags/ghidra/>ghidra</a></li><li><a href=https://bluewalle.github.io/tags/ollydbg/>ollydbg</a></li><li><a href=https://bluewalle.github.io/tags/completed-challenge/>completed-challenge</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>